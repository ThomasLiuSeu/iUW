/*
 * SInA - SAP HANA Simple Info Access API
 * version 1.0.13 - 2015-02-10 

 * Copyright (c) 2015 SAP SE; All rights reserved
 */
/*
 * @file Simple info access (SINA) API: Filter Interface
 * @namespace sap.bc.ina.api.sina.base.filter
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";if(g!==null){g.sap=g.sap||{};g.sap.bc=g.sap.bc||{};g.sap.bc.ina=g.sap.bc.ina||{};g.sap.bc.ina.api=g.sap.bc.ina.api||{};g.sap.bc.ina.api.sina=g.sap.bc.ina.api.sina||{};g.sap.bc.ina.api.sina.expandPackage=function(g,p){var s=p.split('.');var w=g;for(var i=0;i<s.length;i++){if(typeof w[s[i]]==='undefined'){w[s[i]]={};}w=w[s[i]];}};}}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base.filter');var m=g.sap.bc.ina.api.sina.base.filter;m.getRootDataSource=function(){};m.DataSource=function(){this.init.apply(this,arguments);};m.DataSourceMetaData=function(){this.init.apply(this,arguments);};m.Filter=function(){this.init.apply(this,arguments);};m.Condition=function(){this.init.apply(this,arguments);};m.ConditionGroup=function(){this.init.apply(this,arguments);};m.DataSourceMetaData.prototype={init:function(){}};m.DataSource.prototype={init:function(){},equals:function(o){},getMetaData:function(c){},getMetaDataSync:function(){},getLabel:function(){},setLabel:function(l){}};m.Filter.prototype={init:function(p){p=p||{};this.setDataSource(p.dataSource,false);this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=new m.ConditionGroup({operator:'And'});this.searchTerms="";},addFilterConditionGroup:function(c){this.defaultConditionGroup.addCondition(c);},getFilterConditions:function(){return this.defaultConditionGroup;},getSearchTerms:function(){return this.searchTerms;},getDataSource:function(){return this.dataSource;},removeFilterConditionGroup:function(c){this.defaultConditionGroup.removeCondition(c);},setSearchTerms:function(s){this.searchTerms=s;},setDataSource:function(d){this.dataSource=d;},getJson:function(){},setJson:function(){}};m.Condition.prototype={init:function(a,o,v){if($.type(a)==='object'){var p=a;a=p.attribute;o=p.operator;v=p.value;}this.attribute=a||"";this.operator=o||"=";this.value=v;},equals:function(o){if(!(o instanceof m.Condition)){return false;}return this.attribute.toLowerCase()===o.attribute.toLowerCase()&&this.operator===o.operator&&this.value.toLowerCase()===o.value.toLowerCase();},getJson:function(p){},setJson:function(j){},toString:function(){return this.attribute+this.operator+this.value+'';}};m.ConditionGroup.prototype={init:function(p){p=p||{};this.label=p.label||'';this.conditions=p.conditions||[];this.setOperator(p.operator||'And');},addCondition:function(c){this.conditions.push(c);return this;},equals:function(o){if(!(o instanceof m.ConditionGroup)){return false;}if(this.conditions.length!==o.conditions.length){return false;}var a=[];for(var i=0,l=this.conditions.length;i<l;i++){var c=this.conditions[i];var b=false;for(var j=0,d=o.conditions.length;j<d;j++){var e=o.conditions[j];if(c.equals(e)){b=true;break;}}if(b){continue;}else{return false;}}return true;},getConditions:function(){return this.conditions;},getConditionsAsArray:function(a,c){c=c||[];a=a||this;for(var i=0;i<a.conditions.length;i++){if(a.conditions[i]instanceof m.ConditionGroup){this.getConditionsAsArray(a.conditions[i],c);}else{c.push(a.conditions[i]);}}return c;},hasCondition:function(c){for(var i=0,l=this.conditions.length;i<l;i++){var a=this.conditions[i];if(a instanceof m.ConditionGroup){if(c instanceof m.ConditionGroup){if(a.equals(c)){return true;}}else if(c instanceof m.Condition){if(a.hasCondition(c)){return true;}}}else if(a instanceof m.Condition){if(c instanceof m.ConditionGroup){if(c.hasCondition(a)){return true;}}else if(c instanceof m.Condition){if(a.equals(c)){return true;}}}}return false;},removeCondition:function(c){var a;for(var i=0,l=this.conditions.length;i<l;i++){a=this.conditions[i];if(a instanceof m.ConditionGroup){if(c instanceof m.ConditionGroup){if(a.equals(c)){this.conditions.splice(i,1);}}else if(c instanceof m.Condition){a.removeCondition(c);}}else if(a instanceof m.Condition){if(c instanceof m.ConditionGroup){c.removeCondition(a);}else if(c instanceof m.Condition){if(a.equals(c)){this.conditions.splice(i,1);}}}}for(i=0,l=this.conditions.length;i<l;i++){a=this.conditions[i];if(a instanceof m.ConditionGroup&&a.conditions.length===0){this.conditions.splice(i,1);}}return this;},setLabel:function(l){this.label=l;return this;},setOperator:function(o){switch(o.toLowerCase()){case'or':o='Or';break;case'and':o='And';break;default:throw{message:'unknown operator for condition group: '+o};}this.operator=o;return this;},toString:function(){return this.label;},getJson:function(p){},setJson:function(j){}};}(window));
/*
 * @file The Simple Information Access (SINA) Interface
 * @namespace sap.bc.ina.api.sina.base
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.filter;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base');var m=g.sap.bc.ina.api.sina.base;var e=function(){};$.extend(m,{provider:{},registerProvider:function(p){this.provider[p.impl_type]=p;}});m.Sina=function(){this.init.apply(this,arguments);};m.Sina.prototype={init:function(){},_initQueryProperties:function(p){p=p||{};p.system=p.system||this.getSystem();if(p.dataSource){p.dataSource=new this._provider.DataSource(p.dataSource);}return p;},createChartQuery:function(p){p=this._initQueryProperties(p);return new this._provider.chartQuery(p);},createSearchQuery:function(p){p=this._initQueryProperties(p);return new this._provider.searchQuery(p);},createGroupBarChartQuery:function(p){p=this._initQueryProperties(p);return new this._provider.groupBarChartQuery(p);},createLineChartQuery:function(p){p=this._initQueryProperties(p);p.dimensions=[p.dimensionLine,p.dimensionX];p.measures=[{name:p.measureY.name,aggregationFunction:p.measureY.aggregationFunction}];return new this._provider.lineChartQuery(p);},createSuggestionQuery:function(p){p=this._initQueryProperties(p);return new this._provider.suggestionQuery(p);},createPerspectiveQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveQuery(p);},createPerspectiveSearchQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveSearchQuery(p);},createPerspectiveGetQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveGetQuery(p);},sinaSystem:function(s){if(s){this.sys=s;}else{return this.sys;}return{};},getSystem:function(){if(this.sys){return this.sys;}return{};},setSystem:function(s){this.sys=s;},createFacet:function(p){return new this._provider.Facet(p);},FacetType:{ATTRIBUTE:'attribute',DATASOURCE:'datasource',SEARCH:'searchresult'},createFilter:function(p){return new this._provider.Filter(p);},createFilterCondition:function(p){return new this._provider.FilterCondition(p);},createFilterConditionGroup:function(p){return new this._provider.FilterConditionGroup(p);},createDataSource:function(p){return new this._provider.DataSource(p);},createDataSourceQuery:function(p){p=this._initQueryProperties(p);return new this._provider.DataSourceQuery(p);},getRootDataSource:function(){return this._provider.getRootDataSource();}};m.Query=function(){this.init.apply(this,arguments);};m.Query.prototype={init:function(p){p=p||{};this.system=p.system;this.onSuccess=p.onSuccess;this.onError=p.onError;this._responseJson=null;this.setTop(p.top||10);this.setSkip(p.skip||0);this.resultSetProperties=p;this.filter=this.filter||p.filter||new f.Filter({dataSource:p.dataSource});if(p.filterConditions&&p.filterConditions.length>0){for(var i=0,l=p.filterConditions.length;i<l;i++){var a=p.filterConditions[i];if(a&&a instanceof Array&&a.length>0){this.addFilterCondition(a[0],a[1],a[2]);}else if(a&&typeof a==='string'){this.addFilterCondition(p.filterConditions[0],p.filterConditions[1],p.filterConditions[2]);break;}}}this.setSearchTerms(p.searchTerms||'');},dataSource:function(n){if(n){this.setDataSource(n);return this;}else{return this.getDataSource();}},getDataSource:function(){return this.filter.getDataSource();},setDataSource:function(d){if(d===undefined){return this;}if(this.filter.getDataSource()===undefined){this.filter.setDataSource(d);this._resetResultSet();return this;}if(!this.filter.getDataSource().equals(d)){this.filter.setDataSource(d);this._resetResultSet();}return this;},getFilter:function(){return this.filter;},setFilter:function(a){this.filter=a;this._resetResultSet();return this;},setSearchTerms:function(t){if(this.filter.getSearchTerms()!==t){this.filter.setSearchTerms(t);this._resetResultSet();}return this;},getSearchTerms:function(){return this.filter.getSearchTerms();},skip:function(n){if(n!==undefined){this.setSkip(n);}else{return this._skip;}return this;},getSkip:function(){return this._skip;},setSkip:function(s){if(typeof s!=='number'){return false;}this._skip=this._skip||undefined;if(this._skip!==s){this._skip=s;this._resetResultSet();}return this;},top:function(n){if(n!==undefined){this.setTop(n);}else{return this._top;}return this;},getTop:function(){return this._top;},setTop:function(t){if(isNaN(t)){return false;}this._top=parseInt(this._top,10);if(this._top!==t){this._top=t;this._resetResultSet();}return this;},addFilterCondition:function(a,o,v){if(typeof(a)==="string"){a=new g.sap.bc.ina.api.sina.impl.inav2.filter.Condition(a,o,v);}if(this.filter.hasFilterCondition(a,o,v)===false){this.filter.addFilterCondition(a,o,v);this._resetResultSet();}return this;},removeFilterCondition:function(a,o,v){this.filter.removeFilterCondition(a,o,v);this._resetResultSet();return this;},resetFilterConditions:function(){this.filter.resetFilterConditions();this._resetResultSet();return this;},getResultSetSync:function(){this.resultSet=this.executeSync();return this.resultSet;},getResultSet:function(o,a){var _=this;o=o||this.onSuccess||e;a=a||this.onError||e;var r=this.execute();r.done(function(b){_.resultSet=b;o(b);});r.fail(function(b){a(b);});return r.promise();},_resetResultSet:function(){},execute:function(){},executeSync:function(){},};m.ChartQuery=function(){this.init.apply(this,arguments);};m.ChartQuery.prototype=$.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.FacetType=m.Sina.prototype.FacetType;m.Facet=function(){this.init.apply(this,arguments);};m.Facet.prototype={init:function(p){p=p||{};this.title=p.title||'';this.query=p.query||null;p.facetType=p.facetType||'';this.facetType=p.facetType.toLowerCase();if(p.query){this.setQuery(p.query);}},getChartType:function(){},getTitle:function(){return this.title;},getDimension:function(){return this.dimension;},getQuery:function(){return this.query;},getLayout:function(){},getLayoutBinding:function(){},getColorPalette:function(){},setQuery:function(q){this.query=q;}};m.PerspectiveQuery=function(){this.init.apply(this,arguments);};m.PerspectiveQuery.prototype=$.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);this.facets=[];},addFacet:function(a){this.facets.push(a);return this;},getFacets:function(){return this.facets;},setOrderBy:function(o){this._resetResultSet();this.orderBy=o||{orderBy:'$$score$$',sortOrder:'DESC'};return this;}});m.SearchQuery=function(){this.init.apply(this,arguments);};m.SearchQuery.prototype=$.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.SuggestionQuery=function(){this.init.apply(this,arguments);};m.SuggestionQuery.prototype=$.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.SinaError=function(){this.init.apply(this,arguments);};m.SinaError.SEVERITY_ERROR=3;m.SinaError.SEVERITY_WARNING=2;m.SinaError.SEVERITY_INFO=1;m.SinaError.prototype={init:function(p){this.message=p.message||'';this.errorCode=p.errorCode||null;this.severity=p.severity||m.SinaError.SEVERITY_ERROR;},getErrorCode:function(){return this.errorCode;},getMessage:function(){return this.message;},getSeverity:function(){return this.severity;},setSeverity:function(s){this.severity=s;},toString:function(){var a="";switch(this.severity){case m.SinaError.SEVERITY_ERROR:a+="SINA ERROR: ";break;case m.SinaError.SEVERITY_WARNING:a+="SINA WARNING: ";break;case m.SinaError.SEVERITY_INFO:a+="SINA INFO: ";break;}a+=this.message;return a;}};}(window));
/*
 * @file Simple info access (SINA) API: System representation
 * @namespace sap.bc.ina.api.sina.base.system
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var p=g.sap.bc.ina.api.sina.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base.system');var m=g.sap.bc.ina.api.sina.base.system;m.System=function(){this.init.apply(this,arguments);};m.Service=function(){this.init.apply(this,arguments);};m.Capability=function(){this.init.apply(this,arguments);};m.Capability.prototype={init:function(a){this.properties=a||{};this.name=this.properties.Capability||'';this.minVersion=this.properties.MinVersion||0;this.maxVersion=this.properties.MaxVersion||0;}};m.Service.prototype={init:function(a){this.properties=a||{};this.name=this.properties.Service;this.minVersion=this.properties.MinVersion||0;this.maxVersion=this.properties.MaxVersion||0;this.capabilities={};for(var i=0;i<this.properties.Capabilities.length;i++){this.capabilities[this.properties.Capabilities[i].Capability]=new m.Capability(this.properties.Capabilities[i]);}},getCapability:function(n){return this.capabilities[n];},getCapabilities:function(){return this.capabilities;}};m.System.prototype={init:function(a){this.properties=a||{};this.services={};this.proxy=a.proxy||new p.Proxy();},getService:function(n){return this.services[n];},getServices:function(){return this.services;},getSystemType:function(){return this.systemType;},_deleteServerInfo:function(){this.jqXHR=$.Deferred();},_getServerInfo:function(i){var s=this;if(this.jqXHR){return this.jqXHR.promise();}this.jqXHR=$.Deferred();var r={async:i,type:'GET',url:this.infoUrl,getServerInfo:true,processData:false,contentType:'application/json',dataType:'json'};this.proxy.ajax(r).done(function(d){s.setServerInfo(d);s.jqXHR.resolve(s.properties);}).fail(function(e){s.jqXHR.reject(e);});if(i===true){return this.jqXHR.promise();}return this.properties;},getServerInfo:function(){return this._getServerInfo(true);},getServerInfoSync:function(){return this._getServerInfo(false);},setServerInfo:function(j){this.properties.rawServerInfo=j;}};}(window));
/*
 * @file Proxy which offers some extras for ajax calls.
 * @namespace sap.bc.ina.api.sina.proxy
 * @copyright Copyright (c) 2014 SAP SE. All rights reserved.
 * @ignore
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.proxy');var m=g.sap.bc.ina.api.sina.proxy;m.record=g.sap.bc.ina.api.sina.proxy.record||{};m.record.recordings=[];m.Proxy=function(){this.init.apply(this,arguments);};m.inaReqResBuffer={};m.Proxy.prototype={init:function(p){this.properties=p||{};this.xsrfToken='';this.xsrfService=this.properties.xsrfService;this.xsrfRetries=0;this.xsrfRequest={'headers':{'X-CSRF-Token':'Fetch'},'cache':false,'url':this.xsrfService};this.properties.cachelifetime=this.properties.cachelifetime||0;this.properties.httpMethod=this.properties.httpMethod||'post';if(this.properties.cachelifetime>0){g.window.setInterval(function(){m.inaReqResBuffer={};},this.properties.cachelifetime);}this._checkRecordingURLValues();},_checkRecordingURLValues:function(){function a(n){return decodeURI((new RegExp(n+'='+'(.+?)(&|$)').exec(g.window.location.search)||[null])[1]);}function h(n){if(g.window.location.search.toLowerCase().indexOf('&'+n.toLowerCase())!==-1){return true;}if(g.window.location.search.toLowerCase().indexOf('?'+n.toLowerCase())!==-1){return true;}return false;}if(h('record')){var t=a('record');if(!t||t==='undefined'){t='defaultRecord.json';}this.properties.record=t;}if(h('demoMode')){var d=a('demoMode');if(!d||d==='undefined'){d='defaultRecord.json';}this.properties.demoMode=d;}},_requestHashValue:function(u,d){return JSON.stringify({'requestUrl':u,'requestData':d});},_handleRequestFromCache:function(r){var i=JSON.stringify(r.data);var a=m.inaReqResBuffer[i];if(a){var j=$.Deferred();j.resolve(a);return j.promise();}return{};},_handleRequestFromRecords:function(r){var s=this;var d=$.Deferred();var p=d.promise();var a=this._requestHashValue(r.url,r.data);var f=function(c){p.responseText='';for(var i=0;i<c.length;i++){var e=c[i];var h=s._requestHashValue(e.requestUrl,e.requestData);if(a===h){p.responseText=JSON.stringify(e.responseData);d.resolve(e.responseData);return;}}d.reject('could not find recorded demo response for request: '+JSON.stringify(r));return;};if(m.record.demoData){f(m.record.demoData);}else{var b=$.ajax({dataType:'json',url:s.properties.demoMode,async:r.async});if(r.async){b.done(function(c){if(c){m.record.demoData=c;f(c);}else{d.reject('no demo data found at '+s.properties.demoMode);}});}else{var c=JSON.parse(b.responseText);f(c);}}return p;},_processRequestBuffer:function(){var s=this;$.each(this.requestBuffer,function(i,r){s.fireRequest(r).done(function(a){r.jqxhrProxy.resolve(a);});});this.requestBuffer=[];},setXSRFService:function(u){this.xsrfService=u;this.xsrfRequest.url=u;},_getXSRFToken:function(){var s=this;if(!this.xsrfDeferred){this.xsrfRetries++;this.xsrfDeferred=$.ajax(this.xsrfRequest);this.xsrfDeferred.done(function(d){s.xsrfToken=s.xsrfDeferred.getResponseHeader('X-CSRF-Token')||s.xsrfToken||'';if(s.xsrfToken){s.xsrfRetries=0;}});}return this.xsrfDeferred.promise();},_requestWithXSRFToken:function(r){var s=this;if(r.async===false){if(this.xsrfDeferred&&this.xsrfDeferred.state()==='pending'){this.xsrfDeferred.abort();}this.xsrfRequest.async=false;this.xsrfDeferred=$.ajax(this.xsrfRequest);this.xsrfToken=this.xsrfDeferred.getResponseHeader('X-CSRF-Token')||this.xsrfToken||'';r.headers={'X-CSRF-Token':this.xsrfToken};return $.ajax(r);}else{var d=$.Deferred();this._getXSRFToken().done(function(a){r.headers={'X-CSRF-Token':s.xsrfToken};$.ajax(r).done(function(a){d.resolve(a);}).fail(function(e){if(e.status===400){if(e.responseJSON&&e.responseJSON.Error&&e.responseJSON.Error.Code&&e.responseJSON.Error.Code===403){if(s.xsrfRetries<5){s.xsrfDeferred=null;return s._requestWithXSRFToken(r);}}}d.reject(e);});}).fail(function(e){d.reject(e);});return d.promise();}},ajax:function(r){var s=this;var i=r.data===undefined?undefined:JSON.stringify(r.data);var a;if(this.properties.cachelifetime>0){return this._handleRequestFromCache(r);}if(this.properties.demoMode){var f=this._handleRequestFromRecords(r);return f;}var b;if(this.properties.record){b=this._requestHashValue(r.url,r.data);}r.processData=r.processData||false;r.type=r.type||this.properties.httpMethod||'POST';if(i){if(r.type.toLowerCase()==='get'){r.data='Request='+i;}else{r.data=i;}}var j=this._requestWithXSRFToken(r);j.done(function(a){if(s.properties.cachelifetime>0){s._cacheResponse(r,a);}if(s.properties.record){s._recordResponse(JSON.parse(b),a);}});return j;},_cacheResponse:function(r,d){var i=JSON.stringify(r.data);m.inaReqResBuffer[i]=d;},_recordResponse:function(r,a){var s=this;var b={'requestUrl':r.requestUrl,'requestData':r.requestData,'responseData':a};m.record.recordings.push(JSON.stringify(b));var u=function(f){var h={};return f.filter(function(b){var k=m.Proxy.prototype._requestHashValue(b.requestUrl,b.requestData);return(h[k]===1)?0:h[k]=1;});};var c=m.record.recordings.slice();for(var i=0;i<c.length;i++){c[i]=JSON.parse(c[i]);}var d=c.length;c=u(c);var e=JSON.stringify(c);$.ajax({type:'PUT',url:s.properties.record,data:e,contentType:'application/json',dataType:'json',});}};}(window));
/*
 * Simple info access (SINA) API: JSON Templates
 * Package: sap.bc.ina.api.sina.impl.inav2.jsontemplates
 * Copyright (c) 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.jsontemplates');var m=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;m.getDataSourceMetaDataRequest=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Metadata":{"Context":"Search","Expand":["Cube"]},"ServiceVersion":204});};m.getCatalogRequest=function(){return $.extend({},{"DataSource":{"ObjectName":"$$DataSources$$","PackageName":"ABAP"},"Options":["SynchronousRun"],"Search":{"Top":1000,"Skip":0,"OrderBy":[{"AttributeName":"Description","SortOrder":"ASC"},{"AttributeName":"ObjectName","SortOrder":"ASC"}],"Expand":["Grid","Items"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"SupportedService","Comparison":"=","Value":"Search"}}]}}},"NamedValues":[{"AttributeName":"ObjectName","Name":"ObjectName"},{"AttributeName":"Description","Name":"Description"},{"AttributeName":"Type","Name":"Type"}]},"SearchTerms":"*","ServiceVersion":204});};m.getSuggestionRequest=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Suggestions":{"Expand":["Grid","Items"],"Precalculated":false,"SearchTerms":"","AttributeNames":[]},"ServiceVersion":204});};m.getSuggestion2Request=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Suggestions2":{"Expand":["Grid","Items"],"Precalculated":false,"AttributeNames":[]},"ServiceVersion":204});};m.getPerspectiveRequest=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items","ResultsetFacets","TotalCount"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"$$RenderingTemplatePlatform$$","Comparison":"=","Value":"html"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateTechnology$$","Comparison":"=","Value":"Tempo"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateType$$","Comparison":"=","Value":"ResultItem"}}]}}},"Top":10,"Skip":0,"SearchTerms":"S*","NamedValues":[{"Function":"WhyFound","Name":"$$WhyFound$$"},{"Function":"RelatedActions","Name":"$$RelatedActions$$"}]},"ServiceVersion":204});};m.getPerspectiveSearchRequest=function(){return $.extend({},{"DataSource":{"ObjectName":"$$Perspectives$$","Type":"View"},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items"],"Filter":{"Selection":{"Operator":{"Code":"Or","SubSelections":[{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"3"}},{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"4"}},{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"5"}}]}}},"SearchTerms":"*","SelectedValues":[{"AttributeName":"PACKAGE_ID","Name":"PACKAGE_ID"},{"AttributeName":"PERSPECTIVE_ID","Name":"PERSPECTIVE_ID"},{"AttributeName":"TITLE_TEXT","Name":"TITLE_TEXT"},{"AttributeName":"SUMMARY_TEXT","Name":"SUMMARY_TEXT"}],"Skip":0,"Top":30}});};m.getPerspectiveRequestFactsheet=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items","ResultsetFacets","TotalCount"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"$$RenderingTemplatePlatform$$","Comparison":"=","Value":"html"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateTechnology$$","Comparison":"=","Value":"Tempo"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateType$$","Comparison":"=","Value":"ResultItem"}}]}}},"Top":10,"Skip":0,"SearchTerms":"S*","NamedValues":[{"Function":"WhyFound","Name":"$$WhyFound$$"},{"AttributeName":"$$RelatedActions$$"},{"AttributeName":"$$RelatedActions.Proxy$$"}]},"ServiceVersion":204});};m.getSearchRequest=function(){return $.extend({},{"DataSource":{},"SearchTerms":"DUMMY","Search":{"Expand":["Grid","Items","TotalCount"],"Top":"DUMMY","Skip":"DUMMY","SelectedValues":"DUMMY","NamedValues":[{"AttributeName":"$$ResultItemAttributes$$","Name":"$$ResultItemAttributes$$"},{"AttributeName":"$$RelatedActions$$","Name":"$$RelatedActions$$"}]}});};m.getChartRequest=function(){return $.extend({},{"DataSource":{},"Options":["SynchronousRun"],"SearchTerms":"","Analytics":{"Definition":{"Dimensions":[{"Axis":"Rows","Name":"CATEGORY","SortOrder":1,"Top":5},{"Axis":"Columns","Name":"CustomDimension1","Members":[{"Aggregation":"COUNT","AggregationDimension":"CATEGORY","MemberOperand":{"AttributeName":"Measures","Comparison":"=","Value":"COUNT"},"Name":"COUNT","SortOrder":2}]}],"Filter":{}}}});};}(window));
/*
 * @file Implementation of the filter interface
 * @namespace sap.bc.ina.api.sina.impl.inav2.filter
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.base.filter;var t=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.filter');var m=g.sap.bc.ina.api.sina.impl.inav2.filter;m.getRootDataSource=function(){return new m.DataSource({ObjectName:"$$ALL$$",PackageName:"ABAP",SchemaName:"",Type:"Category"});};m.DataSource=function(){this.init.apply(this,arguments);};m.DataSourceMetaData=function(){this.init.apply(this,arguments);};m.Filter=function(){this.init.apply(this,arguments);};m.Condition=function(){this.init.apply(this,arguments);};m.ConditionGroup=function(){this.init.apply(this,arguments);};m.DataSourceMetaData.prototype=$.extend({},f.DataSourceMetaData.prototype,{init:function(p){p=p||{};this.datasource=p.datasource||{};this.description=p.description||'';this.dimensions={};},_getMetaDataRequest:function(){var r=t.getDataSourceMetaDataRequest();r.DataSource=this.datasource.toInAJson();return r;},_getMetaData:function(i,c){var s=this;var r={async:i,url:g.sap.bc.ina.api.sina.getSystem().inaUrl,processData:false,contentType:'application/json',dataType:'json',data:this._getMetaDataRequest()};var j=g.sap.bc.ina.api.sina.getSystem().proxy.ajax(r);j.done(function(d){if(!s.rawMetadata){s._parseServerMetaData(d);}if(c){c(s);}});return this;},_parseServerMetaData:function(a){this.rawMetadata=a;this.description=this.rawMetadata.Cube.Description;this.datasource.setLabel(this.description);for(var i=0;i<this.rawMetadata.Cube.Dimensions.length;i++){var d={};d.name=this.rawMetadata.Cube.Dimensions[i].Name;d.description=this.rawMetadata.Cube.Dimensions[i].Description;d.attributes={};for(var j=0;j<this.rawMetadata.Cube.Dimensions[i].Attributes.length;j++){d.attributes[this.rawMetadata.Cube.Dimensions[i].Attributes[j].Name]={name:this.rawMetadata.Cube.Dimensions[i].Attributes[j].Name,description:this.rawMetadata.Cube.Dimensions[i].Attributes[j].Description};}this.dimensions[d.name]=d;}}});m.DataSource.prototype=$.extend({},f.DataSource.prototype,{init:function(p){p=p||{};p.schemaName=p.schemaName||p.SchemaName||{};this.setSchemaName(p.schemaName);p.packageName=p.packageName||p.PackageName||{};this.setPackageName(p.packageName);p.objectName=p.objectName||p.ObjectName||{};this.setObjectName(p.objectName);p.type=p.type||p.Type||{};this.setType(p.type);this.label=p.label||p.Label||p.Description||'';if(p.metaData){this.setMetaData(p.metaData);}},equals:function(o){if(o instanceof m.DataSource){if(this.getSchemaName().label!==o.getSchemaName().label||this.getSchemaName().value!==o.getSchemaName().value){return false;}if(this.getPackageName().label!==o.getPackageName().label||this.getPackageName().value!==o.getPackageName().value){return false;}if(this.getObjectName().label!==o.getObjectName().label||this.getObjectName().value!==o.getObjectName().value){return false;}if(this.getType().label!==o.getType().label||this.getType().value!==o.getType().value){return false;}return true;}return false;},getMetaData:function(c){var s=this;if(!s.metaData){s.metaData=new m.DataSourceMetaData({datasource:this});}s.metaData._getMetaData(true,c);},getMetaDataSync:function(){var s=this;if(!s.metaData){s.metaData=new m.DataSourceMetaData({datasource:this});s.metaData._getMetaData(false);}return s.metaData;},setMetaData:function(d){this.metaData=d;},getSchemaName:function(){return this.schemaName;},setSchemaName:function(s){if(!this.schemaName){this.schemaName={};}if($.type(s)==='object'){this.schemaName.label=s.label||s.value||'';this.schemaName.value=s.value||'';}if($.type(s)==='string'){this.schemaName.label=s;this.schemaName.value=s;}},getPackageName:function(){return this.packageName;},setPackageName:function(p){if(!this.packageName){this.packageName={};}if($.type(p)==='object'){this.packageName.label=p.label||p.value||'';this.packageName.value=p.value||'';}if($.type(p)==='string'){this.packageName.label=p;this.packageName.value=p;}},getObjectName:function(){return this.objectName;},setObjectName:function(o){if(!this.objectName){this.objectName={};}if($.type(o)==='object'){this.objectName.label=o.label||o.value||'';this.objectName.value=o.value||'';}if($.type(o)==='string'){this.objectName.label=o;this.objectName.value=o;}},setObjectNameValue:function(v){if(!this.objectName){this.objectName={};}this.objectName.value=v||'';},setObjectNameLabel:function(l){if(!this.objectName){this.objectName={};}this.objectName.label=l||'';},getType:function(){return this.type;},setType:function(a){if(!this.type){this.type={};}if($.type(a)==='object'){this.type.label=a.label||a.value||'';this.type.value=a.value||'';}if($.type(a)==='string'){this.type.label=a;this.type.value=a;}},getLabel:function(){if(typeof this.label!=='undefined'&&this.label!==''){return this.label;}if(typeof this.getObjectName().label!=='undefined'&&this.getObjectName().label!==''){return this.getObjectName().label;}if(typeof this.getObjectName().value!=='undefined'&&this.getObjectName().value!==''){return this.getObjectName().value;}return'';},setLabel:function(l){this.label=l||'';},fromInAJson:function(i){this.setSchemaName({value:i.SchemaName,label:i.SchemaLabel});this.setPackageName({value:i.PackageName,label:i.PackageLabel});this.setObjectName({value:i.ObjectName,label:i.ObjectLabel});this.setType({value:i.Type,label:''});},toInAJson:function(){var j={'SchemaName':this.getSchemaName().value,'PackageName':this.getPackageName().value,'ObjectName':this.getObjectName().value};if(this.getType().value){j.Type=this.getType().value;}return j;},toURL:function(){var j={'sn':this.getSchemaName().value,'pn':this.getPackageName().value,'on':this.getObjectName().value};if(this.getType().value){j.tn=this.getType().value;}return j;},fromURL:function(i){this.setSchemaName(i.sn);this.setPackageName(i.pn);this.setObjectName(i.on);this.setType(i.tn);}});m.Filter.prototype=$.extend({},f.Filter.prototype,{init:function(p){g.sap.bc.ina.api.sina.base.filter.Filter.prototype.init.apply(this,[p]);this.defaultConditionGroup=new m.ConditionGroup({operator:'And'});},addFilterCondition:function(a,o,v){var l=a;var b=o;var c=v;if(a instanceof m.ConditionGroup){this.defaultConditionGroup.addCondition(a);return this;}if($.type(a)==='object'){var p=a;l=p.attribute;b=p.operator;c=p.value;}if(l===undefined||b===undefined||c===undefined){return this;}if(this.conditionGroupsByAttribute[l]===undefined){this.conditionGroupsByAttribute[l]=new m.ConditionGroup({operator:'OR'});this.defaultConditionGroup.addCondition(this.conditionGroupsByAttribute[l]);}this.conditionGroupsByAttribute[l].addCondition(new m.Condition(l,b,c));return this;},getJson:function(){var r=[];this.defaultConditionGroup.getJson(r);var a={Selection:r[0]};return a;},setJson:function(j){if(j.Selection===undefined){return;}var a=new m.ConditionGroup();a.setJson(j);this.defaultConditionGroup.addCondition(a);},empty:function(){this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=new m.ConditionGroup({operator:'And'});this.searchTerms='';return this;},hasFilterCondition:function(a,o,v){if(typeof(a)==="string"){a=new m.Condition(a,o,v);}return this.defaultConditionGroup.hasCondition(a);},resetFilterConditions:function(){this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=new m.ConditionGroup({operator:'And'});return this;},removeFilterCondition:function(a,o,v){this.defaultConditionGroup.removeCondition(new m.Condition(a,o,v));delete this.conditionGroupsByAttribute[a];return this;}});m.Condition.prototype=$.extend(Object.create(f.Condition.prototype),{init:function(a,o,v){g.sap.bc.ina.api.sina.base.filter.Condition.prototype.init.apply(this,[a,o,v]);if($.type(a)==='object'){this.inaV2_extended_properties=a;delete this.inaV2_extended_properties.attribute;delete this.inaV2_extended_properties.operator;delete this.inaV2_extended_properties.value;}},getJson:function(p){var o;var j={};if(this.operator.toLowerCase()==='contains'){o='SearchOperand';}else{o='MemberOperand';}j[o]={'AttributeName':this.attribute,'Comparison':this.operator,'Value':this.value};if(o==='SearchOperand'){delete j[o].Comparison;}j[o]=$.extend({},j[o],this.inaV2_extended_properties);if(this.operator==='='&&this.value===null){j.MemberOperand.Comparison='IS NULL';j.MemberOperand.Value='';}p.push(j);},setJson:function(j){this.attribute=j.MemberOperand.AttributeName;this.operator=j.MemberOperand.Comparison;this.value=j.MemberOperand.Value;if(j.MemberOperand.Comparison==='IS NULL'&&j.MemberOperand.Value===''){this.operator='=';this.value=null;}}});m.ConditionGroup.prototype=$.extend(Object.create(f.ConditionGroup.prototype),{init:function(p){f.ConditionGroup.prototype.init.apply(this,[p]);},getJson:function(p){if(this.conditions.length===0){return{};}var c=[];for(var i=0;i<this.conditions.length;++i){this.conditions[i].getJson(c);}var j={'Operator':{'Code':this.operator,'SubSelections':c}};if(p){p.push(j);}else{var r={Selection:j};return r;}return{};},setJson:function(j){if(j.Selection===undefined&&j.Operator){j.Selection={};j.Selection.Operator=j.Operator;}this.setOperator(j.Selection.Operator.Code);var c=j.Selection.Operator.SubSelections;for(var i=0;i<c.length;i++){var a;if(c[i].Operator){a=new m.ConditionGroup();}else{a=new m.Condition();}a.setJson(c[i]);this.addCondition(a);}}});}(window));
/*
 * @file Proxy class to buffer InA JSON requests/responses.
 * @namespace sap.bc.ina.api.sina.impl.inav2.proxy
 * @copyright Copyright (c) 2014 SAP SE. All rights reserved.
 * @ignore
 */
(function(g){"use strict";var p=g.sap.bc.ina.api.sina.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.proxy');var m=g.sap.bc.ina.api.sina.impl.inav2.proxy;m.record=g.sap.bc.ina.api.sina.impl.inav2.proxy.record||{};m.record.recordings=[];m.inaReqResBuffer={};m.Proxy=function(){this.init.apply(this,arguments);};m.Proxy.prototype=$.extend({},p.Proxy.prototype,{init:function(a){var s=this;s.properties=a||{};p.Proxy.prototype.init.apply(this,[a]);}});}(window));
/*
 * @file Simple info access (SINA) API: Implementation of the SINA interface
 * for the INA V2 service.
 * @namespace sap.bc.ina.api.sina.impl.inav2
 * @requires sap.bc.ina.api.sina
 * @requires sap.bc.ina.api.sina.impl.inav2.filter
 * @requires sap.bc.ina.api.sina.impl.inav2.system
 * @requires sap.bc.ina.api.sina.impl.inav2.proxy
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.base;var h=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;var p=g.sap.bc.ina.api.sina.impl.inav2.filter;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2');var q=g.sap.bc.ina.api.sina.impl.inav2;q.Condition=p.Condition;q.Sina=function(){this.init.apply(this,arguments);};q.Facet=function(){this.init.apply(this,arguments);};q.Perspective=function(){this.init.apply(this,arguments);};q.Perspective2=function(){this.init.apply(this,arguments);};q.Query=function(){this.init.apply(this,arguments);};q.CatalogQuery=function(){this.init.apply(this,arguments);};q.CatalogResultSet=function(){this.init.apply(this,arguments);};q.PerspectiveQuery=function(){this.init.apply(this,arguments);};q.PerspectiveGetQuery=function(){this.init.apply(this,arguments);};q.PerspectiveSearchQuery=function(){this.init.apply(this,arguments);};q.PerspectiveSearchResultSet=function(){this.init.apply(this,arguments);};q.Suggestion=function(){this.init.apply(this,arguments);};q.SuggestionQuery=function(){this.init.apply(this,arguments);};q.SuggestionResultSet=function(){this.init.apply(this,arguments);};q.Suggestion2Query=function(){this.init.apply(this,arguments);};q.Suggestion2ResultSet=function(){this.init.apply(this,arguments);};q.ChartQuery=function(){this.init.apply(this,arguments);};q.ChartResultSet=function(){this.init.apply(this,arguments);};q.GroupBarChartQuery=function(){this.init.apply(this,arguments);};q.GroupBarChartResultSet=function(){this.init.apply(this,arguments);};q.LineChartQuery=function(){this.init.apply(this,arguments);};q.LineChartResultSet=function(){this.init.apply(this,arguments);};q.SearchQuery=function(){this.init.apply(this,arguments);};q.SearchResultSet=function(){this.init.apply(this,arguments);};q.SuggestionAutoQuery=function(a){if(a.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.ABAPSystem){$.extend(this,q.Suggestion2Query.prototype);}if(a.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.HANASystem){$.extend(this,q.SuggestionQuery.prototype);}this.init.apply(this,arguments);};q.DataSourceQuery=function(){this.init.apply(this,arguments);};q.getDataSources=function(){return q.doGetDataSources.apply(this,arguments);};q.getDataSourcesSync=function(){return q.doGetDataSourcesSync.apply(this,arguments);};q.IMPL_TYPE="inav2";f.registerProvider({impl_type:q.IMPL_TYPE,sina:q.Sina,chartQuery:q.ChartQuery,searchQuery:q.SearchQuery,groupBarChartQuery:q.GroupBarChartQuery,lineChartQuery:q.LineChartQuery,suggestionQuery:q.SuggestionAutoQuery,perspectiveQuery:q.PerspectiveQuery,perspectiveSearchQuery:q.PerspectiveSearchQuery,perspectiveGetQuery:q.PerspectiveGetQuery,Facet:q.Facet,DataSource:p.DataSource,Filter:p.Filter,FilterCondition:p.Condition,FilterConditionGroup:p.ConditionGroup,getRootDataSource:p.getRootDataSource,DataSourceQuery:q.DataSourceQuery,getDataSources:q.getDataSources,getDataSourcesSync:q.getDataSourcesSync});q.Sina.prototype=$.extend({},f.Sina.prototype,{init:function(a){a=a||{};this.setSystem(a.system||new q.system.HANASystem());f.Sina.prototype.init.apply(this,arguments);},sapclient:function(s){var a;if(s){if(s<0){a=new q.system.HANASystem();}else{a=new q.system.ABAPSystem({'sapclient':s});}this.setSystem(a);}else{return this.getSystem().properties.sapclient();}return{};},_registerPostProcessor:function(a){if(!this.postProcessor){this.postProcessor=[];}this.postProcessor.push(a);},_postprocess:function(s,a){if(this.postProcessor){for(var i=0;i<this.postProcessor.length;i++){this.postProcessor[i](s,a);}}},_assembleDataSourceQuery:function(){var d=this.createDataSourceQuery();d.setTop(1000);d.setOrderBy({orderBy:'DESCRIPTION',sortOrder:'ASC'});return d;},_extractDataSources:function(r){var e=r.getElements();var d=[];for(var i=0;i<e.length;++i){var a=e[i];var b=this.createDataSource({objectName:{label:a.OBJECT_NAME.value,value:a.OBJECT_NAME.value},packageName:{label:"ABAP",value:"ABAP"},schemaName:"",type:{label:'View',value:'View'},label:a.DESCRIPTION.value===null?a.OBJECT_NAME.value:a.DESCRIPTION.value});d.push(b);}return this.removeDuplicateDataSources(d);},removeDuplicateDataSources:function(d){var a=[];var m={};for(var i=0;i<d.length;++i){var b=d[i];if(m[b.objectName.value]){continue;}m[b.objectName.value]=true;a.push(b);}return a;},getDataSources:function(){if(this._dataSourcesDeferred){return this._dataSourcesDeferred;}var s=this;var d=s._dataSourcesDeferred=new $.Deferred();var a=s._assembleDataSourceQuery(s);a.getResultSet().then(function(r){s._dataSources=s._extractDataSources(r);d.resolve(s._dataSources);},function(e){if(s._dataSourcesDeferred===d){s._dataSourcesDeferred=null;}d.reject(e);});return this._dataSourcesDeferred;},getDataSourcesSync:function(){if(this._dataSources){return this._dataSources;}var d=this._assembleDataSourceQuery(this);var r=d.getResultSetSync();this._dataSources=this._extractDataSources(r);this._dataSourcesDeferred=$.when(this._dataSources);return this._dataSources;}});q.Query.prototype=$.extend({},{init:function(a){this.filter=a.filter||new p.Filter({dataSource:a.dataSource});},_resetResultSet:function(){this.deferredResultSet=null;this.resultSet=null;this.jqXHR=null;},_getInAV2Error:function(d){var e=[];if(d.error){e.push(new f.SinaError({message:"INA V2 Service Error "+d.error.code+": "+d.error.message,errorCode:d.error.code}));}if(d.Messages){for(var i=0;i<d.Messages.length;i++){if(d.Messages[i].Type>=2){e.push(new f.SinaError({message:"INA V2 Service Error "+d.Messages[i].Number+": "+d.Messages[i].Text,errorCode:d.Messages[i].Number}));}}}return e;},setDataSource:function(d){if(d===undefined){return this;}d=new p.DataSource(d);if(this.filter.getDataSource()===undefined){this.filter.setDataSource(d);this._resetResultSet();return this;}if(!this.filter.getDataSource().equals(d)){this.filter.setDataSource(d);this._resetResultSet();}return this;},execute:function(){var s=this;var j=s.createJsonRequest();s.system.getServerInfo();if(!s.jqXHR){s.jqXHR=s._fireRequest(j,true);}var d=$.Deferred();s.jqXHR.done(function(a){var e=s._getInAV2Error(a);if(a&&e&&e.length>0){if(a.error){d.reject(e[0]);return;}else if(a.Messages){if(e.length>=a.Messages.length){d.reject(e);return;}}}var r=new s.resultSetClass(s.resultSetProperties);r.setJsonData(a);d.resolve(r);}).fail(function(e){d.reject(e);}).always(function(a){s._responseJson=a;});return d.promise();},executeSync:function(){var s=this;if(s.resultSet!==null){return s.resultSet;}var j=s.createJsonRequest();s.system.getServerInfo();var d=JSON.parse(s._fireRequest(j,false).responseText);s._responseJson=d;s.resultSet=new s.resultSetClass(s.resultSetProperties);if(d){var e=s._getInAV2Error(d);if(e&&e.length>0){throw e[0];}s.resultSet.setJsonData(d);}return s.resultSet;},_fireRequest:function(j,a){var r={async:a,url:this.system.inaUrl,contentType:'application/json',dataType:'json',data:j};var b=this.system.proxy.ajax(r);return b;},_assembleOrderBy:function(){var o=[];function a(c,s){var i={};if(c.toLowerCase()==='$$score$$'){i.Function='Score';}else{i.AttributeName=c;}i.SortOrder=s.toUpperCase();return i;}var b;if($.type(this.orderBy)==='array'){for(var j=0;j<this.orderBy.length;j++){b=a(this.orderBy[j].orderBy,this.orderBy[j].sortOrder);o.push(b);}}else if($.type(this.orderBy)==='object'&&this.orderBy.orderBy){b=a(this.orderBy.orderBy,this.orderBy.sortOrder);o.push(b);}return o;}});q.CatalogQuery.prototype=$.extend({},q.Query.prototype,{init:function(a){a=a||{};this.resultSetClass=q.SearchResultSet;},createJsonRequest:function(){return h.getCatalogRequest();}});q.Facet.prototype=$.extend({},f.Facet.prototype,{init:function(a){a=a||{};f.Facet.prototype.init.apply(this,arguments);if(this.facetType==='$$datasources$$'){this.facetType=f.FacetType.DATASOURCE;this.query=new q.ChartQuery();this.query.resultSet=new q.ChartResultSet({"type":"datasource"});}else if(this.facetType===f.FacetType.ATTRIBUTE){this.query=new q.ChartQuery();this.query.resultSet=new q.ChartResultSet();}else if(this.facetType===f.FacetType.SEARCH){this.query=new q.SearchQuery();this.query.resultSet=new q.SearchResultSet();}},setJsonData:function(d){this.query.resultSet.setJsonData(d);this._parseServerSideFacetMetaData(d.Metadata);},_parseServerSideFacetMetaData:function(d){if(d&&d.Cube){this.title=d.Cube.Description;this.dimension=d.Cube.ObjectName;}}});q.PerspectiveQuery.prototype=$.extend({},f.PerspectiveQuery.prototype,q.Query.prototype,{init:function(a){var s=this;s.chartFacets=[];s.searchFacet=null;s.searchresultset=null;s.layout=null;s.templateFactsheet=a.templateFactsheet||false;a=a||{};q.Query.prototype.init.apply(this,arguments);f.PerspectiveQuery.prototype.init.apply(this,arguments);a.orderBy=a.orderBy||{};this.setOrderBy(a.orderBy);a.expand=a.expand||["Grid","Items","ResultsetFacets","TotalCount"];this.setExpand(a.expand);this.resultSetClass=q.Perspective;},setExpand:function(e){this._expand=e;},createJsonRequest:function(){var t=h.getPerspectiveRequest();if(this.templateFactsheet){t=h.getPerspectiveRequestFactsheet();}t.DataSource=this.filter.dataSource.toInAJson();var s=this.filter.getSearchTerms();t.Search.SearchTerms=s;t.Search.Top=this._top;t.Search.Skip=this._skip;t.Search.Filter=this.filter.getJson();t.Search.OrderBy=this._assembleOrderBy();t.Search.Expand=this._expand;return t;},getPerspective:function(o,a){this.getResultSet(o,a);},generatePerspectiveSync:function(){return this.getResultSetSync();}});q.Perspective.prototype={init:function(a){var s=this;s.chartFacets=[];s.searchFacet=null;s.searchresultset=null;s.layout=null;a=a||{};},getSearchResultSet:function(){return this.searchresultset;},getChartFacets:function(){return this.chartFacets;},getSearchFacet:function(){return this.searchFacet;},getLayout:function(){return this.layout;},determineFacetType:function(r){try{if(r.ResultSet.ItemLists[0].Items[0].NamedValues[0].Name==='$$DataSource$$'){return'$$datasources$$';}else{return f.FacetType.ATTRIBUTE;}}catch(e){return f.FacetType.ATTRIBUTE;}},setJsonData:function(d){var s=this;s.searchFacet=new q.Facet({"facetType":"searchresult"});s.searchFacet.setJsonData(d);s.searchresultset=s.searchFacet.getQuery().getResultSetSync();if(d.ResultsetFacets&&d.ResultsetFacets.Elements){for(var j=0;j<d.ResultsetFacets.Elements.length;j++){var a=s.determineFacetType(d.ResultsetFacets.Elements[j]);var b=new q.Facet({"facetType":a});b.setJsonData(d.ResultsetFacets.Elements[j]);s.chartFacets.push(b);}}else{}}};q.PerspectiveGetQuery.prototype=$.extend({},q.Query.prototype,{init:function(a){var s=this;a=a||{};this.perspectiveId=a.perspectiveId;q.Query.prototype.init.apply(this,[a]);this.resultSetClass=q.Perspective2;},setPerspectiveId:function(a){this.perspectiveId=a;},getPerspective:function(o,a){var s=this;var r={async:true,url:"/sap/bc/ina/service/v2/Perspectives('"+this.perspectiveId+"')",type:"GET"};var j=this.system.proxy.ajax(r);j.done(function(d){if(d&&d.error){a(d.error);}s.resultSet=new s.resultSetClass(s.resultSetProperties);s.resultSet.setJsonData(d);if(o){o(s.resultSet);}}).fail(function(e){if(a){a(e);}});}});q.Perspective2.prototype={init:function(a){var s=this;a=a||{};},getFacetForID:function(a){var s=this;for(var j=0;j<s.facets.length;j++){if(s.facets[j].facetId===a){return s.facets[j];}}return undefined;},getDimensionForID:function(d){var s=this;for(var j=0;j<s.dimensions.length;j++){if(s.dimensions[j].Name===d){return s.dimensions[j];}}return undefined;},getPreviewDimension:function(){var s=this;if(this.bindings["WIDGET-4"]&&this.bindings["WIDGET-4"].dimension){return this.bindings["WIDGET-4"].dimension;}if(this.bindings["WIDGET-1"]&&this.bindings["WIDGET-1"].dimension){return this.bindings["WIDGET-1"].dimension;}if(this.bindings["WIDGET-2"]&&this.bindings["WIDGET-2"].dimension){return this.bindings["WIDGET-2"].dimension;}if(this.bindings["WIDGET-3"]&&this.bindings["WIDGET-3"].dimension){return this.bindings["WIDGET-3"].dimension;}return undefined;},setJsonData:function(d){var s=this;s.rawdata=d;s.ChangedAt=d.ChangedAt;s.ChangedBy=d.ChangedBy;s.content=JSON.parse(d.Content);s.perspectiveId=d.Id;s.name=d.Name;s.packageName=d.Package;s.isActive=d.isActive;s.isGenerated=d.isGenerated;s.datasource=s.content.Model.Queries[0].Datasource;s.measures=[];var m=s.content.Model.Queries[0].CustomDimension1.Members;for(var k=0;k<m.length;k++){s.measures.push(m[k]);}s.dimensions=[];var a=s.content.Model.Queries[0].Dimensions;for(var j=0;j<a.length;j++){s.dimensions.push(a[j]);}s.facets=[];var b=s.content.Model.Facets;for(var i=0;i<b.length;i++){s.facets.push({isActive:b[i].Active,facetId:b[i].FacetId,dimension:s.getDimensionForID(b[i].SeriesChart.ScaleDimensions[0].DimensionName)});}s.bindings={};var c=s.content.Bindings;for(var l=0;l<c.length;l++){var e=c[l];s.bindings[e.WidgetId]=s.getFacetForID(e.FacetId);}}};q.PerspectiveSearchQuery.prototype=$.extend({},q.Query.prototype,{init:function(a){var s=this;a=a||{};q.Query.prototype.init.apply(this,[a]);this.filter.searchTerms=a.searchTerms||"*";this.resultSetClass=q.PerspectiveSearchResultSet;},createJsonRequest:function(){var t=h.getPerspectiveSearchRequest();t.Search.SearchTerms=this.filter.searchTerms;t.Search.Top=this._top;t.Search.Skip=this._skip;return t;},getPerspectiveResults:function(o,a){this.getResultSet(o,a);}});q.PerspectiveSearchResultSet.prototype={init:function(a){var s=this;s.perspectives=[];a=a||{};},getPerspectiveSearchResultSet:function(){return this.perspectives;},setJsonData:function(d){var s=this;var a=d["ItemLists"][0]["Items"];for(var i=0;i<a.length;i++){var n=a[i]["NamedValues"];var b={packageId:n[0].Value,perspectiveId:n[0].Value+"/"+n[1].Value,perspectiveDescription:n[3].Value,title:n[2].Value};s.perspectives.push(b);}}};q.SuggestionQuery.prototype=$.extend({},f.SuggestionQuery.prototype,q.Query.prototype,{init:function(a){a=a||{};this.attributes=a.attributes||[];q.Query.prototype.init.apply(this,arguments);f.SuggestionQuery.prototype.init.apply(this,arguments);this.resultSetClass=q.SuggestionResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},setResponseAttributes:function(a){this.attributes=a;this._resetResultSet();return this;},createJsonRequest:function(){var t=h.getSuggestionRequest();t.Suggestions.Precalculated=false;var s=this.filter.getSearchTerms();if(this.attributes.length===0){throw"add at least one response attribute to your query";}t.Suggestions.SearchTerms=s;t.Suggestions.AttributeNames=this.attributes;t.DataSource=this.filter.dataSource.toInAJson();t.Suggestions.Top=this._top;var p=this.filter.getJson();if(p&&p.Selection){t.Suggestions.Filter=this.filter.getJson();}return t;}});q.SuggestionResultSet.prototype={init:function(){this.suggestions=[];},setJsonData:function(c){this.suggestions=[];var e={};for(var i=0;i<c.ItemLists.length;i++){e[c.ItemLists[i].Name]=c.ItemLists[i];}for(var a=0;a<e.Suggestions.Items.length;a++){var j=e.Suggestions.Items[a],t="",k="",l="";var s={};for(var d=0;d<j.NamedValues.length;++d){var n=j.NamedValues[d];switch(n.Name){case"Term":t=n.Value;s.label=t;break;case"AttributeName":k=n.Value;s.attribute=k;break;case"$$AttributeDescription$$":l=n.Value;s.attributeDescription=l;break;case"Score":var m=n.Value;s.score=parseInt(m,10);break;}}this.suggestions.push(s);}this.suggestions.sort(function(a,b){return b.score-a.score;});for(var o=this.suggestions.length-1;o>=0;o--){delete this.suggestions[o].score;}},getElements:function(){return this.suggestions;}};q.Suggestion2Query.prototype=$.extend({},f.SuggestionQuery.prototype,q.Query.prototype,{init:function(a){a=a||{};this.attributes=a.attributes||[];q.Query.prototype.init.apply(this,[a]);f.SuggestionQuery.prototype.init.apply(this,[a]);this.resultSetClass=q.Suggestion2ResultSet;this.searchTerms=a.searchTerms||{};this.suggestionTerm=a.suggestionTerm||'';},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},addSearchTerm:function(t){if(t){this.searchTerms[t]=t;}this._resetResultSet();return this;},setSuggestionTerm:function(t){if(this.suggestionTerm!==t){this.suggestionTerm=t;this._resetResultSet();}return this;},setResponseAttributes:function(a){this.attributes=a;this._resetResultSet();return this;},createJsonRequest:function(){var t=h.getSuggestion2Request();t.Suggestions2.Precalculated=false;t.Suggestions2.NamedValues=[];for(var i=0;i<this.attributes.length;i++){t.Suggestions2.NamedValues.push({AttributeName:this.attributes[i],Name:this.attributes[i]});}t.DataSource=this.filter.dataSource.toInAJson();t.Suggestions2.Top=this.getTop();t.Suggestions2.Skip=this.getSkip();var r=new p.ConditionGroup();var s=new p.ConditionGroup();for(var a in this.searchTerms){var b=new p.Condition('$$SearchTerms$$','contains',a);r.addCondition(b);}var c=new p.Condition('$$SuggestionTerms$$','contains',this.suggestionTerm);r.addCondition(c);r.addCondition(this.getFilter().getFilterConditions());t.Suggestions2.Filter=r.getJson();return t;}});q.Suggestion2ResultSet.prototype={init:function(){this.datasources={};this.suggestions=[];},setJsonData:function(b){this.datasources={};this.suggestions=[];function e(G){switch(G){case"Value1":case"Value2":case"Order":return false;default:return true;}}var k={};if(!b.ItemLists){return;}for(var i=0;i<b.ItemLists.length;i++){k[b.ItemLists[i].Name]=b.ItemLists[i];}for(var a=0;a<b.Grids.length;a++){var l=b.Grids[a].Axes;var m=b.Grids[a].Cells;if(l===undefined||m===undefined){return;}var s={};for(var n=0;n<m.length;++n){var o=m[n],r="",t="",u="",v={};v.dataSource=new p.DataSource();v.attribute={};for(var j=0;j<o.Index.length;j++){var w=o.Index[j];var x=l[j].Tuples[w];if(x===undefined){continue;}for(var c=0;c<x.length;c++){var y=l[j].Dimensions[c];var z=x[c];var A=k[y.ItemListName];var B=A.Items[z].NamedValues;for(var d=0;d<B.length;++d){var C=B[d];switch(C.Name){case"$$Term$$":v.valueRaw=o.Value||o.ValueFormatted||null;v.value=o.ValueFormatted||o.Value||null;v.labelRaw=C.Value;v.label=C.ValueFormatted;if(!v.filter){v.filter={};}v.filter.value=v.labelRaw;v.filter.valueLabel=v.labelRaw;break;case"$$DataSource$$":var D=C.Value;v.dataSource.setObjectNameValue(D);break;case"$$DataSourceDescription$$":var E=C.Value;v.dataSource.setObjectNameLabel(E);break;case"$$Attribute$$":var F=C.Value;if(!v.filter){v.filter={};}v.filter.attribute=F;v.attribute.value=F;break;case"$$AttributeDescription$$":t=C.Value;if(!v.filter){v.filter={};}v.filter.attributeLabel=t;v.attribute.label=t;break;}}}}this.suggestions.push(v);}}},getElements:function(){return this.suggestions;}};q.ChartQuery.prototype=$.extend({},f.ChartQuery.prototype,q.Query.prototype,{init:function(a){a=a||{};q.Query.prototype.init.apply(this,[a]);f.ChartQuery.prototype.init.apply(this,[a]);this.dimensions={};this.dimensions.CustomDimension1={Axis:"Columns",Name:"CustomDimension1",Members:[]};a.dimensions=a.dimensions||{};if($.type(a.dimensions)==='array'){for(var i=0;i<a.dimensions.length;i++){this.addDimension(a.dimensions[i]);}}else if($.type(a.dimensions)==='string'||$.type(a.dimensions)==='object'){this.addDimension(a.dimensions);}a.measures=a.measures||{};if($.type(a.measures)==='array'){for(var j=0;j<a.measures.length;j++){this.addMeasure(a.measures[j]);}}else if($.type(a.measures)==='object'){this.addMeasure(a.measures);}this.resultSetClass=q.ChartResultSet;},createJsonRequest:function(){var t=h.getChartRequest();t.DataSource=this.filter.dataSource.toInAJson();t.SearchTerms=this.filter.getSearchTerms();t.Analytics.Definition.Filter=this.filter.getJson();t.Analytics.Definition.Dimensions=[];for(var d in this.dimensions){t.Analytics.Definition.Dimensions.push(this.dimensions[d]);}return t;},count:function(d){this.addMeasure({name:d,aggregationFunction:'COUNT'});return this;},addMeasure:function(a){if($.isEmptyObject(a)){return{};}var b='Columns';var n='CustomDimension1';var m;if(a.aggregationFunction.toUpperCase()==='COUNT'||a.aggregationFunction.toUpperCase()==='AVG'){m=this._createAggregationDimension(a.aggregationFunction,a.name,a.aggregationFunction,a.sortOrder||undefined,a.top||undefined);}else{m=this._createAggregationDimension(a.aggregationFunction,'',a.name,a.sortOrder,a.top);delete m.AggregationDimension;delete m.Name;delete m.SortOrder;}this.dimensions.CustomDimension1.Members.push(m);return this;},addDimension:function(d,s,t){if($.type(d)==='object'){if($.isEmptyObject(d)){return{};}this.dimensions[d.name]=this._createDimension(d.name,null,d.sortOrder,d.top);}else if($.type(d)==='string'){if(!d){return{};}this.dimensions[d]=this._createDimension(d,null,s,t);}return this;},_createDimension:function(d,a,s,t){return{"Axis":a||"Rows","Name":d,"SortOrder":s||1,"Top":t||5};},_createAggregationDimension:function(a,b,n,s){return{"Aggregation":a,"AggregationDimension":b,"MemberOperand":{"AttributeName":"Measures","Comparison":"=","Value":n},"Name":n,"SortOrder":s||2};}});q.ChartResultSet.prototype={init:function(a){a=a||{};this.type=a.type;this.elements=[];},_parseNamedValues:function(e,n,m){var s=this;for(var i=0;i<n.length;i++){var a=n[i].Name;var v=n[i].Value;e.label=n[i].ValueFormatted;e.labelRaw=n[i].Value;switch(a){case'$$DataSource$$':s._parseNamedValuesForDataSource(e,v);break;case'$$AttributeValue$$':s._parseNamedValuesForRange(e,v,m);break;}}},_parseNamedValuesForRange:function(e,v,m){var a,b,c;for(var d=0;d<v.length;++d){var n=v[d];switch(n.Name){case"ValueID":e.label=n.ValueFormatted;a=n.Value;break;case"Value1":if(m.Cube.ObjectName&&(n.Value!==undefined)){b=new p.Condition(m.Cube.ObjectName,">=",n.Value);}break;case"Value2":if(m.Cube.ObjectName&&(n.Value!==undefined)){c=new p.Condition(m.Cube.ObjectName,"<=",n.Value);}break;case"Order":break;}}if(a){if(b&&c){var i=new p.ConditionGroup();i.setOperator("AND");i.setLabel(e.label);if(b.value){i.addCondition(b);}if(c.value){i.addCondition(c);}e.labelRaw=i;}else if(b&&b.value&&(!c)){b.operator='=';e.labelRaw=b;}else if(c&&c.value&&(!b)){c.operator='=';e.labelRaw=c;}}},_parseNamedValuesForDataSource:function(e,v){e.dataSource=new p.DataSource();for(var d=0;d<v.length;++d){var n=v[d];switch(n.Name){case"ObjectName":var l=n.ValueFormatted;e.dataSource.setLabel(l);e.dataSource.setObjectName(n.Value,n.ValueFormatted);break;case"PackageName":e.dataSource.setPackageName(n.Value,n.ValueFormatted);break;case"SchemaName":e.dataSource.setSchemaName(n.Value,n.ValueFormatted);break;case"Type":e.dataSource.setType(n.Value,n.ValueFormatted);break;default:e[n.Name]=n.Value;break;}}},setJsonData:function(d){this.elements=[];var m;if(d.Metadata){m=d.Metadata;}if(d.ResultSet){d=d.ResultSet;}var b={};for(var i=0;i<d.ItemLists.length;i++){b[d.ItemLists[i].Name]=d.ItemLists[i];}for(var a=0;a<d.Grids.length;a++){var e=d.Grids[a].Axes;var k=d.Grids[a].Cells;for(var l=0;l<k.length;++l){if(e[0].Dimensions.length===1){var n=k[l];var o={valueRaw:n.Value||n.ValueFormatted||null,value:n.ValueFormatted||n.Value||null};for(var j=0;j<1;j++){var r=n.Index[j];var t=e[j].Tuples[r];if(t===undefined){continue;}for(var c=0;c<t.length;c++){var s=e[j].Dimensions[c];var u=t[c];var v=b[s.ItemListName];var w=v.Items[u].NamedValues;this._parseNamedValues(o,w,m);}}this.elements.push(o);}}}},getElements:function(){return this.elements;}};var R=function(){this.init.apply(this,arguments);};R.prototype={init:function(o){this.resultSet=o.resultSet;this.parse();},parse:function(){this.enhance(this.resultSet);var a=this.resultSet.Grids[0];var r=a.Axes[0];var c=a.Axes[1];var k=function(s){return s.NamedValues[0].Value;};var t=new T({keyFunction:k});for(var i=0;i<a.Cells.length;++i){var b=a.Cells[i];var d=b.Index[0];var e=this.resolve(r,d);var j=e.map(k);var l=b.Index[1];var m=this.resolve(c,l);var n=m.map(k);m=[$.extend({},m[0])];m[0].cell=b;var o=e;o.push.apply(o,m);t.insert(o);}return t;},resolve:function(a,b){var c=[];var t=a.Tuples[b];for(var i=0;i<t.length;++i){var d=t[i];var e=a.Dimensions[i].ItemList.Items[d];c.push(e);}return c;},enhance:function(r){var a={};for(var i=0;i<r.ItemLists.length;++i){var b=r.ItemLists[i];a[b.Name]=b;}for(i=0;i<r.Grids.length;++i){var c=r.Grids[i];for(var j=0;j<c.Axes.length;++j){var d=c.Axes[j];for(var k=0;k<d.Dimensions.length;++k){var e=d.Dimensions[k];e.ItemList=a[e.ItemListName];}}}}};var T=function(){this.init.apply(this,arguments);};T.prototype={init:function(o){this.root={data:"root",subTree:{}};if(o&&o.keyFunction){this.keyFunction=o.keyFunction;}else{this.keyFunction=function(a){return a;};}},insert:function(a){var b=this.root;for(var i=0;i<a.length;++i){var c=a[i];var k=this.keyFunction(c);if(!b.subTree.hasOwnProperty(k)){b.subTree[k]={subTree:{},data:c};}b=b.subTree[k];}},toString:function(){var s=[];this.toStringHelper(this.root,[],s);return s.join("");},toStringHelper:function(t,a,s){var b=null;if(t===this.root){b=t.data;}else{b=this.keyFunction(t.data);}a.push(b);var c=false;for(var d in t.subTree){if(t.subTree.hasOwnProperty(d)){c=true;var e=t.subTree[d];var i=a.slice(0);this.toStringHelper(e,i,s);}}if(!c){s.push(a.toString()+"\n");}}};q.GroupBarChartQuery.prototype=$.extend({},q.ChartQuery.prototype,{init:function(a){a=a||{};q.ChartQuery.prototype.init.apply(this,[a]);this.resultSetClass=q.GroupBarChartResultSet;}});q.GroupBarChartResultSet.prototype={init:function(a){a=a||{};this.elements=[];},setJsonData:function(d){var s=this;this.elements=[];var r=new R({resultSet:d});var t=r.parse();function a(b,c){for(var i in b){var e=b[i];var j={label:e.data.NamedValues[0].ValueFormatted,value:[]};if(e.data.cell){j.value={value:e.data.cell.ValueFormatted,valueRaw:e.data.cell.Value};}if(c){c.value.push(j);}else{s.elements.push(j);}if(e.subTree){a(e.subTree,j);}}}a(t.root.subTree);},getElements:function(){return this.elements;}};q.LineChartQuery.prototype=$.extend({},q.ChartQuery.prototype,{init:function(a){a=a||{};q.ChartQuery.prototype.init.apply(this,[a]);this.resultSetClass=q.LineChartResultSet;}});q.LineChartResultSet.prototype=$.extend({},q.GroupBarChartResultSet.prototype,{init:function(a){a=a||{};this.elements=[];},setJsonData:function(d){var s=this;this.elements=[];var r=new R({resultSet:d});var t=r.parse();function a(b,c){for(var e in b){var i=b[e];var j={label:i.data.NamedValues[0].ValueFormatted,value:[]};for(var k in i.subTree){var l=i.subTree[k];var m={x:l.data.NamedValues[0].ValueFormatted};for(var n in l.subTree){var o=l.subTree[n];m.y=o.data.cell.Value;}j.value.push(m);}s.elements.push(j);}}a(t.root.subTree);},getElements:function(){return this.elements;}});q.SearchQuery.prototype=$.extend({},f.SearchQuery.prototype,q.Query.prototype,{init:function(a){a=a||{};q.Query.prototype.init.apply(this,[a]);f.SearchQuery.prototype.init.apply(this,[a]);this.sqlSearch=(a.sqlSearch===undefined||a.sqlSearch===true)?true:false;this.attributes=a.attributes||[];a.orderBy=a.orderBy||{};this.setOrderBy(a.orderBy);this.resultSetClass=q.SearchResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},createJsonRequest:function(){var s=this;var t=h.getSearchRequest();t.DataSource=this.filter.dataSource.toInAJson();if(this.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.HANASystem){if(this.attributes.length===0){throw{message:"Add at least one response attribute to your query"};}if(this.sqlSearch===true){t.Options=["SqlSearch"];}}var a=[];for(var i=0;i<this.attributes.length;++i){var b=this.attributes[i];if($.type(b)==='string'){a.push({Name:b,AttributeName:b});}else if($.type(b)==='object'){var c={Name:b.name||b.attributeName,AttributeName:b.attributeName||b.name};if(b.highlighted===true){c.Function='Highlighted';}if(b.snippet===true){c.Function='Snippet';}if(b.startPosition!==undefined){c.StartPosition=b.startPosition;}if(b.maxLength!==undefined){c.MaxLength=b.maxLength;}a.push(c);}}t.Search.SelectedValues=a;var d=this.filter.getSearchTerms();if(!d){d='*';}t.SearchTerms=d;t.Search.Top=this._top;t.Search.Skip=this._skip;t.Search.Filter=this.filter.getJson();t.Search.OrderBy=this._assembleOrderBy();return t;},setOrderBy:function(o){this._resetResultSet();this.orderBy=o||{orderBy:'$$score$$',sortOrder:'DESC'};}});q.SearchResultSet.prototype={init:function(a){a=a||{};this.elements=[];this.totalcount=0;},toString:function(r){var e=this.elements;var a=[];var i;for(i=0;i<e.length;++i){var b=e[i];var c={};for(var d in b){if(d.slice(0,2)==='$$'||d.slice(0,1)==='_'){continue;}var j=b[d];if(!j.label||!j.value){continue;}var k={label:j.label,value:j.value};c[d]=k;}a.push(c);}return JSON.stringify(a);},setJsonData:function(d){this.elements=[];function a(){this.type="";this.platform="";this.technology="";this.width="";this.height="";this.variant="";this.uri="";}a.prototype={_fromInaJson:function(k){this.type=k.Type||"";this.platform=k.Platform||"";this.technology=k.Technology||"";this.width=k.Width||"";this.height=k.Height||"";this.variant=k.Variant||"";this.uri=k.Uri||"";}};function b(){this.type="";this.description="";this.uri="";this.request=null;this.encodedJSON="";}b.prototype={_fromInaJson:function(k){var l=this;l.description=k.Description;l.uri=k.Uri;switch(k.Type){case"RelatedRequest":l.type='Search';var m={};m.dataSource=new p.DataSource();m.dataSource.fromInAJson(k.Request.DataSource);m.system=g.sap.bc.ina.api.sina.getSystem();m.top=1;l.request=new q.SearchQuery(m);l.request.filter.setJson(k.Request.Filter);if(k.Request.Filter.Selection===undefined){l.request.invalid=true;l.request.invalidMessage="Related request '"+l.description+"' is invalid because of missing filter conditions.";}break;case"GeneralUri":l.type='Link';l.url=l.uri;break;case"SAPNavigation":l.type='Navigation';l.url=l.uri;break;}l.encodedJSON=encodeURIComponent(l);}};function e(k){this.resultElementAttribute=k;this.correspondingSearchAttributeName="";this.description="";this.isTitle=false;this.presentationUsage=[];this.displayOrder=null;}e.prototype={_fromInaJson:function(k){var l=this;l.correspondingSearchAttributeName=k.correspondingSearchAttributeName||"";l.description=k.Description||"";l.presentationUsage=k.presentationUsage||[];if(k.IsTitle!==undefined){l.isTitle=k.IsTitle;}if(l.isTitle){if(!l.resultElementAttribute.resultElement.title){l.resultElementAttribute.resultElement.title=l.resultElementAttribute.resultElement.$$DataSourceMetaData$$.getLabel()+":";}l.resultElementAttribute.resultElement._registerPostProcessor(function(){l.resultElementAttribute.resultElement.title=l.resultElementAttribute.resultElement.title+" "+l.resultElementAttribute.value;});}}};function r(k){this.resultElement=k;this.$$MetaData$$=new e(this);this.label="";this.labelRaw="";this.value="";this.valueRaw="";}r.prototype={_fromInaJson:function(k){var l=this;l.labelRaw=this.$$MetaData$$.correspondingSearchAttributeName||k.Name||"";l.label=this.$$MetaData$$.description||k.Name||"";l.valueRaw=k.Value||null;l.value=k.ValueFormatted||null;},toString:function(){return this.value;}};function s(){this.title="";this.$$DataSourceMetaData$$={};this.$$RelatedActions$$={};this.$$RenderingTemplateSpecification$$={};this.$$WhyFound$$=[];this.$$PostProcessors$$=[];}s.prototype={_fromInaJson:function(B){var H=this;for(var k=0;k<B.length;++k){var I=B[k];switch(I.Name){case"$$DataSourceMetaData$$":var J=I.Value[0];var K=new p.DataSource(J);H.$$DataSourceMetaData$$=K;break;case"$$AttributeMetadata$$":for(var m=0;m<I.Value.length;++m){var L=I.Value[m];if(!H[L.Name]){H[L.Name]=new r(H);}H[L.Name].$$MetaData$$._fromInaJson(L);H[L.Name].$$MetaData$$.displayOrder=m;}break;case"$$ResultItemAttributes$$":for(var l=0;l<I.Value.length;++l){var M=I.Value[l];if(!H[M.Name]){H[M.Name]=new r(H);}H[M.Name]._fromInaJson(M);}break;case"$$RelatedActions$$":var N={};for(var n=0;n<I.Value.length;++n){var O=I.Value[n];var P=new b();P._fromInaJson(O);N[O.ID]=P;}H.$$RelatedActions$$=N;break;case"$$RenderingTemplateSpecification$$":for(var o=0;o<I.Value.length;++o){var Q=new a();Q._fromInaJson(I.Value[o]);if(Q.type==="ItemDetails"){H._detailTemplate=Q;}else{H.$$RenderingTemplateSpecification$$=Q;}}break;case"$$WhyFound$$":for(var z=0;z<I.Value.length;++z){var S={};S.label=I.Value[z].Description;S.labelRaw=I.Value[z].Name;S.value=I.Value[z].Value;S.valueHighlighted=S.value;S.valueRaw=I.Value[z].Value;H.$$WhyFound$$.push(S);}break;default:H[I.Name]=new r();H[I.Name].label=I.Name||"";H[I.Name].valueRaw=I.Value||I.ValueFormatted||null;H[I.Name].value=I.ValueFormatted||I.Value||null;}}for(var i=0;i<this.$$PostProcessors$$.length;i++){this.$$PostProcessors$$[i]();}},_registerPostProcessor:function(k){this.$$PostProcessors$$.push(k);}};function _(w){if(w._detailTemplate&&!w.$$RelatedActions$$.$$DETAILS$$){w.$$RelatedActions$$.$$DETAILS$$={request:new q.SearchQuery(),description:'',encodedJSON:'',type:'Search',uri:''};}if(w._detailTemplate&&w.$$RelatedActions$$.$$DETAILS$$){var k=new q.SearchResultSet();k.elements[0]=$.extend(true,{},w);k.elements[0].$$RenderingTemplateSpecification$$=w._detailTemplate;k.totalcount=1;delete k.elements[0].$$RelatedActions$$.$$DETAILS$$;w.$$RelatedActions$$.$$DETAILS$$.request.resultSet=k;return k.elements[0];}return{};}var t={};if(!d.ItemLists){return{};}for(var i=0;i<d.ItemLists.length;i++){t[d.ItemLists[i].Name]=d.ItemLists[i];if(d.ItemLists[i].Name.toLowerCase()==="searchresult"){this.totalcount=d.ItemLists[i].TotalCount.Value;}}var u;if(d&&d.Grids&&d.Grids[0]&&d.Grids[0].Axes&&d.Grids[0].Axes[0]){u=d.Grids[0].Axes[0];}else{return{};}for(var j=0;j<u.Tuples.length;j++){var v=u.Tuples[j];if(v===undefined){continue;}var w=new s();for(var c=v.length-1;c>=0;c--){var x=u.Dimensions[c];var y=v[c];var A=t[x.ItemListName];var B=A.Items[y].NamedValues;w._fromInaJson(B);}if(u&&u.Dimensions[1]){var C=u.Dimensions[1];var D=t[C.ItemListName];var E=v[1];if(D&&D.Items&&D.Items[E]){var F=D.Items[E].NamedValues[2];if(F){w=this._postProcess4WhyFound(w,F.Value);}}}var G=_(w);this._postProcessRelatedAction(w);if(G){this._postProcessRelatedAction(G);}this.elements.push(w);}return{};},getElements:function(){return this.elements;},_postProcessRelatedAction:function(e){if(!e.$$RelatedActions$$){return;}for(var r in e.$$RelatedActions$$){var a=e.$$RelatedActions$$[r];if(a.type==="Search"){g.sap.bc.ina.api.sina._postprocess(a,e.title);}}},_postProcess4WhyFound:function(e,m){if(e.$$WhyFound$$&&e.$$WhyFound$$.length>0){var i=e.$$WhyFound$$.length;var v;var a;while(i--){a=false;if(e[e.$$WhyFound$$[i].labelRaw]!==undefined&&m!==undefined){var j=m.length;while(j--){if(m[j].Name===e.$$WhyFound$$[i].labelRaw&&m[j].correspondingSearchAttributeName){e.$$WhyFound$$[i].labelRaw=m[j].correspondingSearchAttributeName;a=true;}}}}}return e;}};q.DataSourceQuery.prototype=$.extend({},q.SearchQuery.prototype,{init:function(a){q.SearchQuery.prototype.init.apply(this,[a]);var s=this;var b;var c=this.system.getServerInfoSync();b=c.rawServerInfo.ServerInfo.SystemId;var d=b+s.system.sapclient()+"~ESH_CONNECTOR~";var e=a.dataSource||{objectName:d,packageName:"ABAP",type:"Connector",label:""};s.setDataSource(e);}});}(window));
/*
 * @file Simple info access (SINA) API: System representation
 * @namespace sap.bc.ina.api.sina.impl.inav2.system
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var b=g.sap.bc.ina.api.sina.base;var s=b.system;var p=g.sap.bc.ina.api.sina.impl.inav2.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.system');var m=g.sap.bc.ina.api.sina.impl.inav2.system;m.ABAPSystem=function(){this.init.apply(this,arguments);};m.HANASystem=function(){this.init.apply(this,arguments);};m.ABAPSystem.prototype=$.extend({},s.System.prototype,{init:function(a){a=a||{};this.systemType='ABAP';this.inaUrl=a.inaUrl||'/sap/es/ina/GetResponse';this.infoUrl=a.infoUrl||'/sap/es/ina/GetServerInfo';a.proxy=a.proxy||new p.Proxy({'xsrfService':this.infoUrl});s.System.prototype.init.apply(this,[a]);this.properties={};if(a.sapclient){this.sapclient(a.sapclient);}else{var c=this._readSapClientFromUrl();this.sapclient(c);}if(a.saplanguage){this.saplanguage(a.saplanguage);}else{var d=this._getUrlParameter("sap-language");this.saplanguage(d);}},setSinaUrlParameter:function(n,v){v=''+v;if(n.toUpperCase()==='SAP-CLIENT'&&v.length<3){for(var i=0;i<2;i++){v='0'+v;}}var a=function(u){var c=(new RegExp(n+'='+'(.+?)(&|$)','i').exec(u)||[null])[1];if(!c){if(u.indexOf('?')===-1){u+='?'+encodeURIComponent(n)+'='+encodeURIComponent(v);}else{u+='&'+encodeURIComponent(n)+'='+encodeURIComponent(v);}}else{u=u.replace(n+'='+c,encodeURIComponent(n)+'='+encodeURIComponent(v));}return u;};this.infoUrl=a(this.infoUrl);this.inaUrl=a(this.inaUrl);},_getUrlParameter:function(n){var a=g.location.href;var v=(new RegExp(n+'='+'(.+?)(&|$)','i').exec(a)||[null])[1];if(!v){return v;}v=decodeURIComponent(v.replace(/\+/g,' '));return v;},_readSapClientFromUrl:function(){if(g.sap.bc.ina.api.sina.properties&&g.sap.bc.ina.api.sina.properties.noSapClientFromUrl&&g.sap.bc.ina.api.sina.properties.noSapClientFromUrl===true){return'';}return this._getUrlParameter('sap-client');},sapclient:function(a){if(a){this.properties.sapclient=a;this.setSinaUrlParameter('sap-client',this.properties.sapclient);this._deleteServerInfo();this.getServerInfo();}else{return this.properties.sapclient;}},saplanguage:function(l){if(l){this.properties.saplanguage=l;this.setSinaUrlParameter('sap-language',this.properties.saplanguage);}else{return this.properties.saplanguage;}},setServerInfo:function(j){this.properties.rawServerInfo=j;if(this instanceof m.ABAPSystem){this.properties.dbms=j.ServerInfo.DataBaseManagementSystem;this.properties.sapclient=j.ServerInfo.Client;this.properties.saplanguage=j.ServerInfo.UserLanguageCode;this.properties.systemid=j.ServerInfo.SystemId;}for(var i=0;i<j.Services.length;i++){this.services[j.Services[i].Service]=new s.Service(j.Services[i]);}}});m.HANASystem.prototype=$.extend({},s.System.prototype,{init:function(a){a=a||{};this.systemType='HANA';this.infoUrl=a.infoUrl||'/sap/bc/ina/service/v2/GetServerInfo';this.inaUrl=a.inaUrl||'/sap/bc/ina/service/v2/GetResponse';a.proxy=a.proxy||new p.Proxy({'xsrfService':this.infoUrl});s.System.prototype.init.apply(this,[a]);this._setUpAjaxErrorHandler();},_setUpAjaxErrorHandler:function(){$(g.document).ajaxError(function(e,j,a,t){switch(j.status){case 401:g.window.location='/sap/hana/xs/formLogin/login.html?x-sap-origin-location='+encodeURIComponent(g.window.location.pathname)+encodeURIComponent(g.window.location.search);break;case 404:return;}});}});}(window));
/*
 * @file Simple info access (SINA) API: Filter
 * @namespace sap.bc.ina.api.sina.impl.odata.filter
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.base.filter;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata.filter');var m=g.sap.bc.ina.api.sina.impl.odata.filter;m.getRootDataSource=function(){return new m.DataSource({collections:['bp_crm']});};m.DataSource=function(){this.init.apply(this,arguments);};m.DataSourceMetaData=function(){this.init.apply(this,arguments);};m.Filter=function(){this.init.apply(this,arguments);};m.Condition=function(){this.init.apply(this,arguments);};m.DataSourceMetaData.prototype=$.extend({},f.DataSourceMetaData.prototype,{init:function(p){p=p||{};this.datasource=p.datasource||{};this.description=p.description||'';this.metaData={};},_getMetaData:function(c){var _=this;var s=g.sap.bc.ina.api.sina.sinaSystem();if(s.metadata&&c){this.metaData=s.metadata;this.description=this.datasource.collections[0];c(this);}else{s.getMetadata().done(function(a){_.metaData=a;_.description=_.datasource.collections[0];if(c){c(_);}});}return this;},_getMetaDataSync:function(){var s=g.sap.bc.ina.api.sina.sinaSystem();this.metaData=s.getMetadataSync();return this.metaData;}});m.DataSource.prototype=$.extend({},f.DataSource.prototype,{init:function(p){p=p||{};p.collection=p.collection||p.Collection||{};this.setCollection(p.collection);this.type={value:'OData'};if(p.metaData){this.setMetaData(p.metaData);}},equals:function(o){if(o instanceof m.DataSource){var c=function(a,b){if(a===b){return true;}if(a===null||b===null){return false;}if(a.length!==b.length){return false;}for(var i=0;i<a.length;++i){if(a[i]!==b[i]){return false;}}return true;};if(!c(this.getCollections(),o.getCollections())){return false;}return true;}return false;},setMetaData:function(d){this.metaData=d;},getMetaData:function(c){if(!this.metaData){this.metaData=new m.DataSourceMetaData({datasource:this});}this.metaData._getMetaData(c);},getMetaDataSync:function(){if(!this.metaData){this.metaData=new m.DataSourceMetaData({datasource:this});this.metaData._getMetaDataSync();}return this.metaData;},setODataUrl:function(d){g.sap.bc.ina.api.sina.sys._setODataUrl(d);},getODataUrl:function(){return g.sap.bc.ina.api.sina.sys.getODataUrl();},setCollection:function(c){if(!this.collection){this.collection="";}if($.type(c)==='string'){this.collection=c;}},getCollection:function(){return this.collection;},toURL:function(){return{ou:this.getODataUrl(),oc:this.getCollection()};},fromURL:function(u){this.setODataUrl(u.ou);this.setCollection(u.oc);}});m.Filter.prototype=$.extend({},f.Filter.prototype,{init:function(p){f.Filter.prototype.init.apply(this,[p]);},setDataSource:function(d){if(d!==undefined&&d!==null){if(!(d instanceof m.DataSource)){d=new m.DataSource(d);}this.dataSource=d;}return this;},getJson:function(){var r=[];this.defaultConditionGroup.getJson(r);var a={Selection:r[0]};return a;},setJson:function(j){if(j.Selection===undefined){return;}var a=new m.ConditionGroup();a.setJson(j);this.defaultConditionGroup.addCondition(a);},addFilterCondition:function(a,o,v){if(a===undefined||o===undefined||v===undefined){return this;}if(this.conditionGroupsByAttribute[a]===undefined){this.conditionGroupsByAttribute[a]=new f.ConditionGroup({operator:'OR'});this.defaultConditionGroup.addCondition(this.conditionGroupsByAttribute[a]);}this.conditionGroupsByAttribute[a].addCondition(new f.Condition(a,o,v));return this;}});m.Condition.prototype=$.extend({},f.Condition.prototype,{init:function(a,o,v){if($.type(a)==='object'){var p=a;a=p.attribute;o=p.operator;v=p.value;}this.attribute=a||'';this.operator=o;this.value=v;},getJson:function(p){},setJson:function(j){},toString:function(){return''+this.attribute+this.value;}});}(window));
/*
 * @file Simple info access (SINA) API: Implementation of the interface
 * @namespace sap.bc.ina.api.sina.impl.odata
 * @requires sap.bc.ina.api.sina
 * @requires sap.bc.ina.api.sina.impl.odata.filter
 * @requires sap.bc.ina.api.sina.impl.odata.system
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata');var b=g.sap.bc.ina.api.sina.base;var f=g.sap.bc.ina.api.sina.impl.odata.filter;var s=g.sap.bc.ina.api.sina.impl.odata.system;var m=g.sap.bc.ina.api.sina.impl.odata;m.Facet=function(){this.init.apply(this,arguments);};m.Sina=function(){this.init.apply(this,arguments);};m.Query=function(){this.init.apply(this,arguments);};m.SearchQuery=function(){this.init.apply(this,arguments);};m.SearchResultSet=function(){this.init.apply(this,arguments);};m.Perspective=function(){this.init.apply(this,arguments);};m.PerspectiveQuery=function(){this.init.apply(this,arguments);};m.ChartQuery=function(){this.init.apply(this,arguments);};m.ChartResultSet=function(){this.init.apply(this,arguments);};m.SuggestionQuery=function(){this.init.apply(this,arguments);};m.SuggestionResultSet=function(){this.init.apply(this,arguments);};m.DataSourceQuery=function(){this.init.apply(this,arguments);};m.DataSourceQueryResultSet=function(){this.init.apply(this,arguments);};m.IMPL_TYPE='odata';b.registerProvider({impl_type:m.IMPL_TYPE,sina:m.Sina,searchQuery:m.SearchQuery,perspectiveQuery:m.PerspectiveQuery,DataSource:f.DataSource,Facet:m.Facet,Filter:f.Filter,FilterCondition:f.Condition,getRootDataSource:f.getRootDataSource,chartQuery:m.ChartQuery,suggestionQuery:m.SuggestionQuery,DataSourceQuery:m.DataSourceQuery});m.Sina.prototype=$.extend({},b.Sina.prototype,{init:function(p){p=p||{};this.setSystem(p.system||new s.ODataSystem(p));},_registerPostProcessor:function(p){if(!this.postProcessor){this.postProcessor=[];}this.postProcessor.push(p);},_postprocess:function(a,c){if(this.postProcessor){for(var i=0;i<this.postProcessor.length;i++){this.postProcessor[i](a,c);}}}});m.Query.prototype=$.extend({},{init:function(p){this.filter=p.filter||new f.Filter({dataSource:p.dataSource});},_resetResultSet:function(){this.deferredResultSet=null;this.resultSet=null;this.jqXHR=null;},_getODataError:function(d){if(d.error){return new b.SinaError({message:"OData Service Error "+d.error.code+": "+d.error.message,errorCode:d.error.code});}},setDataSource:function(d){if(d===undefined){return this;}d=new f.DataSource(d);if(this.filter.getDataSource()===undefined){this.filter.setDataSource(d);this._resetResultSet();return this;}if(!this.filter.getDataSource().equals(d)){this.filter.setDataSource(d);this._resetResultSet();}return this;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},execute:function(){var _=this;if(!this.jqXHR){this.jqXHR=this._fireRequest(this._buildRequestUrl(),true);}var d=$.Deferred();this.jqXHR.done(function(a){var e=_._getODataError(a);if(a&&e){d.reject(e);return;}var r=new _.resultSetClass(_.resultSetProperties);r.setJsonData(a);d.resolve(r);}).fail(function(e){d.reject(e);}).always(function(a){_._responseJson=a;});return d.promise();},executeSync:function(){var _=this;if(this.resultSet!==null){return this.resultSet;}var d=this._fireRequest(this._buildRequestUrl(),false);this._responseJson=d;this.resultSet=new this.resultSetClass(this.resultSetProperties);if(d&&d.responseText){var e=_._getODataError(d);if(e){throw e;}var r=JSON.parse(d.responseText);this.resultSet.setJsonData(r);}return this.resultSet;},_buildRequestUrl:function(){var a=this.system.oDataUrl;var c=this.filter.getDataSource().collection;var d='';if(this.filter.getSearchTerms().length>0){d='&search='+this.filter.getSearchTerms();}var r=this._transformResponseAttributesToODataSyntax(this.attributes)||'';var e=this._transformFilterConditionsToODataSyntax(this.filter.getFilterConditions());var o=$.isEmptyObject(this.orderBy)?'':this._assembleOrderBy();var h='&$skip='+this.getSkip();var t='&$top='+this.getTop();var i='&facets=all';var j='&$inlinecount=allpages';var k='$format=json';return a+c+'/?'+k+d+r+e+t+h+o+i+j;},_fireRequest:function(r,a){var c={async:a,url:r,contentType:'application/json',dataType:'json'};c.type='GET';var j=this.system.proxy.ajax(c);return j;},_assembleOrderBy:function(){var o='&$orderby=';var a=function(c,d){var e=c+' ';e+=d;return e;};if($.type(this.orderBy)==='array'){for(var i=0;i<this.orderBy.length;i++){if(i===0){o+=a(this.orderBy[i].orderBy,this.orderBy[i].sortOrder);continue;}o+=','+a(this.orderBy[i].orderBy,this.orderBy[i].sortOrder);}}else if($.type(this.orderBy)==='object'&&this.orderBy.orderBy){o+=a(this.orderBy.orderBy,this.orderBy.sortOrder);}return o;},_transformFilterConditionsToODataSyntax:function(c){if(typeof c==='object'&&c.conditions.length>0){var r='&$filter=';var a=c.operator;var t=function(r,c,a){var e=c.conditions;if(c.attribute!==undefined){r+=c.attribute+' ';switch(c.operator){case'>':r+='gt ';break;case'>=':case'=>':r+='ge ';break;case'<':r+='lt ';break;case'>=':case'=>':r+='le ';break;case'=':r+='eq ';break;case'!=':r+='ne ';break;}r+="'"+c.value+"'";r+=' '+a+' ';return r;}for(var i=0;i<e.length;i++){g.console.log(r);r+=t('',e[i],a);}return r;};var d=t('',c,a.toLowerCase());d=d.substring(0,d.lastIndexOf('and')).trim();r+=d;return r;}return'';},_transformResponseAttributesToODataSyntax:function(a){if(a&&a.length>0){var r='&$select=';for(var i=0;i<a.length;i++){if(i===0){r+=a[i];continue;}r+=','+a[i];}return r;}return'';}});m.SearchQuery.prototype=$.extend({},b.SearchQuery.prototype,m.Query.prototype,{init:function(p){p=p||{};m.Query.prototype.init.apply(this,[p]);b.SearchQuery.prototype.init.apply(this,[p]);this.attributes=p.attributes||[];p.orderBy=p.orderBy||{};this.setOrderBy(p.orderBy);this.resultSetClass=m.SearchResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},setOrderBy:function(o){this._resetResultSet();this.orderBy=o||{orderBy:'score',sortOrder:'DESC'};},});m.SearchResultSet.prototype={init:function(p){p=p||{};this.elements=[];this.totalcount=0;},getElements:function(){return this.elements;},setJsonData:function(d){this.elements=[];if(d&&d.d){var r=d.d;this.totalcount=r.__count;var p=function(d,c){var a=function(h,j){var _=j.toUpperCase();e[_]={label:_,value:d[i][j],valueRaw:''};};for(var i=0;i<d.length;i++){var k=Object.keys(d[i]);var e={};e['$$RelatedActions$$']={};$.each(k,a);e['$$RenderingTemplateSpecification$$']={uri:"resulttemplate-detail"};e['$$RelatedActions$$']['$$DETAILS$$']={request:{resultSet:{elements:[e],getElements:function(){return[e];}}}};c.push(e);}};var k=Object.keys(r);for(var i=0;i<k.length;i++){if(k[i].indexOf('result')>=0){p(r[k[i]],this.elements);}}}}};m.Facet.prototype=$.extend({},b.Facet.prototype,{init:function(p){p=p||{};b.Facet.prototype.init.apply(this,arguments);if(this.facetType==='$$datasources$$'){this.facetType=b.FacetType.DATASOURCE;this.query=new m.ChartQuery();this.query.resultSet=new m.ChartResultSet({'type':'datasource'});}else if(this.facetType===b.FacetType.ATTRIBUTE){this.query=new m.ChartQuery();this.query.resultSet=new m.ChartResultSet();}else if(this.facetType===b.FacetType.SEARCH){this.query=new m.SearchQuery();this.query.resultSet=new m.SearchResultSet();}},setJsonData:function(d){this.query.resultSet.setJsonData(d);}});m.Perspective.prototype={init:function(p){this.chartFacets=[];this.searchFacet=null;this.searchResultSet=null;this.layout=null;p=p||{};},getSearchResultSet:function(){return this.searchResultSet;},getChartFacets:function(){return this.chartFacets;},getSearchFacet:function(){return this.searchFacet;},getLayout:function(){return this.layout;},determineFacetType:function(r){try{if(r.ResultSet.ItemLists[0].Items[0].NamedValues[0].Name==='$$DataSource$$'){return'$$datasources$$';}else{return b.FacetType.ATTRIBUTE;}}catch(e){return b.FacetType.ATTRIBUTE;}},_findDimension:function(a){try{var k=Object.keys(a.Items[0]);for(var i=0;i<k.length;i++){var p=k[i].indexOf('@com.sap.vocabularies.Common.v1.Label');if(p>0){return k[i].substring(0,p);}}}catch(e){g.console.error('No dimension found!');}},setJsonData:function(d){this.searchFacet=new m.Facet({'facetType':'searchresult'});this.searchFacet.setJsonData(d);this.searchResultSet=this.searchFacet.getQuery().getResultSetSync();var a=d.d['@com.sap.vocabularies.Search.v1.Facets'];if(a){for(var j=0;j<a.length;j++){var c=this.determineFacetType(a[j]);var e=new m.Facet({"facetType":c});e.setJsonData(a[j]);e.title=a[j]['@com.sap.vocabularies.Common.v1.Label'];e.dimension=this._findDimension(a[j]);this.chartFacets.push(e);}}}};m.PerspectiveQuery.prototype=$.extend({},b.PerspectiveQuery.prototype,m.Query.prototype,{init:function(p){this.chartFacets=[];this.searchFacet=null;this.searchResultSet=null;this.layout=null;p=p||{};m.Query.prototype.init.apply(this,arguments);b.PerspectiveQuery.prototype.init.apply(this,arguments);p.orderBy=p.orderBy||{};this.setOrderBy(p.orderBy);this.resultSetClass=m.Perspective;},createJsonRequest:function(){},getPerspective:function(o,a){this.getResultSet(o,a);},getPerspectiveSync:function(){return this.getResultSetSync();}});m.ChartQuery.prototype=$.extend({},b.PerspectiveQuery.prototype,m.Query.prototype,{init:function(p){p=p||{};m.Query.prototype.init.apply(this,[p]);b.ChartQuery.prototype.init.apply(this,[p]);this.resultSetClass=m.ChartResultSet;}});m.ChartResultSet.prototype={init:function(p){p=p||{};this.type=p.type;this.elements=[];},setJsonData:function(d){this._parseFacetElement(d,this.elements);},_parseFacetElement:function(d,c){var _=this;var a;var e=function(i,h){var j;a=[];if(h==='Items'){_._parseResultElement(d[h],_.elements);}};var k=Object.keys(d);$.each(k,e);},_parseResultElement:function(d,c){for(var i=0;i<d.length;i++){var k=Object.keys(d[i]);var r={};for(var j=0;j<k.length;j++){var p=k[j].indexOf('@com.sap.vocabularies.Common.v1.Label');if(p>0){var v=d[i][k[j].substring(0,p)];var a=k[j].substring(0,p);r.label=v;r.labelRaw=new f.Condition(a,'=',v);}}r.value=d[i]['__Count'];c.push(r);}},getElements:function(){return this.elements;}};m.SuggestionQuery.prototype=$.extend({},b.SuggestionQuery.prototype,m.Query.prototype,{init:function(p){p=p||{};this.attributes=p.attributes||[];m.Query.prototype.init.apply(this,arguments);b.SuggestionQuery.prototype.init.apply(this,arguments);this.resultSetClass=m.SuggestionResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},setResponseAttributes:function(a){this.attributes=a;this._resetResultSet();return this;},setSuggestionTerm:function(t){return this;}});m.SuggestionResultSet.prototype={init:function(){this.suggestions=[];},setJsonData:function(d){this.suggestions=[];var i={};},getElements:function(){return this.suggestions;}};m.DataSourceQuery.prototype=$.extend({},m.SearchQuery.prototype,{init:function(p){p=p||{};m.SearchQuery.prototype.init.apply(this,arguments);this.resultSetClass=m.DataSourceQueryResultSet;var a=this.system.getMetadataSync();var d=p.dataSource||{collections:this.system.getAvailableCollections(a)};this.setDataSource(d);},_buildRequestUrl:function(){return this.system.oDataUrl;}});m.DataSourceQueryResultSet.prototype={init:function(){this.elements=[];},setJsonData:function(d){var c=d.d.EntitySets;for(var i=0;i<c.length;i++){var r={};r[c[i].toUpperCase()]={label:'DataSource',value:c[i],type:'OData'};this.elements.push(r);}},getElements:function(){return this.elements;}};}(window));
/*
 * @file Simple info access (SINA) API: System representation
 * @namespace sap.bc.ina.api.sina.impl.odata.system
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var p=g.sap.bc.ina.api.sina.proxy;var s=g.sap.bc.ina.api.sina.base.system;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata.system');var a=g.sap.bc.ina.api.sina.impl.odata.system;a.ODataSystem=function(){this.init.apply(this,arguments);};a.ODataSystem.prototype=$.extend({},s.System.prototype,{init:function(b){this.properties=b||{};this.systemType='OData';this.oDataUrl=this._prepareUrl(this.properties.oDataUrl);this.oDataMetadataUrl=this.oDataUrl+'$metadata';s.System.prototype.init.apply(this,[this.properties]);},_prepareUrl:function(u){if(!u){return'';}if(u.slice(-1)!=='/'){return u+'/';}return u;},_setMetadata:function(m){var b=$(m);this.metadata={};this.metadata.version=b.find('Edmx').attr('Version');this.metadata.dataServices={};this.metadata.dataServices.dataServiceVersion=b.find('DataServices').attr('m:DataServiceVersion');this.metadata.dataServices.maxDataServiceVersion=b.find('DataServices').attr('m:MaxDataServiceVersion');this.metadata.dataServices.schema=[];var c=b.find('Schema');for(var i=0;i<c.length;i++){var d=$(c[i]);var e={};e.namespace=d.attr('Namespace');this.metadata.dataServices.schema.push(e);var f=d.find('EntityType');var h=d.find('EntityContainer');if(f.length){e.association=[];e.entityType=[];var j=d.find('Association');e=this._getEntityTypes(j,f,e);}if(h.length){e=this._getEntityContainer(h,e);}}},_getEntityTypes:function(b,e,c){c=this._getAssociations(b,c);for(var i=0;i<e.length;i++){var d=$(e[i]);var f={};f.name=d.attr('Name');f.key={};f.key.propertyRef=[];var h=d.find('PropertyRef');for(var j=0;j<h.length;j++){var l=$(h[j]);f.key.propertyRef.push({name:l.attr('Name')});}f.property=[];var m=d.find('Property');for(var k=0;k<m.length;k++){var n=$(m[k]);var o={};o.name=n.attr('Name');o.type=n.attr('Type');if(n.attr('Nullable')){o.nullable=n.attr('Nullable');}if(n.attr('MaxLength')){o.maxLength=n.attr('MaxLength');}if(n.attr('FixedLength')){o.fixedLength=n.attr('FixedLength');}if(n.attr('Unicode')){o.unicode=n.attr('Unicode');}f.property.push(o);}c=this._getNavigationProperties(f,d,c);}return c;},_getAssociations:function(b,c){var d=function(t,u){var v=t.find('PropertyRef');for(var x=0;x<v.length;x++){var w=$(v[x]);u.push({name:w.attr('Name')});}};for(var i=0;i<b.length;i++){var e=$(b[i]);var f={};f.end=[];f.name=e.attr('Name');f.referentialConstraint={};f.referentialConstraint.dependent={};f.referentialConstraint.principal={};var h=e.find('End');for(var j=0;j<h.length;j++){var k=$(h[j]);var l={};l.type=k.attr('Type');l.role=k.attr('Role');l.multiplicity=k.attr('Multiplicity');f.end.push(l);}var r=e.find('ReferentialConstraint');var m=e.find('Principal');var n=e.find('Dependent');var o=$(m);var q=$(n);f.referentialConstraint.principal.role=o.attr('Role');f.referentialConstraint.principal.propertyRef=[];f.referentialConstraint.dependent.role=q.attr('Role');f.referentialConstraint.dependent.propertyRef=[];d(o,f.referentialConstraint.principal.propertyRef);d(q,f.referentialConstraint.dependent.propertyRef);c.association.push(f);}return c;},_getNavigationProperties:function(e,b,c){e.navigationProperty=[];var n=b.find('NavigationProperty');for(var i=0;i<n.length;n++){var d=$(n[i]);var f={};f.fromRole=d.attr('FromRole');f.name=d.attr('Name');f.relationship=d.attr('Relationship');f.toRole=d.attr('ToRole');e.navigationProperty.push(f);}c.entityType.push(e);return c;},_getEntityContainer:function(b,c){c.entityContainer=[];for(var l=0;l<b.length;l++){var d=$(b[l]);var h={};h.associationSet=[];h.entitySet=[];var i=d.find('AssociationSet');for(var e=0;e<i.length;e++){var j=$(i[e]);var k={};k.association=j.attr('Association');k.name=j.attr('Name');k.end=[];var n=j.find('End');for(var f=0;f<n.length;f++){var o=$(n[f]);var q={};q.entitySet=o.attr('EntitySet');q.role=o.attr('Role');k.end.push(q);}h.associationSet.push(k);}var r=d.find('EntitySet');for(var m=0;m<r.length;m++){var t=$(r[m]);var u={};u.entityType=t.attr('EntityType');u.name=t.attr('Name');h.entitySet.push(u);}h.extensions=[];var v={name:'tbd',namespace:d.attr('xmlns:p6'),value:d.attr('p6:LazyLoadingEnabled')};h.extensions.push(v);h.isDefaultEntityContainer=d.attr('m:IsDefaultEntityContainer');h.name=d.attr('Name');c.entityContainer.push(h);}return c;},getMetadata:function(){var _=this;if(this.jqXHR){return this.jqXHR.promise();}this.jqXHR=$.Deferred();this._fireRequest(true).done(function(d){_._setMetadata(d);_.jqXHR.resolve(_.metadata);}).fail(function(e){_.jqXHR.reject(e);});return _.jqXHR.promise();},getMetadataSync:function(){var d=this._fireRequest(false);this._setMetadata($.parseXML(d.responseText));return this.metadata;},getAvailableCollections:function(m){var e=m.dataServices.schema[0].entityContainer[0].entitySet;var c=[];for(var i=0;i<e.length;i++){c.push(e[i].name);}return c;},_fireRequest:function(b){var r={async:b,type:'GET',url:this.oDataMetadataUrl,dataType:'xml'};if(!b){return $.ajax(r);}return this.proxy.ajax(r);},getODataUrl:function(){return this.oDataUrl;},setODataUrl:function(d){this.oDataUrl=this._prepareUrl(d);this.oDataMetadataUrl=this.oDataUrl+'$metadata';}});}(window));
/*
 * @file Simple info access (SINA) API: Factory
 * @namespace sap.bc.ina.api.sina
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var b=g.sap.bc.ina.api.sina.base;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina');var m=g.sap.bc.ina.api.sina;m.properties=m.properties||{};if(m.impl&&m.impl.inav2&&m.impl.inav2.IMPL_TYPE){m.SINA_TYPE_INAV2=m.impl.inav2.IMPL_TYPE;}m.getSina=function(p){p=p||{};p.impl_type=p.impl_type||m.SINA_TYPE_INAV2;if(p.impl_type===m.SINA_TYPE_INAV2){if(!p.system){var i=m.impl.inav2.proxy;var a=m.impl.inav2.system;var n=new i.Proxy(p);var s;if(p.systemType&&p.systemType.toUpperCase()==='ABAP'){s=new a.ABAPSystem({'proxy':n});}else{s=new a.HANASystem({'proxy':n});}n.setXSRFService(s.infoUrl);p.system=s;}}if(b.provider[p.impl_type]&&b.provider[p.impl_type].sina){var c=new b.provider[p.impl_type].sina(p);c._provider=b.provider[p.impl_type];return c;}return{};};m.properties.impl_type=m.properties.impl_type||'inav2';g.sap.bc.ina.api.sina=$.extend({},m,m.getSina(m.properties));return g.sap.bc.ina.api.sina;}(window));
