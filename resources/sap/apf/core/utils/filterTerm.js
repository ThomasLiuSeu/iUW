/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.core.utils.filterTerm');jQuery.sap.require('sap.apf.utils.utils');
sap.apf.core.utils.FilterTerm=function(m,p,o,a,h){this.type="filterTerm";var b=o;var c=a;if(b.length==2){b=b.toUpperCase();}m.check((b!==undefined),"sap.apf.utils.FilterTerm.constructor op undefined");m.check((jQuery.inArray(b,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.FilterTerm op "+b+" not supported");m.check((p!==undefined),"sap.apf.utils.core.FilterTerm sProperty undefined");m.check((c!==undefined),"sap.apf.utils.FilterTerm value undefined");var d=function(e,c){var v,l;if(e!==p){return true;}if(b===sap.apf.core.constants.FilterOperators.EQ){if(a instanceof Date&&c instanceof Date){return(a.valueOf()===c.valueOf());}return(a===c);}else if(b===sap.apf.core.constants.FilterOperators.LT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()>c.valueOf());}return(a>c);}else if(b===sap.apf.core.constants.FilterOperators.LE){if(a instanceof Date&&c instanceof Date){return(a.valueOf()>=c.valueOf());}return(a>=c);}else if(b===sap.apf.core.constants.FilterOperators.GT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<c.valueOf());}return(a<c);}else if(b===sap.apf.core.constants.FilterOperators.BT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<=c.valueOf()&&c.valueOf()<=h.valueOf());}return(a<=c&&c<=h);}else if(b===sap.apf.core.constants.FilterOperators.GE){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<=c.valueOf());}return(a<=c);}else if(b===sap.apf.core.constants.FilterOperators.NE){if(a instanceof Date&&c instanceof Date){return!(a.valueOf()===c.valueOf());}return!(a===c);}else if(b===sap.apf.core.constants.FilterOperators.StartsWith){l=a.length;if(l>c.length){return false;}v=c.slice(0,l);return(v===a);}else if(b===sap.apf.core.constants.FilterOperators.EndsWith){l=a.length;if(l>c.length){return false;}v=c.slice(-l);return(v===a);}else if(b===sap.apf.core.constants.FilterOperators.Contains){var i=c.indexOf(a);return(i>-1);}};this.contains=function(e,c){var i=0;if(e instanceof Array){for(i=0;i<e.length;i++){if(e[i]===p){return d(e[i],c[e[i]]);}}return true;}else{return d(e,c);}};this.toUrlParam=function(e){var s="'";var f=" ";var g="";var P=[];var a,i;if(e&&e.formatValue){a=e.formatValue(p,c);if(h){i=e.formatValue(p,h);}}else{if(typeof c==='number'){a=c;}else{a=s+sap.apf.utils.escapeOdata(c)+s;}if(h){if(typeof c==='number'){i=h;}else{i=s+sap.apf.utils.escapeOdata(h)+s;}}}if(b===sap.apf.core.constants.FilterOperators.StartsWith){g='startswith('+sap.apf.utils.escapeOdata(p)+','+a+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.EndsWith){g='endswith('+sap.apf.utils.escapeOdata(p)+','+a+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.Contains){g='substringof('+a+','+sap.apf.utils.escapeOdata(p)+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.BT){g='(('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+"ge"+f+a)+')'+jQuery.sap.encodeURL(f+'and'+f)+'('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+"le"+f+i)+'))';}else{g='('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+b.toLowerCase()+f+a)+')';}if(e&&e.asFilterArray===true){P.push(g);return P;}return g;};this.getProperty=function(){return p;};this.getOp=function(){return b;};this.getValue=function(){return c;};this.getHighValue=function(){return h;};this.getHash=function(){var s=p+b+c;return sap.apf.utils.hashCode(s);};this.copy=function(){return new sap.apf.core.utils.FilterTerm(m,p,b,c,h);};this.removeTermsByProperty=function(e){var i=0;var l=0;if(e instanceof Array){l=e.length;for(i=0;i<l;i++){if(p===e[i]){return undefined;}}return this.copy();}else{if(p===e){return undefined;}return this.copy();}};this.removeTerms=function(e,f,a){var i=0;var l=0;if(e instanceof Array){l=e.length;for(i=0;i<l;i++){if(p===e[i]&&b===f&&c===a){return undefined;}}return this.copy();}else{if(p===e&&b===f&&c===a){return undefined;}return this.copy();}};this.mapProperties=function(M){var i;for(i=0;i<M.length;i++){if(p===M[i].source){p=M[i].target;return undefined;}}return undefined;};this.mapToSelectionVariant=function(){if(b===sap.apf.core.constants.FilterOperators.BT){return{option:b,low:c,high:h};}return{option:b,low:c,high:null};};this.mapToSapUI5FilterExpression=function(){if(b===sap.apf.core.constants.FilterOperators.BT){return{path:p,operator:b,value1:c,value2:h};}return{path:p,operator:b,value1:c};};};
