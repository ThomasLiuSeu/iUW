sap.ui.controller("sap.apf.modeler.ui.controller.configurationListNew",{onInit:function(){var c=this.getOwnerComponent();if(c){this.oCoreApi=c.oCoreApi;}this.aData=[];this.oModel=new sap.ui.model.json.JSONModel({tableData:this.aData});this.oView=this.getView();this.oView.setModel(this.oModel);sap.ui.core.UIComponent.getRouterFor(this).attachRouteMatched(this._handleRouteChanged.bind(this));},_handleRouteChanged:function(e){var E=e.getParameters();if(E.name!=="applicationList"){this.sAppId=E.arguments.appId;this._displayApplicationName();this._getConfigHandler().then(this._populateConfigList);this.oModel.updateBindings();}},_getConfigHandler:function(){var s=this;var c=new jQuery.Deferred();this.oCoreApi.getConfigurationHandler(this.sAppId,function(C){s.oConfigHandler=C;c.resolveWith(s,[C]);});return c;},_populateConfigList:function(){var s=this;var c=this.oConfigHandler.getList();c.forEach(function(C){s.aData.push({AnalyticalConfiguration:C.AnalyticalConfiguration,Application:C.Application,name:C.AnalyticalConfigurationName,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION});});this.oModel.updateBindings();},_displayApplicationName:function(){var s=this;this.oCoreApi.getApplicationHandler(function(a){var A=a.getApplication(s.sAppId).ApplicationName;s.byId("idConfigTitleMaster").setText(s.oCoreApi.getText("configurationObjectTitle")+" : "+A);});}});
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.controller("sap.apf.modeler.ui.controller.navigationTarget",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.createMessageObject=this.oViewData.createMessageObject;this.putMessage=this.oViewData.putMessage;this.updateTitleAndBreadCrumb=this.oViewData.updateTitleAndBreadCrumb;this.getAllAvailableSemanticObjects=this.oViewData.getAllAvailableSemanticObjects;this.getSemanticActions=this.oViewData.getSemanticActions;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._setDisplayText();var m=[];m.push(this.byId("idSemanticObjectField"));m.push(this.byId("idActionField"));this._setMandatoryFields(m);this.getAllAvailableSemanticObjects(function(a,b){if(b===undefined){s._populateSemanticObjectModel(a);s.setDetailData();}else{var M=s.createMessageObject({code:"12004"});M.setPrevious(b);s.putMessage(M);}});},_populateSemanticObjectModel:function(a){var A;var b=[];a.forEach(function(S){var o={};o.semanticObjectKey=S.id;o.semanticObjectName=S.id;b.push(o);});var s={aAllSemanticObjects:b};A=new sap.ui.model.json.JSONModel();A.setSizeLimit(500);A.setData(s);this.byId("idSemanticObjectField").setModel(A);},_setDisplayText:function(){this.byId("idSemanticObjectLabel").setText("* "+this.getText("semanticObject")+": ");this.byId("idActionLabel").setText("* "+this.getText("action")+": ");this.byId("idDescriptionLabel").setText(this.getText("description")+": ");},setDetailData:function(){var s=this.byId("idSemanticObjectField").getModel().getData().aAllSemanticObjects;if(this.params&&this.params.arguments&&this.params.arguments.navTargetId){this.oNavTarget=this.oConfigurationEditor.getNavigationTarget(this.params.arguments.navTargetId);}if(this.oNavTarget){var S;var a=this.oNavTarget.getSemanticObject();for(var i=0;i<s.length;i++){if(a===s[i].semanticObjectKey){S=true;break;}}this.byId("idSemanticObjectField").setValue(a);var b={changeSemanticObject:false,semanticObjectInList:S?true:false};this._populateActions(a,b);}else{var n=this.oConfigurationEditor.createNavigationTarget();this.oNavTarget=this.oConfigurationEditor.getNavigationTarget(n);s.splice(0,0,{semanticObjectKey:"",semanticObjectName:""});var o={aAllSemanticObjects:s};this.byId("idSemanticObjectField").getModel().setData(o);this.byId("idSemanticObjectField").setSelectedKey("");var m=new sap.ui.model.json.JSONModel();var d={aActions:[{id:"",text:""}]};m.setData(d);this.byId("idActionField").setModel(m);this.byId("idActionField").setSelectedKey("");var A={id:n};this.oViewData.updateSelectedNode(A);}},handleChangeSemanticObjectValue:function(e){var s=this.byId("idSemanticObjectField").getModel().getData().aAllSemanticObjects;if(s[0].semanticObjectKey===""){s.splice(0,1);var S={aAllSemanticObjects:s};this.byId("idSemanticObjectField").getModel().setData(S);}var a=e.getParameter("value");var b=this.byId("idSemanticObjectField").getSelectedKey();var c={changeSemanticObject:true,semanticObjectInList:a===b?true:false};if(a!==""&&a!==null){this.oConfigurationEditor.setIsUnsaved();this.oNavTarget.setSemanticObject(a);this._populateActions(a,c);}},_getActionText:function(){var t;var s=this.byId("idActionField").getModel().getData().aActions;for(var i=0;i<s.length;i++){if(s[i].id===this.oNavTarget.getAction()){t=s[i].text;break;}}return t;},handleChangeofAction:function(e){var t;var a=e.getParameter("value");if(a!==""&&a!==null){this.oNavTarget.setAction(a);}this.oConfigurationEditor.setIsUnsaved();t=this._getActionText();if(t===undefined){t=this.oNavTarget.getSemanticObject();}var A={name:t};this.byId("idDescription").setValue(t);this.oViewData.updateSelectedNode(A);t=this.getText("navigationTarget")+": "+t;this.updateTitleAndBreadCrumb(t);},_updateDescriptionAndTitle:function(s,t){if(s.changeSemanticObject){if(t===undefined){t=this.oNavTarget.getSemanticObject();}var a={name:t};this.byId("idDescription").setValue(t);this.oViewData.updateSelectedNode(a);t=this.getText("navigationTarget")+": "+t;this.updateTitleAndBreadCrumb(t);}},_populateActions:function(s,a){var b=this;var t;if(a&&a.semanticObjectInList){var p=this.getSemanticActions(s);p.then(function(S){var A={aActions:S.semanticActions};var o=new sap.ui.model.json.JSONModel();o.setData(A);b.byId("idActionField").setModel(o);if(b.oNavTarget.getAction()&&a&&a.changeSemanticObject===false){b.byId("idActionField").setValue(b.oNavTarget.getAction());var T=b._getActionText()?b._getActionText():b.oNavTarget.getSemanticObject();b.byId("idDescription").setValue(T);}else if(o.getData().aActions.length>0){b.byId("idActionField").setSelectedKey(o.getData().aActions[0].id);b.oNavTarget.setAction(o.getData().aActions[0].id);t=o.getData().aActions[0].text;}b._updateDescriptionAndTitle(a,t);},function(c){var M=b.createMessageObject({code:"12005"});M.setPrevious(c);b.putMessage(M);});}else{var m=new sap.ui.model.json.JSONModel();var d={aActions:[]};m.setData(d);this.byId("idActionField").setModel(m);if(this.oNavTarget.getAction()&&a&&a.changeSemanticObject===false){this.byId("idActionField").setValue(this.oNavTarget.getAction());var T=b.oNavTarget.getSemanticObject();b.byId("idDescription").setValue(T);}else{this.byId("idActionField").setValue("");}this._updateDescriptionAndTitle(a,t);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_setValidationState:function(){var m=this._getMandatoryFields();if(m.length!==0){for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue()!=="")?true:false;if(this.isValidState===false){break;}}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});sap.ui.controller("sap.apf.modeler.ui.controller.titleBreadCrumb",{onInit:function(){this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this._addConfigStyleClass();},_addConfigStyleClass:function(){this.byId("IdBreadCrumb").addStyleClass("breadCrumb");this.byId("IdFormTitle").addStyleClass("formTitle");},setTitleAndBreadCrumb:function(f,b){this.byId("IdFormTitle").setText(f);this.byId("IdBreadCrumb").setText(b);}});sap.ui.controller("sap.apf.modeler.ui.controller.toolbar",{onInit:function(){this.oCoreApi=this.getView().getViewData().oConfigListInstance.oCoreApi;this.oConfigListInstance=this.getView().getViewData().oConfigListInstance;this._setDisplayText();},_setDisplayText:function(){this.byId("idAddButton").setText(this.oCoreApi.getText("addButton"));this.byId("idCopyButton").setText(this.oCoreApi.getText("copyButton"));this.byId("idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));},enableCopyDeleteButton:function(){if(!this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(true);}if(!this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(true);}},disableCopyDeleteButton:function(){if(this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(false);}if(this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(false);}},_setAddMenuText:function(){sap.ui.core.Fragment.byId("idAddMenuFragment","idNewConfig").setText(this.oCoreApi.getText("newConfiguration"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewFacetFilter").setText(this.oCoreApi.getText("newFacetFilter"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewCategory").setText(this.oCoreApi.getText("newCategory"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewNavigationTarget").setText(this.oCoreApi.getText("newNavigationTarget"));sap.ui.core.Fragment.byId("idAddMenuFragment","idStep").setText(this.oCoreApi.getText("step"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewStep").setText(this.oCoreApi.getText("newStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idExistingStep").setText(this.oCoreApi.getText("existingStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewRepresentation").setText(this.oCoreApi.getText("newRepresentation"));},_setExistingStepDialogText:function(){sap.ui.core.Fragment.byId("idExistingStepDialogFragment","idExistingStepDialog").setTitle(this.oCoreApi.getText("existingStepDialogTitle"));},_enableDisableAddMenuItems:function(s,a){var A=a.getItems();var n;if(this.oConfigListInstance.configurationHandler.getList().length===0||s===null){n="default";}else{n=s.nodeObjectType;}var m={};m["default"]=1;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=5;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=4;A.forEach(function(M,i){if(i<m[n]){M.setEnabled(true);}else{M.setEnabled(false);}});},_handlePressAddButton:function(e){var s;var S=this;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.oConfigListInstance.bIsSaved=this.oConfigListInstance.configEditor?this.oConfigListInstance.configEditor.isSaved():undefined;var a=false;var b=function(){var A=e.getSource();var o=this.oConfigListInstance.oTreeInstance.getNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());if(!this.addMenu){this.addMenu=new sap.ui.xmlfragment("idAddMenuFragment","sap.apf.modeler.ui.fragment.addMenu",this);this.getView().addDependent(this.addMenu);this._setAddMenuText();}var c=sap.ui.core.Popup.Dock;this._enableDisableAddMenuItems(o,this.addMenu);this.addMenu.open(false,A,c.BeginTop,c.BeginBottom,A);};if(!i){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){b.call(S);}}});a=true;}if(!a){b.call(S);}},_handleAddMenuItemPress:function(e){var i=this.addMenu.getItems();var a=e.getParameters("item");var n;var N={"idAddMenuFragment--idNewFacetFilter":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,"idAddMenuFragment--idNewCategory":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,"idAddMenuFragment--idNewStep":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,"idAddMenuFragment--idNewRepresentation":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,"idAddMenuFragment--idNewConfig":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,"idAddMenuFragment--idNewNavigationTarget":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,"default":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION};i.forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}else if(I.getSubmenu()){I.getSubmenu().getItems().forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}});}});if(a.id==="idAddMenuFragment--idExistingStep"){this._handleAddExistingStepPress();}else if(a.id!=="idAddMenuFragment--idStep"&&n!==undefined){this.oConfigListInstance.oTreeInstance.addNodeInTree(n);}},_copyConfiguration:function(c,n){var C=this.oConfigListInstance.configurationHandler.getConfiguration(c);var o={};o.AnalyticalConfiguration=C.AnalyticalConfiguration;o.name="< "+C.AnalyticalConfigurationName+" >";o.Application=C.Application;o.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;o.bIsLoaded=false;o.bToggleState=false;o.isSelected=true;o.expanded=true;o.selectable=true;o.hasExpander=true;this.oConfigListInstance.oModel.getData().aConfigDetails.push(o);this.oConfigListInstance.oModel.updateBindings();this.oConfigListInstance.selectedNode=this.oConfigListInstance.oTreeInstance.getNodeByContext(n);var a={appId:this.oConfigListInstance.appId,configId:c};sap.ui.core.UIComponent.getRouterFor(this.oConfigListInstance).navTo(o.type,a);},_handlePressCopyButton:function(e){var s;var S=this;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var a=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.oConfigListInstance.bIsSaved=this.oConfigListInstance.configEditor?this.oConfigListInstance.configEditor.isSaved():undefined;var b=false;var c=function(){var C=this;var g=this.oTreeInstance.getNodeContext(this.oTreeInstance.getSelection()||this.selectedNode);this.selectedNode=this.oTreeInstance.getSelection()||this.selectedNode;var h,k,l,O,p,m,q,r,t,u,v;k=g.nodeContext;switch(g.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:var F=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var w=this.configEditor.copyFacetFilter(g.nodeAPFId);var x=this.configEditor.getFacetFilter(w);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var y=this.oTextPool.setText(F,T);x.setLabelKey(y);O=k.split("/");m=O[2];q=O[6];var z=this.oModel.getData().aConfigDetails[m].configData[0].filters[q];z.isSelected=false;var A=jQuery.extend(true,{},z);A.id=w;A.name="< "+F+" >";A.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[0].filters.length;this.oModel.getData().aConfigDetails[m].configData[0].filters.push(A);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:var B=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var D=this.configEditor.copyCategory(g.nodeAPFId);var E=this.configEditor.getCategory(D);var G=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var H=this.oTextPool.setText(B,G);var I={labelKey:H};this.configEditor.setCategory(I,D);O=k.split("/");m=O[2];r=O[6];var N=[];var J=this.configEditor.getSteps();J.forEach(function(y1){if(C.configEditor.getCategoriesForStep(y1.getId())[0]===D){N.push(y1.getId());}});var K=this.oModel.getData().aConfigDetails[m].configData[1].categories[r];K.isSelected=false;var L=jQuery.extend(true,{},K);if(L.steps){for(var i=0;i<L.steps.length;i++){L.steps[i].id=N[i];var M=C.configEditor.getStep(N[i]);var P=M.getRepresentations();if(L.steps[i].representations){for(var j=0;j<L.steps[i].representations.length;j++){L.steps[i].representations[j].id=P[j].getId();}}}}L.id=D;L.name="< "+B+" >";L.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[1].categories.length;this.oModel.getData().aConfigDetails[m].configData[1].categories.push(L);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:var Q=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var R=this.configEditor.copyNavigationTarget(g.nodeAPFId);var U=this.configEditor.getNavigationTarget(R);O=k.split("/");m=O[2];t=O[6];var V=this.oModel.getData().aConfigDetails[m].configData[2].navTargets[t];V.isSelected=false;var W=jQuery.extend(true,{},V);W.id=R;W.name="< "+Q+" >";W.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[2].navTargets.length;this.oModel.getData().aConfigDetails[m].configData[2].navTargets.push(W);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var X=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var Y=this.configEditor.copyStep(g.nodeAPFId);var Z=this.configEditor.getCategoriesForStep(Y);var $=this.configEditor.getStep(Y);var _=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var a1=this.oTextPool.setText(X,_);$.setTitleId(a1);O=k.split("/");m=O[2];r=O[6];u=O[8];var b1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u];b1.isSelected=false;var c1=jQuery.extend(true,{},b1);P=$.getRepresentations();c1.id=Y;c1.name="< "+X+" >";if(c1.representations){for(j=0;j<c1.representations.length;j++){c1.representations[j].id=P[j].getId();}}l=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps.length;O[8]=l;h=O.join("/");for(var d1=0;d1<Z.length;d1++){var e1=jQuery.extend(true,{},c1);var f1={arguments:{configId:S.oConfigListInstance.configId,categoryId:Z[d1]}};var g1=S.oConfigListInstance.getSPathFromURL(f1).sPath.split("/");var h1=g1[6];this.oModel.getData().aConfigDetails[m].configData[1].categories[h1].steps.push(e1);}this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[l].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=k.split("/");m=O[2];r=O[6];u=O[8];v=O[10];var i1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].id;var j1=this.configEditor.getStep(i1);var k1=this.configEditor.getCategoriesForStep(i1);this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[v].isSelected=false;var l1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[v];var m1=jQuery.extend(true,{},l1);var n1=j1.copyRepresentation(m1.id);m1.id=n1;l=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations.length;O[10]=l;h=O.join("/");for(var o1=0;o1<k1.length;o1++){var p1=jQuery.extend(true,{},m1);var q1={arguments:{configId:S.oConfigListInstance.configId,categoryId:k1[o1],stepId:i1}};var r1=S.oConfigListInstance.getSPathFromURL(q1).sPath.split("/");var s1=r1[6];var t1=r1[8];this.oModel.getData().aConfigDetails[m].configData[1].categories[s1].steps[t1].representations.push(p1);}this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[l].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var u1=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;O=k.split("/");m=O[2];var v1=this.oModel.getData().aConfigDetails[m];v1.isSelected=false;O[2]=this.oModel.getData().aConfigDetails.length;h=O.join("/");this.configurationHandler.copyConfiguration(g.nodeAPFId,function(y1){var z1={AnalyticalConfigurationName:u1};var A1=C.configurationHandler.setConfiguration(z1,y1);C.configTitle=u1;C.configurationHandler.loadConfiguration(A1,function(B1){var u1=C.configTitle;var C1=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var D1=C.configurationHandler.getTextPool().setText(u1,C1);B1.setApplicationTitle(D1);});S._copyConfiguration(y1,h);});case"default":break;}if(g.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.oModel.updateBindings();this.selectedNode=this.oTreeInstance.getNodeByContext(h);var w1=this.oTreeInstance.getNodeContext(this.selectedNode);var x1=this.oTreeInstance.getParentNodeContext(w1);this.navigateToDifferntView(x1,w1);this.configEditor.setIsUnsaved();}};var d=function(){var g=new sap.m.Label().addStyleClass("noConfigSelected");g.setText(S.oConfigListInstance.oCoreApi.getText("noConfigSelected"));g.placeAt(S.oConfigListInstance.byId("idConfigDetailData"));S.oConfigListInstance.toolbarController.disableCopyDeleteButton();S.oConfigListInstance.disableExportButton();};var o;if(!a){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){S.oConfigListInstance.bIsDifferntConfig=S.oConfigListInstance.oTreeInstance.isConfigurationSwitched(S.oConfigListInstance.oPreviousSelectedNode,S.oConfigListInstance.selectedNode);if(S.oConfigListInstance.bIsDifferntConfig===false){var r=S.oConfigListInstance.getRouteContext(S.oConfigListInstance.oParentNodeDetails);var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var i=S.oConfigListInstance._isNewSubView(s.oViewData.oParams);if(!i){var p=S.oConfigListInstance.getSPathForConfig(S.oConfigListInstance.configId);c.call(S.oConfigListInstance);S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,S.oConfigListInstance.oSelectedNodeDetails,r);}else{S.oConfigListInstance.handleConfirmDeletion();}}else{var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){if(!N.bIsSaved){o(S.oConfigListInstance);}else{c.call(S.oConfigListInstance);}}}}});b=true;}var f;if(s.oViewData.oParams.name==="configuration"){f=true;}o=function(g){n.throwLossOfDataPopup(g,{yes:function(h){S.oConfigListInstance._navSaveState(function(){h(function(i){if(S.oConfigListInstance.selectedNode){var B=S.oConfigListInstance.selectedNode.getBindingContext().sPath;var C=B.split("/");var j=C[2];}S.oConfigListInstance.oModel.getData().aConfigDetails[j].AnalyticalConfiguration=S.oConfigListInstance.configId;S.oConfigListInstance.oModel.updateBindings();c.call(S.oConfigListInstance);});});},no:function(){var g={appId:S.oConfigListInstance.appId,configId:S.oConfigListInstance.configId};var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var f=(s.oViewData.oParams.name==="configuration")?true:false;if(S.oConfigListInstance.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,{},g,f);S.oConfigListInstance.clearTitleAndBreadCrumb();S.oConfigListInstance.byId("idConfigDetailData").removeAllContent();d();}else{S.oConfigListInstance._navConfigResetState(S.oConfigListInstance,function(){c.call(S.oConfigListInstance);});}}});};if(!S.oConfigListInstance.bIsSaved&&a&&f){o(S.oConfigListInstance);b=true;}if(!b){c.call(S.oConfigListInstance);}},_handlePressDeleteButton:function(e){var d;var s=this.oConfigListInstance.oTreeInstance.getNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var n=this.oCoreApi.getText(s.nodeObjectType);e.getSource().$().blur();if(s.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=this.oCoreApi.getText("confirmStepDeletion",[s.nodeTitle]);}else{d=this.oCoreApi.getText("confirmDeletion",[n,s.nodeTitle]);}this._openDeleteConfirmationDialog(d);},_openDeleteConfirmationDialog:function(d){var s=this;var c=jQuery.extend(s.oConfigListInstance,{closeDialog:s.closeDialog.bind(s)});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfigConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",c);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(d);this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},closeDialog:function(){if(this.confirmationDialog&&this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_handlePressMoveUpButton:function(){this.bIsDown=false;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_handlePressMoveDownButton:function(){this.bIsDown=true;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_moveUpOrDown:function(s,i){var a=s.nodeObjectType;var b=s.nodeAPFId;var n=s.nodeContext;var c=n.split('/')[2];var o,d,t,T,l;var S=false;var e=n.split('/')[n.split('/').length-1];switch(a){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[0].filters;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[2].navTargets;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var f=n.split('/')[6];var g=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f];o=g.steps;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:var h=this.oConfigListInstance.oTreeInstance.getSelection();var j=sap.ui.getCore().byId(h.getId());var k=j.getParent();var m=this.oConfigListInstance.oTreeInstance.getNodeContext(k).nodeAPFId;var p=this.oConfigListInstance.configEditor.getStep(m);f=n.split('/')[6];var q=n.split('/')[8];o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f].steps[q].representations;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){p.moveRepresentationUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){p.moveRepresentationUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;}if(S){t=o[e];T=o[d];o[d]=t;o[e]=T;this.oConfigListInstance.oModel.updateBindings();this.oConfigListInstance.configEditor.setIsUnsaved();}},_handleAddExistingStepPress:function(){var s=this;var a=this.oConfigListInstance.oTreeInstance.getNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var c=this.oConfigListInstance.oTreeInstance.getParentNodeContext(a).categoryId;var S=this.oConfigListInstance.configEditor.getStepsNotAssignedToCategory(c);var b;var d=[];S.forEach(function(e){var o={};var f=s.oConfigListInstance.configEditor.getStep(e);b=s.oConfigListInstance.oTextPool.get(f.getTitleId()).TextElementDescription;o.id=e;o.name=b;d.push(o);});var m=new sap.ui.model.json.JSONModel({existingStepData:d});if(!this.addExistingStepDialog){this.addExistingStepDialog=sap.ui.xmlfragment("idExistingStepDialogFragment","sap.apf.modeler.ui.fragment.existingStepDialog",this);this._setExistingStepDialogText();}this.getView().addDependent(this.addExistingStepDialog);this.addExistingStepDialog.setModel(m);this.addExistingStepDialog.open();},_handleExistingStepDialogOK:function(e){var s=this;var n=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;var a=e.getParameters("listItem").selectedItems;var b=a.length;var c=this.oConfigListInstance.oTreeInstance.getNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var d=this.oConfigListInstance.oTreeInstance.getParentNodeContext(c).categoryId;var E=[];for(var i=0;i<b;i++){var p=e.getParameters("selectedItems").selectedContexts[i].sPath.split('/')[2];var o=e.getSource().getModel().getData().existingStepData[p];var f=this.oConfigListInstance.configEditor.getStep(o.id);this.oConfigListInstance.configEditor.addCategoryStepAssignment(d,o.id);var r=f.getRepresentations();var g=r.length;var R=[];for(var j=0;j<g;j++){var h={};h.id=r[j].getId();h.name=r[j].getRepresentationType();h.icon=this._getRepresentationIcon(h.name);R.push(h);}var S={};S.step=o;S.representations=R;S.noOfReps=g;E.push(S);}if(b!==0){var k={noOfSteps:b,aExistingStepsToBeAdded:E};this.oConfigListInstance.oTreeInstance.addNodeInTree(n,k);}},_getRepresentationIcon:function(r){var i;var R=this.oCoreApi.getRepresentationTypes();for(var a=0;a<R.length;a++){if(r===R[a].id){i=R[a].picture;break;}}return i;},_handleExistingStepDialogSearch:function(e){var v=e.getParameter("value");var f=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);var b=e.getSource().getBinding("items");b.filter([f]);},_handleExistingStepDialogClose:function(e){if(this.addExistingStepDialog){e.getSource().getBinding("items").filter([]);}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.analysisPath",{refreshAnalysisPath:function(){this.getView().getCarousel().getController().refreshCarousel();},isOpenPath:false,isNewPath:false,bIsBackNavigation:false,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.bIsDirtyState=false;},refresh:function(n){var v=this.getView().oCarousel;var s=v.stepViews;var i;if(n!==-1){for(i=n;i<s.length;i++){var S={};S=s[i];if(S!==undefined){S.oThumbnailChartLayout.setBusy(true);}}}var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(a>n){var c=this.oUiApi.getStepContainer();c.vLayout.setBusy(true);}var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();if((this.bIsDirtyState===undefined||this.bIsDirtyState===false)&&this.oCoreApi.getSteps().length!==0){var b="*"+p;this.bIsDirtyState=true;this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(b);}},callBackForUpdatePath:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);},callBackForUpdatePathAndSetLastStepAsActive:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){var S=this.oCoreApi.getSteps()[this.oCoreApi.getSteps().length-1];this.oCoreApi.setActiveStep(S);this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);this.oUiApi.getLayoutView().setBusy(false);},updateCurrentStep:function(c,n,s){var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var b=(n===a);var d=(n===this.oCoreApi.getSteps().length-1);this.drawThumbnail(n,s||i);if(b){this.drawMainChart(s);}if(this.oUiApi.getAnalysisPath().getController().isOpenPath&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().isOpenPath=false;}if(this.oUiApi.getAnalysisPath().getController().bIsBackNavigation&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().bIsBackNavigation=false;}this.oUiApi.getAnalysisPath().getController().isNewPath=false;},drawMainChart:function(s){var c=this.oUiApi.getStepContainer();c.getController().drawStepContent(s);},drawThumbnail:function(n,s){var S=this.getView().getCarousel().getStepView(n);S.getController().drawThumbnailContent(s);}});sap.ui.controller("sap.apf.ui.reuse.controller.carousel",{onAfterRendering:function(){if(this.oCoreApi.getSteps().length<1){jQuery(".DnD-separator").hide();}this.oViewData=this.getView().getViewData().oInject;this.oUiApi=this.oViewData.uiApi;jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();if(jQuery("#"+this.initialText.getId()).length===0){jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}if(this.oUiApi.getAnalysisPath().getController().isOpenPath){jQuery(".initialText").remove();}},onInit:function(){var v=this.getView().getViewData().oInject;this.oCoreApi=v.oCoreApi;this.oUiApi=v.uiApi;this.stepGalleryView=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.stepGallery",viewData:v});this.initialText=new sap.m.Label({text:v.oCoreApi.getTextNotHtmlEncoded('initialText')}).addStyleClass('initialText');},showStepGallery:function(){this.stepGalleryView.oController.openHierarchicalSelectDialog();},onBeforeRendering:function(){this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().up);this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().down);},getStepData:function(s){var S=this;var f=s;var o={};o.index=this.oCoreApi.getSteps().indexOf(s);o.title=this.oCoreApi.getTextNotHtmlEncoded(f.title);o.thumbnail=this.getThumbnailDataset(s);return o;},refreshCarousel:function(){if(this.oCoreApi.getSteps().length>this.getView().stepViews.length){this.addStep(this.oCoreApi.getSteps());}},addStep:function(s){this.oViewData=this.getView().getViewData().apfInstance;if(s instanceof Array){if(this.oUiApi.getAnalysisPath().getController().isOpenPath||this.oUiApi.getAnalysisPath().getController().bIsBackNavigation){var i;for(i=0;i<s.length;i++){this.addStep(s[i]);}return;}else{this.addStep(s[this.oCoreApi.getSteps().length-1]);return;}}var a=new sap.ui.view({viewName:"sap.apf.ui.reuse.view.step",type:sap.ui.core.mvc.ViewType.JS,viewData:this.getView().getViewData().oInject});var j=new sap.ui.model.json.JSONModel();a.setModel(j);var b=this.getStepData(s);j.setData(b);this.getView().stepViews.push(a);var c=document.createElement('div');c.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var d=this.getView().dndBox;var e=d.eleRefs.blocks.length-1;jQuery(".initialText").remove();jQuery(this.oUiApi.getStepContainer().getDomRef()).show();jQuery(".DnD-separator").show();var f=this.Step?this.Step.categories[0].id:undefined;if(f==="initial"){d.insertBlock({blockElement:c,dragState:false,dropState:false,removable:false},e);}else{d.insertBlock({blockElement:c},e);}if(b.index===this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){a.toggleActiveStep();}a.rerender();this.oUiApi.getLayoutView().setBusy(true);},moveStep:function(d,a){var c=this.oUiApi.getAnalysisPath().getCarousel();if(d===a){return;}c.stepViews=(function(e,f,t){var g=Math.abs(t-f);var h=(t-f)>0?1:-1;var i;while(g--){i=e[f];e[f]=e[f+h];e[f+h]=i;f=f+h;}return e;})(c.stepViews,d,a);this.oUiApi.getAnalysisPath().getController().refresh(Math.min(d,a));var b=this.oCoreApi.getSteps()[d];this.oCoreApi.moveStepToPosition(b,a,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));},removeStep:function(r){var c=this.oUiApi.getAnalysisPath().getCarousel();c.stepViews.splice(r,1);var s=c.stepViews.length;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(s>0){if(r===a){var n;var b;if(a===0){n=a;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n+1]);}else{n=a-1;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n]);}}}else{jQuery(".DnD-separator").hide();jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}var d=this.oCoreApi.getSteps()[r];this.oUiApi.getAnalysisPath().getController().refresh(r);this.oCoreApi.removeStep(d,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));},removeAllSteps:function(){var r=0;var i;var d=this.getView().dndBox;var c=this.oUiApi.getAnalysisPath().getCarousel();var s=c.stepViews.length;for(i=1;i<=s;i++){d.removeBlock(r,function(){return;});c.stepViews.splice(r,1);}jQuery(".DnD-separator").hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();},getThumbnailDataset:function(s){var S=this;var t=["leftUpper","rightUpper","leftLower","rightLower"];var T=s.thumbnail;var o=s.getSelectedRepresentationInfo().thumbnail;var r={};t.forEach(function(a){var h=o&&o[a];h=h&&!S.oCoreApi.isInitialTextKey(o[a]);var H=T&&T[a];H=H&&!S.oCoreApi.isInitialTextKey(T[a]);if(h){r[a]=S.oCoreApi.getTextNotHtmlEncoded(o[a]);return;}else if(H){r[a]=S.oCoreApi.getTextNotHtmlEncoded(T[a]);return;}});return r;}});sap.ui.controller("sap.apf.ui.reuse.controller.deleteAnalysisPath",{onInit:function(){var s=this;this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.stdDialog=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),contentWidth:s.contentWidth,contentHeight:s.contentHeight,content:this.getView().getContent()[0],leftButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){s.stdDialog.close();s.oUiApi.getLayoutView().setBusy(false);}})});},openPathGalleryWithDelete:function(){this.stdDialog.open();},getGuidForPath:function(p,v){var i;for(i=0;i<v.length;i++){var d=v[i];if(d.AnalysisPathName===p){return d.guid;}}},deleteSavedPath:function(p,i){var s=this;var g=i.guid;var a=p;var m;var c=s.oUiApi.getAnalysisPath().oSavedPathName.getTitle();s.oSerializationMediator.deletePath(g,function(r,b,d){if(d===undefined&&(typeof r==="object")){i.list.removeItem(i.item);s.oCoreApi.readPaths(function(r,b,d){if(d===undefined&&(typeof r==="object")){var n=r.paths.length;if(n===0){jQuery(".pathText").removeClass("pathTextDontShow");jQuery(".pathText").addClass("pathTextShow");}}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});}else{m=s.oCoreApi.createMessageObject({code:"6009",aParameters:["delete",a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});if(c===a){s.oUiApi.getAnalysisPath().getToolbar().getController().resetAnalysisPath();}}});sap.ui.controller("sap.apf.ui.reuse.controller.layout",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;var a;if(this.oCoreApi.getApplicationConfigProperties()){a=this.oCoreApi.getApplicationConfigProperties().appName;}this.applicationTitle=this.oCoreApi.getTextNotHtmlEncoded(a);this.getView().byId("application").addStyleClass("sapApfHeader");this.getView().byId("application").setText(this.applicationTitle);var m=this.oUiApi.getNotificationBar();this.getView().byId("applicationPage").addContent(m);var c=m.initializeHandler;this.oCoreApi.setCallbackForMessageHandling(c.bind(m));this.loadLayout();},loadLayout:function(){var c=this.oUiApi.getStepContainer();var a=this.oUiApi.getAnalysisPath();this.getView().byId("application").setText(this.applicationTitle);this.getView().byId("masterFooter").addStyleClass("applicationFooter");this.getView().byId("detailFooter").addStyleClass("applicationFooter");this.getView().byId("stepContainer").addContent(c);this.getView().byId("analysisPath").addContent(a);this.addOpenInButton();},onAfterRendering:function(){var s=this;var a=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.getView().byId("applicationView").showMaster();},lite:true,type:"Transparent"});this.getView().byId("applicationView").attachAfterMasterClose(function(){s.getView().byId("detailFooter").removeContentLeft(a);s.addDetailFooterContentLeft(a);});this.getView().byId("applicationView").attachAfterMasterOpen(function(){if(s.getView().byId('detailFooter')){s.getView().byId("detailFooter").removeAllContentLeft();}});if(this.getView().byId("applicationView").isMasterShown()===false){this.addDetailFooterContentLeft(a);}},hideMaster:function(){if(sap.ui.Device.system.phone||sap.ui.Device.system.tablet){this.getView().byId("applicationView").hideMaster();if(sap.ui.Device.system.phone){this.getView().byId("applicationView").toDetail(this.getView().byId("stepContainer").getId());}}},showMaster:function(){this.getView().byId("applicationView").showMaster();},addMasterFooterContentLeft:function(c){this.getView().byId("masterFooter").addContentLeft(c);},addMasterFooterContentRight:function(c){if(this.getView().byId("masterFooter").getContentRight().length===0){this.getView().byId("masterFooter").insertContentRight(c);}else{this.addMasterFooterContent(c);}},addMasterFooterContent:function(c){var s=this;if(this.oActionListPopover===undefined){this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}if(typeof c.getWidth==="function"){c.setWidth("100%");}if(this.footerContentButton===undefined){this.getView().byId("masterFooter").getContentRight()[0].setWidth("71%");this.footerContentButton=new sap.m.Button({text:'...',press:function(e){s.oActionListPopover.openBy(e.getSource());},lite:true,type:"Transparent"});}this.oActionListPopover.addContent(c);this.getView().byId("masterFooter").insertContentRight(this.footerContentButton,1);},addDetailFooterContentLeft:function(c){this.getView().byId("detailFooter").addContentLeft(c);},addFacetFilter:function(f){this.getView().byId("subHeader").addItem(f);},addOpenInButton:function(){var s=this;if(s.oNavListPopover===undefined){this.oNavListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}this.openInBtn=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("openIn"),type:"Transparent",press:function(e){s.oNavTargetsView=sap.ui.view({viewName:"sap.apf.ui.reuse.view.navigationTarget",type:sap.ui.core.mvc.ViewType.JS,viewData:{oNavigationHandler:s.oNavigationHandler,oNavListPopover:s.oNavListPopover,oOpenInButtonEventSource:e.getSource(),oUiApi:s.oUiApi}});}});if(this.oNavigationHandler.getNavigationTargets().length===0){this.openInBtn.setEnabled(false);}this.getView().byId("detailFooter").insertContentRight(this.openInBtn,1);}});sap.ui.controller("sap.apf.ui.reuse.controller.messageHandler",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},showMessage:function(m){var t=m.getMessage();var c=m.getCode();var s=m.getSeverity();var d=m.getTimestampAsdateObject();var M=new sap.ui.core.Message({text:t,timestamp:d});var f=sap.apf.core.constants.message.severity.fatal;var w=sap.apf.core.constants.message.severity.warning;var a=sap.apf.core.constants.message.severity.technError;var e=sap.apf.core.constants.message.severity.error;var b=this;switch(s){case f:M.setLevel(sap.ui.core.MessageType.Error);this.oUiApi.getLayoutView().setBusy(false);b.showDialog(t,c);break;case w:M.setLevel(sap.ui.core.MessageType.Warning);break;case e:this.oUiApi.getLayoutView().setBusy(false);M.setLevel(sap.ui.core.MessageType.Error);break;case a:break;default:jQuery.sap.log.error("Error type not defined");break;}if(s===f||s===w||s===e){jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(M.getText(),{duration:3000,width:"40%",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:2000});}},showDialog:function(t){var s=this;var b=this.oCoreApi.getTextNotHtmlEncoded("application-logout");var d=this.oCoreApi.getTextNotHtmlEncoded("fatal-error");var l=this.oCoreApi.getLogMessages();var a=false;var i;for(i=0;i<l.length;i++){if(l[i].search(5021)!==-1){a=true;break;}}if(a===true){t=this.oCoreApi.getTextNotHtmlEncoded("application-reload");b=this.oCoreApi.getTextNotHtmlEncoded("reload-button");d=this.oCoreApi.getTextNotHtmlEncoded("sessionTimeout");}var D;for(i=0;i<l.length;i++){if(D){D=D+"\n"+l[i];}else{D=l[i];}}var I=false;s.fnClose=function(){I=true;if(window.location.hash){window.location.hash="";}};sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:t,details:D},s.fnClose);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.navigationTarget",{onInit:function(){this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;},handleNavigation:function(s){this.oNavigationHandler.navigateToApp(s);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.pathGallery",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;},openPathGallery:function(){if(this.oHierchicalPathGalleryDialog){this.oHierchicalPathGalleryDialog.destroy();}this.oHierchicalPathGalleryDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",this);var m=new sap.ui.model.json.JSONModel();var j=this.getPathGalleryData();m.setData(j);this.oHierchicalPathGalleryDialog.setModel(m,"json");this.oHierchicalPathGalleryDialog.open();},getPathGalleryData:function(){var s=this;var a=this.getView().getViewData()?this.getView().getViewData().jsonData:{};var f=function(){var c={"steps":s.oCoreApi.getStepTemplates()};return c;};if(a.GalleryElements.length!==0){var b=a.GalleryElements;var c=f();var i,j,k,d;for(i=0;i<b.length;i++){for(j=0;j<b[i].StructuredAnalysisPath.steps.length;j++){for(k=0;k<c.steps.length;k++){var e=b[i].StructuredAnalysisPath.steps[j].stepId;var g=b[i].StructuredAnalysisPath.steps[j].selectedRepresentationId;if(e===c.steps[k].id){for(d in c.steps[k].getRepresentationInfo()){if(g===c.steps[k].getRepresentationInfo()[d].representationId){a.GalleryElements[i].StructuredAnalysisPath.steps[j].imgSrc=c.steps[k].getRepresentationInfo()[d].picture;a.GalleryElements[i].StructuredAnalysisPath.steps[j].title=s.oCoreApi.getTextNotHtmlEncoded(c.steps[k].title.key);}}}}}}}return a;},openPath:function(p,g,a){var s=this;var m;var c=s.oUiApi.getAnalysisPath().getCarousel();s.oSerializationMediator.openPath(g,(function(s){return function(r,e,b){if(b===undefined&&(typeof r==="object")){s.oUiApi.getAnalysisPath().getController().isOpenPath=true;s.oUiApi.contextChanged();s.oUiApi.getAnalysisPath().getCarousel().oController.removeAllSteps();s.oUiApi.getAnalysisPath().getController().refresh(-1);s.oCoreApi.updatePath(s.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(s.oUiApi.getAnalysisPath().getController()));s.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);s.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(s.oHierchicalPathGalleryDialog!==undefined){s.oHierchicalPathGalleryDialog.close();}c.rerender();s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6008",aParameters:[p]});m.setPrevious(b);s.oUiApi.getLayoutView().setBusy(false);s.oCoreApi.putMessage(m);}};}(this)),a);}});sap.ui.controller("sap.apf.ui.reuse.controller.step",{setActiveStep:function(i){var o=this.oCoreApi.getActiveStep();var a=this.oCoreApi.getSteps().indexOf(o);if(a===i){return;}var b=this.oCoreApi.getSteps()[i];this.oCoreApi.setActiveStep(b);this.oUiApi.getAnalysisPath().getController().drawMainChart();var s=this.oUiApi.getAnalysisPath().getCarousel().stepViews[i];s.toggleActiveStep();},bindEvts:function(){var s=this;var c=this.oUiApi.getAnalysisPath().getCarousel();var a=this.getView().oVChartTiltleLayout;a.attachBrowserEvent('click',function(){var b=c.stepViews.indexOf(s.getView());s.setActiveStep(b);});},onAfterRendering:function(){this.bindEvts();},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.isSwitched=false;},drawThumbnailContent:function(d){var v=this.getView();var i=this.oUiApi.getAnalysisPath().getCarousel().stepViews.indexOf(v);if(this.representationInstance!==undefined){if(this.representationInstance!==this.oCoreApi.getSteps()[i].getSelectedRepresentation().type){this.isSwitched=true;}}this.representationInstance=this.oCoreApi.getSteps()[i].getSelectedRepresentation().type;if(this.oCoreApi.getSteps()[i].getSelectedRepresentation().toggleInstance!==undefined){this.bToggleInstanceExists=true;}if(this.isSwitched===true||d===undefined||d===true||this.bToggleInstanceExists===true){this.isSwitched=false;v.oThumbnailChartLayout.removeAllItems();var s=this.oCoreApi.getSteps()[i];var c;if(s.getSelectedRepresentation().bIsAlternateView){if(s.getSelectedRepresentation().toggleInstance!==undefined){var a=s.getSelectedRepresentation().getData();var m=s.getSelectedRepresentation().getMetaData();s.getSelectedRepresentation().toggleInstance.setData(a,m);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}else{s.getSelectedRepresentation().toggleInstance=this.oUiApi.getStepContainer().getController().createAlternateRepresentation(i);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}}else{c=s.getSelectedRepresentation().getThumbnailContent();}var o=new sap.m.VBox({}).addStyleClass("overlayThumbnailWrapper");v.oThumbnailChartLayout.addItem(c);v.oThumbnailChartLayout.addItem(o);var C=this.oUiApi.getAnalysisPath().getCarousel().getController();var t=C.getThumbnailDataset(s);v.getModel().getData().thumbnail=t;v.getModel().updateBindings();v.oThumbnailChartLayout.rerender();v.oThumbnailChartLayout.setBusy(false);}else{v.oThumbnailChartLayout.setBusy(false);}}});sap.ui.controller("sap.apf.ui.reuse.controller.stepContainer",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},drawSelectionContainer:function(){this.getView().getStepToolbar().getController().showSelectionCount();},resizeContent:function(){if(this.oCoreApi.getActiveStep()){if(this.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){this.drawStepContent();var s=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-20)+"px";jQuery('.tableWithoutHeaders').css({"height":s});}else{this.drawStepContent();}}},onAfterRendering:function(){var s=this;var t;jQuery(window).resize(function(){clearTimeout(t);t=setTimeout(function(){s.resizeContent();},500);});},getCurrentRepresentation:function(){return this.representationInstance;},drawRepresentation:function(){var s=this;var a=this.oCoreApi.getActiveStep();if(a.getSelectedRepresentation().bIsAlternateView===undefined||a.getSelectedRepresentation().bIsAlternateView===false){this.representationInstance=a.getSelectedRepresentation();}else{this.representationInstance=a.getSelectedRepresentation().toggleInstance;var d=a.getSelectedRepresentation().getData(),m=a.getSelectedRepresentation().getMetaData();this.representationInstance.setData(d,m);}var l=a.longTitle&&!this.oCoreApi.isInitialTextKey(a.longTitle.key)?a.longTitle:undefined;var t=l||a.title;var S=this.oCoreApi.getTextNotHtmlEncoded(t);var c=this.representationInstance.getMainContent(S);var b=this.getView().getStepToolbar().chartToolbar.getId();this.setHeightAndWidth=function(){var e;var f;if(jQuery("#"+b).length!==0){e=jQuery("#"+b+" > div:first-child > div:nth-child(2)").offset().top;f=jQuery("#"+b+" > div:first-child > div:nth-child(2)").width();}else{e="0";f=jQuery(window).width();}var g=s.getView().getStepToolbar().chartToolbar.getFullScreen()?(jQuery(window).height()-e):(jQuery(window).height()-e)-jQuery(".applicationFooter").height();var h=f;if(s.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView||s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){c.getContent()[0].setHeight((g-5)+"px");c.getContent()[0].setWidth(h+"px");}else if(s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP){var i=(jQuery(c.getContent())[0]);i.style.height=g+"px";i.style.width=h+"px";c.setContent(i.outerHTML);}else{c.setHeight(g+"px");c.setWidth(h+"px");}};c.getIcon=function(){return;};c.getLabel=function(){return;};c.addEventDelegate({onBeforeRendering:function(){s.setHeightAndWidth();}});this.getView().getStepToolbar().getController().drawRepresentation(c);},createAlternateRepresentation:function(I){var s=this;var a=function(b){var e=b.dimensions;var m=s.oCoreApi.getSteps()[I].getSelectedRepresentation().getMetaData();if(m===undefined){return b;}var i;for(i=0;i<e.length;i++){var S=m.getPropertyMetadata(e[i].fieldName).hasOwnProperty('text');if(S){var n={};n.fieldName=m.getPropertyMetadata(e[i].fieldName).text;b.dimensions.push(n);}}b.isAlternateRepresentation=true;return b;};var A=s.oCoreApi.getSteps()[I];var c=A.getSelectedRepresentation();var p=jQuery.extend(true,{},c.getParameter());delete p.alternateRepresentationTypeId;delete p.alternateRepresentationType;p=a(p);this.newToggleInstance=this.oCoreApi.createRepresentation(c.getParameter().alternateRepresentationType.constructor,p);var d=c.getData();var m=c.getMetaData();if(d!==undefined&&m!==undefined){this.newToggleInstance.setData(d,m);}this.newToggleInstance.adoptSelection(c);return this.newToggleInstance;},isActiveStepChanged:function(){var a;if(this.currentActiveStepIndex===undefined){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else if(this.currentActiveStepIndex!==this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else{a=false;}return a;},isSelectedRepresentationChanged:function(){var s;if(this.currentSelectedRepresentationId===undefined){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.currentSelectedRepresentationId!==this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.getCurrentRepresentation().type!==this.oCoreApi.getActiveStep().getSelectedRepresentation().type){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else{s=false;}return s;},drawStepContent:function(d){var n=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var t=this.oUiApi.getAnalysisPath().getCarousel().getStepView(n).oThumbnailChartLayout.isBusy();var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oUiApi.getAnalysisPath().getController().isNewPath;if(t){this.getView().vLayout.setBusy(true);return;}var A=this.isActiveStepChanged();var s=this.isSelectedRepresentationChanged();var r=(d===undefined||d===true);if(r||A||s||i||a){this.drawRepresentation();}else{if(this.oCoreApi.getSteps().length>=1){this.drawSelectionContainer();}}if(this.getView().vLayout.isBusy()){this.getView().vLayout.removeAllContent();this.getView().vLayout.addContent(this.getView().stepLayout);this.getView().vLayout.setBusy(false);}this.getView().vLayout.setBusy(false);}});sap.ui.controller("sap.apf.ui.reuse.controller.toolbar",{resetAnalysisPath:function(){this.oCoreApi.resetPath();this.oUiApi.getAnalysisPath().getController().isNewPath=true;this.oPathContextHandler.restoreInitialContext();this.oUiApi.contextChanged(true);this.oUiApi.getAnalysisPath().getCarousel().getController().removeAllSteps();this.oUiApi.getAnalysisPath().getController().refreshAnalysisPath();this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(this.oCoreApi.getTextNotHtmlEncoded("unsaved"));this.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;this.oUiApi.getAnalysisPath().getCarousel().rerender();},onInit:function(){this.view=this.getView();this.oViewData=this.getView().getViewData();this.oCoreApi=this.oViewData.oCoreApi;this.oSerializationMediator=this.oViewData.oSerializationMediator;this.oUiApi=this.oViewData.uiApi;this.oPathContextHandler=this.oViewData.oPathContextHandler;this.oPrintHelper=new sap.apf.ui.utils.PrintHelper(this.oViewData);this.bIsPathGalleryWithDelete=false;},openPathGalleryWithDelete:function(){var j={};var s=this;var m;var i;s.oCoreApi.readPaths(function(d,a,b){if(b===undefined&&(typeof d==="object")){var g=d.paths;for(i=0;i<g.length;i++){var n=g[i].StructuredAnalysisPath.steps.length;var u=g[i].LastChangeUTCDateTime;var c=/\d+/g;var t=parseInt(u.match(c)[0],10);var e=((new Date(t)).toString()).split(' ');var f=e[1]+"-"+e[2]+"-"+e[3];g[i].guid=g[i].AnalysisPath;g[i].StructuredAnalysisPath.noOfSteps=n;g[i].description=f+"  -   ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";g[i].summary=g[i].AnalysisPathName+"- ("+f+") - ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";}j={GalleryElements:g};s.deleteAnalysisPath=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.deleteAnalysisPath",viewData:{jsonData:j,oInject:s.oViewData}});s.deleteAnalysisPath.getController().openPathGalleryWithDelete();s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});m.setPrevious(b);s.oCoreApi.putMessage(m);s.oUiApi.getLayoutView().setBusy(false);}});},openPathGallery:function(){var j={};var s=this;var i,m;s.oCoreApi.readPaths(function(d,a,b){if(b===undefined&&(typeof d==="object")){var g=d.paths;for(i=0;i<g.length;i++){var n=g[i].StructuredAnalysisPath.steps.length;var u=g[i].LastChangeUTCDateTime;var c=/\d+/g;var t=parseInt(u.match(c)[0],10);var e=((new Date(t)).toString()).split(' ');var f=e[1]+"-"+e[2]+"-"+e[3];g[i].guid=g[i].AnalysisPath;g[i].StructuredAnalysisPath.noOfSteps=n;g[i].description=f+"  -   ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";g[i].summary=g[i].AnalysisPathName+"- ("+f+") - ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";}j={GalleryElements:g};s.pathGallery=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.pathGallery",viewData:{jsonData:j,oInject:s.oViewData}});s.pathGallery.getController().openPathGallery();s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});m.setPrevious(b);s.oCoreApi.putMessage(m);s.oUiApi.getLayoutView().setBusy(false);}});},doPrint:function(){var p=this.oPrintHelper;p.doPrint();},getSaveDialog:function(s,r,p){var a=this;var h=this.oCoreApi.getTextNotHtmlEncoded("saveName");var b=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var m=new sap.ui.model.json.JSONModel();m.setData(p);if(b){var f=b.charAt(0);if(f==="*"){b=b.split('*')[1];}}this.oInput=new sap.m.Input({type:sap.m.InputType.Text,placeholder:h,showSuggestion:true,suggestionItems:{path:"/",template:new sap.ui.core.Item({text:"{AnalysisPathName}",additionalText:"{AnalysisPath}"}),showValueHelp:true,valueHelpRequest:function(e){var c=function(e){var S=e.getParameter("selectedItem");if(S){input.setValue(S.getTitle());}e.getSource().getBinding("items").filter([]);};}}}).addStyleClass("saveStyle");this.oInput.setModel(m);if(!s){this.oInput.destroySuggestionItems();}this.oInput.attachEvent("click",function(e){jQuery(e.currentTarget).attr('value','');});this.oInput.attachLiveChange(function(d){var v=this.getValue();var c=a.saveDialog;var e=new RegExp("[*]","g");if(v===""){c.getBeginButton().setEnabled(false);}if((v.match(e)!==null)){c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:this.oCoreApi.getTextNotHtmlEncoded('invalid-entry')})}));this.setValueState(sap.ui.core.ValueState.Error);return false;}else{c.getBeginButton().setEnabled(true);c.destroySubHeader();this.setValueState(sap.ui.core.ValueState.None);}if(v.trim()!==""){c.getBeginButton().setEnabled(true);c.destroySubHeader();}else{c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:a.oCoreApi.getTextNotHtmlEncoded('enter-valid-path-name')})}));}});if(b!==(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){this.oInput.setValue(b);}else{}this.analysisPathName=(a.oInput.getValue()).trim();this.saveDialog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:a.oCoreApi.getTextNotHtmlEncoded("save-analysis-path"),beginButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("ok"),enabled:false,press:function(){a.saveDialog.getBeginButton().setEnabled(false);a.saveDialog.getEndButton().setEnabled(false);var c=(a.oInput.getValue()).trim();a.saveAnalysisPath(c,r,s);this.destroy();}}),endButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){a.saveDialog.close();this.destroy();}}),afterClose:function(){a.oUiApi.getLayoutView().setBusy(false);}});this.saveDialog.addContent(this.oInput);if(this.oInput.getValue()===b){this.saveDialog.getBeginButton().setEnabled(true);}if(a.oCoreApi.getSteps().length>=1){if(!s&&b===(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){this.saveDialog.open();}else if(s){this.saveDialog.open();}else{a.saveAnalysisPath(b,r,s);}}},doOkOnNewAnalysisPath:function(){var s=this;this.isOpen=false;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){s.resetAnalysisPath();},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},doOkOnOpenAnalysisPath:function(i){var s=this;this.isOpen=true;this.bIsPathGalleryWithDelete=i;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getNewAnalysisPathDialog:function(){var s=this;if(s.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(0,1)==="*"&&s.oCoreApi.getSteps().length!==0){var n=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnNewAnalysisPath();n.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.resetAnalysisPath();n.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});n.open();}else{this.resetAnalysisPath();}},getOpenDialog:function(i){var s=this;var d=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnOpenAnalysisPath(s.bIsPathGalleryWithDelete);d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){d.close();s.resetAnalysisPath();if(s.bIsPathGalleryWithDelete){s.openPathGalleryWithDelete();}else{s.openPathGallery();}}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmDelDialog:function(l){var s=this;var p=l.sPathName;var d=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("delPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("do-you-want-to-delete-analysis-path")+" '"+p+"'?"}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.oUiApi.getAnalysisPath().getPathGalleryWithDeleteMode().getController().deleteSavedPath(p,l);d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmDialog:function(p){var s=this;var o=p||{};var a={success:o.success||function(){},fail:o.fail||function(){},msg:o.msg||""};var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("caution"),type:sap.m.DialogType.Standard,content:new sap.m.Text({text:a.msg}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.overWriteAnalysisPath();d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){var S=true;var D=s.oInput.getModel().getData();s.getSaveDialog(S,function(){},D);d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmLogOffDialog:function(){var s=this;var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("confirmation"),type:sap.m.DialogType.Standard,content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("do-you-want-to-logout")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.oCoreApi.logoutHanaXse();d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getErrorMessageDialog:function(m){var s=this;var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("error"),type:sap.m.DialogType.Message,content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){var f=function(){};if(f){setTimeout(function(){s.callbackforSave(f);},200);}d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},callbackforSave:function(f){f();},onOpenPathGallery:function(){this.bIsPathGalleryWithDelete=false;var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var f=p.charAt(0);if(f==="*"&&this.oCoreApi.getSteps().length!==0){this.getOpenDialog(this.bIsPathGalleryWithDelete);}else{this.openPathGallery();}this.isOpen=false;},onOpenPathGalleryWithDelete:function(){this.bIsPathGalleryWithDelete=true;var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var f=p.charAt(0);if(f==="*"&&this.oCoreApi.getSteps().length!==0){this.getOpenDialog(this.bIsPathGalleryWithDelete);}else{this.openPathGalleryWithDelete();}this.isOpen=false;},saveAnalysisPath:function(a,f,s){var b=this;this.saveCallback=f;this.analysisPathName=a;this.aData=b.oInput.getModel().getData();var c=false;this.guid="";var d=b.oCoreApi.getSteps();if(this.aData.length>this.getView().maxNumberOfPaths){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-paths-exceeded"));if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}return false;}else if(d.length>this.getView().maxNumberOfSteps){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-steps-exceeded"));if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}return false;}for(var i=0;i<this.aData.length;i++){var e=this.aData[i].AnalysisPathName;if(this.analysisPathName===e){c=true;this.guid=this.aData[i].AnalysisPath;break;}}if(!c){b.oSerializationMediator.savePath(b.analysisPathName,function(r,m,g){if(g===undefined&&(typeof r==="object")){b.oUiApi.getAnalysisPath().oSavedPathName.setTitle(b.analysisPathName);b.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}var h=b.oCoreApi.getTextNotHtmlEncoded("path-saved-successfully",["'"+b.analysisPathName+"'"]);b.getSuccessToast(b.analysisPathName,h);if(typeof b.saveCallback==="function"){b.saveCallback();}}else{var M=b.oCoreApi.createMessageObject({code:"6006",aParameters:[b.analysisPathName]});M.setPrevious(g);b.oCoreApi.putMessage(M);}});}else{if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}var p;if(b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().charAt(0)==="*"&&this.oCoreApi.getSteps().length!==0){p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(1,b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().length);}else{p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle();}if(!s&&p===b.analysisPathName){b.overWriteAnalysisPath();}else{this.getConfirmDialog({msg:b.oCoreApi.getTextNotHtmlEncoded("path-exists",["'"+b.analysisPathName+"'"])});}c=false;}},getSuccessToast:function(p,m){var s=this;var a=m;sap.m.MessageToast.show(a,{width:"20em"});if(s.isOpen&&s.bIsPathGalleryWithDelete){s.openPathGalleryWithDelete();}else if(s.isOpen){s.openPathGallery();}},overWriteAnalysisPath:function(){var s=this;var p=this.analysisPathName;var g=this.guid;s.oSerializationMediator.savePath(g,p,function(r,m,a){if(a===undefined&&(typeof r==="object")){s.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);var b=s.oCoreApi.getTextNotHtmlEncoded("path-updated-successfully",["'"+p+"'"]);s.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(s.saveDialog&&s.saveDialog.isOpen()){s.saveDialog.close();}s.getSuccessToast(p,b);if(typeof s.saveCallback==="function"){s.saveCallback();}}else{var M=s.oCoreApi.createMessageObject({code:"6007",aParameters:[p]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getDialogForNoPathAdded:function(){var s=this;var m=s.oCoreApi.getTextNotHtmlEncoded("noStepInPath");var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("alert"),type:sap.m.DialogType.Message,contentWidth:jQuery(window).height()*0.2+"px",contentHeight:jQuery(window).height()*0.2+"px",content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();}});sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",{createContent:function(c){this.oController=c;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";var s=this;this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;this.pathGalleryHierarchicalDialog=new sap.ca.ui.HierarchicalSelectDialog({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),contentWidth:s.contentWidth,contentHeight:s.contentHeight,select:function(e){s.oUiApi.getLayoutView().setBusy(true);var a=e.getParameters().selectedItem.oBindingContexts.json.sPath.split('/');var p=this.getModel("json").getData().GalleryElements[a[2]].AnalysisPathName;var b=this.getModel("json").getData().GalleryElements[a[2]].AnalysisPath;var d=a[5];c.openPath(p,b,d);s.oUiApi.getLayoutView().setBusy(false);},cancel:function(){var S=this;s.oUiApi.getLayoutView().setBusy(false);S.close();S.destroy();}});this.pathName=new sap.ca.ui.HierarchicalSelectDialogItem({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),entityName:"json>/GalleryElements",visible:true});this.pathTemplate=new sap.m.StandardListItem({title:'{json>AnalysisPathName}',description:'{json>description}',tooltip:'{json>AnalysisPathName}'});this.stepTitle=new sap.ca.ui.HierarchicalSelectDialogItem({entityName:"json>StructuredAnalysisPath/steps"});this.stepTemplate=new sap.m.StandardListItem({title:'{json>title}',icon:'{json>imgSrc}',tooltip:'{json>title}'});this.pathName.setListItemTemplate(this.pathTemplate);this.stepTitle.setListItemTemplate(this.stepTemplate);this.pathGalleryHierarchicalDialog.addItem(this.pathName);this.pathGalleryHierarchicalDialog.addItem(this.stepTitle);return this.pathGalleryHierarchicalDialog;}});
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",{createContent:function(c){this.oController=c;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";var s=this;this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){s.selectionDisplayDialog.close();s.selectionDisplayDialog.destroy();}});var A=this.oCoreApi.getActiveStep();var b=A.getSelectedRepresentation();var d=typeof(b.getSelections)==="function"?b.getSelections():undefined;var e=b.getMetaData().getPropertyMetadata(b.getParameter().requiredFilters[0]).label;var m=new sap.ui.model.json.JSONModel();if(d!==undefined){var D={selectionData:d};var f=new sap.m.List({items:{path:"/selectionData",template:new sap.m.StandardListItem({title:"{text}"})}});m.setData(D);f.setModel(m);this.selectionDisplayDialog=new sap.m.Dialog({title:this.oCoreApi.getTextNotHtmlEncoded("selected-required-filter",[e])+" ("+d.length+")",contentWidth:s.contentWidth,contentHeight:s.contentHeight,buttons:[a],content:[f]});return this.selectionDisplayDialog;}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",{createContent:function(c){this.oController=c;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";var s=this;this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;this.hierarchicalDialog=new sap.ca.ui.HierarchicalSelectDialog({title:s.oCoreApi.getTextNotHtmlEncoded("stepGallery"),contentWidth:s.contentWidth,contentHeight:s.contentHeight,select:function(e){s.oUiApi.getLayoutView().setBusy(true);var a=e.getParameters().selectedItem.oBindingContexts.json.sPath.split('/');var b=a[2];var d=a[4];var r=a[6];var f=c.getStepDetails(b,d);c.onStepPress(f.id,f.representationtypes[r].representationId);},cancel:function(){var S=this;S.close();S.destroy();}});this.categoryTitle=new sap.ca.ui.HierarchicalSelectDialogItem({title:s.oCoreApi.getTextNotHtmlEncoded("category"),entityName:"json>/GalleryElements",visible:true});this.categoryTemplate=new sap.m.StandardListItem({title:'{json>categoryDetails/title}',tooltip:'{json>categoryDetails/title}'});this.stepTitle=new sap.ca.ui.HierarchicalSelectDialogItem({entityName:"json>stepTemplates"});this.stepTemplate=new sap.m.StandardListItem({title:'{json>maintitle}',tooltip:'{json>maintitle}'});this.representationTitle=new sap.ca.ui.HierarchicalSelectDialogItem({entityName:"json>representationtypes"});this.representationTemplate=new sap.m.StandardListItem({icon:'{json>picture}',title:'{json>title}',tooltip:'{json>title}'});this.representationTemplate.bindProperty("description","json>sortDescription",function(v){if(v===undefined||v===null){return null;}return s.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+v;});this.categoryTitle.setListItemTemplate(this.categoryTemplate);this.stepTitle.setListItemTemplate(this.stepTemplate);this.representationTitle.setListItemTemplate(this.representationTemplate);this.hierarchicalDialog.addItem(this.categoryTitle);this.hierarchicalDialog.addItem(this.stepTitle);this.hierarchicalDialog.addItem(this.representationTitle);return this.hierarchicalDialog;}});sap.ui.jsview("sap.apf.ui.reuse.view.analysisPath",{getCarousel:function(){return this.oCarousel;},getToolbar:function(){return this.oActionListItem;},getPathGallery:function(){return this.pathGallery;},getPathGalleryWithDeleteMode:function(){return this.deleteAnalysisPath;},getControllerName:function(){return"sap.apf.ui.reuse.controller.analysisPath";},createContent:function(c){var s=this;this.oController=c;this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Bottom,contentWidth:"150px"});var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;this.oActionListItem=sap.ui.view({viewName:"sap.apf.ui.reuse.view.toolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v}).addStyleClass("toolbarView");this.oActionListPopover.addContent(this.oActionListItem);this.oSavedPathName=new sap.m.ObjectHeader({title:this.oCoreApi.getTextNotHtmlEncoded("unsaved"),showTitleSelector:true,condensed:true,titleSelectorPress:function(e){s.oActionListPopover.openBy(e.getParameter("domRef"));}}).addStyleClass("sapApfObjectHeader");this.oCarousel=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.carousel",viewData:{analysisPath:s,oInject:v}});this.pathGallery=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.pathGallery",viewData:{oInject:v}});this.deleteAnalysisPath=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.deleteAnalysisPath",viewData:{oInject:v}});this.oAnalysisPath=new sap.ui.layout.VerticalLayout({content:[s.oContentTitle,s.oSavedPathName,s.oCarousel],width:'100%'});return this.oAnalysisPath;}});sap.ui.jsview("sap.apf.ui.reuse.view.carousel",{getStepGallery:function(){var s=this.oController.stepGalleryView;return s;},getChartToolbar:function(){return this.oController.oStepToolbar;},carouselContent:function(c){jQuery.sap.require('sap.apf.ui.controls.draggableCarousel.DraggableCarousel');var s=this;this.oController=c;this.stepViews=[];var v=this.getViewData().oInject;s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var a=new sap.ui.core.Icon({src:"sap-icon://arrow-bottom"}).addStyleClass('downArrow');var b=document.createElement('div');b.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var r=new sap.ui.core.Icon({src:"sap-icon://sys-cancel-2",size:"20px"}).addStyleClass('removeIcon');var d=document.createElement('div');d.innerHTML=sap.ui.getCore().getRenderManager().getHTML(r);var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";var w="320px";window.onresize=function(){var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";jQuery('.DnD-container').css({"height":jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px"});jQuery(".scrollContainerEle").css("height",h);};this.dndBox=new sap.apf.ui.controls.draggableCarousel.DraggableCarousel({containerHeight:jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px",containerWidth:w,blockHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_HEIGHT,blockWidth:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_WIDTH,blockMargin:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_MARGIN,separatorHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.SEPARATOR_HEIGHT,removeIconHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.REMOVE_ICON_HEIGHT,separator:b,removeIcon:d,onBeforeDrag:function(f){},onAfterDrop:c.moveStep.bind(c),onAfterRemove:c.removeStep.bind(c),onAfterSelect:function(i){if(jQuery(this).attr("drag-state")==="true"){s.getStepView(i).oController.setActiveStep(i);}else{c.showStepGallery();}}});window.dndBox=this.dndBox;var u=this.createId("dnd-Holder");this.oHtml=new sap.ui.core.HTML({content:"<div id = '"+u+"'></div>",afterRendering:function(){s.dndBox.placeAt(u);jQuery(s.dndBox.eleRefs.blocks[0]).height("80px");}});var e;this.addButton=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("add-step"),width:"100%",icon:"sap-icon://add",press:function(f){c.showStepGallery();}});e=document.createElement('div');e.setAttribute('class','addStepBtnHolder');jQuery(e).html(jQuery(sap.ui.getCore().getRenderManager().getHTML(this.addButton)).attr("tabindex",-1));dndBox.addBlock({blockElement:e,dragState:false,dropState:false,removable:false});this.up=new sap.m.Button({icon:"sap-icon://arrow-top",press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==0){var n=f-1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.down=new sap.m.Button({icon:"sap-icon://arrow-bottom",press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==(s.oCoreApi.getSteps().length-1)){var n=f+1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.oCarousel=new sap.m.ScrollContainer({content:this.oHtml,height:h,horizontal:false,vertical:true}).addStyleClass("scrollContainerEle");return this.oCarousel;},getControllerName:function(){return"sap.apf.ui.reuse.controller.carousel";},createContent:function(c){var a=this.carouselContent(c);return a;},getStepView:function(s){return this.stepViews[s];}});sap.ui.jsview("sap.apf.ui.reuse.view.deleteAnalysisPath",{getControllerName:function(){return"sap.apf.ui.reuse.controller.deleteAnalysisPath";},createContent:function(c){this.oController=c;this.viewData=this.getViewData();var s=this;this.oCoreApi=this.getViewData().oInject.oCoreApi;this.oUiApi=this.getViewData().oInject.uiApi;this.width=jQuery(window).height()*0.55+"px";this.height=jQuery(window).height()*0.55+"px";var l=new sap.m.List({width:s.width,height:s.height,mode:sap.m.ListMode.Delete,items:{path:"/GalleryElements",template:new sap.m.StandardListItem({title:"{AnalysisPathName}",description:"{description}",tooltip:"{AnalysisPathName}"})},"delete":function(e){var i=e.getParameter("listItem");var P=i.getProperty('title');var g=s.oController.getGuidForPath(P,s.viewData.jsonData.GalleryElements);var L={};L.item=i;L.list=l;L.guid=g;L.sPathName=P;s.oUiApi.getAnalysisPath().getToolbar().getController().getConfirmDelDialog(L);}});var p=new sap.ui.model.json.JSONModel();p.setData(this.viewData.jsonData);l.setModel(p);return l;}});sap.ui.jsview("sap.apf.ui.reuse.view.facetFilter",{getControllerName:function(){return"sap.apf.ui.reuse.controller.facetFilter";},createContent:function(c){var s=this;this.aFacetFilterListControls=[];this.oCoreApi=this.getViewData().oCoreApi;this.oUiApi=this.getViewData().oUiApi;this.oPathContextHandler=this.getViewData().oPathContextHandler;this.aFacetFilterListData=this.getViewData().aFacetFilterListData;this.aFacetFilterListData.forEach(function(f){var F=new sap.m.FacetFilterList({title:s.oCoreApi.getTextNotHtmlEncoded(f.label),multiSelect:f.multiSelection==="true",key:f.property,growing:false,listClose:c.onListClose.bind(c)});s.aFacetFilterListControls.push(F);});this.onContextChanged=c.onContextChanged.bind(c);this.getFormattedFilters=c.getFormattedFilters.bind(c);this.oFacetFilter=new sap.m.FacetFilter({type:"Simple",showReset:true,showPopoverOKButton:true,lists:this.aFacetFilterListControls,reset:c.onResetPress.bind(c)});return this.oFacetFilter;}});sap.ui.jsview("sap.apf.ui.reuse.view.messageHandler",{initializeHandler:function(m){this.getController().showMessage(m);},getControllerName:function(){return"sap.apf.ui.reuse.controller.messageHandler";},createContent:function(c){jQuery.sap.require("sap.m.MessageToast");jQuery.sap.require("sap.ca.ui.message.message");}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.navigationTarget",{getControllerName:function(){return"sap.apf.ui.reuse.controller.navigationTarget";},createContent:function(c){var v=this.getViewData();this.oNavListPopover=v.oNavListPopover;this.oOpenInButtonEventSource=v.oOpenInButtonEventSource;this.oNavigationHandler=v.oNavigationHandler;this.oUiApi=v.oUiApi;this.oController=c;this.oUiApi.getLayoutView().byId("applicationPage").setBusy(true);var n=this.oNavigationHandler.getNavigationTargetsWithText();n.then(this._prepareActionListModel.bind(this),function(){this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);});},_prepareActionListModel:function(n){var a,n;var s=this;var m=new sap.ui.model.json.JSONModel();var d={navTargets:n};a=new sap.m.List({items:{path:"/navTargets",template:new sap.m.StandardListItem({title:"{text}",type:sap.m.ListType.Navigation,press:function(e){var b=e.getSource().getBindingContext().getObject().id;s.oController.handleNavigation(b);},})}});m.setData(d);a.setModel(m);this.oNavListPopover.removeAllContent();this.oNavListPopover.addContent(a);this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);this.oNavListPopover.openBy(this.oOpenInButtonEventSource);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.pathGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.pathGallery";},createContent:function(c){this.viewData=this.getViewData();}});sap.ui.jsview("sap.apf.ui.reuse.view.step",{getControllerName:function(){return"sap.apf.ui.reuse.controller.step";},stepContent:function(){this.oCoreApi=this.getViewData().oCoreApi;this.oUiApi=this.getViewData().uiApi;this.oTopLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftUpper}',tooltip:'{/thumbnail/leftUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightUpper}',tooltip:'{/thumbnail/rightUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("topLayout");this.oThumbnailChartLayout=new sap.m.VBox({height:"80px"}).addStyleClass('ChartArea');this.oThumbnailChartLayout.setBusy(true);this.oBottomLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftLower}',tooltip:'{/thumbnail/leftLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightLower}',tooltip:'{/thumbnail/rightLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("bottomLayout");this.oThumbnailVLayout=new sap.m.VBox({items:[this.oTopLayout,this.oThumbnailChartLayout,this.oBottomLayout],height:"130px"}).addStyleClass('stepThumbnail');this.oStepTitle=new sap.m.Text({text:'{/title}',textAlign:sap.ui.core.TextAlign.Center,wrapping:true,width:"200px"});this.oVChartLayout=new sap.m.VBox({items:[this.oThumbnailVLayout,this.oStepTitle],width:"200px"}).addStyleClass("sapApfStepLayout");var h=new sap.m.VBox({items:[]}).addStyleClass("block-overlay-container");var s=this;h.addEventDelegate({onAfterRendering:function(){var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.oUiApi.getLayoutView().byId("detailFooter").removeAllContentLeft();s.oUiApi.getLayoutView().byId("applicationView").backToTopMaster();},lite:true,type:"Transparent"});jQuery(h.getDomRef()).on("mouseenter",function(){jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0.3"});});jQuery(h.getDomRef()).on("touchstart",function(){var t=e.timeStamp,b=$(this).data('lastTouch')||t,d=t-b,f=e.originalEvent.touches.length;$(this).data('lastTouch',t);if(!d||d>500||f>1)return;e.preventDefault();$(this).trigger('click').trigger('click');jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});jQuery(h.getDomRef()).on("mouseleave",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"1"});});jQuery(h.getDomRef()).on("touchend touchmove",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});if(sap.ui.Device.system.phone){jQuery(h.getDomRef()).on("tap",function(){s.oUiApi.getLayoutView().getController().hideMaster();s.oUiApi.getLayoutView().byId("detailFooter").removeContentLeft(a);s.oUiApi.getLayoutView().getController().addDetailFooterContentLeft(a);s.oUiApi.getStepContainer().getController().drawStepContent();});}}});this.oVChartTiltleLayout=new sap.m.VBox({items:[h,this.oVChartLayout],width:"200px",}).addStyleClass("sapUiTableCCnt");return this.oVChartTiltleLayout;},createContent:function(c){var s=this.stepContent();return s;},toggleActiveStep:function(){var a=this.oUiApi.getAnalysisPath().getCarousel().stepViews;for(var i in a){if(a[i].oThumbnailVLayout.hasStyleClass('sapThemeBaseBG-asBackgroundColor')){a[i].oThumbnailVLayout.removeStyleClass('sapThemeBaseBG-asBackgroundColor');a[i].oStepTitle.removeStyleClass('activeStepTitle');break;}}this.oThumbnailVLayout.addStyleClass('sapThemeBaseBG-asBackgroundColor');this.oStepTitle.addStyleClass('activeStepTitle');},});sap.ui.jsview("sap.apf.ui.reuse.view.stepContainer",{getStepToolbar:function(){return this.oStepToolbar;},getControllerName:function(){return"sap.apf.ui.reuse.controller.stepContainer";},createContent:function(c){var v=this.getViewData();this.oStepToolbar=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepToolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v});this.stepLayout=new sap.ui.layout.VerticalLayout({content:[this.oStepToolbar],width:"100%"});this.vLayout=new sap.ui.layout.VerticalLayout({content:this.stepLayout,width:"100%"});this.vLayout.setBusy(true);return this.vLayout;},});sap.ui.jsview("sap.apf.ui.reuse.view.stepGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepGallery";},createContent:function(c){this.oController=c;}});sap.ui.jsview("sap.apf.ui.reuse.view.stepToolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepToolbar";},createContent:function(c){this.chartToolbar=new sap.ca.ui.charts.ChartToolBar({showLegend:true,showFullScreen:true});return this.chartToolbar;}});sap.ui.jsview("sap.apf.ui.reuse.view.toolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.toolbar";},createContent:function(c){this.maxNumberOfSteps=32;this.maxNumberOfPaths=255;var s=this;var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var t=new sap.m.StandardListItem({icon:'sap-icon://add-product',type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("new"),press:function(){s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.getNewAnalysisPathDialog();s.oUiApi.getLayoutView().setBusy(false);},});var T=new sap.m.StandardListItem({icon:"sap-icon://open-folder",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("open"),press:function(){s.oUiApi.getLayoutView().setBusy(true);s.getParent().close();c.onOpenPathGallery();},});var o=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("save"),press:function(){s.getParent().close();if(s.oCoreApi.getSteps().length!==0){s.oUiApi.getLayoutView().setBusy(true);s.oCoreApi.readPaths(function(r,m,e){var S=false;var p=r.paths;if(m!==undefined){s.maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(e===undefined&&(typeof r==="object")){c.getSaveDialog(S,function(){},p);}else{oMessageObject=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});oMessageObject.setPrevious(e);s.oCoreApi.putMessage(oMessageObject);}s.oUiApi.getLayoutView().setBusy(false);});}else c.getDialogForNoPathAdded();},});var a=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("saveAs"),press:function(){s.getParent().close();if(s.oCoreApi.getSteps().length!==0){s.oUiApi.getLayoutView().setBusy(true);s.oCoreApi.readPaths(function(r,m,e){var S=true;var p=r.paths;if(m!==undefined){s.maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(e===undefined&&(typeof r==="object")){c.getSaveDialog(S,function(){},p);}else{oMessageObject=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});oMessageObject.setPrevious(e);s.oCoreApi.putMessage(oMessageObject);}s.oUiApi.getLayoutView().setBusy(false);});}else c.getDialogForNoPathAdded();},});var b=new sap.m.StandardListItem({icon:"sap-icon://delete",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("delete"),press:function(){s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.onOpenPathGalleryWithDelete();},});var d=new sap.m.StandardListItem({icon:"sap-icon://print",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("print"),press:function(){s.getParent().close();c.doPrint();},});this.oActionListItem=new sap.m.List({items:[t,T,o,a,b,d]});return this.oActionListItem;}});jQuery.sap.declare('sap.apf.library-all');jQuery.sap.declare('sap.apf.modeler.ui.controller.configurationListNew.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.navigationTarget.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.titleBreadCrumb.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.analysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.carousel.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.deleteAnalysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.layout.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.messageHandler.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.navigationTarget.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.pathGallery.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.step.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.stepContainer.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.fragment.pathGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.selectionDisplay.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.stepGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.view.analysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.carousel.view');jQuery.sap.declare('sap.apf.ui.reuse.view.deleteAnalysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.facetFilter.view');jQuery.sap.declare('sap.apf.ui.reuse.view.messageHandler.view');jQuery.sap.declare('sap.apf.ui.reuse.view.navigationTarget.view');jQuery.sap.declare('sap.apf.ui.reuse.view.pathGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.step.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepContainer.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepToolbar.view');jQuery.sap.declare('sap.apf.ui.reuse.view.toolbar.view');if(!jQuery.sap.isDeclared('sap.apf.core.constants')){jQuery.sap.declare('sap.apf.core.constants');jQuery.sap.require('sap.ui.model.FilterOperator');(function(){'use strict';sap.apf.core.constants=sap.apf.core.constants||{};sap.apf.core.constants.filterMethodTypes={selectionAsArray:'saa',filter:'f'};sap.apf.core.constants.FilterOperators=sap.ui.model.FilterOperator;sap.apf.core.constants.BooleFilterOperators={AND:"and",OR:"or",NOT:"not"};sap.apf.core.constants.aSelectOpt=[sap.apf.core.constants.FilterOperators.EQ,sap.apf.core.constants.FilterOperators.NE,sap.apf.core.constants.FilterOperators.GT,sap.apf.core.constants.FilterOperators.LT,sap.apf.core.constants.FilterOperators.GE,sap.apf.core.constants.FilterOperators.LE,sap.apf.core.constants.FilterOperators.BT,sap.apf.core.constants.FilterOperators.StartsWith,sap.apf.core.constants.FilterOperators.Contains,sap.apf.core.constants.FilterOperators.EndsWith];sap.apf.core.constants.resourceLocation={applicationMessageDefinitionLocation:"applicationMessageDefinitionLocation",applicationMessageTextBundle:"applicationMessageTextBundle",apfUiTextBundle:"apfUiTextBundle",applicationUiTextBundle:"applicationUiTextBundle",analyticalConfigurationLocation:"analyticalConfigurationLocation"};sap.apf.core.constants.message={};sap.apf.core.constants.message.severity={fatal:"fatal",warning:"warning",error:"error",technError:"technError"};sap.apf.core.constants.message.code={suppressFurtherException:"APFapf1972",errorCheck:"5100",errorCheckWarning:"5101",errorCheckConfiguration:"5102",errorCheckConfigurationWarning:"5103",errorExitTriggered:"5300",errorUnknown:"9000",errorLoadConfig:"9001",errorStopProcessing:"9002",errorStartUp:"9003",errorLoadingRessource:"9007",wrongRessourcePath:"9008",missingAnalyticalConfig:"9009",errorLoadingAnalyticalConfig:"9010",errorInAnalyticalConfig:"9011"};sap.apf.core.constants.eventTypes={contextChanged:"contextChanged",printTriggered:"printTriggered",format:"format"};sap.apf.core.constants.configurationObjectTypes={facetFilter:"facetFilter"};sap.apf.core.constants.entitySets={application:'ApplicationQueryResults',configuration:'AnalyticalConfigurationQueryResults',texts:'TextElementQueryResults',logicalSystem:"SAPClientQuery",analysisPath:"AnalysisPathQueryResults",smartBusiness:"EVALUATIONS"};sap.apf.core.constants.developmentLanguage="";sap.apf.core.constants.textKeyForInitialText="00000000000000000000000000000000";sap.apf.core.constants.representationMetadata={kind:{XAXIS:"xAxis",YAXIS:"yAxis",BUBBLEWIDTH:"bubbleWidth",BUBBLEHEIGHT:"bubbleHeight",SECTORSIZE:"sectorSize",LEGEND:"legend",SECTORCOLOR:"sectorColor",REGIONCOLOR:"regionColor",REGIONSHAPE:"regionShape",COLUMN:"column"}};sap.apf.core.constants.vizFrame={feedItemTypes:{CATEGORYAXIS:"categoryAxis",COLOR:"color",VALUEAXIS:"valueAxis",VALUEAXIS2:"valueAxis2",BUBBLEHEIGHT:"bubbleHeight",BUBBLEWIDTH:"bubbleWidth",SIZE:"size",SHAPE:"shape"}};sap.apf.core.constants.applicationConfiguration={applicationConfigPath:"config/applicationConfiguration.json"};}());};if(!jQuery.sap.isDeclared('sap.apf.core.entityTypeMetadata')){jQuery.sap.declare("sap.apf.core.entityTypeMetadata");sap.apf.core.EntityTypeMetadata=function(m,e,M){this.type='entityTypeMetadata';this.getPropertyMetadata=function(p){var r;r=M.getPropertyMetadata(e,p);if(!r){r={dataType:{}};}return r;};this.getEntityTypeMetadata=function(){return M.getEntityTypeMetadata(e);};function c(){m.check(e&&typeof e==='string','sap.apf.core.entityTypeMetadata: incorrect value for parameter sEntityType');m.check(M&&M.type&&M.type==="metadata",'sap.apf.core.entityTypeMetadata: incorrect value for parameter oMetadata');}c();};};if(!jQuery.sap.isDeclared('sap.apf.core.messageDefinition')){jQuery.sap.declare("sap.apf.core.messageDefinition");sap.apf.core.messageDefinition=[{code:"3001",severity:"technError",text:"Text is not available for the following key: {0}"},{code:"5001",severity:"technError",text:"Request {3} to server failed with http status code {0}, http error message {1}, and server response {2}."},{code:"5002",severity:"error",description:"Error in OData request; update of analysis step {0} failed.",key:"5002"},{code:"5004",severity:"fatal",description:"Request with ID {0} does not exist in the analytical content configuration.",key:"5004"},{code:"5005",severity:"technError",text:"Required property {1} is missing in the filter of the OData request for entity type {0}."},{code:"5006",severity:"technError",text:"Inconsistency in data model; non-filterable property {1} is set as required filter for entity type {0}."},{code:"5015",severity:"fatal",description:"Service for request {0} is not defined in the analytical content configuration.",key:"5015"},{code:"5016",severity:"technError",text:"Mandatory parameter key property {0} is missing in filter."},{code:"5017",severity:"technError",text:"Error during annotation retrieval: {0}"},{code:"5018",severity:"fatal",description:"Metadata request {0} failed.",key:"5018"},{code:"5019",severity:"technError",text:"System query option $orderby for property {1} removed from OData request for entity type {0}."},{code:"5020",severity:"fatal",description:"Analytical content configuration is not available.",key:"5020"},{code:"5021",severity:"error",description:"Error during server request; session timeout occurred.",key:"5021"},{code:"5022",severity:"fatal",description:"Analytical configuration with ID {0} is not available.",key:"5022"},{code:"5023",severity:"fatal",description:"Texts could not be loaded for Analytical configuration with ID {0}.",key:"5023"},{code:"5025",severity:"fatal",description:"Value for SAP client has not been provided at startup of the application.",key:"5025"},{code:"5026",severity:"fatal",description:"Logical system cannot be determined for SAP client {0}. ",key:"5026"},{code:"5027",severity:"technError",text:"Inconsistent parameters; analysis path cannot be saved. Path ID: {0}, path name: {1}, callback function {2}"},{code:"5028",severity:"technError",text:"Binding with ID {0} contains a representation without ID."},{code:"5029",severity:"technError",text:"Binding with ID {0} contains a duplicated representation ID."},{code:"5030",severity:"technError",text:"Constructor property of representation type ID {0} does not contain a module path to a valid function."},{code:"5031",severity:"technError",text:"Argument for method 'setApplicationMessageCallback' is not a function."},{code:"5032",severity:"technError",text:"System query option {1} unknown in request for entity type {0}."},{code:"5033",severity:"technError",text:"Unsupported type {0} in configuration object provided."},{code:"5034",severity:"technError",text:"Facet filter configuration attribute 'property' missing."},{code:"5035",severity:"technError",text:"Function module path contained in property preselectionFuntion of facet filter ID {0} does not contain a valid function."},{code:"5036",severity:"technError",text:"Start paramater step id {0} is not exisiting."},{code:"5037",severity:"technError",text:"Start paramater representation id {0} is not exisiting."},{code:"5038",severity:"technError",text:"Environment for sap.ushell.Container is not existing."},{code:"5039",severity:"technError",text:"Error while pushing content to the ushell container"},{code:"5040",severity:"technError",text:"Error while fetching content from the ushell container"},{code:"5100",severity:"fatal",description:"Unexpected internal error: {0}. Contact SAP.",key:"5100"},{code:"5101",severity:"technError",text:"Unexpected internal error: {0}. Contact SAP."},{code:"5102",severity:"fatal",description:"Wrong definition in analytical content configuration: {0}",key:"5102"},{code:"5103",severity:"technError",text:"Wrong definition in analytical content configuration."},{code:"5104",severity:"technError",text:"Wrong filter mapping definition in analytical content configuration"},{code:"5200",severity:"technError",text:"Server error during processing of path: {0} {1}"},{code:"5201",severity:"error",description:"Unknown server error.",key:"5201"},{code:"5202",severity:"technError",text:"Persistence service call returned '405 - Method not allowed'."},{code:"5203",severity:"technError",text:"Bad request; data is structured incorrectly."},{code:"5204",severity:"error",description:"Error during server request; maximum number of analysis steps exceeded.",key:"5204"},{code:"5205",severity:"error",description:"Error during server request; maximum number of analysis paths exceeded.",key:"5205"},{code:"5206",severity:"error",description:"Access forbidden; insufficient privileges",key:"5206"},{code:"5207",severity:"error",description:"Inserted value too large; probably maximum length of analysis path name exceeded",key:"5207"},{code:"5208",severity:"error",description:"Error during path persistence; request to server can not be proceed due to invalid ID.",key:"5208"},{code:"5210",severity:"error",description:"Error during opening of analysis path; see log.",key:"5210"},{code:"5211",severity:"error",description:"Server response contains undefined path objects.",key:"5211"},{code:"5300",severity:"fatal",description:"You must log out of the application due to a critical error.",key:"5300"},{code:"6001",severity:"fatal",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6000",severity:"error",description:"Data is not available for the {0} step.",key:"6000"},{code:"6002",severity:"error",description:"Missing {0} for {1} in the configuration; contact your administrator.",key:"6002"},{code:"6003",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6004",severity:"technError",text:"Metadata not available for step {0}."},{code:"6005",severity:"error",description:"Server request failed. Unable to read paths.",key:"6005"},{code:"6006",severity:"error",description:"Server request failed. Unable to save path {0}.",key:"6006"},{code:"6007",severity:"error",description:"Server request failed. Unable to update path {0}.",key:"6007"},{code:"6008",severity:"error",description:"Server request failed. Unable to open path {0}.",key:"6008"},{code:"6009",severity:"error",description:"Server request failed. Unable to delete path {0}.",key:"6009"},{code:"6010",severity:"error",description:"Data is not available for filter {0}",key:"6010"},{code:"6011",severity:"fatal",description:"Smart Business service failed.Please try later",key:"6011"},{code:"7000",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"}];};if(!jQuery.sap.isDeclared('sap.apf.core.messageObject')){jQuery.sap.declare("sap.apf.core.messageObject");sap.apf.core.MessageObject=function(c){var C=c.code;var p=c.aParameters||[];var o=c.oCallingObject;var m="";var s="";var P;var d=new Date();var r=c.rawText;this.type="messageObject";this.getCode=function(){return C;};this.setCode=function(a){C=a;};this.hasRawText=function(){return(r!==undefined);};this.getRawText=function(){return r;};this.getMessage=function(){return m;};this.setMessage=function(t){m=t;};this.setSeverity=function(a){s=a;};this.getSeverity=function(){return s;};this.setPrevious=function(a){P=a;};this.getPrevious=function(){return P;};this.getCallingObject=function(){return o;};this.getParameters=function(){return p;};this.getStack=function(){if(this.stack){return this.stack;}return"";};this.getTimestamp=function(){return d.getTime();};this.getTimestampAsdateObject=function(){return d;};this.getJQueryVersion=function(){return jQuery().jquery;};this.getSapUi5Version=function(){return sap.ui.version;};};sap.apf.core.MessageObject.prototype=new Error();sap.apf.core.MessageObject.prototype.constructor=sap.apf.core.MessageObject;};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFactory')){jQuery.sap.declare("sap.apf.core.metadataFactory");sap.apf.core.MetadataFactory=function(i){this.type="metadataFactory";var t=this;var m=i.messageHandler;var c=i.configurationFactory;var h=i.hashtable;var M=i.metadata;var e=i.entityTypeMetadata;var f=i.metadataFacade;var a=i.metadataProperty;delete i.metadata;delete i.entityTypeMetadata;delete i.metadataFacade;delete i.metadataProperty;delete i.configurationFactory;var o=new h(m);this.getMetadata=function(A){var b;if(o.hasItem(A)===false){b=new M(i,A);if(!b.failed){o.setItem(A,{metadata:b});}else{return;}}return o.getItem(A).metadata;};this.getEntityTypeMetadata=function(A,E){var b;var d=this.getMetadata(A);b=o.getItem(A).entityTypes;if(!b){b=new h(m);o.getItem(A).entityTypes=b;}if(!b.getItem(E)){b.setItem(E,new e(m,E,d));}return b.getItem(E);};this.getMetadataFacade=function(A){return new f({messageHandler:m,metadataProperty:sap.apf.core.MetadataProperty,metadataFactory:t},A);};this.getServiceDocuments=function(){return c.getServiceDocuments();};this.getEntitySets=function(s){var b=this.getMetadata(s);return b.getEntitySets();};};};if(!jQuery.sap.isDeclared('sap.apf.core.metadataProperty')){jQuery.sap.declare("sap.apf.core.metadataProperty");sap.apf.core.MetadataProperty=function(a){var t=this;var k=false;var p=false;this.isKey=function(){return k;};this.isParameterEntitySetKeyProperty=function(){return p;};this.getAttribute=function(n){if(typeof this[n]!=="function"){return this[n];}};function b(n,v){switch(n){case"isKey":if(v===true){k=true;}break;case"isParameterEntitySetKeyProperty":if(v===true){p=true;}break;default:if(typeof t[n]!=="function"){t[n]=v;}}return t;};function i(){for(var n in a){switch(n){case"dataType":for(var d in a.dataType){b(d,a.dataType[d]);}break;default:b(n,a[n]);}}}i();};};if(!jQuery.sap.isDeclared('sap.apf.core.path')){jQuery.sap.declare("sap.apf.core.path");sap.apf.core.Path=function(I){this.type="path";var m=I.messageHandler;var c=I.coreApi;var t=this;var s=[];var a=[];var n=0;this.getSteps=function(){return jQuery.extend(true,[],s);};this.addStep=function(S,f){s.push(S);var o;t.update(f);};this.makeStepActive=function(S){var f=this.stepIsInPath(S);m.check(f,"An unknown step can't be an active step.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){if(this.stepIsActive(S)===false){a.push(S);}}};this.makeStepInactive=function(S){var f=this.stepIsActive(S);m.check(f,"Only an active step can be removed from the active steps.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){var i=jQuery.inArray(S,a);a.splice(i,1);}};this.stepIsActive=function(S){var i=jQuery.inArray(S,a);if(i>=0){return true;}else{return false;}};this.stepIsInPath=function(S){var i=jQuery.inArray(S,s);if(i>=0){return true;}else{return false;}};this.getActiveSteps=function(){return jQuery.extend(true,[],a);};this.getCumulativeFilterUpToActiveStep=function(){var C=c.getContext();var o=C.getInternalFilter().copy();var i,l=s.length;for(i=0;i<l;i++){o=o.addAnd(s[i].getFilter());if(t.stepIsActive(s[i])){return o;}}return o;};this.moveStepToPosition=function(S,f,h){var i=jQuery.inArray(S,s);var j=f;var M;m.check(typeof f==="number"&&f>=0&&f<s.length,"Path: moveStepToPosition invalid argument for nPosition");m.check(i>=0&&i<s.length,"Path: moveStepToPosition invalid step");if(i===f){return;}s.splice(i,1);s.splice(j,0,S);this.update(h);};this.removeStep=function(S,f){var h=this.stepIsInPath(S);var i=this.stepIsActive(S);var j=jQuery.inArray(S,s);var M;m.check(h,"Path: remove step - invalid step");s.splice(j,1);if(i){this.makeStepInactive(S);}this.update(f);};this.update=function(S,C){if(!s[0]){return;}var f;var o=s[0];var h=c.getContext();var i=h.getInternalFilter().copy();if(C===true){return;}n++;f=n;o.update(i,j);function j(r,l){var p=jQuery.inArray(o,s);var M;if(f===n){if(r instanceof Error){var q=p+1;M=m.createMessageObject({code:"5002",aParameters:[q],callingObject:o});M.setPrevious(r);m.putMessage(M);o.setData({data:[],metadata:undefined},i);S(o,true);p++;o=s[p];while(o){o.setData({data:[],metadata:undefined},i);S(o,true);p++;o=s[p];}return;}if(!l){o.setData(r,i);}S(o,!l);o.determineFilter(i.copy(),k);}}function k(F){var l=jQuery.inArray(o,s);i.addAnd(F);o=s[l+1];if(o){o.update(i,j);}}};this.serialize=function(){return{path:{steps:b(),indicesOfActiveSteps:g()}};};this.deserialize=function(S){var C;if(S.context){C=new sap.apf.utils.Filter(m);C.deserialize(S.context);c.setContext(C);}d(S.path.steps,this);e(S.path.indicesOfActiveSteps,this);};function g(){var f=[];for(var i=0;i<s.length;i++){for(var j=0;j<a.length;j++){if(s[i]===a[j]){f.push(i);}}}return f;}function b(){var S=[];for(var i=0;i<s.length;i++){S.push(s[i].serialize());}return S;}function d(S,C){var f=C.update;C.update=function(){};var i=0;for(i=0;i<S.length;i++){c.createStep(S[i].stepId);}for(i=0;i<s.length;i++){s[i].deserialize(S[i]);}C.update=f;}function e(f,C){for(var i=0;i<f.length;i++){var h=f[i];C.makeStepActive(s[h]);}}};};if(!jQuery.sap.isDeclared('sap.apf.core.persistence')){jQuery.sap.declare("sap.apf.core.persistence");sap.apf.core.Persistence=function(I){this.createPath=function(n,C,E){var S=I.coreApi.serializePath();if(E){S.pathContextHandler=E.pathContextHandler;}var o=e(S);var r={data:{AnalysisPath:"",AnalysisPathName:n,LogicalSystem:I.coreApi.getLogicalSystem(),ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"POST"};if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){r.data.AnalyticalConfiguration=I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId();}s(r,R.bind(this));function R(h,i,m){if(m){C({oResponse:h,status:"failed"},i,m);}else{I.messageHandler.check(h&&h.data&&h.statusCode===201&&h.statusText==="Created","Persistence create Path - proper response");C({AnalysisPath:h.data.AnalysisPath,status:"successful"},i,m);}}};this.readPaths=function(C){var r={method:"GET"};s(r,R.bind(this));function R(o,E,m){if(!m&&o&&o.data&&o.data.results){for(var i in o.data.results){o.data.results[i].StructuredAnalysisPath=JSON.parse(o.data.results[i].StructuredAnalysisPath);}}else if(!m||o.statusCode!==200||o.statusText!=="OK"){m=I.messageHandler.createMessageObject({code:'5211'});}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({paths:o.data.results,status:"successful"},E,m);}}};this.deletePath=function(A,C){var r={method:"DELETE"};s(r,R.bind(this),A);function R(o,E,m){if((o.statusCode!==204||o.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[o.statusCode,o.statusText]}));}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({status:"successful"},E,m);}}};this.modifyPath=function(A,n,C,E){var S=I.coreApi.serializePath();if(E){S.pathContextHandler=E.pathContextHandler;}var o=e(S);var r={data:{AnalysisPathName:n,LogicalSystem:I.coreApi.getLogicalSystem(),ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"PUT"};s(r,R.bind(this),A);function R(h,i,m){if((h.statusCode!==204||h.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[h.statusCode,h.statusText]}));}if(m){C({oResponse:h,status:"failed"},i,m);}else{C({AnalysisPath:A,status:"successful"},i,m);}}};this.openPath=function(A,C,n){var r={method:"GET"};s(r,R.bind(this),A);function R(o,E,m){var M;if(!m&&o&&o.statusCode===200&&o.data&&o.data.SerializedAnalysisPath){o.data.SerializedAnalysisPath=JSON.parse(o.data.SerializedAnalysisPath);m=a(o.data,n);}if(m){M=I.messageHandler.createMessageObject({code:'5210'});M.setPrevious(m);I.messageHandler.putMessage(M);}if(M){C({oResponse:o,status:"failed"},E,M);}else{C({path:o.data,status:"successful"},E,M);}}};function s(r,l,A){var u=d();switch(r.method){case"GET":if(!r.data&&A){r.requestUri=u+"('"+A+"')";}else if(!r.data&&!A){r.requestUri=u+g();}break;case"POST":if(r.data&&!A){r.requestUri=u;}break;case"DELETE":if(!r.data&&A){r.requestUri=u+"('"+A+"')";}break;case"PUT":if(r.data&&A){r.requestUri=u+"('"+A+"')";}break;default:break;}r.headers={"x-csrf-token":I.coreApi.getXsrfToken(d())};var S=function(D,R){l(R,f(),undefined);};var E=function(o){var m;if(o.messageObject&&o.messageObject.getCode&&o.messageObject.getCode()===5021){l(o,f(),o.messageObject);return;}var h=c(o.response.body);if(h!==undefined){m=I.messageHandler.createMessageObject({code:h});}if(o.response.body.match("274")){m=I.messageHandler.createMessageObject({code:'5207'});}if(o.response.statusCode===400){m=I.messageHandler.createMessageObject({code:'5203'});}if(o.response.statusCode===403){m=I.messageHandler.createMessageObject({code:'5206'});}if(o.response.statusCode===405){m=I.messageHandler.createMessageObject({code:'5202'});}if(o.response.statusCode===404){m=I.messageHandler.createMessageObject({code:'5208'});}if(!m&&o.response.statusCode===500){m=I.messageHandler.createMessageObject({code:'5200',aParameters:[o.response.statusCode,o.response.statusText]});}if(!m){m=I.messageHandler.createMessageObject({code:'5201'});}I.messageHandler.putMessage(m);l(o,f(),m);};I.coreApi.odataRequest(r,S,E);}function g(){var h="";if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){h="AnalyticalConfiguration%20eq%20'"+I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()+"'%20and%20";}var u="?$select=AnalysisPath,AnalysisPathName,StructuredAnalysisPath,CreationUTCDateTime,LastChangeUTCDateTime&$filter=("+h+"LogicalSystem%20eq%20'"+I.coreApi.getLogicalSystem()+"'%20and%20"+"ApplicationConfigurationURL%20eq%20'"+I.coreApi.getApplicationConfigurationURL()+"')"+"&$orderby=LastChangeUTCDateTime%20desc";return u;}function c(E){var h=E.match("52[0-9]{2}");if(h){return h[0];}else{return undefined;}}function a(r,n){var p;var m;var o=I.coreApi.getContext();function h(){I.messageHandler.putMessage=p;}function i(){p=I.messageHandler.putMessage;I.messageHandler.putMessage=function(m){throw m;};}if(n!==undefined){r.SerializedAnalysisPath.path.indicesOfActiveSteps[0]=n;}I.coreApi.resetPath(true);i();try{I.coreApi.deserializePath(r.SerializedAnalysisPath);}catch(E){I.coreApi.restoreOriginalPath();I.coreApi.setContext(o);m=b(E);}finally{h();}return m;}function b(E){var m;if(E.type&&E.type==="messageObject"){m=E;}else{m=new I.coreApi.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});m.setSeverity(sap.apf.core.constants.message.severity.error);m.setMessage("Unknown exception caught "+E.message);}return m;}function d(){var p=I.coreApi.getPersistenceConfiguration().path;var S=p.service+"/"+p.entitySet;return S;}function e(S){var h=[];var j=S.path.steps;var k;for(var i in j){h.push({stepId:j[i].stepId,selectedRepresentationId:j[i].binding.selectedRepresentationId});}k={steps:h,indexOfActiveStep:S.path.indicesOfActiveSteps[0]};return k;}function f(){var C=I.coreApi.getPersistenceConfiguration();var E=I.coreApi.getEntityTypeMetadata(C.path.service,C.path.entitySet);return E;}};};if(!jQuery.sap.isDeclared('sap.apf.core.representationTypes')){jQuery.sap.declare("sap.apf.core.representationTypes");sap.apf.core.representationTypes=function(){return[{"type":"representationType","id":"ColumnChart","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"LineChart","constructor":"sap.apf.ui.representations.lineChart","picture":"sap-icon://line-chart","label":{"type":"label","kind":"text","key":"LineChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"StackedColumnChart","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://vertical-stacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PercentageStackedColumnChart","constructor":"sap.apf.ui.representations.percentageStackedColumnChart","picture":"sap-icon://full-stacked-column-chart","label":{"type":"label","kind":"text","key":"PercentageStackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PieChart","constructor":"sap.apf.ui.representations.pieChart","picture":"sap-icon://pie-chart","label":{"type":"label","kind":"text","key":"PieChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORSIZE,"min":"1","max":"1"}]}}},{"type":"representationType","id":"ScatterPlotChart","constructor":"sap.apf.ui.representations.scatterPlotChart","picture":"sap-icon://scatter-chart","label":{"type":"label","kind":"text","key":"ScatterPlotChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"}]},"sortable":false}},{"type":"representationType","id":"BubbleChart","constructor":"sap.apf.ui.representations.bubbleChart","picture":"sap-icon://bubble-chart","label":{"type":"label","kind":"text","key":"BubbleChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEWIDTH,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEHEIGHT,"min":"0","max":"1"}]},"sortable":false}},{"type":"representationType","id":"TableRepresentation","constructor":"sap.apf.ui.representations.table","picture":"sap-icon://table-chart","label":{"type":"label","kind":"text","key":"TableRepresentation"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.COLUMN,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.COLUMN,"min":"1","max":"*"}]}}},{"type":"representationType","id":"ColumnChartSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartSorted"}},{"type":"representationType","id":"ColumnChartClustered","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartClustered"}},{"type":"representationType","id":"ColumnChartClusteredSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart-2","label":{"type":"label","kind":"text","key":"ColumnChartClusteredSorted"}},{"type":"representationType","id":"StackedColumnSorted","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://upstacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnSorted"}}];};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.checkForTimeout')){jQuery.sap.declare('sap.apf.core.utils.checkForTimeout');sap.apf.core.utils.checkForTimeout=function(s){var a;var m;var r=false;if(s&&s.headers&&s.headers['x-sap-login-page']){r=true;}if(s&&s.getResponseHeader&&s.getResponseHeader('x-sap-login-page')!==null){r=true;}if(s&&s.status){a=s.status;}if(s&&s.response&&s.response.statusCode){a=s.response.statusCode;}if(a===303||a===401||a===403||r){m=new sap.apf.core.MessageObject({code:"5021"});}return m;};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.fileExists')){jQuery.sap.declare('sap.apf.core.utils.fileExists');sap.apf.core.utils.fileExists=function(u){var f=false;jQuery.ajax({url:u,type:"HEAD",success:function(d,s,j){var m=sap.apf.core.utils.checkForTimeout(j);f=!m;},error:function(){f=false;},async:false});return f;};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.uriGenerator')){jQuery.sap.declare("sap.apf.core.utils.uriGenerator");sap.apf.core.utils.uriGenerator={};sap.apf.core.utils.uriGenerator.getAbsolutePath=function(p){if(p.slice(-1)==='/'){return p;}else{return p+"/";}};sap.apf.core.utils.uriGenerator.getODataPath=function(p){var s=p.split('/');var i;var S=[];for(i=0;i<s.length;i++){if(s[i]!==""){S.push(s[i]);}}var r='';var l=S.length-1;for(i=0;i<l;i++){r=r+'/'+S[i];}return r+'/';};sap.apf.core.utils.uriGenerator.getApfLocation=function(){return jQuery.sap.getModulePath("sap.apf")+'/';};sap.apf.core.utils.uriGenerator.buildUri=function(m,e,s,f,p,a,P,F,b,u){var r="";r+=e;r+=c(p,u);r=r+"?";r+=d(s);r+=g(f,b);r+=h(a,s);r+=j(P);r+=k(F);return r;function c(p,u){var r='';var i=false;var l;for(l in p){if(!i){r+='(';i=true;}else{r+=',';}r+=l.toString()+'='+p[l];}if(i){r+=')/';}r+=u||'';return r;}function d(s){if(!s[0]){return'';}var R="$select=";for(var i in s){R+=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(s[i]));if(i<s.length-1){R+=",";}}return R;}function g(f,b){if(!(f&&f instanceof sap.apf.core.utils.Filter)){return'';}var i=f.toUrlParam({formatValue:b});if(i===""||i==='()'){return'';}return'&$filter='+i;}function h(a,s){var o='';var S='';if(!a){return'';}switch(true){case jQuery.isArray(a):for(var i=0;i<a.length;i++){S=l(a[i],s);if(o.length>0&&S.length>0){o+=',';}o+=S;}break;case jQuery.isPlainObject(a):o+=l(a,s);break;case typeof a==='string':o+=l({property:a},s);break;}if(o.length>0){return"&$orderby="+o;}else{return'';}function l(O,s){var v='';if(jQuery.inArray(O.property,s)>-1){v+=O.property;if(O.descending===true){v+=' desc';}else{v+=' asc';}}else{m.putMessage(m.createMessageObject({code:'5019',aParameters:[e,O.property]}));}return jQuery.sap.encodeURL(v);}}function j(P){function l(P){var n,i;n=Object.getOwnPropertyNames(P);for(i=0;i<n.length;i++){if(n[i]!=='top'&&n[i]!=='skip'&&n[i]!=='inlineCount'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,n[i]]}));}}}var r='';if(!P){return r;}else{l(P);if(P.top){r+='&$top='+P.top;}if(P.skip){r+='&$skip='+P.skip;}if(P.inlineCount===true){r+='&$inlinecount=allpages';}return r;}}function k(F){if(!F){F='json';}return'&$format='+F;}};};if(!jQuery.sap.isDeclared('sap.apf.library')){jQuery.sap.declare("sap.apf.library");jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');sap.ui.getCore().initLibrary({name:"sap.apf",dependencies:["sap.ui.core"],types:[],interfaces:[],controls:[],elements:[],noLibraryCSS:true,version:"1.28.1"});};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationObjects')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.configurationObjects");(function(){'use strict';sap.apf.modeler.core.ConfigurationObjects=function(i){var t=this;var H,a,p,m;if(i.constructor.hashtable){H=i.constructor.hashtable;}if(i.instance.textPool){a=i.instance.textPool;}if(i.instance.persistenceProxy){p=i.instance.persistenceProxy;}if(i.instance.messageHandler){m=i.instance.messageHandler;}function c(h,j){var P=[];if(j){P.push(j);}m.putMessage(m.createMessageObject({code:h,aParameters:P}));}function b(l){var r=l&&l.type&&l.type==="label"&&l.kind&&l.kind==="text"&&l.key&&typeof l.key==="string";if(!r){c(11030,l.key);}return r;}this.serializeLabelKey=function(h){return{type:"label",kind:"text",key:a.getPersistentKey(h)};};this.serializeAndAddThumbnail=function(h,j){var l=h.getLeftLowerCornerTextKey();var k=h.getLeftUpperCornerTextKey();var r=h.getRightUpperCornerTextKey();var n=h.getRightLowerCornerTextKey();var o={type:"thumbnail"};if(k){o.leftUpper=this.serializeLabelKey(k);}if(l){o.leftLower=this.serializeLabelKey(l);}if(r){o.rightUpper=this.serializeLabelKey(r);}if(n){o.rightLower=this.serializeLabelKey(n);}if(o.leftLower||o.leftUpper||o.rightLower||o.rightUpper){j.thumbnail=o;}};this.serializeCategory=function(h,j){var T=a.get(h.labelKey);var k=[];if(j){j.forEach(function(n){k.push({type:"step",id:n});});}var l=(T&&T.TextElementDescription)||"";return{type:"category",description:l,id:h.getId(),label:t.serializeLabelKey(h.labelKey),steps:k};};this.validateCategory=function(h){var r=h&&h.type&&h.type==="category"&&h.id&&h.steps&&b(h.label);if(r){h.steps.forEach(function(o){if(!o.type||o.type!=="step"||!o.id){r=false;}});}if(!r){c(11031,h.id);}return r;};this.validateRequest=function(r){var h=r&&r.id&&r.type==="request"&&r.service&&typeof r.service==="string"&&((r.entityType&&typeof r.entityType==="string")||(r.entitySet&&typeof r.entitySet==="string"))&&r.selectProperties&&r.selectProperties&&r.selectProperties instanceof Array&&r.selectProperties.length>=0;if(!h){c(11032,r.id);}return h;};this.validateBinding=function(h){var r=h&&h.id&&h.type==="binding"&&h.requiredFilters&&h.requiredFilters instanceof Array&&h.requiredFilters.length>=0&&h.representations&&h.representations instanceof Array;if(!r){c(11033,h.id);}return r;};this.validateFacetFilter=function(h){var r=h&&h.id&&h.property&&h.type==="facetFilter";if(!r){c(11034,h.id);}return r;};this.validateNavigationTarget=function(n){var r=n&&n.id&&n.semanticObject&&n.action&&n.type==="navigationTarget";if(!r){c(11040,n.id);}return r;};this.validateStep=function(h){var r=h&&h.id&&h.type==="step"&&b(h.title)&&b(h.longTitle);if(!r){c(11035,h.id);}return r;};this.validateConfiguration=function(h){var r=h&&h.applicationTitle&&h.applicationTitle.key&&typeof h.applicationTitle.key==='string'&&h.steps&&h.steps instanceof Array&&h.steps.length>=0&&h.requests&&h.requests instanceof Array&&h.requests.length>=0&&h.bindings&&h.bindings instanceof Array&&h.bindings.length>=0&&h.representationTypes&&h.representationTypes instanceof Array&&h.representationTypes.length>=0&&h.facetFilters&&h.facetFilters instanceof Array&&h.facetFilters.length>=0&&h.categories&&h.categories instanceof Array&&h.categories.length>=0;if(!r){c(11036);}return r;};function s(h){var r=[];var j,k;var l,n;var o;var q;var u=h.getRepresentations();u.forEach(function(v){j=[];k=v.getDimensions();k.forEach(function(w){var x={fieldName:w};if(v.getDimensionKind(w)){x.kind=v.getDimensionKind(w);}if(v.getDimensionTextLabelKey(w)){x.fieldDesc={type:'label',kind:'text',key:v.getDimensionTextLabelKey(w)};}j.push(x);});l=[];n=v.getMeasures();n.forEach(function(w){var x={fieldName:w};if(v.getMeasureKind(w)){x.kind=v.getMeasureKind(w);}if(v.getMeasureTextLabelKey(w)){x.fieldDesc={type:'label',kind:'text',key:v.getMeasureTextLabelKey(w)};}l.push(x);});o=[];v.getOrderbySpecifications().forEach(function(w){o.push({property:w.property,ascending:w.ascending});});q={id:v.getId(),representationTypeId:v.getRepresentationType(),parameter:{dimensions:j,measures:l,alternateRepresentationTypeId:v.getAlternateRepresentationType()}};if(v.getWidthProperties()){q.parameter.width=v.getWidthProperties();}if(o.length>0){q.parameter.orderby=o;}t.serializeAndAddThumbnail(v,q);r.push(q);});return r;}this.serializeBinding=function(h,j){var k="binding-for-"+h.getId();var T=a.get(h.getTitleId());var l=(T&&T.TextElementDescription)||"";j.bindings.push({type:"binding",id:k,stepDescription:l,requiredFilters:h.getFilterProperties(),representations:s(h)});return k;};this.serializeRequest=function(h,j){var r;var k="request-for-"+h.getId();r={type:"request",id:k,service:h.getService(),entitySet:h.getEntitySet(),selectProperties:h.getSelectProperties()};j.requests.push(r);return k;};this.serializeFilterMappingRequest=function(h,j){var r="request-for-FilterMapping"+h.getId();var k={type:"request",id:r,service:h.getFilterMappingService(),entitySet:h.getFilterMappingEntitySet(),selectProperties:h.getFilterMappingTargetProperties()};j.requests.push(k);return r;};this.serializeStep=function(h,j){var r=t.serializeRequest(h,j);var k=t.serializeBinding(h,j);var T=a.get(h.getTitleId());var l=(T&&T.TextElementDescription)||"";var n=h.getLongTitleId();var o={type:"step",description:l,request:r,binding:k,id:h.getId(),title:t.serializeLabelKey(h.getTitleId())};if(h.getFilterMappingService()){o.filterMapping={requestForMappedFilter:t.serializeFilterMappingRequest(h,j),target:h.getFilterMappingTargetProperties(),keepSource:h.getFilterMappingKeepSource()?"true":"false"};}if(n!==""&&n!==undefined){o.longTitle=t.serializeLabelKey(h.getLongTitleId());}this.serializeAndAddThumbnail(h,o);return o;};this.serializeFacetFilter=function(h,j){var r,k;if(h.getServiceOfFilterResolution()){r=n("FilterResolution",h,j);}if(h.getServiceOfValueHelp()){k=n("ValueHelp",h,j);}var T=a.get(h.getLabelKey());var l=(T&&T.TextElementDescription)||"";return{type:"facetFilter",description:l,id:h.getId(),alias:h.getAlias(),property:h.getProperty(),multiSelection:h.isMultiSelection()+"",preselectionFunction:h.getPreselectionFunction(),preselectionDefaults:h.getPreselectionDefaults(),label:t.serializeLabelKey(h.getLabelKey()),filterResolutionRequest:r,valueHelpRequest:k};function n(o,h,j){var q;var u;var v;var w;switch(o){case"ValueHelp":u=h.getServiceOfValueHelp();v=h.getEntitySetOfValueHelp();w=h.getSelectPropertiesOfValueHelp();break;case"FilterResolution":u=h.getServiceOfFilterResolution();v=h.getEntitySetOfFilterResolution();w=h.getSelectPropertiesOfFilterResolution();break;}var x=o+"-request-for-"+h.getId();q={type:"request",id:x,service:u,entitySet:v,selectProperties:w};j.requests.push(q);return x;}};this.serializeNavigationTarget=function(n){return{type:"navigationTarget",id:n.getId(),semanticObject:n.getSemanticObject(),action:n.getAction()};};this.serializeConfiguration=function(h){var j={applicationTitle:t.serializeLabelKey(h.getApplicationTitle()),steps:[],requests:[],bindings:[],representationTypes:[],categories:[],facetFilters:[],navigationTargets:[]};var k={requests:j.requests,bindings:j.bindings};h.getCategories().forEach(function(l){var n=h.getCategoryStepAssignments(l.getId());j.categories.push(t.serializeCategory(l,n));});h.getSteps().forEach(function(l){var n=t.serializeStep(l,k);j.steps.push(n);});h.getFacetFilters().forEach(function(l){var n=t.serializeFacetFilter(l,k);j.facetFilters.push(n);});h.getNavigationTargets().forEach(function(n){var l=t.serializeNavigationTarget(n);j.navigationTargets.push(l);});return j;};function d(h,j){var k=h.thumbnail;if(!k){return;}if(k.leftLower){j.setLeftLowerCornerTextKey(k.leftLower.key);}if(k.leftUpper){j.setLeftUpperCornerTextKey(k.leftUpper.key);}if(k.rightLower){j.setRightLowerCornerTextKey(k.rightLower.key);}if(k.rightUpper){j.setRightUpperCornerTextKey(k.rightUpper.key);}}function e(h,r,j){var k=j.createStepWithId(h.id);var l=j.getStep(k);var n=r.getItem(h.request);if(n.entityType){n.entitySet=n.entityType;delete n.entityType;}if(n.service){j.registerService(n.service);}l.setService(n.service);l.setEntitySet(n.entitySet);l.setTitleId(h.title.key);if(h.longTitle&&h.longTitle.key){l.setLongTitleId(h.longTitle.key);}d(h,l);n.selectProperties.forEach(function(u){l.addSelectProperty(u);});var o=r.getItem(h.binding);o.requiredFilters.forEach(function(u){l.addFilterProperty(u);});o.representations.forEach(function(u){var v;var w=l.getRepresentation(l.createRepresentation().getId());w.setRepresentationType(u.representationTypeId);w.setAlternateRepresentationType(u.parameter.alternateRepresentationTypeId);u.parameter.dimensions.forEach(function(x){w.addDimension(x.fieldName);if(x.fieldDesc){w.setDimensionTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setDimensionKind(x.fieldName,x.kind);}});u.parameter.measures.forEach(function(x){w.addMeasure(x.fieldName);if(x.fieldDesc){w.setMeasureTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setMeasureKind(x.fieldName,x.kind);}});if(u.parameter.width){for(v in u.parameter.width){if(u.parameter.width.hasOwnProperty(v)){w.setWidthProperty(v,u.parameter.width[v]);}}}if(u.parameter.orderby){u.parameter.orderby.forEach(function(x){w.addOrderbySpec(x.property,x.ascending);});}d(u,w);});if(h.filterMapping){var q=r.getItem(h.filterMapping.requestForMappedFilter);if(q.entityType){q.entitySet=q.entityType;delete q.entityType;}l.setFilterMappingService(q.service);l.setFilterMappingEntitySet(q.entitySet);h.filterMapping.target.forEach(function(u){l.addFilterMappingTargetProperty(u);});if(h.filterMapping.keepSource==="true"){l.setFilterMappingKeepSource(true);}else{l.setFilterMappingKeepSource(false);}}}function f(h,r,j){var k=j.createFacetFilterWithId(h.id);var l=j.getFacetFilter(k);l.setLabelKey(h.label.key);l.setAlias(h.alias);l.setProperty(h.property);l.setPreselectionFunction(h.preselectionFunction);l.setPreselectionDefaults(h.preselectionDefaults);if(h.multiSelection==="true"){l.setMultiSelection(true);}if(h.valueHelpRequest){var n=r.getItem(h.valueHelpRequest);if(n.entityType){n.entitySet=n.entityType;delete n.entityType;}if(n.service){j.registerService(n.service);l.setServiceOfValueHelp(n.service);}if(n.entitySet){l.setEntitySetOfValueHelp(n.entitySet);}n.selectProperties.forEach(function(q){l.addSelectPropertyOfValueHelp(q);});}if(h.filterResolutionRequest){var o=r.getItem(h.filterResolutionRequest);if(o.entityType){o.entitySet=o.entityType;delete o.entityType;}if(o.service){j.registerService(o.service);l.setServiceOfFilterResolution(o.service);}if(o.entitySet){l.setEntitySetOfFilterResolution(o.entitySet);}o.selectProperties.forEach(function(q){l.addSelectPropertyOfFilterResolution(q);});}}function g(h,j){var k=j.createNavigationTargetWithId(h.id);var l=j.getNavigationTarget(k);l.setSemanticObject(h.semanticObject);l.setAction(h.action);}this.mapToDesignTime=function(r,h){h.setApplicationTitle(r.getItem('applicationTitle').key);r.getSteps().forEach(function(j){e(j,r,h);});r.getCategories().forEach(function(j){h.createCategoryWithId({labelKey:j.label.key},j.id);j.steps.forEach(function(k){h.addCategoryStepAssignment(j.id,k.id);});});r.getFacetFilters().forEach(function(j){f(j,r,h);});r.getNavigationTargets().forEach(function(n){g(n,h);});};this.loadAllConfigurations=function(h,j){var k=new sap.apf.core.utils.Filter(m,'Application','eq',h);p.readCollection("configuration",function(r,l,n){j(r,l,n);},undefined,undefined,k,true);};this.getTextKeysFromAllConfigurations=function(h,j){this.loadAllConfigurations(h,function(k,l,n){var o=new H(m);if(n){j(undefined,n);return;}k.forEach(function(q){var r=JSON.parse(q.SerializedAnalyticalConfiguration);var u=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(r);u.forEach(function(v){o.setItem(v,v);});});j(o,undefined);});};};sap.apf.modeler.core.ConfigurationObjects.deepDataCopy=function deepDataCopy(i){var r;if(!i){r=i;}else if(i.copy&&typeof i.copy==="function"){r=i.copy();}else if(i&&typeof i==="object"){if(i instanceof Array){r=[];i.forEach(function(a){r.push(deepDataCopy(a));});}else{r={};for(var a in i){if(!i.hasOwnProperty(a)){continue;}r[a]=deepDataCopy(i[a]);}}}else{r=i;}return r;};sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration=function getTextKeysFromConfiguration(c){var r=[];if(!c){return;}if(c.type&&c.type==="label"&&c.kind&&c.kind==="text"&&c.key){return[c.key];}else{for(var i in c){if(typeof c[i]!=="object"||!c.hasOwnProperty(i)){continue;}Array.prototype.push.apply(r,getTextKeysFromConfiguration(c[i]));}return r;}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.elementContainer')){jQuery.sap.declare("sap.apf.modeler.core.elementContainer");(function(){'use strict';sap.apf.modeler.core.ElementContainer=function(n,E,i,d){var e,a,r=new RegExp("^"+n+"-([123456789]\\d*)$"),b=new RegExp("^"+n);var t=this;i.instance.messageHandler.check(n!==undefined,"ElementContainer: Element has been created without name");if(!d){e=new i.constructor.hashtable(i.instance.messageHandler);a=0;}else{e=d.elements;a=d.elementCounter;}this.generateId=function(){return n+"-"+(++a);};this.createElement=function(f){var g;g=t.generateId();return c(f,g);};this.createElementWithProposedId=function(f,p){function g(k){var m=r.exec(k);if(m){var l=parseInt(m[1],10);if(l>a){a=l;}}}var h;var j=e.getItem(p);if(j){return t.createElement(f);}h=c(f,p);g(p);return h;};this.removeElement=function(f){return e.removeItem(f);};this.getElement=function(f){return e.getItem(f);};this.updateElement=function(f,g){i.instance.messageHandler.check(f!==undefined,"ElementContainer: Element has been updated with undefined elementId");if((!g.getId)||g.getId()!==f){g.getId=function(){return f;};}e.setItem(f,g);return f;};this.setElement=function(f,g){var h;if(g){if(!(e.getItem(g))){i.instance.messageHandler.putMessage(i.instance.messageHandler.createMessageObject({code:'11006',aParameters:[g]}));return undefined;}t.updateElement(g,f);return g;}h=t.createElement(f);return h.getId();};this.getElements=function(){var l=[];e.forEachOrdered(function(f,g){l.push(g);});return l;};this.moveUpOrDown=function(f,g){return e.moveUpOrDown(f,g);};this.moveBefore=function(f,m){return e.moveBefore(f,m);};this.moveToEnd=function(f){return e.moveToEnd(f);};this.copyElement=function(f){var g,h,j;g=e.getItem(f);if(!g){return;}j=t.generateId();if(g.copy&&typeof g.copy==="function"){h=g.copy(j);}else{h=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(g);}h.getId=function(){return j;};e.setItem(j,h);return j;};this.copy=function(f){var g={elements:new i.constructor.hashtable(i.instance.messageHandler),elementCounter:a};var h;var j;e.getKeysOrdered().forEach(function(k){h=e.getItem(k);j=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);if(f&&k.indexOf(n)===0){k=k.replace(b,f);}i.instance.messageHandler.check(k!==undefined,"ElementContainer: Element has been created without name in copy - 1");if(typeof j==="object"&&j.getId&&typeof j.getId==="function"){j.getId=function(){return k;};}g.elements.setItem(k,j);});i.instance.messageHandler.check(n!==undefined||f!==undefined,"ElementContainer: Element has been created without name in copy 2");return new sap.apf.modeler.core.ElementContainer((f||n),E,i,g);};function c(f,g){var h;i.instance.messageHandler.check(g!==undefined,"ElementContainer: Element has been created with undefined id");if(typeof E==='function'){if(E!==sap.apf.modeler.core.ElementContainer){h=new E(g,i);}else{h=new E(g,undefined,i);}}else{h={};}h.getId=function(){return g;};if(f){h=jQuery.extend(h,f);}e.setItem(g,h);return h;}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.facetFilter')){jQuery.sap.declare("sap.apf.modeler.core.facetFilter");(function(){'use strict';sap.apf.modeler.core.FacetFilter=function(f,i,d){var r,s,a,m,l,p,b,c,e,g,h;if(!d){r={forValueHelp:{service:undefined,entitySet:undefined},forFilterResolution:{service:undefined,entitySet:undefined}};s=new i.constructor.elementContainer("SelectPropertyValueHelp",undefined,i);a=new i.constructor.elementContainer("SelectPropertyFilterResolution",undefined,i);m={};l={};p=[];h=false;}else{r=d.request;s=d.selectPropertyForValueHelp;a=d.selectPropertyForFilterResolution;m=d.metadata;l=d.label;p=d.preselectionDefaults;b=d.property;c=d.alias;e=d.labelKey;g=d.preselectionFunction;h=d.isMultiSelectionActive;}this.getId=function(){return f;};this.setMultiSelection=function(j){h=j;};this.isMultiSelection=function(){return h;};this.setAlias=function(j){c=j;};this.getAlias=function(){return c;};this.setPreselectionFunction=function(v){g=v;};this.getPreselectionFunction=function(){return g;};this.removePreselectionFunction=function(){g=undefined;};this.setPreselectionDefaults=function(j){p=j;};this.getPreselectionDefaults=function(){return p;};this.removePreselectionDefaults=function(){p=[];};this.setLabelKey=function(j){e=j;};this.getLabelKey=function(){return e;};this.setProperty=function(j){b=j;};this.getProperty=function(){return b;};this.setServiceOfValueHelp=function(j){r.forValueHelp.service=j;};this.getServiceOfValueHelp=function(){return r.forValueHelp.service;};this.setEntitySetOfValueHelp=function(j){r.forValueHelp.entitySet=j;};this.getEntitySetOfValueHelp=function(){return r.forValueHelp.entitySet;};this.getSelectPropertiesOfValueHelp=function(){var j=[];var k;k=s.getElements();k.forEach(function(n){j.push(n.getId());});return j;};this.removeSelectPropertyOfValueHelp=function(j){s.removeElement(j);};this.addSelectPropertyOfValueHelp=function(j){s.createElementWithProposedId(undefined,j);};this.setServiceOfFilterResolution=function(j){r.forFilterResolution.service=j;};this.getServiceOfFilterResolution=function(){return r.forFilterResolution.service;};this.setEntitySetOfFilterResolution=function(j){r.forFilterResolution.entitySet=j;};this.getEntitySetOfFilterResolution=function(){return r.forFilterResolution.entitySet;};this.getSelectPropertiesOfFilterResolution=function(){var j=[];var k;k=a.getElements();k.forEach(function(n){j.push(n.getId());});return j;};this.removeSelectPropertyOfFilterResolution=function(j){a.removeElement(j);};this.addSelectPropertyOfFilterResolution=function(j){a.createElementWithProposedId(undefined,j);};this.copy=function(n){var j={request:r,selectPropertyForValueHelp:s,selectPropertyForFilterResolution:a,metadata:m,label:l,preselectionDefaults:p,property:b,alias:c,labelKey:e,preselectionFunction:g,isMultiSelectionActive:h};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(j);return new sap.apf.modeler.core.FacetFilter((n||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.lazyLoader')){jQuery.sap.declare("sap.apf.modeler.core.lazyLoader");(function(){'use strict';sap.apf.modeler.core.LazyLoader=function(a,c,d){var o={id:null,instance:null,isInitializing:false,callbacksAfterAsyncGet:new a.constructor.hashtable(a.instance.messageHandler)},b=null;if(d){o.id=d.id;o.instance=d.instance;}this.type="lazyLoader";this.getId=function(){return o.id;};this.getInstance=function(){return o.instance;};this.isInitializing=function(){return o.isInitializing;};this.reset=function(){b=o.instance;o={id:null,isInitializing:false,callbacksAfterAsyncGet:new a.constructor.hashtable(a.instance.messageHandler),instance:null};};function e(i,f,g){if(i!==o.id){return;}o.isInitializing=false;if(!g){o.instance=f;}o.callbacksAfterAsyncGet.each(function(k,h){h.forEach(function(j){j(o.instance,g,o.id);});});o.callbacksAfterAsyncGet=null;}function m(f){var i;var g,h;h=o.callbacksAfterAsyncGet.getItem(f);if(!h){o.callbacksAfterAsyncGet.setItem(f,[f]);return;}g=false;for(i=0;i<h.length;i++){if(h[i]===f){g=true;break;}}if(!g){h.push(f);}}this.asyncGetInstance=function(i,f){if(o.id&&i!==o.id){this.reset();}if(o.id&&o.instance){f(o.instance,undefined,o.id);return;}m(f);if(!o.isInitializing){o.isInitializing=true;o.id=i;o.instance=null;c(i,e,b);}};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.messageDefinition')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.messageDefinition");sap.apf.modeler.core.messageDefinition=[{code:"11005",severity:"technError",text:"Bad HTTP request returned status code {0} with status text {1}."},{code:"11006",severity:"technError",text:"Unknown identifier: {0}"},{code:"11007",severity:"technError",text:"Cannot export unsaved configuration. Configuration ID: {0}"},{code:"11008",severity:"error",description:"Format information is missing at least for text element {0} - please edit the exported text property file manually",key:"11008"},{code:"11009",severity:"error",description:"Application id {0} cannot be used as translation uuid in text property file - please edit the exported text property file manually",key:"11009"},{code:"11010",severity:"error",description:"Imported text property file does not contain the APF application id - expected an entry like #ApfApplicationId=543EC63F05550175E10000000A445B6D.",key:"11010"},{code:"11011",severity:"error",description:"Expected a valid text entry <key>=<value> in line {0}, but could not find - key must be in valid guid format.",key:11011},{code:"11012",severity:"error",description:"No valid text entry <key>=<value> in line {0}, key is not in valid guid format like 543EC63F05550175E10000000A445B6D.",key:11012},{code:"11013",severity:"technError",text:"Metadata request {3} to server failed with http status code {0}, http error message {1}, and server response {2}",key:"11013"},{code:"11014",severity:"error",description:"ApfApplicationId in line {0} has invalid format - a valid application id looks like 543EC63F05550175E10000000A445B6D.",key:"11014"},{code:"11015",severity:"error",description:"Date in line {0} has invalid format.",key:"11015"},{code:"11020",severity:"error",description:"Text property has invalid format and cannot be imported - see previous messages for details",key:"11020"},{code:"11021",severity:"error",description:"ApfApplicationId {0} referenced in the text property is not yet existing - please load one configuration of the application before importing the texts.",key:"11021"},{code:"11030",severity:"error",description:"Label {0} is not valid",key:"11030"},{code:"11031",severity:"error",description:"Category {0} is not valid",key:"11031"},{code:"11032",severity:"error",description:"Request {0} is not valid",key:"11032"},{code:"11033",severity:"error",description:"Binding {0} is not valid",key:"11033"},{code:"11034",severity:"error",description:"Facet filter {0} is not valid",key:"11034"},{code:"11035",severity:"error",description:"Step {0} is not valid",key:"11035"},{code:"11036",severity:"error",description:"Configuration is not valid",key:"11036"},{code:"11037",severity:"error",description:"Invalid application guid {0}",key:"11037"},{code:"11038",severity:"error",description:"Invalid configuration guid {0}",key:"11038"},{code:"11039",severity:"error",description:"Invalid text guid {0}",key:"11039"},{code:"11040",severity:"error",description:"Navigation target {0} is not valid",key:"11040"},{code:"11041",severity:"technError",text:"Network service for retrieving semantic objects failed - see console."},{code:"11042",severity:"technError",text:"Error occurred when retrieving actions for semantic object - see console."}];};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.navigationTarget')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.navigationTarget");(function(){'use strict';sap.apf.modeler.core.NavigationTarget=function(n,d){var s,a;if(d){s=d.semObject;a=d.actn;}this.getId=function(){return n;};this.setSemanticObject=function(b){s=b;};this.getSemanticObject=function(){return s;};this.setAction=function(b){a=b;};this.getAction=function(){return a;};this.copy=function(b){var c={semObject:s,actn:a};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(c);return new sap.apf.modeler.core.NavigationTarget((b||this.getId()),d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.parseTextPropertyFile')){jQuery.sap.declare("sap.apf.modeler.core.parseTextPropertyFile");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.modeler.core.parseTextPropertyFile=function(t,a){function c(v,w){var x=m.createMessageObject({code:v,aParameters:[w]});s.Messages.push(x);}function b(v){c(11013,v);}function d(v){c(11011,v);}function e(v,w){var x=sap.apf.utils.isValidGuid(v);if(!x){c(11012,w);return false;}else{return true;}}function f(v){c(11015,v);}function g(v){c(11012,v);}var m=a.instance.messageHandler;var D=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});var o;var l=t.split(/\r?\n/);var h=l.length;var i;var j=-1;var k=-1;var n;var p,q,r;var A=false;var s={Application:undefined,TextElements:[],Messages:[]};for(i=0;i<h;i++){if(!A){var u=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(u!==null){s.Application=l[i].split('=')[1];if(!sap.apf.utils.isValidGuid(s.Application)){s.Application="";b(i);}A=true;continue;}}if(l[i]===""){continue;}if(k===i&&/^\#\s*LastChangeDate/.exec(l[i])){r=l[i].split('=');if(r.length===2){o=D.parse(r[1]);if(!o){f(i);n.LastChangeUTCDateTime="";}else{n.LastChangeUTCDateTime='/Date('+o.getTime()+')/';}s.TextElements.push(n);}else{f(i);}n=null;continue;}if(j===i){r=l[i].split('=');if(r.length===2){if(e(r[0],i)){n.TextElement=r[0];n.TextElementDescription=r[1];}else{g(i);}}else{d(i);}continue;}p=/^\#(X|Y)[A-Z]{3},[0-9]+:/.exec(l[i]);if(p){if(j===i){d(i);}n={};n.Language=sap.apf.core.constants.developmentLanguage;n.Application=s.Application;n.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];n.MaximumLength=l[i].match(/,[0-9]+/);n.MaximumLength=parseInt(n.MaximumLength[0].substring(1),10);n.TranslationHint=l[i].match(/:\s*[0-9a-zA-Z\s]+$/);n.TranslationHint=n.TranslationHint[0].substring(1);j=i+1;k=i+2;}else{q=/^\#(X|Y)[A-Z]{3},[0-9]+/.exec(l[i]);if(q){if(j===i){d(i);}n={};n.Language=sap.apf.core.constants.developmentLanguage;n.Application=s.Application;n.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];n.MaximumLength=l[i].match(/,[0-9]+/);n.MaximumLength=parseInt(n.MaximumLength[0].substring(1),10);n.TranslationHint="";j=i+1;k=i+2;}}}if(!A){c(11010,0);}return s;};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.registryWrapper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.registryWrapper");(function(){'use strict';sap.apf.modeler.core.RegistryWrapper=function(h){function g(t){var r=[];if(h.getNumberOfItems()!==0){h.each(function(i,e){if(e.type===t){r.push(e);}});}return r;}this.getItem=function(k){return h.getItem(k);};this.getSteps=function(){return g("step");};this.getCategories=function(){return g("category");};this.getFacetFilters=function(){return g("facetFilter");};this.getNavigationTargets=function(){return g("navigationTarget");};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.representation')){jQuery.sap.declare("sap.apf.modeler.core.representation");(function(){'use strict';sap.apf.modeler.core.Representation=function(r,i,d){var a,b,w,c,m,l,e,f,g,o;if(!d){w={};c=new i.constructor.elementContainer("dimension",undefined,i);m=new i.constructor.elementContainer("measure",undefined,i);o=new i.constructor.elementContainer("orderBy",undefined,i);}else{a=d.representationTypeId;b=d.alternateRepresentationTypeId;w=d.width;c=d.dimensions;m=d.measures;l=d.leftUpperCornerTextKey;e=d.rightUpperCornerTextKey;f=d.leftLowerCornerTextKey;g=d.rightLowerCornerTextKey;o=d.orderByProperties;}this.getId=function(){return r;};this.setRepresentationType=function(t){a=t;};this.getRepresentationType=function(){return a;};this.setAlternateRepresentationType=function(t){b=t;};this.getAlternateRepresentationType=function(){return b;};this.getDimensions=function(){var h=[];c.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addDimension=function(p,t){var h;if(c.getElement(p)){return null;}h={propertyName:p,textLabelKey:t};return c.createElementWithProposedId(h,p).getId();};this.removeDimension=function(p){c.removeElement(p);};this.setDimensionKind=function(p,k){var h=c.getElement(p);if(h){h.kind=k;}};this.getDimensionKind=function(p){var h=c.getElement(p);if(h){return h.kind;}return undefined;};this.setDimensionTextLabelKey=function(p,t){var h=c.getElement(p);if(h){h.textLabelKey=t;}};this.getDimensionTextLabelKey=function(p){var h=c.getElement(p);if(h){return h.textLabelKey;}return undefined;};this.getMeasures=function(){var h=[];m.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addMeasure=function(p){var h;if(m.getElement(p)){return null;}h={propertyName:p};return m.createElementWithProposedId(h,p).getId();};this.removeMeasure=m.removeElement;this.setMeasureTextLabelKey=function(p,t){var h=m.getElement(p);if(h){h.textLabelKey=t;}};this.getMeasureTextLabelKey=function(p){var h=m.getElement(p);if(h){return h.textLabelKey;}return undefined;};this.setMeasureKind=function(p,k){var h=m.getElement(p);if(h){h.kind=k;}};this.getMeasureKind=function(p){var h=m.getElement(p);if(h){return h.kind;}return undefined;};this.setWidthProperty=function(p,h){w[p]=h;};this.getWidthProperties=function(){return w;};this.setLeftUpperCornerTextKey=function(t){l=t;};this.getLeftUpperCornerTextKey=function(){return l;};this.setRightUpperCornerTextKey=function(t){e=t;};this.getRightUpperCornerTextKey=function(){return e;};this.setLeftLowerCornerTextKey=function(t){f=t;};this.getLeftLowerCornerTextKey=function(){return f;};this.setRightLowerCornerTextKey=function(t){g=t;};this.getRightLowerCornerTextKey=function(){return g;};this.addOrderbySpec=function(p,h){var j;j=o.getElement(p);if(j){j.ascending=h;return j;}j={property:p,ascending:h};return o.createElementWithProposedId(j,p).getId();};this.removeOrderbySpec=function(p){o.removeElement(p);};this.getOrderbySpecifications=function(){var h=[];o.getElements().forEach(function(j){h.push({property:j.property,ascending:j.ascending});});return h;};this.copy=function(n){var h={representationTypeId:a,alternateRepresentationTypeId:b,width:w,dimensions:c,measures:m,leftUpperCornerTextKey:l,rightUpperCornerTextKey:e,leftLowerCornerTextKey:f,rightLowerCornerTextKey:g,orderByProperties:o};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);return new sap.apf.modeler.core.Representation((n||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.step')){jQuery.sap.declare("sap.apf.modeler.core.step");(function(){'use strict';sap.apf.modeler.core.Step=function(s,i,d){var r,a,b,f,c,e,t,k,g,l,h,j,m,n;if(!d){r=new i.constructor.elementContainer(s+"-Representation",i.constructor.representation,i);a={};b=new i.constructor.elementContainer("SelectProperty",undefined,i);f=new i.constructor.elementContainer("FilterProperty",undefined,i);c={};e=new i.constructor.elementContainer("SelectPropertyForFilterMapping",undefined,i);t=new i.constructor.elementContainer("TargetPropertyForFilterMapping",undefined,i);k=false;}else{r=d.representationContainer;a=d.request;b=d.selectProperties;f=d.filterProperties;c=d.requestForFilterMapping;e=d.selectPropertiesForFilterMapping;t=d.targetPropertiesForFilterMapping;k=d.keepSourceForFilterMapping;g=d.titleId;l=d.longTitleId;h=d.leftUpperCornerTextKey;j=d.rightUpperCornerTextKey;m=d.leftLowerCornerTextKey;n=d.rightLowerCornerTextKey;}this.getId=function(){return s;};this.getService=function(){return a.service;};this.setService=function(o){a.service=o;};this.getEntitySet=function(){return a.entitySet;};this.setEntitySet=function(o){a.entitySet=o;};this.setTitleId=function(o){g=o;};this.getTitleId=function(){return g;};this.setLongTitleId=function(o){l=o;};this.getLongTitleId=function(){return l;};this.getSelectProperties=function(){var o=[];var p=b.getElements();p.forEach(function(q){o.push(q.getId());});return o;};this.addSelectProperty=function(p){b.createElementWithProposedId(undefined,p);};this.removeSelectProperty=function(p){b.removeElement(p);};this.getFilterProperties=function(){var o=[];var p=f.getElements();p.forEach(function(q){o.push(q.getId());});return o;};this.addFilterProperty=function(p){return f.createElementWithProposedId(undefined,p).getId();};this.removeFilterProperty=function(p){f.removeElement(p);};this.setFilterMappingService=function(o){c.service=o;};this.getFilterMappingService=function(){return c.service;};this.setFilterMappingEntitySet=function(o){c.entitySet=o;};this.getFilterMappingEntitySet=function(){return c.entitySet;};this.addFilterMappingSelectProperty=function(p){return;};this.getFilterMappingSelectProperties=function(){return[];};this.removeFilterMappingSelectProperty=function(p){return;};this.addFilterMappingTargetProperty=function(p){t.createElementWithProposedId(undefined,p);};this.getFilterMappingTargetProperties=function(){var p=[];var o=t.getElements();o.forEach(function(q){p.push(q.getId());});return p;};this.removeFilterMappingTargetProperty=function(p){t.removeElement(p);};this.setFilterMappingKeepSource=function(o){k=o;};this.getFilterMappingKeepSource=function(){return k;};this.getRepresentations=r.getElements;this.getRepresentation=r.getElement;this.createRepresentation=r.createElement;this.removeRepresentation=r.removeElement;this.copyRepresentation=r.copyElement;this.moveRepresentationBefore=function(o,p){return r.moveBefore(o,p);};this.moveRepresentationUpOrDown=function(o,p){return r.moveUpOrDown(o,p);};this.moveRepresentationToEnd=function(o){return r.moveToEnd(o);};this.setLeftUpperCornerTextKey=function(o){h=o;};this.getLeftUpperCornerTextKey=function(){return h;};this.setRightUpperCornerTextKey=function(o){j=o;};this.getRightUpperCornerTextKey=function(){return j;};this.setLeftLowerCornerTextKey=function(o){m=o;};this.getLeftLowerCornerTextKey=function(){return m;};this.setRightLowerCornerTextKey=function(o){n=o;};this.getRightLowerCornerTextKey=function(){return n;};this.copy=function(o){var p={request:a,selectProperties:b,filterProperties:f,requestForFilterMapping:c,selectPropertiesForFilterMapping:e,targetPropertiesForFilterMapping:t,keepSourceForFilterMapping:k,titleId:g,longTitleId:l,leftUpperCornerTextKey:h,rightUpperCornerTextKey:j,leftLowerCornerTextKey:m,rightLowerCornerTextKey:n};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(p);d.representationContainer=r.copy(o+"-Representation");return new sap.apf.modeler.core.Step((o||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textHandler')){jQuery.sap.declare("sap.apf.modeler.core.textHandler");(function(){'use strict';sap.apf.modeler.core.TextHandler=function(){var b,B;this.getMessageText=function(r,p){return this.getText(r,p);};this.getText=function(r,p){var t;t=B.getText(r,p);if(t!==r){return t;}return b.getText(r,p);};function i(){var u;var I=sap.ui.getCore().getConfiguration().getOriginInfo();var m=jQuery.sap.getModulePath("sap.apf");u=m+'/modeler/resources/i18n/texts.properties';B=jQuery.sap.resources({url:u,includeInfo:I});u=m+'/resources/i18n/apfUi.properties';b=jQuery.sap.resources({url:u,includeInfo:I});}i();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFRouter')){jQuery.sap.declare('sap.apf.modeler.ui.utils.APFRouter');sap.apf.modeler.ui.utils.APFRouter={patternMatch:function(c){this.params={};var s=this;sap.ui.core.UIComponent.getRouterFor(c).attachRoutePatternMatched(function(e){var a={};s.params={name:e.getParameter("name"),arguments:e.getParameter("arguments")};if(s.params.name!=="applicationList"){var C=c.oCoreApi;c.appId=s.params.arguments.appId;c.configId=s.params.arguments.configId;C.getApplicationHandler(function(A){c.applicationHandler=A;c.appName=A.getApplication(c.appId).ApplicationName;var t=c.byId("idConfigTitleMaster").getText();if(t===""||s.params.name==="configurationList"){c.setConfigListMasterTitle(c.appName);}C.getConfigurationHandler(c.appId,function(b){c.configurationHandler=b;c.oTextPool=c.configurationHandler.getTextPool();if(c.configurationHandler.getList().length>c.getView().getModel().getData().aConfigDetails.length){c.createConfigList();if(s.params.name==="configurationList"){c.updateConfigListView();}}if(c.configurationHandler.getList().length===0&&(c.configId===undefined)){c.oTreeInstance.addNodeInTree(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION);var d=c.oTreeInstance.getNodes();var n=d[d.length-1];c.oTreeInstance.setSelectedNode(n);}if(c.configId!==undefined){var E=b.getConfiguration(c.configId);if(E){b.loadConfiguration(c.configId,function(f){c.configEditor=f;var p=c.getSPathForConfig(c.configId);if(c.oModel.getData().aConfigDetails[p.split('/')[2]].bIsLoaded===false){c.updateTree();if(s.params.name!=="navigationTarget"){s.setCurrentSelectionState(s.params,c);}}else{s.setCurrentSelectionState(s.params,c);}});}else{s.setCurrentSelectionState(s.params,c);}}});});}});},setCurrentSelectionState:function(p,c){var v=c.getSPathFromURL(p);if(p.name!=="configurationList"){if(v&&v.objectType){c.updateSubView(p);if(v.sPath){c.setSelectionOnTree(v.sPath);}c.updateTitleAndBreadCrumb();}else{c.showNoConfigSelectedText();c.removeSelectionOnTree();}}}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.constants')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.constants');sap.apf.modeler.ui.utils.CONSTANTS={configurationObjectTypes:{CONFIGURATION:"configuration",FACETFILTER:"facetFilter",CATEGORY:"category",STEP:"step",REPRESENTATION:"representation",NAVIGATIONTARGET:"navigationTarget",ISNEWCONFIG:"apf1972-"}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.helper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.helper');sap.apf.modeler.ui.utils.helper={onResize:function(c){jQuery(window).resize(function(){c();});},applySize:function(w,h,c,o){var a,b;if(h!==undefined){b=((h.getDomRef!==undefined)?jQuery(h.getDomRef()).height():(jQuery.isNumeric(h)?h:jQuery(h).height()));}if(w!==undefined){a=((w.getDomRef!==undefined)?jQuery(w.getDomRef()).width():(jQuery.isNumeric(w)?w:jQuery(w).width()));}var d=(c.getDomRef!==undefined)?jQuery(c.getDomRef()):jQuery(c);var e=(o===undefined)?0:(o.offsetHeight||0);var f=(o===undefined)?0:(o.offsetWidth||0);d.css({height:(h===undefined)?"100%":b+e+"px",width:(w===undefined)?"100%":a+f+"px"});}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.navigationHandler')){jQuery.sap.declare('sap.apf.modeler.ui.utils.navigationHandler');sap.apf.modeler.ui.utils.navigationHandler=(function(){var i,d={};var t=function(l,m){b(l,{isSwitchConfiguration:true},m);};var a=function(l,m){_(l,{isValidationCheck:true},m);};var _=function(l,s,m){var C=l.oCoreApi;var n=C.getText("mandatoryField");var o=Object.keys(s)[0];var p={_handleValidationNavigation:f,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmValidationDialog=sap.ui.xmlfragment("idMandatoryValidationDialogFragement","sap.apf.modeler.ui.fragment.mandatoryDialog",p);l.getView().addDependent(d.oConfirmValidationDialog);e(C,"validationDialog");var v=new sap.m.Label();v.addStyleClass("dialogText");v.setText(n);d.oConfirmValidationDialog.removeAllContent();d.oConfirmValidationDialog.addContent(v);d.oConfirmValidationDialog.open();};var b=function(l,s,m){var C=l.oCoreApi;var n=C.getText("unsavedConfiguration");var o=Object.keys(s)[0];var p={_handleNavigationWithSave:g,_handleNavigateWithoutSave:h,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmNavigationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",p);l.getView().addDependent(d.oConfirmNavigationDialog);e(C,"naviagtionDialog");var q=new sap.m.Label();q.addStyleClass("dialogText");q.setText(n);d.oConfirmNavigationDialog.removeAllContent();d.oConfirmNavigationDialog.addContent(q);d.oConfirmNavigationDialog.open();};var c=function(d){d.close();d.destroy();};var e=function(C,l){if(l==="naviagtionDialog"){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(C.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(C.getText("cancel"));}else if(l==="validationDialog"){sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idMandatoryValidationDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idNoButton").setText(C.getText("no"));}};var f=function(){var l=this.configListInstance;var m=this.callback;c(d.oConfirmValidationDialog);if(typeof m.yes==="function"){m.yes();}};var g=function(){var l=this.configListInstance;var m=this.callback;var s=function(m){l.configEditor.save(function(n,o,p){l.configId=n;if(p===undefined){if(typeof m==="function"){m();}var q=l.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(q,{width:"20em"});}else{var M=l.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(p);l.oCoreApi.putMessage(M);var r=l.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(r,{width:"20em"});}});};c(d.oConfirmNavigationDialog);if(typeof m.yes==="function"){m.yes(s);}};var h=function(){var l=this.configListInstance;var m=this.callback;c(d.oConfirmNavigationDialog);l.configurationHandler.resetConfiguration(l.configId);if(typeof m.no==="function"){m.no();}};var j=function(){var l=this.isTraverseBack;var m=this.isSwitchConfiguration;var n=this.isValidationCheck;var o=this.configListInstance;var p=this.callback;if(!n){c(d.oConfirmNavigationDialog);}else{c(d.oConfirmValidationDialog);}if(typeof p.cancel==="function"){p.cancel();}else if(typeof p.no==="function"&&n){p.no();}};var k=function(){return{throwLossOfDataPopup:t,throwMandatoryPopup:a};};return{getInstance:function(){return i||(i=k());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.textPoolHelper')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.textPoolHelper');sap.apf.modeler.ui.utils.TextPoolHelper=function(t){this.oTextPool=t;};sap.apf.modeler.ui.utils.TextPoolHelper.prototype={setAutoCompleteOn:function(i,d){i.setShowSuggestion(true);var s=[];if(d.type==="text"){var e=this._getSuggestionItems(d.oTranslationFormat);e.forEach(function(t){var o={};o.suggetionText=t.TextElementDescription;s.push(o);});}else if(d.type==="service"){var E=d.oConfigurationEditor.getAllServices();E.forEach(function(a){var o={};o.suggetionText=a;s.push(o);});}var I=i.getModel();var m=I||new sap.ui.model.json.JSONModel({});if(!m.getData().suggestions){m.getData().suggestions=s;}if(!I){i.setModel(m);}i.bindAggregation("suggestionItems",{path:"/suggestions",template:new sap.ui.core.Item({text:"{suggetionText}"})});i.attachSuggest(this._handleSuggestion);},_handleSuggestion:function(e){var v=e.getParameter("suggestValue");var f=new sap.ui.model.Filter("suggetionText",sap.ui.model.FilterOperator.Contains,v);e.getSource().getBinding("suggestionItems").filter([f]);},_getSuggestionItems:function(t){return this.oTextPool.getTextsByTypeAndLength(t.TextElementType,t.MaximumLength);}};sap.apf.modeler.ui.utils.TranslationFormatMap={APPLICATION_TITLE:{TextElementType:"XTIT",MaximumLength:250},CATEGORY_TITLE:{TextElementType:"XTIT",MaximumLength:60},FACETFILTER_LABEL:{TextElementType:"XFLD",MaximumLength:50},STEP_TITLE:{TextElementType:"XTIT",MaximumLength:100},STEP_LONG_TITLE:{TextElementType:"XTIT",MaximumLength:200},STEP_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25},REPRESENTATION_LABEL:{TextElementType:"XTIT",MaximumLength:80},REPRESENTATION_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25}};};if(!jQuery.sap.isDeclared('sap.apf.ui.controls.draggableCarousel.DraggableCarousel')){jQuery.sap.declare("sap.apf.ui.controls.draggableCarousel.DraggableCarousel");(function(u){"use strict";var a;var d=(function(){a=window.hasOwnProperty('ontouchstart')||window.hasOwnProperty('onmsgesturechange');}());sap.apf.ui.controls.draggableCarousel.DraggableCarousel=function(o){var b=o||{};this.eleRefs={blocks:[],containerEle:o.containerEle};this._editState=b.editable===u?true:b.editable;this._dragState=this._editState;this._removeState=this._editState;this.styles={containerHeight:b.containerHeight,containerWidth:b.containerWidth,blockHeight:b.blockHeight,blockWidth:b.blockWidth,blockMargin:b.blockMargin,separatorHeight:b.separatorHeight,removeIconHeight:b.removeIconHeight};this.elems={separator:b.separator,removeIcon:b.removeIcon};this.callbacks={onBeforeDrag:b.onBeforeDrag,onAfterDrop:b.onAfterDrop,onAfterRemove:b.onAfterRemove,onAfterSelect:b.onAfterSelect};this.eleRefs.containerEle=this._drawSkeleton();this._initDimensions();this._isMouseDown=false;};sap.apf.ui.controls.draggableCarousel.DraggableCarousel.prototype={_initDimensions:function(){var m=this.styles.blockMargin;this._blockMargin=parseInt(m.replace("px"),10);var b=this.styles.blockHeight;this._blockHeight=parseInt(b.replace("px"),10);this._blockTotalHeight=this._blockHeight+(2*this._blockMargin);this._separatorHeight=0;if(this.elems.separator!==u){var s=this.styles.separatorHeight;this._separatorHeight=parseInt(s.replace("px"),10);}this._mFactor=this._blockTotalHeight+this._separatorHeight;},_drawSkeleton:function(){var c;if(this.eleRefs.containerEle===u){c=document.createElement('div');}else{c=this.eleRefs.containerEle;}c.style.cssText+=this._getContainerStyles();c.classList.add('DnD-container');var s=this;var t=a?"touchend":"mouseup";document.addEventListener(t,function(e){s._onMouseUp(e,s);});return c;},_getBlockWrapper:function(b){var c=b.blockElement;var f=this.eleRefs.blocks;var g=b.dragState===u?true:b.dragState;var h=b.dropState===u?true:b.dropState;var r=b.removable===u?true:b.removable;var i=document.createElement('div');i.style.cssText+=this._getBlockStyles();i.setAttribute('class','DnD-block');i.setAttribute('drag-state',g);i.setAttribute('drop-state',h);if(r){var j=this._getRemoveIconEle();i.appendChild(j);}var s=this;var t=a?"touchstart":"mousedown";i.addEventListener(t,function(e){s._onMouseDown(e,s,this);});var k=a?"touchmove":"mousemove";i.addEventListener(k,function(e){window.clearTimeout(s._TIMEOUTID);});this._keypress(i,13,function(l,e){var m=f.indexOf(l);s.callbacks.onAfterSelect.apply(l,[m]);});this._keypress(i,32,function(l,e){var m=f.indexOf(l);s.callbacks.onAfterSelect.apply(l,[m]);});this._keypress(i,36,function(l,e){jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[0]).attr("tabindex",0);jQuery(f[0]).focus();});this._keypress(i,35,function(l,e){jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[f.length-1]).attr("tabindex",0);jQuery(f[f.length-1]).focus();});if(r===true){this._keypress(i,46,function(l,e){var m=f.indexOf(l);s.removeBlock(m,s.callbacks.onAfterRemove);s._grouping(f);jQuery(f).parent().wrap("<div>").find("[tabindex='0']").focus();});}i.appendChild(c);return i;},_getSeparatorEle:function(){var s=document.createElement('div');s.style.cssText+=this._getSeparatorStyles();s.setAttribute('class','DnD-separator');s.innerHTML=this.elems.separator.outerHTML;return s;},_getRemoveIconEle:function(){var r=this.elems.removeIcon;var b=document.createElement('div');b.style.cssText+=this._getRemoveIconStyles();b.setAttribute('class','DnD-removeIconWrapper');b.innerHTML=r.outerHTML;var s=this;var t=a?"touchstart":"mousedown";b.addEventListener(t,function(e){s._onRemoveBlock(e,s,this);});return b;},addBlock:function(b){if(b instanceof Array){var i;for(i=0;i<b.length;i++){this.addBlock(b[i]);}return;}var c=this._getBlockWrapper(b);var e=this.eleRefs.blocks.length;var f=this.eleRefs.blocks;var s=this;var y=e*this._mFactor;c.style.cssText=c.style.cssText+this._getTransformCss(y);this.eleRefs.blocks.push(c);var g=this.eleRefs.containerEle;g.appendChild(c);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var h=this._getSeparatorEle();var j=y+this._blockHeight+2*this._blockMargin;h.style.cssText=h.style.cssText+this._getTransformCss(j);g.appendChild(h);}this._grouping(f);},swapBlocks:function(f,t){var b=this.eleRefs.blocks[f];var c=this.eleRefs.blocks[t];if((b.getAttribute('drag-state')!=="true"&&b.getAttribute('drop-state')!=="true")||(c.getAttribute('drag-state')!=="true"&&c.getAttribute('drop-state')!=="true")){return false;}var e=f*this._mFactor;var g=e;var h=g+this._blockHeight+(2*this._blockMargin);var i=t*this._mFactor;var j=i;var k=j+this._blockHeight+(2*this._blockMargin);var l=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:this.eleRefs.containerEle;var s=l.scrollTop;if((f>t)&&j<l.scrollTop){s=j;}if((f<t)&&k-l.offsetHeight>l.scrollTop){s=k-l.offsetHeight;}var p;var m=40;var n=window.setInterval(function(){l.scrollTop+=(s-l.scrollTop)/m;if(l.scrollTop===p){window.clearInterval(n);}p=l.scrollTop;},1000/60);this._setTransformYValue(b,i);this._setTransformYValue(c,e);this._swapArray(this.eleRefs.blocks,f,t);return true;},insertBlock:function(b,c){var e=this.eleRefs.blocks;e.push({});var i;for(i=e.length-1;i>c;i--){e[i]=e[i-1];var f=i*this._mFactor;this._setTransformYValue(e[i],f);}var g=this._getBlockWrapper(b);e[i]=g;var y=c*this._mFactor;g.style.cssText=g.style.cssText+this._getTransformCss(y);var h=this.eleRefs.containerEle;h.appendChild(g);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var s=this._getSeparatorEle();var j=y+this._blockHeight+2*this._blockMargin;s.style.cssText=s.style.cssText+this._getTransformCss(j);h.appendChild(s);}this._grouping(e);},removeBlock:function(b,c){var e=this.eleRefs.blocks;var f=this.eleRefs.containerEle;var i;var r=e[b];f.removeChild(r);for(i=b;i<e.length-1;i++){e[i]=e[i+1];var y=i*this._mFactor;this._setTransformYValue(e[i],y);}e.pop();if(this.elems.separator!==u){var s=f.querySelectorAll('.DnD-separator');var l=s[s.length-1];f.removeChild(l);}c.apply(f,[b]);this._grouping(e);},placeAt:function(i){var e=document.getElementById(i);e.appendChild(this.eleRefs.containerEle);this._setHorizontalBlockMargin();},getEditable:function(){return this._editState;},setEditable:function(e){this._editState=e;this._setDragState(e);this._setRemoveState(e);},_setDragState:function(b){this._dragState=b;},_setRemoveState:function(r){this._removeState=r;var b=this.eleRefs.containerEle.querySelectorAll('.DnD-removeIconWrapper');var c;if(r){c="display : block";}else{c="display : none";}var i;for(i=0;i<b.length;i++){b[i].style.cssText+=c;}},_getContainerStyles:function(){var s=["height : ",this.styles.containerHeight,";width : ",this.styles.containerWidth,"overflow : auto; position : relative"].join("");return s;},_getBlockStyles:function(){if(this.styles.horizontalBlockMargin===u){var c=this.eleRefs.containerEle.clientWidth;var b=this.eleRefs.blocks[0]===u?0:this.eleRefs.blocks[0].clientWidth;this.styles.horizontalBlockMargin=((c-b)/2)+"px";}var s=["height : ",this.styles.blockHeight,";width : ",this.styles.blockWidth,";margin : ",this.styles.blockMargin," ",this.styles.horizontalBlockMargin,";position : absolute"].join("");return s;},_getSeparatorStyles:function(){var s=["height : ",this.styles.separatorHeight,";width : 100%",";position : absolute"].join("");return s;},_getRemoveIconStyles:function(){var s=["height : ",this.styles.removeIconHeight,";width : ",this.styles.removeIconHeight,";float : right",";margin : -10px -13px -10px 0",";z-index : 2",";position : relative",";cursor : pointer"].join("");if(this._removeState){s+=";display : block";}else{s+=";display : none";}return s;},_getTransformCss:function(y){var Y=y+"px";var t=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"];var c="";var i;for(i=0;i<t.length;i++){c+=t[i]+": translate3d(0px,"+Y+", 0px); ";}return c;},_setTransformYValue:function(e,y){var v=[{"WebkitTransform":"-webkit-transform"},{"MozTransform":"-moz-transform"},{"MsTransform":"-ms-transform"},{"OTransform":"-o-transform"}];var t="transform";var i;for(i=0;i<v.length;i++){if(e.style.hasOwnProperty(Object.keys(v[i])[0])){t=v[i][Object.keys(v[i])[0]];}}var Y=y+'px';e.style.cssText=e.style.cssText+" "+t+": translate3d(0px,"+Y+", 0px);";},_setHorizontalBlockMargin:function(){var b=this.eleRefs.blocks;var c=this.eleRefs.containerEle;var e=b[0]===u?0:b[0].clientWidth;var f=c.clientWidth;this.styles.horizontalBlockMargin=((f-e)/2)+"px";var m=this.styles.horizontalBlockMargin;[].forEach.call(b,function(g){g.style.cssText+="margin-right : "+m+";margin-left : "+m;});},_onMouseDown:function(e,c,b){c._isMouseDown=true;c._TIMEOUTID=window.setTimeout(function(){if(c._isMouseDown){c._onDragStart(e,c,b);}},500);},_onMouseUp:function(e,c){c._isMouseDown=false;if(c._dragEle!==u&&c._dragEle.ele!==u){c._onDrop(e,c);}},_onDragStart:function(e,c,b){if(!c._dragState||b.getAttribute('drag-state')!=='true'){return;}c._dragIndex=c.eleRefs.blocks.indexOf(b);var y=c._dragIndex*c._mFactor;var f=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;c._containerEleOffsetHeight=f.offsetHeight;c._containerEleScrollHeight=f.scrollHeight;c._blockEleOffsetHeight=b.offsetHeight;c._containerEleScrollTop=f.scrollTop;var g=y+c._blockMargin;var h=g+c._blockHeight;if(g<c._containerEleScrollTop){f.scrollTop=g;c._containerEleScrollTop=Math.max(0,g);}if(h-c._containerEleOffsetHeight>f.scrollTop){f.scrollTop=h-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,h-c._containerEleOffsetHeight);}c._diffTop=e.pageY-y+c._containerEleScrollTop;c._dragEle={ele:b,pos:{y:y}};c.callbacks.onBeforeDrag.apply(b,[c._dragIndex]);c._dragEle.ele.className=c._dragEle.ele.className+" "+"DnD-drag";var t=a?"touchmove":"mousemove";document.addEventListener(t,function(e){if(c._dragEle.ele!==u){e.preventDefault();c._onDrag(e,c);e.stopPropagation();}});},_onDrag:function(e,c){var b=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;var y=e.pageY-c._diffTop+c._containerEleScrollTop;var f=y+c._blockMargin;var g=f+c._blockHeight;var h=((e.pageY-c._diffTop)>c._prevPageY);var j=((e.pageY-c._diffTop)<c._prevPageY);c._prevPageY=(e.pageY-c._diffTop);if(j&&(f<c._containerEleScrollTop)){b.scrollTop=f;c._containerEleScrollTop=Math.max(0,f);y=e.pageY-c._diffTop+c._containerEleScrollTop;}if(h&&((g-c._containerEleOffsetHeight)>c._containerEleScrollTop)){b.scrollTop=g-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,g-c._containerEleOffsetHeight);y=e.pageY-c._diffTop+c._containerEleScrollTop;}c._setTransformYValue(c._dragEle.ele,y);var m=c.styles.blockMargin;var k=parseInt(m.replace("px"),10);var l=y;var n=y+c._blockEleOffsetHeight;var o=c._dragEle.pos.y-(c._mFactor-(c._blockHeight/2));var p=(c._dragEle.pos.y+c._blockEleOffsetHeight)+(c._mFactor-(c._blockHeight/2));var q=c._dragEle.pos.y;var r=q/(c._mFactor);var s=c.eleRefs.blocks;var t=-1,v=s.length;var i,w;for(i=r-1;i>=0;i--){w=s[i];if(w.getAttribute('drop-state')==='true'){t=i;break;}}for(i=r+1;i<s.length;i++){w=s[i];if(w.getAttribute('drop-state')==='true'){v=i;break;}}o=c._dragEle.pos.y-((r-t)*c._mFactor-(c._blockHeight/2));p=(c._dragEle.pos.y+c._blockEleOffsetHeight)+((v-r)*c._mFactor-(c._blockHeight/2));var x;var S=false;if(l<o){S=true;x=t;}else if(n>p){S=true;x=v;}if(S&&(x>=0)&&(x<=s.length-1)){c._dragEle.pos.y=x*(c._mFactor);var z=s[x];if(z!==u){c._setTransformYValue(z,q);c._swapArray(s,r,x);}}},_onDrop:function(e,c){c._dragEle.ele.className=c._dragEle.ele.className.replace(" DnD-drag","");var b=c.eleRefs.containerEle.querySelectorAll('.DnD-drag');var i;for(i=0;i<b.length;i++){b[i].className=b[i].className.replace(" DnD-drag","");}var f=c._dragEle.pos.y;c._dropIndex=f/(c._mFactor);c._setTransformYValue(c._dragEle.ele,f);c.callbacks.onAfterDrop.apply(c._dragEle.ele,[c._dragIndex,c._dropIndex]);c._dragEle={};},_onRemoveBlock:function(e,c,r){e.stopPropagation();var b=r.parentElement;var f=c.eleRefs.blocks.indexOf(b);c.removeBlock(f,c.callbacks.onAfterRemove);},_swapArray:function(b,f,t){var c=b[f];b[f]=b[t];b[t]=c;return b;},_grouping:function(b){var c=b;var f=(b.length>2)?b.length-2:0;jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[f]).attr("tabindex",0);this._keypress(c,38,function(g,e){var i=c.indexOf(g);if(i===0){return;}jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[i-1]).attr("tabindex",0);jQuery(c[i-1]).focus();});this._keypress(c,40,function(g,e){var i=c.indexOf(g);if(i===c.length-1){return;}jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[i+1]).attr("tabindex",0);jQuery(c[i+1]).focus();});},_keypress:function(b,k,c){jQuery(b).keydown(function(e){var f=e.keyCode||e.which;if(f===k){c(this,e);return false;}});}};}(undefined));};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.representationInterface')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.representations.representationInterface');(function(){'use strict';sap.apf.ui.representations.RepresentationInterfaceProxy=function(c,u){this.type='RepresentationInterfaceProxy';this.putMessage=function(m){return c.putMessage(m);};this.createMessageObject=function(C){return c.createMessageObject(C);};this.getActiveStep=function(){return c.getActiveStep();};this.setActiveStep=function(s){return c.setActiveStep(s);};this.getTextNotHtmlEncoded=function(l,p){return c.getTextNotHtmlEncoded(l,p);};this.updatePath=function(s){return c.updatePath(s);};this.createFilter=function(){return c.createFilter();};this.selectionChanged=function(r){return u.selectionChanged(r);};this.getEventCallback=function(e){return u.getEventCallback(e);};};sap.apf.ui.representations.representationInterface=function(d,c){this.setData=function(m,D){};this.getSelectionAsArray=function(){return[0,2];};this.adoptSelection=function(s){};this.getFilterMethodType=function(){return sap.apf.constants.filterMethodTypes.selectionAsArray;};this.getRequestOptions=function(){return{};};this.getParameter=function(){var p={dimensions:[],measures:[]};return p;};this.getMainContent=function(){var u={};return u;};this.getThumbnailContent=function(){var u={};return u;};this.getPrintContent=function(){var u={};return u;};this.getTooltipContent=function(){var u={};return u;};this.removeAllSelection=function(){};this.serialize=function(){var s={};return s;};this.deserialize=function(s){};this.getAlternateRepresentation=function(){return this.oAlternateRepresentation;};this.getMetaData=function(){return this.metadata;};this.getData=function(){return this.aDataResponse;};};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.UI5ChartHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.UI5ChartHelper");sap.apf.ui.representations.utils.UI5ChartHelper=function(a,p){var s=this;this.parameter=p;this.classifiedData=[];this.extendedDataSet=[];this.fieldKeysLookup={};this.displayNameLookup={};this.fieldNameLookup={};this.filterLookup={};this.datasetObj={};this.cachedSelection=[];this.filterValues=[];this.dataAlreadySorted=false;this.init=function(D,m,i,o){this.metadata=m;this.formatter=new sap.apf.ui.representations.utils.formatter(a,m,D);b.bind(this)(m,D);c.bind(this)(D);d.bind(this)(i,o);if(this.parameter.requiredFilters!==undefined&&this.parameter.requiredFilters.length!==0){v();}};var v=function(){s.filterValues=s.filterValues.filter(function(f){for(var i=0;i<s.extendedDataResponse.length;i++){var h=0;for(var j=0;j<s.parameter.requiredFilters.length;j++){if(f[j]===s.extendedDataResponse[i][s.parameter.requiredFilters[j]]){h=h+1;}}if(h===s.parameter.requiredFilters.length){return true;}else if(i===s.extendedDataResponse.length-1){return false;}}});s.cachedSelection=e();};var b=function(m,D){var f=this.parameter.dimensions.concat(this.parameter.measures);var r=[];var h=function(n){var o=0;for(var i=0;i<f.length;i++){if(f[i].fieldName===n){o++;}}return(o===0?false:true);};if(this.parameter.requiredFilters){this.parameter.requiredFilters.forEach(function(n){if(!h(n)){var o={fieldName:n};r.push(o);}});}if(r.length!==0){f=f.concat(r);}for(var i=0;i<f.length;i++){var j=f[i];var k=j.fieldName;this.displayNameLookup[k]={};if(m!==undefined){if(m.getPropertyMetadata(k).hasOwnProperty('text')&&(m.getPropertyMetadata(k)["aggregation-role"]!=="measure")){var t=m.getPropertyMetadata(k).text;var l=m.getPropertyMetadata(t).label;this.displayNameLookup[k].DISPLAY_NAME=l;this.displayNameLookup[k].VALUE="formatted_"+k;}else if(m.getPropertyMetadata(k)["aggregation-role"]==="dimension"){this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label;this.displayNameLookup[k].VALUE="formatted_"+k;}else{this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label;this.displayNameLookup[k].VALUE=k;}if(j.fieldDesc!==undefined&&a.getTextNotHtmlEncoded(j.fieldDesc).length){this.displayNameLookup[k].DISPLAY_NAME=a.getTextNotHtmlEncoded(j.fieldDesc);}if(m.getPropertyMetadata(k).unit!==undefined){var u=m.getPropertyMetadata(k).unit;var U;if(D!==undefined&&D.length!==0){U=D[0][u];this.displayNameLookup[k].DISPLAY_NAME=this.displayNameLookup[k].DISPLAY_NAME+' ('+U+')';}}}this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME]={};this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].FIELD_NAME=k;this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].VALUE=this.displayNameLookup[k].VALUE;}};var c=function(D){this.extendedDataResponse=jQuery.extend([],true,D);var i,j,k;if(this.extendedDataResponse.length!==0){for(i=0;i<this.extendedDataResponse.length;i++){for(k=0;k<this.parameter.measures.length;k++){if(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]!==null){this.extendedDataResponse[i][this.parameter.measures[k].fieldName]=parseFloat(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]);}}for(j=0;j<Object.keys(this.displayNameLookup).length;j++){var f=Object.keys(this.displayNameLookup)[j];var h=(this.displayNameLookup[f].VALUE.search('formatted_')!==-1);if(h){var t=this.metadata.getPropertyMetadata(f).hasOwnProperty('text');if(!t){this.extendedDataResponse[i][this.displayNameLookup[f].VALUE]=this.formatter.getFormattedValue(f,this.extendedDataResponse[i][f]);}else{var l=this.metadata.getPropertyMetadata(f).text;var T={text:this.extendedDataResponse[i][l],key:this.extendedDataResponse[i][f]};this.extendedDataResponse[i][this.displayNameLookup[f].VALUE]=this.formatter.getFormattedValueForTextProperty(f,T);}}}var m="";for(j=0;j<this.parameter.dimensions.length;j++){var n=this.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE;this.extendedDataResponse[i][n]=this.extendedDataResponse[i][n]===null?this.extendedDataResponse[i][n]:this.extendedDataResponse[i][n].toString();m=m+this.extendedDataResponse[i][n];this.filterLookup[m]=[];if(this.parameter.requiredFilters){for(k=0;k<this.parameter.requiredFilters.length;k++){var o={};o.id=this.extendedDataResponse[i][this.parameter.requiredFilters[k]];o.text=this.extendedDataResponse[i][this.displayNameLookup[this.parameter.requiredFilters[k]].VALUE];this.filterLookup[m].push(o);}}}}}else{var q={};for(k=0;k<this.parameter.measures.length;k++){q[s.displayNameLookup[this.parameter.measures[k].fieldName].VALUE]=undefined;}for(j=0;j<this.parameter.dimensions.length;j++){q[s.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE]=undefined;}this.extendedDataResponse.push(q);}};var d=function(I,D){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});var f=[];var M=[];var i=0;for(i=0;i<this.parameter.dimensions.length;i++){f[i]={name:this.displayNameLookup[this.parameter.dimensions[i].fieldName].DISPLAY_NAME,value:this.displayNameLookup[this.parameter.dimensions[i].fieldName].VALUE,kind:this.parameter.dimensions[i].kind?this.parameter.dimensions[i].kind:undefined,axisfeedItemId:this.parameter.dimensions[i].axisfeedItemId?this.parameter.dimensions[i].axisfeedItemId:undefined};}s.measureAxisType=I;for(i=0;i<this.parameter.measures.length;i++){M[i]={name:this.displayNameLookup[this.parameter.measures[i].fieldName].DISPLAY_NAME,value:this.displayNameLookup[this.parameter.measures[i].fieldName].VALUE,kind:this.parameter.measures[i].kind?this.parameter.measures[i].kind:undefined,axisfeedItemId:this.parameter.measures[i].axisfeedItemId?this.parameter.measures[i].axisfeedItemId:undefined};}var P={dimensions:f,measures:M};var h=D.getDataset(P);if(this.metadata!==undefined){for(i=0;i<this.parameter.dimensions.length;i++){var j=this.metadata.getPropertyMetadata(this.parameter.dimensions[i].fieldName);if(j.isCalendarYearMonth==="true"){if(this.parameter.dimensions.length>1){h.data.sorter=new sap.ui.model.Sorter(this.parameter.dimensions[0].fieldName,false);}}}}this.datasetObj=h;};this.getDataset=function(){return new sap.viz.ui5.data.FlattenedDataset(this.datasetObj);};this.getModel=function(){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});return m;};this.getFilterCount=function(){return this.filterValues.length;};this.getFilters=function(){var f=Object.keys(this.filterLookup);var F=[];var s=this;var h=function(k){for(var i=0;i<f.length;i++){var l={};var m=f[i];for(var j=0;j<s.filterLookup[m].length;j++){if(k===s.filterLookup[m][j].id){l.id=k;l.text=s.filterLookup[m][j].text;F.push(l);return;}}}};for(var i=0;i<this.filterValues.length;i++){h(this.filterValues[i][0]);}return F;};this.getSelectionFromFilter=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){return[];}var h=e();return h;};this.getHighlightPointsFromSelectionEvent=function(f){var h=[];var n=[];h=g(f,this.cachedSelection);for(var i=0;i<h.length;i++){var k=h[i];if(this.parameter.measures.length===1){var m=this.displayNameLookup[this.parameter.measures[0].fieldName].DISPLAY_NAME;if(k.data[m]===undefined||k.data[m]===null){continue;}}var l="";for(var j=0;j<this.parameter.dimensions.length;j++){var o=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[o];}var q=this.filterLookup[l];var r=this.filterValues.filter(function(t){var u=0;for(var i=0;i<s.parameter.requiredFilters.length;i++){if(t[i]===q[i].id){u=u+1;}else{break;}}if(u===s.parameter.requiredFilters.length){return true;}else if(i===s.parameter.requiredFilters.length){return false;}});if(r.length===0){var M=q.map(function(t){return t.id;});this.filterValues.push(M);}}n=e();this.cachedSelection=n;return n;};var g=function(f,n){var h=f.filter(function(k){for(var i=0;i<n.length;i++){var l=0;for(var j=0;j<Object.keys(k.data).length;j++){if(n[i].data[Object.keys(k.data)[j]]===k.data[Object.keys(k.data)[j]]){l=l+1;}else{break;}}if(l===Object.keys(k.data).length){return false;}else if(j===Object.keys(k.data).length){return true;}}return true;});return h;};this.getFilterFromSelection=function(){var r=[];var i;for(i=0;i<s.filterValues.length;i++){r.push(s.filterValues[i][0]);}var f=a.createFilter();var E=f.getOperators().EQ;var F;var A=f.getTopAnd().addOr('exprssionOr');for(i=0;i<r.length;i++){var h=this.metadata.getPropertyMetadata(s.parameter.requiredFilters[0]).dataType.type;if(h==="Edm.Int32"){r[i]=r[i]===null?r[i]:parseFloat(r[i]);}F={id:r[i],name:s.parameter.requiredFilters[0],operator:E,value:r[i]};A.addExpression(F);}return f;};var e=function(){var r=[];r[0]=[];var i,j,k,l;for(i=0;i<s.filterValues.length;i++){r[0].push(s.filterValues[i][0]);}var n=[];for(i=0;i<s.extendedDataResponse.length;i++){var f=s.extendedDataResponse[i];for(j=0;j<r[0].length;j++){var h=0;for(k=0;k<r.length;k++){if(f[s.parameter.requiredFilters[k]]===r[k][j]){h=h+1;}}if(h===r.length){var m={data:{}};var o;var q;for(k=0;k<s.getDataset().getDimensions().length;k++){var t=s.getDataset().getDimensions()[k].getName();var u=s.fieldNameLookup[t].VALUE;m.data[t]=f[u];}if(!s.measureAxisType){var w;var x;for(l=0;l<s.getDataset().getMeasures().length;l++){var y=jQuery.extend(true,{},m);w=s.getDataset().getMeasures()[l].getName();x=s.fieldNameLookup[w].VALUE;y.data[w]=f[x]===null?f[x]:parseFloat(f[x]);n.push(y);}}else{for(k=0;k<s.getDataset().getMeasures().length;k++){o=s.getDataset().getMeasures()[k].getName();q=s.fieldNameLookup[o].VALUE;m.data[o]=f[q]===null?f[q]:parseFloat(f[q]);}n.push(m);}}}}return n;};this.getHighlightPointsFromDeselectionEvent=function(f){var i,j;var h=g(this.cachedSelection,f);for(i=0;i<h.length;i++){var k=h[i];var l="";for(j=0;j<this.parameter.dimensions.length;j++){var m=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[m];}var n=this.filterLookup[l];this.filterValues=this.filterValues.filter(function(q,r){var t=0;for(var i=0;i<n.length;i++){if(n[i].id===q[i]){t=t+1;}}if(t===n.length){return false;}else{return true;}});}var o=e();this.cachedSelection=o;return o;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.formatter')){jQuery.sap.declare("sap.apf.ui.representations.utils.formatter");sap.apf.ui.representations.utils.formatter=function(a,m,d){var s=this;this.metadata=m;this.dataResponse=d;this.getFormattedValue=function(f,o){var b,y,q,c,e,w,g;var M=this.metadata.getPropertyMetadata(f);if(M.isCalendarYearMonth){if(o!==null){b=this.doYearMonthFormat(o);}else{b="";}}else if(M.dataType.type==="Edm.DateTime"){if(o!==null){g=new Date(parseInt(o.slice(6,o.length-2),10));g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.unit){if(o!==null){var h=s.metadata.getPropertyMetadata(M.unit);if(h.semantics==="currency-code"){var p=this.dataResponse[0][M.scale];o=parseFloat(o).toFixed(p).toString();var i=o.split(".");var j=parseFloat(i[0]).toLocaleString();var k=0.1;k=k.toLocaleString();if(j.split(k.substring(1,2)).length>1){j=j.split(k.substring(1,2))[0];}j=j.concat(k.substring(1,2),i[1]);b=j;}else{b=o;}}else{b="-";}}else if(M.isCalendarDate){if(o!==null){y=o.substr(0,4);var l=parseInt(o.substr(4,2),10)-1;var n=o.substr(6,2);g=new Date(y,l,n);g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.isCalendarYearQuarter){if(o!==null){y=o.substr(0,4);q=o.substr(4,1);c=new Date(y);e=c.getFullYear();var r;r="Q"+q;var t=r+" "+e;b=t;}else{b="";}}else if(M.isCalendarYearWeek){if(o!==null){y=o.substr(0,4);w=o.substr(4,2);c=new Date(y);e=c.getFullYear();var u;u="CW"+w;var v=u+" "+e;b=v;}else{b="";}}else{if(o===null){b="null";}else{b=o;}}var x=jQuery.extend({},this.metadata.getPropertyMetadata(f));b=this._applyCustomFormatting(x,f,o,b);return b;};this.doYearMonthFormat=function(f){var j=a.getTextNotHtmlEncoded("month-1-shortName");var b=a.getTextNotHtmlEncoded("month-2-shortName");var c=a.getTextNotHtmlEncoded("month-3-shortName");var e=a.getTextNotHtmlEncoded("month-4-shortName");var g=a.getTextNotHtmlEncoded("month-5-shortName");var h=a.getTextNotHtmlEncoded("month-6-shortName");var i=a.getTextNotHtmlEncoded("month-7-shortName");var k=a.getTextNotHtmlEncoded("month-8-shortName");var l=a.getTextNotHtmlEncoded("month-9-shortName");var o=a.getTextNotHtmlEncoded("month-10-shortName");var n=a.getTextNotHtmlEncoded("month-11-shortName");var p=a.getTextNotHtmlEncoded("month-12-shortName");var q=[j,b,c,e,g,h,i,k,l,o,n,p];var y=f.substr(0,4);var r=q[f.substr(4,6)-1];return r+" "+y;};this.isAmountField=function(f){var i=false;if(this.metadata&&this.dataResponse){var M=this.metadata.getPropertyMetadata(f);if(M!==undefined&&M.unit){var c=this.metadata.getPropertyMetadata(M.unit);if(c!==undefined&&c.semantics==="currency-code"){i=true;}}}return i;};this.getPrecision=function(f){var M=this.metadata.getPropertyMetadata(f);if(M!==undefined&&this.dataResponse!==undefined&&this.dataResponse[0]!==undefined){return this.dataResponse[0][M.scale];}};this.getFormatString=function(b){var z="";var f;var c=b.fieldName;var e=this.isAmountField(c);if(e===true){var p=this.getPrecision(c);if(p!==undefined){for(var i=0;i<p;i++){z=z+"0";}f="#,#0"+"."+z;}else{f="";}}else{f="";}return f;};this.getFormattedValueForTextProperty=function(f,t){var F;if(t.key){F=t.text+"("+t.key+")";}else{F=t.text;}var b=jQuery.extend({},this.metadata.getPropertyMetadata(f));F=this._applyCustomFormatting(b,f,t.text,F);return F;};this._applyCustomFormatting=function(b,f,o,c){var e=a.getEventCallback(sap.apf.core.constants.eventTypes.format);if(typeof e==="function"){var g=e.apply(a,[b,f,o,c]);if(g!==undefined){c=g;}if(g===null){c="";}}return c;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizDatasetHelper");sap.apf.ui.representations.utils.VizDatasetHelper=function(i){var g=function(k){var n;var s=sap.apf.core.constants.representationMetadata.kind;if(!i){if(k===s.LEGEND){n=2;}else if(k===s.XAXIS||k===s.SECTORCOLOR){n=1;}}else{if(k===s.REGIONCOLOR){n=1;}else if(k===s.REGIONSHAPE){n=2;}}return n;};this.getDataset=function(p){this.parameter=p;var d=[];var m=[];this.parameter.dimensions.forEach(function(a,b){if(a.kind!==undefined){d[b]={name:a.name,value:'{'+a.value+'}',axis:g(a.kind)};}else{d[b]={name:a.name,value:'{'+a.value+'}',axis:b===0?1:2};}});this.parameter.measures.forEach(function(a,b){var A;if(i){A=sap.apf.ui.utils.CONSTANTS.axisTypes.GROUP;}else{A=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;}if(a.kind!==undefined){m[b]={name:a.name,value:'{'+a.value+'}'};var s=sap.apf.core.constants.representationMetadata.kind;switch(a.kind){case s.XAXIS:m[b][A]=1;break;case s.YAXIS:if(!i){m[b][A]=1;}else{m[b][A]=2;}break;case s.SECTORSIZE:m[b][A]=1;break;case s.BUBBLEWIDTH:m[b][A]=3;break;case s.BUBBLEHEIGHT:m[b][A]=4;break;}}else{m[b]={name:a.name,value:'{'+a.value+'}'};m[b][A]=b+1;}});var f={dimensions:d,measures:m,data:{path:"/data"}};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizFrameDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizFrameDatasetHelper");sap.apf.ui.representations.utils.vizFrameDatasetHelper=function(i){var g=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var f=sap.apf.core.constants.vizFrame.feedItemTypes;var a;switch(k){case s.XAXIS:if(!i){a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;}else{a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}break;case s.YAXIS:if(!i){a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}else{a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;}break;case s.SECTORCOLOR:case s.LEGEND:case s.REGIONCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.SECTORSIZE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SIZE;break;case s.REGIONSHAPE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;break;case s.BUBBLEWIDTH:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH;break;case s.BUBBLEHEIGHT:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGHT;break;}return a;};this.getDataset=function(p){this.parameter=p;var d=[];var m=[];this.parameter.dimensions.forEach(function(a,b){if(a.kind!==undefined){d[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:g(a.kind)};}else{d[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:a.axisfeedItemId};}});this.parameter.measures.forEach(function(a,b){if(a.kind!==undefined){m[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:g(a.kind)};}else{m[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:a.axisfeedItemId};}});var f={dimensions:d,measures:m,data:{path:"/data"}};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.constants')){jQuery.sap.declare("sap.apf.ui.utils.constants");sap.apf.ui.utils.CONSTANTS={step:{OPEN_OVERLAY_IMAGE_HEIGHT:15,DROP_MARKER_HEIGHT:1},representationTypes:{FORM_REPRESENTATION:"FormRepresentation",TABLE_REPRESENTATION:"TableRepresentation",COLUMN_CHART:"ColumnChart",LINE_CHART:"LineChart",PIE_CHART:"PieChart",GEO_MAP:"GeoMap",STACKED_COLUMN_CHART:"StackedColumnChart",SCATTERPLOT_CHART:"ScatterPlotChart",PERCENTAGE_STACKED_COLUMN_CHART:"PercentageStackedColumnChart",BUBBLE_CHART:"BubbleChart"},vizChartTypes:{COLUMN:"Column",LINE:"Line",PIE:"Pie",STACKED_COLUMN:"StackedColumn",PERCENTAGE_STACKED_COLUMN:"StackedColumn100",SCATTERPLOT:"Scatter",BUBBLE:"Bubble"},vizFrameChartTypes:{COLUMN:"column",LINE:"line",PIE:"pie",STACKED_COLUMN:"stacked_column",PERCENTAGE_STACKED_COLUMN:"100_stacked_column",SCATTERPLOT:"scatter",BUBBLE:"bubble"},axisTypes:{AXIS:"axis",GROUP:"group"},thumbnailDimensions:{HEIGHT:"75px",WIDTH:"180px",STEP_WIDTH:"202px",STEP_HEIGHT:"170px",STEP_MARGIN:"20px",SEPARATOR_HEIGHT:"25px",REMOVE_ICON_HEIGHT:"20px",TOTAL_STEP_HEIGHT:215},printChartDimensions:{WIDTH:"0.89",POTRAITWIDTH:"793.700787402",LANDSCAPEWIDTH:"1122.519685039"},analysisPathArea:{HEADERHEIGHT:140},chartArea:{CHARTHEADERHEIGHT:120},carousel:{SCROLLCONTAINER:275,DNDBOX:280},landingPage:"landingPage"};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterHandler')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.utils.facetFilterHandler');jQuery.sap.require('sap.ui.thirdparty.d3');sap.apf.ui.utils.FacetFilterHandler=function(i){"use strict";var c=i.oCoreApi;var s=i.oSBHandler;var p=i.oPathContextHandler;var u=i.oUiApi;var f=[];var m=i.mode;var S=[];var F=[];var C=[];var o={};var a;var b;this.initialize=function(){f=c.getFacetFilterConfigurations();if(s){s.initialize();b=s.getAllFilters();b.then(this._prepareContext.bind(this));}else{this._prepareContext([]);}};this._prepareContext=function(d){if(m!=="backward"){this._setSBFilters(d);this._setFacetFiltersFromConfiguration();this._setConsolidatedFilters();this._setContextFilterMap();this._updatePathContextHandler();}else{u.contextChanged();}};this._setSBFilters=function(d){S=d;};this._setFacetFiltersFromConfiguration=function(){var d=this;f.forEach(function(e){if(d._isPresentInSbFilters(e.property)){return;}if(e.preselectionDefaults||e.preselectionFunction){var v=e.preselectionDefaults&&e.preselectionDefaults.length&&e.preselectionDefaults;var V;if(!v){V=e.preselectionFunction&&e.preselectionFunction.call();}var g=v||V||[];g.forEach(function(h){var j={NAME:e.property,OPERATOR:"EQ",VALUE_1:h,VALUE_2:null};F.push(j);});}});};this._setConsolidatedFilters=function(){C=[].concat(S,F);};this._setContextFilterMap=function(){C.forEach(function(d){if(!o[d.NAME]){o[d.NAME]=[];}o[d.NAME].push({OPERATOR:d.OPERATOR,VALUE_1:d.VALUE_1,VALUE_2:d.VALUE_2});});o=d3.map(o);};this._updatePathContextHandler=function(){o.forEach(function(d,e){var g=c.createFilter();var h=g.getTopAnd().addOr(d);e.forEach(function(E){var j={name:d,operator:E.OPERATOR,value:E.VALUE_1};if(E.OPERATOR==="BT"){j.high=E.VALUE_2;}h.addExpression(j);});p.update(d,g);});p.saveInitialContext();u.contextChanged();};this._isPresentInSbFilters=function(d){var e=S.map(function(h){return h.NAME;});var g=e.indexOf(d);return g!==-1;};this._drawFacetFilter=function(d){if(f&&f.length){a=sap.ui.view({viewName:"sap.apf.ui.reuse.view.facetFilter",type:sap.ui.core.mvc.ViewType.JS,viewData:{oCoreApi:c,oUiApi:u,oPathContextHandler:p,aFacetFilterListData:f}});d.addItem(a);}};this.drawFacetFilter=function(d){var e=this;if(f.length){if(s){b.then(function(){e._drawFacetFilter(d);});}else{e._drawFacetFilter(d);}}};this.contextChanged=function(){if(a){a.onContextChanged.call();}};this.getFormattedFilters=function(P){if(a){return a.getFormattedFilters(P);}};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.helper')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.utils.helper');sap.apf.ui.utils.Helper=function(c){"use strict";this.oCoreApi=c;this.getRepresentationSortInfo=function(r){var s=this;var C=r.parameter.dimensions.concat(r.parameter.measures);var S=r.parameter.orderby;var a=S.map(function(o){var b;C.forEach(function(d){if(o.property===d.fieldName&&s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc)){b=s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc);return;}});if(!b){s.oCoreApi.getMetadataFacade().getProperty(o.property,function(m){if(m.label){b=m.label?m.label:(m.name?m.name:"");}});}return b;});return a.join(",");};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.print')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.utils.print");sap.apf.ui.utils.PrintHelper=function(I){"use strict";this.oCoreApi=I.oCoreApi;this.oUiApi=I.uiApi;this.oPathContextHandler=I.oPathContextHandler;this.printLayout=function(s,i,a){var m;var d=new Date();var b=this.oCoreApi.getApplicationConfigProperties().appName;if(!b){m=this.oCoreApi.createMessageObject({code:"6003",aParameters:["appName"]});this.oCoreApi.putMessage(m);}var c=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var h=new sap.ui.core.HTML({content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+this.oCoreApi.getTextHtmlEncoded(b)+' : '+jQuery.sap.encodeHTML(c)+'</p>','<p class="printHeaderDate"> '+d.toTimeString()+' </p></div><div class="clear"></div>','<div class="printChipName"><p>'+this.oCoreApi.getTextHtmlEncoded("print-step-number",[i,a])+'</p></div>'].join("")});var e=new sap.ui.layout.VerticalLayout();var S=this.oCoreApi.getTextNotHtmlEncoded(s.title);var f=s.getSelectedRepresentation();var g=f.bIsAlternateView?f.toggleInstance:f;if(f.bIsAlternateView){var j=s.getSelectedRepresentation().getData();var k=s.getSelectedRepresentation().getMetaData();g.setData(j,k);}var r={};if(g.type==="TableRepresentation"){r=g.getPrintContent(S);r.setWidth("1000px");}else{r=g.getPrintContent(S);}if(g.bIsLegendVisible===false){if(r.setLegend!==undefined){r.setLegend(new sap.viz.ui5.types.legend.Common({visible:false}));}if(r.setSizeLegend!==undefined){r.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:false}));}}else{if(r.setLegend!==undefined){r.setLegend(new sap.viz.ui5.types.legend.Common({visible:true}));}if(r.setSizeLegend!==undefined){r.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:true}));}}e.addContent(r);var p=new sap.ui.layout.VerticalLayout({content:[h,e]}).addStyleClass("representationContent");return p;};this.formatter=function(m,v){var d=function(o){var p=this.oCoreApi.getTextNotHtmlEncoded("month-1-shortName");var r=this.oCoreApi.getTextNotHtmlEncoded("month-2-shortName");var s=this.oCoreApi.getTextNotHtmlEncoded("month-3-shortName");var t=this.oCoreApi.getTextNotHtmlEncoded("month-4-shortName");var u=this.oCoreApi.getTextNotHtmlEncoded("month-5-shortName");var x=this.oCoreApi.getTextNotHtmlEncoded("month-6-shortName");var z=this.oCoreApi.getTextNotHtmlEncoded("month-7-shortName");var A=this.oCoreApi.getTextNotHtmlEncoded("month-8-shortName");var B=this.oCoreApi.getTextNotHtmlEncoded("month-9-shortName");var C=this.oCoreApi.getTextNotHtmlEncoded("month-10-shortName");var D=this.oCoreApi.getTextNotHtmlEncoded("month-11-shortName");var E=this.oCoreApi.getTextNotHtmlEncoded("month-12-shortName");var F=[p,r,s,t,u,x,z,A,B,C,D,E];var G=o.substr(0,4);var H=F[o.substr(4,6)-1];return H+" "+G;};var f,y,q,a,b,w,c;if(m.getAttribute("isCalendarYearMonth")){if(originalFieldValue===null){return"";}f=d(v);}else if(m.type==="Edm.DateTime"){if(v===null){return"-";}c=new Date(parseInt(v.slice(6,v.length-2),10));c=c.toLocaleDateString();if(c==="Invalid Date"){return"-";}f=c;}else if(m.getAttribute("isCalendarDate")){if(v===null){return"-";}y=v.substr(0,4);var e=(parseInt((v.substr(4,2)),10)-1).toString();var g=v.substr(6,2);c=new Date(y,e,g);c=c.toLocaleDateString();if(c==="Invalid Date"){return"-";}f=c;}else if(m.getAttribute("isCalendarYearQuarter")){if(v===null){return"";}y=v.substr(0,4);q=v.substr(4,1);a=new Date(y);b=a.getFullYear();var h;h="Q"+q;var i=h+" "+b;f=i;}else if(m.getAttribute("isCalendarYearWeek")){if(v===null){return"";}y=v.substr(0,4);w=v.substr(4,2);a=new Date(y);b=a.getFullYear();var j;j="CW"+w;var k=j+" "+b;f=k;}else{if(v===null){return"null";}f=v;}var l=this.oUiApi.getEventCallback(sap.apf.core.constants.eventTypes.format);if(typeof l==="function"){var n=l.apply(this.oUiApi,[m,m.name,v,f]);if(n!==undefined){f=n;}if(n===null){f="";}}return f;};this.doPrint=function(){this.oUiApi.createApplicationLayout(false).setBusy(true);var a=this.oCoreApi.getSteps();var s=new sap.ui.layout.VerticalLayout();var d="";var p=2000;var t=this;var b=new Date();var c=this.oCoreApi.getApplicationConfigProperties().appName;var e=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();jQuery('#apfPrintArea').remove();jQuery("body").append('<div id="apfPrintArea"></div>');var f;var g=this.oUiApi.getEventCallback(sap.apf.core.constants.eventTypes.printTriggered);var h=this.oPathContextHandler?this.oPathContextHandler.getAllIds():[];var l=[];if(h.length>0){for(var i=0;i<h.length;i++){var F=[this.oUiApi.getFormattedFilters(h[i])];if(!F[0]){F=this.oPathContextHandler.get(h[i]).getExpressions();}l.push(F[0]);}}else{l=this.oCoreApi.getContext().getExpressions();}var m=function(A){var B=[];var C=[];for(var i=0;i<l.length;i++){for(var j=0;j<l[i].length;j++){var D=l[i][j];if(!D.formatted){var w="";var E="";A.oCoreApi.getMetadataFacade().getProperty(l[i][j].name,function(o){w=o.label;E=A.formatter(o,l[i][j].value);});D["name"]=w;D["value"]=E;}B.push(D);}C.push(B);B=[];}return C;};var n={getTextNotHtmlEncoded:t.oCoreApi.getTextNotHtmlEncoded};if(g!==undefined){var q=g.apply(n,[l])||[];f=(q.length>0)?q:m(this);}else{f=m(this);}var r=new sap.ui.core.HTML({content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+this.oCoreApi.getTextHtmlEncoded(c)+' : '+jQuery.sap.encodeHTML(e)+'</p>','<p class="printHeaderDate"> '+b.toTimeString()+' </p></div><div class="clear"></div>'].join("")});var u=new sap.ui.layout.VerticalLayout();var v="";var w="";var i,j;for(i=0;i<f.length;i++){for(j=0;j<f[i].length;j++){w=f[i][j].name;if(j!==f[i].length-1){v+=f[i][j].value+", ";}else{v+=f[i][j].value;}}var x=new sap.m.Text({text:w}).addStyleClass("printFilterName");var y=new sap.m.Text({text:v}).addStyleClass("printFilterValue");u.addContent(x);u.addContent(y);v="";}var P=new sap.ui.layout.VerticalLayout({content:[r,u]}).addStyleClass("representationContent");s.addContent(P);var k;for(k=0;k<a.length;k++){var z=parseInt(k,10)+1;s.addContent(this.printLayout(a[k],z,a.length));}s.placeAt("apfPrintArea");if(jQuery(".v-geo-container").length){p=4000;}window.setTimeout(function(){t.oUiApi.createApplicationLayout(false).setBusy(false);},p-150);window.setTimeout(function(){jQuery("#"+s.sId+" > div").after("<div class='page-break'> </div>");d=s.getDomRef();var o=jQuery('#apfPrintArea .sapUiTable');if(o.length){var A=jQuery('#apfPrintArea .printTable .sapMListTblHeader .sapMListTblCell').length;if(A>11){jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode' > @media print and (min-resolution: 300dpi) { @page {size : landscape;}}</style>").appendTo("head");}else{jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode'>@media print and (min-resolution: 300dpi) { @page {size : portrait;}}</style>").appendTo("head");}}jQuery("#apfPrintArea").empty();jQuery("#sap-ui-static > div").hide();jQuery("#apfPrintArea").append(jQuery(d).html());var i;for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=true;}window.print();window.setTimeout(function(){for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=false;}s.destroy();},10);},p);};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.promiseBasedCreateReadRequest')){jQuery.sap.declare('sap.apf.ui.utils.promiseBasedCreateReadRequest');sap.apf.ui.utils.PromiseBasedCreateReadRequest=function(c,r,f){var d=new jQuery.Deferred();var R=c.createReadRequestByRequiredFilter(r);var C=function(D,m){var a={aData:D,oMetadata:m};if(D&&m){d.resolveWith(this,[a]);}else{d.rejectWith(this,[a]);}};if(!f){f=c.createFilter();}R.send(f,C);return d.promise();};};if(!jQuery.sap.isDeclared('sap.apf.utils.hashtable')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.hashtable');(function(){'use strict';sap.apf.utils.Hashtable=function(m){var n=0;var i={};var o=[];this.type="hashTable";this.setItem=function(k,v){var p;m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.setItem: key undefined");m.check((v!==undefined&&v!==null),"sap.apf.utils.HashTable.setItem: value undefined");if(this.hasItem(k)){p=i[k];}else{n++;o.push(k);}i[k]=v;return p;};this.getNumberOfItems=function(){return n;};this.getItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.getItem key undefined");return this.hasItem(k)?i[k]:undefined;};this.hasItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.hasItem key undefined");return i.hasOwnProperty(k);};this.removeItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.removeItem key undefined");var I;if(this.hasItem(k)){I=i[k];n--;o.splice(o.indexOf(k),1);delete i[k];return I;}return undefined;};this.getKeys=function(){var K=[];var k;for(k in i){if(this.hasItem(k)){K.push(k);}}return K;};this.each=function(f){var k;for(k in i){if(this.hasItem(k)){f(k,i[k]);}}};this.forEachOrdered=function(f){var t=this;o.forEach(function(k){if(!t.hasItem(k)){m.check(false,"sap.apf.utils.HashTable.forEachOrdered: key not contained");}else{f(k,i[k]);}});};this.getKeysOrdered=function(){var l=[];this.forEachOrdered(function(k){l.push(k);});return l;};this.moveUpOrDown=function(a,d){m.check((a!==undefined&&a!==null),"sap.apf.utils.HashTable.moveItemUpOrDown movedKey undefined");var b=o.indexOf(a);var c=b+d;if(b<0){return null;}if(d<0){o.splice(b,1);if(c<0){o.splice(0,0,a);return 0;}else{o.splice(b+d,0,a);return b+d;}}else if(d===0){return b;}else if(d>0){o.splice(b,1);if(c>=o.length){o.splice(o.length,0,a);return o.length;}else{o.splice(c,0,a);return c;}}};this.moveBefore=function(b,a){if(o.indexOf(b)<0||o.indexOf(a)<0){return null;}if(b===a){return o.indexOf(a);}o.splice(o.indexOf(a),1);o.splice(o.indexOf(b),0,a);return o.indexOf(a);};this.moveToEnd=function(a){if(o.indexOf(a)<0){return null;}o.splice(o.indexOf(a),1);o.push(a);return o.indexOf(a);};this.reset=function(){i={};o=[];n=0;};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.navContainer')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.utils.navContainer');sap.apf.utils.navContainer=sap.apf.utils.navContainer||{};sap.apf.utils.navContainer.pushContent=function(c,a,m,b){if(u()){var d=jQuery.sap.uid();sap.ushell.Container.getService("Personalization").getContainer(a,{validity:0}).done(function(e){e.setItemValue(d,c);e.save();b(d,null);}).fail(function(){p("5039",m,b);});}else{p("5038",m,b);}};sap.apf.utils.navContainer.fetchContent=function(c,a,m,b){if(u()){sap.ushell.Container.getService("Personalization").getContainer(a).done(function(d){var e=d.getItemValue(c);if(e){b(e,null);}else{p("5040",m,b);}}).fail(function(){p("5040",m,b);});}else{p("5038",m,b);}};function u(){if(sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService){return true;}else{return false;}}function p(m,a,c){var b=a.createMessageObject({code:m});a.putMessage(b);c(null,b);}}());};if(!jQuery.sap.isDeclared('sap.apf.utils.navigationHandler')){(function(){'use strict';jQuery.sap.declare("sap.apf.utils.navigationHandler");jQuery.sap.require('sap.ui.core.routing.HashChanger');sap.apf.utils.NavigationHandler=function(I){var n,a;var m=I.instances.messageHandler;this.getFilterFromSelectionVariant=function(s,d){function e(f,g){var h;if(g){d(undefined,g);}else{h=sap.apf.utils.Filter.createFilterFromSapUi5FilterJSON(m,f.Filter);d(h);}}sap.apf.utils.navContainer.fetchContent(s,'sap.apf.selectionVariant',m,e);};this.getNavigationTargets=function(){if(!n){c();}return jQuery.extend(true,[],n);};this.getNavigationTargetsWithText=function(){var d;var e=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var s=[];function f(h,i,t){a.forEach(function(j){if(h===j.semanticObject&&i===j.action){j.text=t;}});}function g(h){var d=jQuery.Deferred();var i=[];if(h===s.length){d=jQuery.Deferred();a.forEach(function(k){if(k.text!==""){i.push(k);}});a=i;d.resolve(a);return d.promise();}var j=s[h];e.getSemanticObjectLinks(j,undefined,false,I.instances.component,undefined).done(function(k){k.forEach(function(l){var o=l.intent.split("-");var p=o[1].split("?");p=p[0].split("~");f(j,p[0],l.text);});g(h+1).done(function(){d.resolve(a);});}).fail(function(){return g(h+1);});return d.promise();}if(a){d=jQuery.Deferred();d.resolve(a);return d.promise();}if(!n){c();}a=jQuery.extend(true,[],n);a.forEach(function(h){h.text="";});n.forEach(function(h){if($.inArray(h.semanticObject,s)===-1){s.push(h.semanticObject);}});d=jQuery.Deferred();g(0).done(function(){d.resolve(a);}).fail(function(){d.resolve(a);});return d.promise();};this.navigateToApp=function(d){if(!n){c();}var i;var l=n.length;var s,p,e,f;var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance();f={sapApfState:I.functions.serializePath()};f.sapApfState.pathContextHandler=I.functions.serializeContext();f.sapApfCumulativeFilter=I.functions.getCumulativeFilterUpToActiveStep().mapToSapUI5FilterExpression();for(i=0;i<l;i++){if(n[i].id===d){s=b(d);sap.apf.utils.navContainer.pushContent(JSON.stringify(s),'sap.apf.selectionVariant',m,function(g,j){if(j){m.putMessage(j);}else{jQuery.sap.log.info("navigation with containerId "+g);}var C=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");if(C){p={'sap-apf-selection-variant-id':g};e=C.createEmptyAppState(I.instances.component);e.setData(f);e.save();if(h){h.replaceHash("sap-iapp-state="+e.getKey());}C.toExternal({target:{semanticObject:n[i].semanticObject,action:n[i].action},params:p,appStateKey:e.getKey()});}});return;}}};this.checkMode=function(){var d=jQuery.Deferred();var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance&&sap.ui.core.routing.HashChanger.getInstance();var i=/(?:sap-iapp-state=)([^&=]+)/;var x=/(?:sap-xapp-state=)([^&=]+)/;var e,f,g,j,k;if(h){g=i.exec(h.getHash());if(g){e=g[1];}}j=x.exec(window.location.hash);if(j){f=j[1];}if(e){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,e).done(function(l){k=l.getData();if(k.sapApfState){I.functions.deserializeContext(k.sapApfState.pathContextHandler);I.functions.deserializePath(k.sapApfState);d.resolve({navigationMode:"backward"});}});}else if(f){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,f).done(function(l){k=l.getData();if(k&&k.sapApfCumulativeFilter){d.resolve({navigationMode:"forward",sapApfCumulativeFilter:k.sapApfCumulativeFilter});}else{d.resolve({navigationMode:"forward"});}});}else{d.resolve({navigationMode:"forward"});}return d.promise();};function b(s){var d=new Date();var f=I.functions.getCumulativeFilterUpToActiveStep();var e=f.mapToSapUI5FilterExpression();return{"SelectionVariantID":s,"Text":"Temporary Selection Variant Producer = APF, "+d.toUTCString(),"Filter":e};}function c(){n=I.functions.getNavigationTargets();}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.pathContextHandler')){jQuery.sap.declare('sap.apf.utils.pathContextHandler');sap.apf.utils.PathContextHandler=function(f,m){var u=1;var c={};var a;this.add=function(e){c[u]=e;f.setContext(b());return u++;};this.update=function(i,e){if(i&&typeof i=='number'){m.check((i>0&&i<u),'Passed unknown numeric identifier during update of path context handler');if(!(i>0&&i<u)){return;}}else if(!i||typeof i!='string'){m.check(i,'Passed false identifier during update of path context handler');return;}c[i]=e;f.setContext(b());};this.get=function(i){switch(typeof i){case'number':m.check((i>0&&i<u),'Passed unknown numeric identifier during get from path context handler');break;case'string':m.check(c[i],'Passed unknown string identifier during get from path context handler');break;}return c[i];};this.getAllIds=function(){var r=[];var p;for(p in c){if(c.hasOwnProperty(p)){r.push(d(p));}}return r;};this.serialize=function(){var s={};var p;for(p in c){if(c.hasOwnProperty(p)){s[p]=c[p].serialize();}}return s;};this.deserialize=function(e){var p;u=1;c={};for(p in e){if(e.hasOwnProperty(p)){c[p]=new sap.apf.utils.Filter(m).deserialize(e[p]);u++;}}if(u>1){f.setContext(b());}return this;};this.saveInitialContext=function(e){var p,i,l;var g={};var h={};if(e){for(p in a){if(a.hasOwnProperty(p)){g[p]=new sap.apf.utils.Filter(m).deserialize(a[p]);}}for(i=0,l=e.length;i<l;i++){g[e[i]]=c[e[i]];}for(p in g){h[p]=g[p].serialize();}a=h;}else{a=this.serialize();}};this.restoreInitialContext=function(i){var e={};var p;if(a){if(i){for(p in c){if(i.indexOf(d(p))==-1){e[p]=c[p];}}}this.deserialize(a);for(p in e){c[p]=e[p];}f.setContext(b());}};function b(){var e=[];for(var g in c){if(c.hasOwnProperty(g)){e.push(c[g]);}}return new sap.apf.utils.Filter(m).intersectWith(e);}function d(p){if(isNaN(Number(p))){return p;}else{return Number(p);}}};};if(!jQuery.sap.isDeclared('sap.apf.utils.serializationMediator')){jQuery.sap.declare("sap.apf.utils.serializationMediator");sap.apf.utils.SerializationMediator=function(i){this.savePath=function(a,b,c){var e={pathContextHandler:i.pathContextHandler.serialize()};if(typeof a==='string'&&typeof b==='function'){i.coreApi.savePath(a,b,e);}else if(typeof a==='string'&&typeof b==='string'&&typeof c==='function'){i.coreApi.savePath(a,b,c,e);}};this.openPath=function(p,c,n){var C=function(r,e,m){if(r&&r.path&&r.path.SerializedAnalysisPath&&r.path.SerializedAnalysisPath.pathContextHandler){i.pathContextHandler.deserialize(r.path.SerializedAnalysisPath.pathContextHandler);delete r.path.SerializedAnalysisPath.pathContextHandler;}c(r,e,m);};i.coreApi.openPath(p,C,n);};this.deletePath=function(p,c){i.coreApi.deletePath(p,c);};this.readPaths=function(c){i.coreApi.readPaths(c);};};};if(!jQuery.sap.isDeclared('sap.apf.utils.smartBusinessHandler')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.smartBusinessHandler');sap.apf.utils.SmartBusinessHandler=function(i){"use strict";var s=this;var c={getApplicationConfigProperties:i.getApplicationConfigProperties,createReadRequestByRequiredFilter:i.createReadRequestByRequiredFilter,getTextNotHtmlEncoded:i.getTextNotHtmlEncoded};var m=i.oMessageHandler;var S=i.startParameter;var d=new jQuery.Deferred();var p=d.promise();var f=[];var P=[];var C=[];var a={FILTER_TYPE:"FI",PARAMETER_TYPE:"PA"};var g=function(){return S.getEvaluationId();};var e=g();this.initialize=function(){p=this._fetchSBData().then(this._pushAllSBFilters);};this.getEvaluationId=function(){return e;};this._fetchSBData=function(){if(e){var b=c.getApplicationConfigProperties().smartBusiness||c.getApplicationConfigProperties().smartBusinessService;var h=b.runtime||b.evaluation;var E=sap.apf.core.constants.entitySets.smartBusiness;var j=[h.service,"/",E,"('",e,"')/FILTERS?$format=json"].join("");if(d.state()==="pending"){jQuery.ajax({url:j,success:function(k){d.resolveWith(s,[k]);},error:function(k,t,l){var M=m.createMessageObject({code:"6011"});m.putMessage(M);}});}}else{d.resolveWith(s,[{d:{results:[]}}]);}return d.promise();};this._pushAllSBFilters=function(b){var h=b.d.results;h.forEach(function(j){if(j.TYPE===a.FILTER_TYPE){f.push(j);}else if(j.TYPE===a.PARAMETER_TYPE){P.push(j);}C.push(j);});return C;};this.getAllFilters=function(){return p;};};};if(!jQuery.sap.isDeclared('sap.apf.utils.startParameter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.utils.startParameter');sap.apf.utils.StartParameter=function(c){var a=null;var s=null;var r=null;var b=null;var d;var e;var f;if(c&&c.getComponentData&&c.getComponentData()&&c.getComponentData().startupParameters){f=c.getComponentData().startupParameters;if(f['sap-apf-configuration-id']){a=f['sap-apf-configuration-id'][0];}if(f['sap-apf-step-id']){s=f['sap-apf-step-id'][0];}if(f['sap-apf-representation-id']){r=f['sap-apf-representation-id'][0];}if(f['sap-apf-selection-variant-id']){b=f['sap-apf-selection-variant-id'][0];}if(f['sap-apf-app-config-path']){d=f['sap-apf-app-config-path'][0];}if(f['evaluationId']){e=f['evaluationId'][0];}}this.getAnalyticalConfigurationId=function(){if(!a){a=jQuery.sap.getUriParameters().get('sap-apf-configuration-id');}return a;};this.getSteps=function(){if(!s){s=jQuery.sap.getUriParameters().get('sap-apf-step-id');}if(!r){r=jQuery.sap.getUriParameters().get('sap-apf-representation-id');}if(!s){return null;}else{return[{stepId:s,representationId:r}];}};this.getSelectionVariantId=function(){if(!b){b=jQuery.sap.getUriParameters().get('sap-apf-selection-variant-id');}return b;};this.getApplicationConfigurationPath=function(){return d;};this.getEvaluationId=function(){return e;};this.getStartUpMode=function(){};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.utils')){jQuery.sap.declare('sap.apf.utils.utils');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.apf.utils.getUriParameters=function(){return jQuery.sap.getUriParameters().mParams;};sap.apf.utils.eliminateDuplicatesInArray=function(m,w){m.check((w!==undefined&&typeof w==='object'&&w.hasOwnProperty('length')===true),'Error - aArray is undefined');var r=[];for(var i=0;i<w.length;i++){for(var j=i+1;j<w.length;j++){if(w[i]===w[j]){j=++i;}}r.push(w[i]);}return r;};sap.apf.utils.hashCode=function(v){var n=0;var i=0;var a=0;v=v+'';var l=v.length;for(i=0;i<l;i++){a=v.charCodeAt(i);n=(17*n+a)<<0;}return n;};sap.apf.utils.escapeOdata=function(v){if(typeof v==="string"){return v.replace("'","''");}else{return v;}};sap.apf.utils.json2javascriptFormat=function(v,t){var i;switch(t){case"Edm.Boolean":if(typeof v==="boolean"){return v;}if(typeof v==="string"){return v.toLowerCase()==="true";}return false;case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.String":return v;case"Edm.Int16":case"Edm.Int32":return parseInt(v,10);case"Edm.Single":case"Edm.Float":return parseFloat(v);case"Edm.Time":return v;case"Edm.DateTime":i=v.replace('/Date(','').replace(')/','');i=parseFloat(i);return new Date(i);case"Edm.DateTimeOffset":i=v.replace('/Date(','');i=i.replace(')/','');i=parseFloat(i);return new Date(i);}return v;};sap.apf.utils.formatValue=function(a,t){function c(v){var b;if(v instanceof Date){return v;}else if(typeof v==='string'){if(v.substring(0,6)==='/Date('){b=v.replace('/Date(','');b=b.replace(')/','');b=parseInt(b,10);return new Date(b);}else{return new Date(v);}}}var d;var f="";if(a===null||a===undefined){return"null";}switch(t){case"Edm.String":f="'"+String(a).replace(/'/g,"''")+"'";break;case"Edm.Time":if(typeof a==='number'){d=new Date();d.setTime(a);var h=d.getUTCHours();if(h<10){h='0'+h;}var m=d.getUTCMinutes();if(m<10){m='0'+m;}var s=d.getUTCSeconds();if(s<10){s='0'+s;}f="time'"+h+':'+m+':'+s+"'";}else{f="time'"+a+"'";}break;case"Edm.DateTime":if(!sap.apf.utils.formatValue.oDateTimeFormat){sap.apf.utils.formatValue.oDateTimeFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetime'''yyyy-MM-dd'T'HH:mm:ss''"});}d=c(a);f=sap.apf.utils.formatValue.oDateTimeFormat.format(d,true);break;case"Edm.DateTimeOffset":if(!sap.apf.utils.formatValue.oDateTimeOffsetFormat){sap.apf.utils.formatValue.oDateTimeOffsetFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetimeoffset'''yyyy-MM-dd'T'HH:mm:ss'Z'''"});}d=c(a);f=sap.apf.utils.formatValue.oDateTimeOffsetFormat.format(d,true);break;case"Edm.Guid":f="guid'"+a+"'";break;case"Edm.Decimal":f=a+"M";break;case"Edm.Int64":f=String(a)+"L";break;case"Edm.Single":f=a+"f";break;case"Edm.Binary":f="binary'"+a+"'";break;default:f=a;break;}return f;};sap.apf.utils.extractFunctionFromModulePathString=function(f){if(jQuery.isFunction(f)){return f;}var d,n,F;n=f.split('.');d=window;for(var i=0;i<n.length-1;i++){d=d[n[i]]?d[n[i]]:undefined;if(!d){return;}}F=n[n.length-1];return d[F];};sap.apf.utils.isValidGuid=function(g){return/^[0-9A-F]{32}$/.test(g);};sap.apf.utils.migrateConfigToCategoryStepAssignment=function(a,i){var c=new i.constructor.hashtable(i.instance.messageHandler);if(a.steps){a.steps.forEach(function(s){if(s.categories){s.categories.forEach(function(b){var d=c.getItem(b.id);if(!d){d={category:b.id,steps:[{type:"step",id:s.id}]};c.setItem(b.id,d);}else{d.steps.push({type:"step",id:s.id});}});delete s.categories;}});}if(a.categories){a.categories.forEach(function(b){if(!b.steps){var d=c.getItem(b.id);if(d){b.steps=d.steps;}else{b.steps=[];}}});}};};if(!jQuery.sap.isDeclared('sap.apf.core.ajax')){jQuery.sap.declare("sap.apf.core.ajax");sap.apf.core.ajax=function(s){var a=jQuery.extend(true,{},s);var b=a.beforeSend;var S=a.success;var e=a.error;a.beforeSend=function(j,c){if(b){b(j,c);}};a.success=function(d,t,j){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(d,"error",undefined,m);}else{S(d,t,j);}};a.error=function(j,t,c){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(j,t,c,m);}else{e(j,t,c);}};return jQuery.ajax(a);};};if(!jQuery.sap.isDeclared('sap.apf.core.messageHandler')){jQuery.sap.declare("sap.apf.core.messageHandler");sap.apf.core.MessageHandler=function(l){var t=this;var T;var L=[];var n=0;var a;var m;var A=function(){};var o=false;var d=false;var D=false;var h=false;var u="";var b={code:sap.apf.core.constants.message.code.errorUnknown,severity:sap.apf.core.constants.message.severity.error,rawText:"Unknown Error occurred"};this.createMessageObject=function(C){if(l){var M=new sap.apf.core.MessageObject(C);if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}k.bind(this)(M);p(M,1);}return new sap.apf.core.MessageObject(C);};this.activateOnErrorHandling=function(O){o=O;if(o===true){jQuery(window).on("error",r);}else{jQuery(window).off("error");}};this.setTextResourceHandler=function(i){T=i;};this.loadConfig=function(M,R){if(a===undefined||R){a=new sap.apf.utils.Hashtable(t);}for(var i=0;i<M.length;i++){q(M[i]);}};this.setMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){m=C;}else{m=undefined;}};this.setApplicationMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){A=C;}else{A=function(){};this.putMessage(this.createMessageObject({code:"5031"}));}};this.putMessage=function(M){var P;var i=0;var w;if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}k.bind(this)(M);if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){w=t.createMessageObject({code:sap.apf.core.constants.message.code.errorExitTriggered});k.bind(this)(w);w.setSeverity(sap.apf.core.constants.message.severity.fatal);if(w.getMessage()===""){w.setMessage("You must log out of the application due to a critical error");}}P=M.getPrevious();while(P!==undefined&&P.type&&P.type==="messageObject"&&i<10){if(P.getCode()===undefined){P.setCode(sap.apf.core.constants.message.code.errorUnknown);}k.bind(this)(P);P=P.getPrevious();i++;}if(w!==undefined){w.setPrevious(M);M=w;}if(!l){p(M,10);}if(d){return;}if(m!==undefined){d=true;m(M,A);d=false;}if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(sap.ui.Device.browser.firefox){h=true;}throw new Error(u);}};this.check=function(i,M,C){var E=C||sap.apf.core.constants.message.code.errorCheck;if(!i){var w=this.createMessageObject({code:E,aParameters:[M]});t.putMessage(w);}};this.getConfigurationByCode=function(E){if(a===undefined){return undefined;}return a.getItem(E);};this.getLogMessages=function(){return jQuery.extend(true,[],L);};this.reset=function(){a=undefined;m=undefined;A=undefined;L=[];};function c(E){if(sap.ui.Device.browser.firefox){return h;}return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)>-1);}function e(E){return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)===-1&&E.originalEvent.message.search(sap.apf.core.constants.message.code.suppressFurtherException)>-1);}function g(){var i=new Date();var w=Math.random()*i.getTime();return sap.apf.core.constants.message.code.suppressFurtherException+w;}function f(C){var N=parseInt(C,10);if(N==sap.apf.core.constants.message.code.errorExitTriggered){return true;}else if(N>=sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.errorInAnalyticalConfig){return true;}return false;}function j(C){var N=parseInt(C,10);if(N>sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.errorInAnalyticalConfig){return true;}return false;}function k(M){var C=M.getCode();var i=t.getConfigurationByCode(C);if(i===undefined){i=jQuery.extend(true,{},b);if(f(C)){if(M.hasRawText()){i.rawText=M.getRawText();}i.rawText+=' '+M.getParameters();if(j(C)){i.severity=sap.apf.core.constants.message.severity.fatal;}}else{i.rawText="Message "+C+"  "+M.getParameters()+" (Message Code has no Configuration)";}if(!f(C)){M.setCode(i.code);}}if(i.severity!==undefined){M.setSeverity(i.severity);}else{M.setSeverity(sap.apf.core.constants.message.severity.technError);}if(i.rawText){M.setMessage(i.rawText);}else{var P=M.getParameters();if(M.getSeverity()===sap.apf.core.constants.message.severity.technError){var w=t.getConfigurationByCode(i.code).text;if(!w){w=t.getConfigurationByCode(i.code).description;}var x=0;while(w.indexOf("{"+x+"}")>-1){if(typeof P[x]==="string"){w=w.replace("{"+x+"}",P[x]);}else{w=w.replace("{"+x+"}","undefined");}x++;}M.setMessage(w);}else{try{if(T){M.setMessage(T.getMessageText(i.key,M.getParameters()));}else{M.setMessage("Message Code: "+C+" "+P.toString());}}catch(E){M.setMessage("Message Code: "+C+" "+P.toString());}}}}function p(M,i){var w="APF message ";var P="";var x=i-1;if(i===0){return;}var y=M.getPrevious();if(y!==undefined){p(y,x);P=" - (see previous message for more information)";}n++;var z=w+'('+n+'): '+M.getCode()+" - "+M.getMessage()+P;if(D){alert("Fatal Error during Log Writing "+z);return;}D=true;if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(L.length<2){L.unshift(z);}}switch(M.getSeverity()){case sap.apf.core.constants.message.severity.warning:jQuery.sap.log.warning(z);break;case sap.apf.core.constants.message.severity.error:jQuery.sap.log.error(z);break;case sap.apf.core.constants.message.severity.fatal:jQuery.sap.log.error(z);break;case sap.apf.core.constants.message.severity.technError:jQuery.sap.log.error(z);break;default:jQuery.sap.log.info(z);}D=false;}function s(i){t.check(i!==undefined&&i.hasOwnProperty("code")!==false,"MessageHandler setItem: oItem is undefined or property 'code' is missing",sap.apf.core.constants.message.code.errorStartUp);var w=a.setItem(i.code,i);t.check((w===undefined),"MessageHandler setItem: Configuration includes duplicated codes",sap.apf.core.constants.message.code.errorStartUp);}function q(M){if(M.type===undefined){M.type="message";}s(M);}function r(E){var M;var i="";var w="";var U="";var x="";var B=true;if(sap.ui.Device.browser.firefox){B=false;}if(B&&E&&E.originalEvent){i=E.originalEvent.message;U=E.originalEvent.filename;w=E.originalEvent.lineno;}if(c(E)){E.stopImmediatePropagation();E.preventDefault();}else if(e(E)){return;}else if(d){M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorStopProcessing});M.setSeverity(sap.apf.core.constants.message.severity.error);x="Unknown exception happened during processing of error by callback function ";if(B){x=x+i+" (source: "+U+":"+w+")";}M.setMessage(x);p(M,1);}else{M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});M.setSeverity(sap.apf.core.constants.message.severity.error);x="Unknown exception ";if(B){x=x+i+" (source: "+U+":"+w+")";}M.setMessage(x);p(M,1);}}function v(){u=g();}v();};};if(!jQuery.sap.isDeclared('sap.apf.core.metadata')){jQuery.sap.declare("sap.apf.core.metadata");sap.apf.core.Metadata=function(I,a){'use strict';this.type="metadata";var t=this;var b=false;var c=I.coreApi;var m;var A;var e;var h=new I.hashtable(I.messageHandler);var H=new I.hashtable(I.messageHandler);var o=new I.hashtable(I.messageHandler);var d=new I.hashtable(I.messageHandler);var f=new I.hashtable(I.messageHandler);var g=new I.hashtable(I.messageHandler);var O=I.ODataModel||sap.ui.model.odata.ODataModel;var D=false;if(I.deactivateFatalError){D=true;}function l(){if(!e){e=[];m.dataServices.schema.forEach(function(i){i.entityType.forEach(function(j){e.push(j.name);});});}return e;}function n(){I.messageHandler.check(m!==undefined,'sap.apf.metadata - oMetadata is undefined');I.messageHandler.check(m.dataServices,'sap.apf.metadata - oMetadata.dataServices is undefined');I.messageHandler.check(m.dataServices.schema!==undefined,'sap.apf.metadata - oMetadata.dataServices.schema is undefined');I.messageHandler.check(A!==undefined,'sap.apf.metadata - oAnnotation is undefined');}function p(i,j){var k=false,M;m.dataServices.schema.forEach(function(S){S.entityType.forEach(function(N){var P=N.extensions;if(P&&N.name.indexOf(i)>-1){P.forEach(function(Q){if(k){return;}if((Q.name==="semantics")&&((j&&Q.value==="aggregate")||(!j&&Q.value==="parameters"))){k=true;M=N;}});}});});if(k){return M;}return{property:[]};}function q(i,j){var k={},M=false,N;if(!i||(!A.propertyAnnotations)){return{};}var P='Results';if(i.indexOf(P,i.length-P.length)!==-1){i=i.substring(0,i.length-P.length);}jQuery.each(A.propertyAnnotations,function(Q,R){if(M){return;}N=Q.split(".").pop().toString();if(N===i||N.indexOf((i+(j?"ResultsType":"Type")))>-1){M=true;k=A.propertyAnnotations[Q];return;}}.bind(t));return k;}function r(i){function j(M){if(!i.dataType){i.dataType={};}i.dataType[M]=i[M];delete i[M];}function k(M,N){if(jQuery.isArray(i[N])===true){(i[N]).forEach(function(P){i[P.name]=P.value;});delete i[N];}else if(N!=="dataType"&&typeof(i[N])==="object"){if(Object.keys(i[N]).length===0){i[M]="true";}jQuery.each(i[N],function(P,Q){i[M]=Q;});delete i[N];}else{i[M]=i[N];}}jQuery.each(i,function(P){switch(P){case'type':j(P);break;case'maxLength':j(P);break;case'precision':j(P);break;default:var M=P.split(".").pop();if(M.search("ISO")===0){k(M,P);}else{k(M.replace(/^./,M[0].toLowerCase()),P);}break;}});return i;}function s(j,k){if(d.hasItem(j)!==true){n();var M=p(j,false);var N=q(j,false);var P={};if(M.key&&M.key.propertyRef){M.key.propertyRef.forEach(function(W){P[W.name]=null;});}var Q={};var R={allParameters:[],keyParameters:[]};var i,S,T;for(i=0;i<M.property.length;i++){S=M.property[i];S.isKey=P.hasOwnProperty(S.name);T=N[S.name];if(T!==undefined){S=jQuery.extend(S,T);}Q[S.name]=S;}var U,V;for(U in Q){V=r(Q[U]);R.allParameters.push(V);if(V.isKey){R.keyParameters.push(V);}}d.setItem(j,R);}if(!k){return d.getItem(j).allParameters;}return d.getItem(j).keyParameters;}function u(i){var P=[];var j=z(i);if(j){i=E(i);}var k=p(i,true);k.property.forEach(function(M){P.push(M.name);});return P;}function v(j){var i;if(o.hasItem(j)===true){return o.getItem(j);}var k=[];var P=[];var M=[];var N=E(j);var Q=p(N,true);for(i=0;i<Q.property.length;i++){P.push(Q.property[i].name);}var R=s(j,false);for(i=0;i<R.length;i++){M.push(R[i].name);}k=P.concat(M);o.setItem(j,k);return o.getItem(j);}function w(i){var j;if(y(i)){j=i;}else{j=g.getItem(i);j=j||g.getItem(i+"Results");}return j;}function x(k){if(H.hasItem(k)===true){return H.getItem(k);}n();var R=[];var M=p(k,true);var N=q(k,true);for(var i=0;i<M.property.length;i++){var P=M.property[i];if(P.extensions&&P.extensions){var Q=true;for(var j=0;j<P.extensions.length;j++){var S=P.extensions[j];if(S.name==="filterable"&&S.value==="false"){Q=false;break;}}if(Q){R.push(P.name);}}}for(var T in N){if(N[T]&&N[T].filterable&&N[T].filterable==="true"){R.push(T);}}H.setItem(k,R);return H.getItem(k);}function y(i){var e=l();return(jQuery.inArray(i,e)>-1);}function z(M){var N;var P;for(var i=0;i<m.dataServices.schema.length;i++){for(var j=0;j<m.dataServices.schema[i].entityType.length;j++){N=m.dataServices.schema[i].entityType[j].name.split(".").pop();if(N===M){P=m.dataServices.schema[i].entityType[j].extensions;if(!P){return false;}for(var k=0;k<P.length;k++){if(P[k].name==="semantics"){return(P[k].value==="parameters");}}}}}}function B(i){for(var j in A){if(j.split(".").pop().toString().indexOf(i)>-1){return A[j];}}return{};}function C(i,P){var j;var k=z(i);if(k){j=E(i);}if(h.hasItem(i+P)===true){return h.getItem(i+P);}else{n();var M=p(i,!k);var N=q(i,!k);var Q;var R=G(M,P);if(R&&R.name){Q=J(N,P);}else{M=p(j,true);R=G(M,P);N=q(j,true);Q=J(N,P);}var S=K(Q,R);h.setItem(i+P,r(S));return h.getItem(i+P);}}function E(k){var M;for(var i=0;i<m.dataServices.schema.length;i++){for(var j=0;j<m.dataServices.schema[i].entityType.length;j++){M=m.dataServices.schema[i].entityType[j];if(M.name===k){if(M.navigationProperty&&M.navigationProperty.length>0){return F(M.navigationProperty[0].relationship,M.navigationProperty[0].toRole);}else{return k;}}}}return k;}function F(M,N){var P;var Q=M.split(".").pop();for(var i=0;i<m.dataServices.schema.length;i++){for(var j=0;j<m.dataServices.schema[i].association.length;j++){P=m.dataServices.schema[i].association[j];if(P.name===Q){for(var k=0;k<P.end.length;k++){if(P.end[k].role===N){return P.end[k].type.split(".").pop();}}}}}}function G(j,P){for(var i=0;i<j.property.length;i++){if(j.property[i].name===P){return j.property[i];}}return{};}function J(i,P){for(var j in i){if(j===P){return i[j];}}return{};}function K(j,S){for(var i in S){j[i]=S[i];}return j;}function L(){var i,j;var k=c.getUriGenerator().getODataPath(a)+"annotation.xml";var M={loadMetadataAsync:false,annotationURI:k,json:true};var T,N;var P;var Q=new O(a,M);T=Q.getServiceMetadata();if(!T){P="5018";if(D){P="11013";}I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:P,aParameters:[a],oCallingObject:t}));b=true;return;}N=Q.getServiceAnnotations();if(!N){I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:"5017",aParameters:[a],oCallingObject:t}));}m=jQuery.extend(true,{},T);A=jQuery.extend(true,{},N);m.dataServices.schema.forEach(function(R){R.entityContainer.forEach(function(S){if(S.entitySet){S.entitySet.forEach(function(i){j=i.entityType.split(/[. ]+/).pop();g.setItem(i.name,j);});}});});}this.getPropertyMetadata=function(i,P){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect EntityType name or type");I.messageHandler.check(P!==undefined&&typeof P==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect sPropertyName name or type");var j=w(i);if(!j){return{};}return C(j,P);};this.patchEntitySetName=function(i){if(g.hasItem(i)){return i;}if(g.hasItem(i+"Results")){return i+"Results";}return undefined;};this.getFilterableProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getFilterableProperties incorrect EntityType name or type");var j=w(i);if(!j){return[];}j=E(j);return x(j);};this.getAllPropertiesOfExtendedEntityType=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getAllProperties incorrect EntityType name or type");var j=w(i);if(!j){return[];}return v(j);};this.getAllAggregatePropertiesOfEntitySet=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getAllProperties incorrect EntityType name or type");var j=w(i);return u(j);};this.getAllAggregateProperties=function(){var i=[];var e=l();e.forEach(function(j){i=i.concat(u(j));});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAllProperties=function(){var i=[];l().forEach(function(j){i=i.concat(v(j));});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getParameterEntitySetKeyPropertiesForService=function(){var i=[];var P=[];l().forEach(function(j){s(j,true).forEach(function(k){i.push(k.name);});});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAllKeys=function(){var i=[];var k=[];l().forEach(function(j){var M=p(j,true);if(!M.name){M=p(j,false);}k=[];if(M.key&&M.key.propertyRef){M.key.propertyRef.forEach(function(N){k.push(N.name);});}i=i.concat(k);});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAttributes=function(P){var e=l();var i=false;var j;l().forEach(function(k){if(i){return;}j=C(k,P);if(j.name){i=true;}});return j;};this.getParameterEntitySetKeyProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getParameterEntitySetKeyProperties incorrect EntityType name or type");var j=w(i);if(!j){return[];}return s(j,true);};this.getEntityTypeMetadata=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getEntityTypeMetadata incorrect EntityType name or type");var j=w(i);if(f.hasItem(j)===true){return f.getItem(j);}else{n();var k=B(j);var M={};for(var A in k){var N=A.split(".").pop();N=N.replace(/^./,N[0].toLowerCase());for(var P in k[A]){M[N]=k[A][P];}}var Q=E(j);if(Q!==j){var R=B(j);for(var S in R){var T=S.split(".").pop();T=T.replace(/^./,T[0]);for(var U in k[S]){M[T]=k[S][U];}}}f.setItem(j,M);return f.getItem(j);}};this.getUriSuffix=function(k){var M=w(k);var N;if(z(M)){for(var i=0;i<m.dataServices.schema.length;i++){for(var j=0;j<m.dataServices.schema[i].entityType.length;j++){N=m.dataServices.schema[i].entityType[j];if(N.name===M){if(N.navigationProperty&&N.navigationProperty.length>0){return N.navigationProperty[0].name;}else{return"";}}}}}else{return"";}};this.getEntitySets=function(){var i={};var j=[];m.dataServices.schema.forEach(function(k){k.entityContainer.forEach(function(M){if(M.associationSet){M.associationSet.forEach(function(N){i[N.end[1].entitySet]=true;});}if(M.entitySet){M.entitySet.forEach(function(N){if(!i[N.name]){j.push(N.name);}});}});});return j;};L();if(b){this.failed=true;}};};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFacade')){jQuery.sap.declare("sap.apf.core.metadataFacade");sap.apf.core.MetadataFacade=function(I,a){this.type="metadataFacade";var m=I.metadataProperty;var M=I.messageHandler;var o=I.metadataFactory;var p;var P;var b={};this.getAllProperties=function(c){if(p){c(p);}else{var d=g();var e;p=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);p=p.concat(e.getAllProperties());}p=sap.apf.utils.eliminateDuplicatesInArray(M,p);c(p);}};this.getAllParameterEntitySetKeyProperties=function(c){if(P){c(P);}else{var d=g();var e;P=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);P=P.concat(e.getParameterEntitySetKeyPropertiesForService());}P=sap.apf.utils.eliminateDuplicatesInArray(M,P);c(P);}};this.getProperty=function(n,c){if(b[n]){c(b[n]);}else{var d=g();var e;var f;for(var i=0;i<d.length;i++){f=o.getMetadata(d[i]);e=f.getAttributes(n);if(e.name){if(f.getParameterEntitySetKeyPropertiesForService().indexOf(n)>-1){e.isParameterEntitySetKeyProperty=true;}if(f.getAllKeys().indexOf(n)>-1){e.isKey=true;}break;}}for(var h in e){if(h==="dataType"){for(var j in e.dataType){e[j]=e.dataType[j];}}}var k=new m(e);b[n]=k;c(b[n]);}};function g(){if(typeof a==="string"){return[a];}else{return o.getServiceDocuments();}}};};if(!jQuery.sap.isDeclared('sap.apf.core.odataProxy')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataProxy");jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.OdataProxy=function(s,a){var c=a.instance.coreApi;var m=a.instance.messageHandler;var b=s.serviceRoot;var e="";function g(b,e){return c.getEntityTypeMetadata(b,e);}function f(p,v){var i="'";var E=g(b,e).getPropertyMetadata(p);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}if(typeof v==='number'){return v;}return i+sap.apf.utils.escapeOdata(v)+i;};function d(j){var i,o,p;if(!j){return"";}o=j.length;if(o===1){return"('"+j[0].value+"')";}p="(";for(i=0;i<o;i++){if(i>0){p=p+",";}p=p+j[i].name+"='"+j[i].value+"'";}return p+")";}function h(E){var i;if(E.messageObject&&E.messageObject.getCode){i=E.messageObject;}else if(E.response&&E.response.statusCode&&E.response.statusCode>=400){i=m.createMessageObject({code:'11005',aParameters:[E.response.statusCode.toString(),E.response.statusText]});}else{i=m.createMessageObject({code:'5201'});}m.putMessage(i);return i;}function k(E,i){var j=h(E);i(undefined,undefined,j);}function l(D,b,e,i){var r;var j;if(D&&D.results){r=D.results;}else if(D){r=D;}else{j=m.createMessageObject({code:'5201'});}i(r,g(b,e),j);}this.readEntity=function(i,j,o,p,q){var A;var e=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var u=b+'/'+e;u=u+d(o);if(p&&p.length>0){u=u+"?$select="+p.join();}if(q===undefined){A=true;}else{A=q;}var r={requestUri:u,async:A,method:"GET",headers:{"x-csrf-token":x}};c.odataRequest(r,function(D){l(D,b,e,j);},function(E){k(E,j);});};function n(r){var x=c.getXsrfToken(b);var j=[];var i,o=r.length;var u,S,p,q;for(i=0;i<o;i++){S=false;e=sap.apf.core.constants.entitySets[r[i].entitySetName];u=e;u=u+d(r[i].inputParameters);if(r[i].selectList&&r[i].selectList.length>0){u=u+"?$select="+r[i].selectList.join();S=true;}if(r[i].filter){if(S){u=u+'&';}else{u=u+'?';}u=u+'$filter='+r[i].filter.toUrlParam({formatValue:f});}p=r[i].method||'GET';q={requestUri:u,method:p,headers:{"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":x}};if(p!=="GET"){q.data=r[i].data;}j.push(q);}return j;};this.doChangeOperationsInBatch=function(r,o){var x=c.getXsrfToken(b);var p=n(r);var q={requestUri:b+'/'+'$batch',method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:[{__changeRequests:p}]}};var S=function(t,u){var v;var w;var y="";var i,j;if(t&&t.__batchResponses){for(i=0;i<t.__batchResponses.length;i++){if(t.__batchResponses[i].message){var z=t.__batchResponses[i].message;var A="";y=u.requestUri;v=m.createMessageObject({code:"5001",aParameters:[A,z,"",y]});break;}for(j=0;j<t.__batchResponses[i].__changeResponses.length;j++){w=t.__batchResponses[i].__changeResponses[j];if(w.message){var z=w.message;var B=w.data;var A=w.statusCode;y=u.requestUri;v=m.createMessageObject({code:"5001",aParameters:[A,z,B,y]});break;}}}o(v);}};var E=function(i){var j="unknown error";var t="unknown error";var u="";if(i.message!==undefined){j=i.message;}var v="unknown";if(i.response&&i.response.statusCode){v=i.response.statusCode;t=i.response.statusText||"";u=i.response.requestUri;}if(i.messageObject&&i.messageObject.type==="messageObject"){o(i.messageObject);}else{o(m.createMessageObject({code:"5001",aParameters:[v,j,t,u]}));}};c.odataRequest(q,S,E,OData.batchHandler);};this.readCollectionsInBatch=function(r,j,o){var x=c.getXsrfToken(b);var p=n(r);var A;if(o===undefined){A=true;}else{A=o;}var q={requestUri:b+'/'+'$batch',async:A,method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:p}};var S=function(t,u){var u=[];var v;var w="";var i;if(t&&t.__batchResponses){for(i=0;i<t.__batchResponses.length;i++){if(t.__batchResponses[i].data&&t.__batchResponses[i].data.results){u.push(t.__batchResponses[i].data.results)}else if(t.__batchResponses[i].message){var y=t.__batchResponses[i].message;var z=t.__batchResponses[i].response.body;var B=t.__batchResponses[i].response.statusCode;w=u.requestUri;v=m.createMessageObject({code:"5001",aParameters:[B,y,z,w]});break;}else{w=u.requestUri;v=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",w]});break;}}j(u,v);}};var E=function(i){var t="unknown error";var u="unknown error";var v="";if(i.message!==undefined){t=i.message;}var w="unknown";if(i.response&&i.response.statusCode){w=i.response.statusCode;u=i.response.statusText||"";v=i.response.requestUri;}if(i.messageObject&&i.messageObject.type==="messageObject"){j([],i.messageObject);}else{j([],m.createMessageObject({code:"5001",aParameters:[w,t,u,v]}));}};c.odataRequest(q,S,E,OData.batchHandler);};this.readCollection=function(i,j,o,p,q,r){var A;e=sap.apf.core.constants.entitySets[i];var Q='';var x=c.getXsrfToken(b);var u=b+'/'+e;u=u+d(o);if(p&&p.length>0){Q="$select="+p.join();}if(q){if(Q){Q=Q+'&';}Q=Q+'$filter='+q.toUrlParam({formatValue:f});}if(e===sap.apf.core.constants.entitySets.application){if(Q){Q=Q+'&';}Q=Q+'$orderby=ApplicationName';}if(Q){u=u+'?'+Q;}if(r===undefined){A=true;}else{A=r;}var t={requestUri:u,async:A,method:"GET",headers:{"x-csrf-token":x}};c.odataRequest(t,function(D){l(D,b,e,j);},function(E){k(E,j);});};this.create=function(i,j,o,p){var A;e=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var u=b+'/'+e;if(p===undefined){A=true;}else{A=p;}var r={requestUri:u,async:A,method:"POST",headers:{"x-csrf-token":x},data:j};function q(D,R){var v;var w;if(D&&R.statusText==="Created"){v=D;}else{w=m.createMessageObject({code:'5201'});}o(v,g(b,e),w);}function t(E){var v=h(E);o(undefined,undefined,v);}c.odataRequest(r,q,t);};this.update=function(i,j,o,p){e=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var u=b+'/'+e+d(p);var r={requestUri:u,method:"PUT",headers:{"x-csrf-token":x},data:j};function q(D,R){var v;if(R.statusCode!==204){v=m.createMessageObject({code:'5201'});}o(g(b,e),v);}function t(E){var v=h(E);o(undefined,v);}c.odataRequest(r,q,t);};this.remove=function(i,j,o,p){e=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var u=b+'/'+e+d(j);if(p){u=u+'$filter='+p.toUrlParam({formatValue:f});}var r={requestUri:u,method:"DELETE",headers:{"x-csrf-token":x}};function q(D,R){var v;var w;if(R.statusText==="No Content"){w=g(b,e);}else{v=m.createMessageObject({code:'5201'});}o(w,v);}function t(E){var v=h(E);o(undefined,v);}c.odataRequest(r,q,t);};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.odataRequest')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataRequest");jQuery.sap.require('sap.ui.thirdparty.datajs');sap.apf.core.odataRequestWrapper=function(m,r,s,e,b){function a(d,f){var M=sap.apf.core.utils.checkForTimeout(f);var E={};if(M){E.messageObject=M;e(E);}else{s(d,f);}}function c(E){var M=sap.apf.core.utils.checkForTimeout(E);if(M){E.messageObject=M;}e(E);}OData.request(r,a,c,b);};};if(!jQuery.sap.isDeclared('sap.apf.core.textResourceHandler')){jQuery.sap.declare("sap.apf.core.textResourceHandler");jQuery.sap.require('jquery.sap.resources');(function(){'use strict';sap.apf.core.TextResourceHandler=function(I){var t=this;var m=I.messageHandler;var c=I.coreApi;var h=new sap.apf.utils.Hashtable(m);var H=new sap.apf.utils.Hashtable(m);this.getTextNotHtmlEncoded=function(L,p){if(typeof L==="string"){return b(L,p);}m.check((L!==undefined&&L.kind!==undefined),"Error - oLabel is not compatible");if(L.kind==="text"){m.check((L.key!==undefined),"Error - oLabel is not compatible");return a(L,p);}return"";};this.getTextHtmlEncoded=function(L,p){return jQuery.sap.encodeHTML(this.getTextNotHtmlEncoded(L,p));};this.getMessageText=function(r,p){var T;l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationMessageTextBundle);if(h.hasItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle)){T=h.getItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle).getText(r,p);if(T!==r){return T;}}return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(r,p);};this.loadTextElements=function(e){var i,f;f=e.length;for(i=0;i<f;i++){H.setItem(e[i].TextElement,e[i].TextElementDescription);}};function l(A,o){var u;if(h.hasItem(A)===false){u=c.getResourceLocation(A);d(A,u);}u=c.getResourceLocation(o);if(u!==""&&h.hasItem(o)===false){d(o,u);}}function a(L,p){if(L.key===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(L.key,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(L.key,p);}else if(k(L.key,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(L.key,p);}else if(H.hasItem(L.key)){return H.getItem(L.key);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[L.key],oCallingObject:t}));return"# text not available: "+L.key;}function b(e,p){if(e===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(e,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(e,p);}else if(k(e,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(e,p);}else if(H.hasItem(e)){return H.getItem(e);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[e],oCallingObject:this}));return"# text not available: "+e;}function k(e,T){var o=h.getItem(T);var i;var f;if(o){f=o.getText(e);}if(o&&o.aPropertyFiles&&o.aPropertyFiles.length>0&&o.aPropertyFiles[0].aKeys instanceof Array){for(i=0;i<o.aPropertyFiles.length;i++){if(jQuery.inArray(e,o.aPropertyFiles[i].aKeys)>=0){return true;}}}return false;}function d(K,u){var B=jQuery.sap.resources({url:u,includeInfo:sap.ui.getCore().getConfiguration().getOriginInfo()});h.setItem(K,B);}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filterTerm')){jQuery.sap.declare('sap.apf.core.utils.filterTerm');sap.apf.core.utils.FilterTerm=function(m,p,o,a,h){this.type="filterTerm";var b=o;var c=a;if(b.length==2){b=b.toUpperCase();}m.check((b!==undefined),"sap.apf.utils.FilterTerm.constructor op undefined");m.check((jQuery.inArray(b,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.FilterTerm op "+b+" not supported");m.check((p!==undefined),"sap.apf.utils.core.FilterTerm sProperty undefined");m.check((c!==undefined),"sap.apf.utils.FilterTerm value undefined");var d=function(e,c){var v,l;if(e!==p){return true;}if(b===sap.apf.core.constants.FilterOperators.EQ){if(a instanceof Date&&c instanceof Date){return(a.valueOf()===c.valueOf());}return(a===c);}else if(b===sap.apf.core.constants.FilterOperators.LT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()>c.valueOf());}return(a>c);}else if(b===sap.apf.core.constants.FilterOperators.LE){if(a instanceof Date&&c instanceof Date){return(a.valueOf()>=c.valueOf());}return(a>=c);}else if(b===sap.apf.core.constants.FilterOperators.GT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<c.valueOf());}return(a<c);}else if(b===sap.apf.core.constants.FilterOperators.BT){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<=c.valueOf()&&c.valueOf()<=h.valueOf());}return(a<=c&&c<=h);}else if(b===sap.apf.core.constants.FilterOperators.GE){if(a instanceof Date&&c instanceof Date){return(a.valueOf()<=c.valueOf());}return(a<=c);}else if(b===sap.apf.core.constants.FilterOperators.NE){if(a instanceof Date&&c instanceof Date){return!(a.valueOf()===c.valueOf());}return!(a===c);}else if(b===sap.apf.core.constants.FilterOperators.StartsWith){l=a.length;if(l>c.length){return false;}v=c.slice(0,l);return(v===a);}else if(b===sap.apf.core.constants.FilterOperators.EndsWith){l=a.length;if(l>c.length){return false;}v=c.slice(-l);return(v===a);}else if(b===sap.apf.core.constants.FilterOperators.Contains){var i=c.indexOf(a);return(i>-1);}};this.contains=function(e,c){var i=0;if(e instanceof Array){for(i=0;i<e.length;i++){if(e[i]===p){return d(e[i],c[e[i]]);}}return true;}else{return d(e,c);}};this.toUrlParam=function(e){var s="'";var f=" ";var g="";var P=[];var a,i;if(e&&e.formatValue){a=e.formatValue(p,c);if(h){i=e.formatValue(p,h);}}else{if(typeof c==='number'){a=c;}else{a=s+sap.apf.utils.escapeOdata(c)+s;}if(h){if(typeof c==='number'){i=h;}else{i=s+sap.apf.utils.escapeOdata(h)+s;}}}if(b===sap.apf.core.constants.FilterOperators.StartsWith){g='startswith('+sap.apf.utils.escapeOdata(p)+','+a+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.EndsWith){g='endswith('+sap.apf.utils.escapeOdata(p)+','+a+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.Contains){g='substringof('+a+','+sap.apf.utils.escapeOdata(p)+')';g=jQuery.sap.encodeURL(g);}else if(b===sap.apf.core.constants.FilterOperators.BT){g='(('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+"ge"+f+a)+')'+jQuery.sap.encodeURL(f+'and'+f)+'('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+"le"+f+i)+'))';}else{g='('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(p)+f+b.toLowerCase()+f+a)+')';}if(e&&e.asFilterArray===true){P.push(g);return P;}return g;};this.getProperty=function(){return p;};this.getOp=function(){return b;};this.getValue=function(){return c;};this.getHighValue=function(){return h;};this.getHash=function(){var s=p+b+c;return sap.apf.utils.hashCode(s);};this.copy=function(){return new sap.apf.core.utils.FilterTerm(m,p,b,c,h);};this.removeTermsByProperty=function(e){var i=0;var l=0;if(e instanceof Array){l=e.length;for(i=0;i<l;i++){if(p===e[i]){return undefined;}}return this.copy();}else{if(p===e){return undefined;}return this.copy();}};this.removeTerms=function(e,f,a){var i=0;var l=0;if(e instanceof Array){l=e.length;for(i=0;i<l;i++){if(p===e[i]&&b===f&&c===a){return undefined;}}return this.copy();}else{if(p===e&&b===f&&c===a){return undefined;}return this.copy();}};this.mapProperties=function(M){var i;for(i=0;i<M.length;i++){if(p===M[i].source){p=M[i].target;return undefined;}}return undefined;};this.mapToSelectionVariant=function(){if(b===sap.apf.core.constants.FilterOperators.BT){return{option:b,low:c,high:h};}return{option:b,low:c,high:null};};this.mapToSapUI5FilterExpression=function(){if(b===sap.apf.core.constants.FilterOperators.BT){return{path:p,operator:b,value1:c,value2:h};}return{path:p,operator:b,value1:c};};};};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.applicationHandler')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.applicationHandler");(function(){'use strict';sap.apf.modeler.core.ApplicationHandler=function(i,a){var t=this;var p=i.instance.persistenceProxy;var m=i.instance.messageHandler;var H=i.constructor.hashtable;var b;this.type="application";this.setAndSave=function(d,e,f,g){if(typeof d==="object"&&typeof e==="function"&&typeof f==="string"&&!g){var h=function(k,l){if(l){e(undefined,k,l);}else{b.setItem(d.Application,d);e(d.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}d.Application=f;p.update(this.type,d,h,[{name:"Application",value:f}]);}else if(typeof d==="object"&&typeof e==="function"){var j=function(r,k,l){if(l){e(r,k,l);}else{b.setItem(r.Application,{Application:r.Application,ApplicationName:r.ApplicationName,SemanticObject:r.SemanticObject});e(r.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}if(g&&f){d.Application=f;}else{d.Application="";}p.create(this.type,d,j);}};this.removeApplication=function(d,e){var f=function(g,h){if(!h){b.removeItem(d);}i.functions.resetConfigurationHandler(d);e(d,g,h);};p.remove(this.type,[{name:"Application",value:d}],f);};this.getList=function(){var d=[];var e=function(k,f){d.push(f);};b.forEachOrdered(e);return d;};this.getApplication=function(d){return b.getItem(d);};function c(){b=new H(m);var d=function(r,e,f){if(r instanceof Array&&f===undefined){r.forEach(function(o){b.setItem(o.Application,{Application:o.Application,ApplicationName:o.ApplicationName,SemanticObject:o.SemanticObject});});}a(t,f);};p.readCollection(t.type,d);}c();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationEditor')){jQuery.sap.declare("sap.apf.modeler.core.configurationEditor");(function(){'use strict';sap.apf.modeler.core.ConfigurationEditor=function(c,a,b,d){var t=this;var e;var f;var g=a.instance.configurationHandler;var p=a.instance.persistenceProxy;var m=a.instance.messageHandler;var h=a.instance.metadataFactory;var j=true;var s,k,l,n,o,q;var r=new a.constructor.configurationObjects(a);var u=new a.constructor.configurationFactory({messageHandler:m,constructor:{registryProbe:a.constructor.registryProbe}});if(!d){s=new a.constructor.elementContainer("Step",a.constructor.step,a);k=new a.constructor.elementContainer("Category",undefined,a);l=new a.constructor.elementContainer("FacetFilter",a.constructor.facetFilter,a);n=new a.constructor.elementContainer("NavigationTarget",a.constructor.navigationTarget,a);o=new a.constructor.elementContainer("CategoryStepAssignment",a.constructor.elementContainer,a);q=[];}else{s=d.stepContainer;k=d.categoryContainer;l=d.facetFilterContainer;n=d.navigationTargetContainer;o=d.categoryStepAssignmentContainer;q=d.serviceList;}this.registerService=function(i){var y=false;if(q.indexOf(i)===-1){if(h.getMetadata(i)){q.push(i);y=true;}}else{y=true;}return y;};this.getAllServices=function(){return q;};this.getAllEntitySetsOfService=function(i){var y=[];if(q.indexOf(i)>-1){y=h.getEntitySets(i);}return y;};this.getAllEntitySetsOfServiceWithGivenProperties=function(y,z){var A=[],B;var C=this.getAllEntitySetsOfService(y);if(!z||z.length===0){return C;}B=h.getMetadata(y);C.forEach(function(D){var E=B.getFilterableProperties(D);var F=true;for(var i=0;i<z.length;i++){if(E.indexOf(z[i])<=-1){F=false;break;}}if(F){A.push(D);}});return A;};this.getAllPropertiesOfEntitySet=function(i,y){var z=[];if(q.indexOf(i)>-1){z=h.getMetadata(i).getAllAggregatePropertiesOfEntitySet(y);}return z;};this.getAllKnownProperties=function(){var i=[];var y;q.forEach(function(z){y=h.getMetadata(z);i=i.concat(y.getAllProperties());});i=sap.apf.utils.eliminateDuplicatesInArray(m,i);return i;};this.setApplicationTitle=function(i){j=false;e=i;};this.getApplicationTitle=function(){return e;};this.getConfigurationName=function(){return f;};this.getCategoryStepAssignments=function(i){var y=[];if(!this.getCategory(i)){return false;}var z=o.getElement(i);if(z){z.getElements().forEach(function(A){y.push(A.stepId);});}return y;};this.addCategoryStepAssignment=function(i,y){if(!this.getCategory(i)||!this.getStep(y)){return false;}var z=o.getElement(i);if(!z){o.createElementWithProposedId({},i);z=o.getElement(i);}if(!z.getElement(y)){z.createElementWithProposedId({stepId:y},y);return true;};return false;};this.removeCategoryStepAssignment=function(i,y){var z;if(!y){var A=this.getCategoryStepAssignments(i);z=o.removeElement(i);if(z){_(A);}return!!z;}var B=o.getElement(i);if(!B){return false;}z=B.removeElement(y);if(B.getElements().length===0){o.removeElement(i);}if(z){_([y]);}return!!z;};function _(i){if(!i){return;}i.forEach(function(y){if(t.getCategoriesForStep(y).length===0){v(y);}});}this.moveCategoryStepAssignmentBefore=function(i,y,z){var A=o.getElement(i);if(!A){return null;}return A.moveBefore(y,z);};this.moveCategoryStepAssignmentToEnd=function(i,y){var z=o.getElement(i);if(!z){return null;}return z.moveToEnd(y);};this.moveCategoryStepAssignmentUpOrDown=function(i,y,z){var A=o.getElement(i);if(!A){return null;}return A.moveUpOrDown(y,z);};this.getCategory=k.getElement;this.setCategory=function(i,y){j=false;return k.setElement(i,y);};this.createCategoryWithId=function(i,y){j=false;return k.createElementWithProposedId(i,y).getId();};this.removeCategory=function(i){var y=t.getCategoryStepAssignments(i);if(y){y.forEach(function(z){var A=t.getCategoriesForStep(z);if(!A||A.length<2){v(z);}});}k.removeElement(i);};this.getCategories=k.getElements;this.copyCategory=function(i){var y=k.copyElement(i),z;if(!y){return;}t.getCategoryStepAssignments(i).forEach(function(A){z=w(A,y);});return y;};this.moveCategoryBefore=function(i,y){return k.moveBefore(i,y);};this.moveCategoryToEnd=function(i){return k.moveToEnd(i);};this.moveCategoryUpOrDown=function(i,y){return k.moveUpOrDown(i,y);};this.serialize=function(){return r.serializeConfiguration(t);};this.isSaved=function(){return j;};this.setIsUnsaved=function(){j=false;};this.save=function(i){function y(B,C,D){if(!D){j=true;f=A.AnalyticalConfigurationName;g.replaceConfigurationId(c.id||c,B.AnalyticalConfiguration);c=B.AnalyticalConfiguration;}i(c,C,D);}function z(B,C){if(!C){j=true;f=A.AnalyticalConfigurationName;}i(c.id||c,B,C);}var A={AnalyticalConfiguration:"",AnalyticalConfigurationName:g.getConfiguration(c.id||c).AnalyticalConfigurationName,Application:g.getApplicationId(),SerializedAnalyticalConfiguration:JSON.stringify(this.serialize()),CreatedByUser:"",CreationUTCDateTime:null,LastChangeUTCDateTime:null,LastChangedByUser:""};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){p.create("configuration",A,y);}else{A.AnalyticalConfiguration=c;p.update("configuration",A,z,[{name:"AnalyticalConfiguration",value:c}]);}}else{if(c.id.indexOf("apf1972-")===0){A.AnalyticalConfiguration="";A.CreationUTCDateTime=null;A.LastChangeUTCDateTime=null;}else{A.AnalyticalConfiguration=c.id;A.CreationUTCDateTime=c.creationDate;A.LastChangeUTCDateTime=c.lastChangeDate;}if(c.updateExisting){p.update("configuration",A,z,[{name:"AnalyticalConfiguration",value:c.id}]);}else{p.create("configuration",A,y);}}};this.createFacetFilterWithId=function(i){return l.createElementWithProposedId(undefined,i).getId();};this.createFacetFilter=function(){return l.createElement().getId();};this.removeFacetFilter=l.removeElement;this.getFacetFilter=l.getElement;this.getFacetFilters=l.getElements;this.copyFacetFilter=l.copyElement;this.moveFacetFilterBefore=function(i,y){return l.moveBefore(i,y);};this.moveFacetFilterToEnd=function(i){return l.moveToEnd(i);};this.moveFacetFilterUpOrDown=function(i,y){return l.moveUpOrDown(i,y);};this.createNavigationTargetWithId=function(i){return n.createElementWithProposedId(undefined,i).getId();};this.createNavigationTarget=function(){return n.createElement().getId();};this.removeNavigationTarget=n.removeElement;this.getNavigationTarget=n.getElement;this.getNavigationTargets=n.getElements;this.copyNavigationTarget=n.copyElement;this.moveNavigationTargetBefore=function(i,y){return n.moveBefore(i,y);};this.moveNavigationTargetToEnd=function(i){return n.moveToEnd(i);};this.moveNavigationTargetUpOrDown=function(i,y){return n.moveUpOrDown(i,y);};this.createStepWithId=function(i){return s.createElementWithProposedId(undefined,i).getId();};this.createStep=function(i){if(!this.getCategory(i)){return;}var y=s.createElement().getId();this.addCategoryStepAssignment(i,y);return y;};var v=s.removeElement;this.getStep=s.getElement;this.getSteps=s.getElements;this.getStepsNotAssignedToCategory=function(i){var y=this.getCategoryStepAssignments(i);var z=[];t.getSteps().forEach(function(A){var B=A.getId();if(y.indexOf(B)===-1){z.push(B);}});return z;};this.copyStep=function(i){var y=w(i);if(!y){return false;}var z=this.getCategoriesForStep(i);if(z){z.forEach(function(A){t.addCategoryStepAssignment(A,y);});}return y;};function w(i,y){if(y&&!t.getCategory(y)){return false;}var z=s.copyElement(i);if(!z){return false;}if(y){t.addCategoryStepAssignment(y,z);}return z;};this.getCategoriesForStep=function getCategoriesForStep(i){var y=[];var z=t.getCategories();if(z){z.forEach(function(A){var B=A.getId();var C=t.getCategoryStepAssignments(B);if(C&&C.indexOf(i)>-1){y.push(B);}});}return y;};this.copy=function(i){var y={stepContainer:s,categoryContainer:k,facetFilterContainer:l,navigationTargetContainer:n,categoryStepAssignmentContainer:o,serviceList:q};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(y);return new sap.apf.modeler.core.ConfigurationEditor(i,a,undefined,d);};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){j=false;if(b){b(t,undefined);}}else{if(!d){x(c,p,function(i,y){if(!y){var z=JSON.parse(i.SerializedAnalyticalConfiguration);t.setApplicationTitle(z.applicationTitle);u.loadConfig(z);r.mapToDesignTime(u.getRegistry(),t);j=true;f=i.AnalyticalConfigurationName;b(t,undefined);}else{b(undefined,y);}});}}}else{u.loadConfig(c.content);r.mapToDesignTime(u.getRegistry(),this);if(b){b(t,undefined);}}function x(i,y,b){y.readEntity("configuration",function(z,A,B){b(z,B);},[{name:"AnalyticalConfiguration",value:i}],undefined,true);}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationHandler')){jQuery.sap.declare("sap.apf.modeler.core.configurationHandler");(function(){'use strict';sap.apf.modeler.core.ConfigurationHandler=function(a){var t=this;var m=a.instance.messageHandler;var p=a.instance.persistenceProxy;var C=a.constructor.configurationEditor;var H=a.constructor.hashtable;var L=a.constructor.lazyLoader;var c=new H(m);var l=new H(m);var b=new H(m);var d,e;var f={constructor:{hashtable:H},instance:{messageHandler:m}};this.exportTexts=function(){return e.exportTexts();};this.getTextPool=function(){return e;};this.setApplicationIdAndContext=function(h,j,T){e=T||e;c=new H(m);var i,k=j.length;for(i=0;i<k;i++){c.setItem(j[i].AnalyticalConfiguration,j[i]);}d=h;};this.getApplicationId=function(){return d;};this.setConfiguration=function(h,i){h.AnalyticalConfiguration=i||g();h.Application=d;c.setItem(h.AnalyticalConfiguration,h);return h.AnalyticalConfiguration;};this.getList=function(){var h=[];var i=function(k,j){h.push(j);};c.each(i);return h;};this.getConfiguration=function(i){return c.getItem(i);};this.loadConfiguration=function(h,i){function j(n,q,r){var s={instance:{coreApi:a.instance.coreApi,messageHandler:m,datajs:a.instance.datajs,configurationHandler:t,persistenceProxy:p,textPool:e,metadataFactory:a.instance.metadataFactory},constructor:{hashtable:H,step:a.constructor.step,facetFilter:a.constructor.facetFilter,navigationTarget:a.constructor.navigationTarget,representation:a.constructor.representation,configurationObjects:a.constructor.configurationObjects,elementContainer:a.constructor.elementContainer,configurationFactory:a.constructor.configurationFactory,registryProbe:a.constructor.registryProbe}};new C(h,s,function(u,v){q(n,u,v);});}var k,n=h.id||h;if(!h.updateExisting){k=l.getItem(n);}if(!k){k=new L(f,j);l.setItem(n,k);}k.asyncGetInstance(n,o);function o(q,r,s){i(q,r);}};this.resetConfiguration=function(h){var i;if(l.hasItem(h)){i=c.getItem(h);i.AnalyticalConfigurationName=l.getItem(h).getInstance().getConfigurationName();l.removeItem(h);return h;}};this.copyConfiguration=function(i,h){var j=this.getConfiguration(i);if(!j){h(null);return;}t.loadConfiguration(i,k);function k(n){var o,q,r,s;s=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(j);o=g();s.AnalyticalConfiguration=o;t.setConfiguration(s,o);q=n.copy(o);r=new L(f,undefined,{id:o,instance:q});l.setItem(o,r);h(o);}};this.replaceConfigurationId=function(h,s){if(h.indexOf("apf1972-")===0){var i=c.getItem(h);var j=l.getItem(h).getInstance();var n=new L(f,undefined,{id:s,instance:j});i.AnalyticalConfiguration=s;c.setItem(s,i);c.removeItem(h);l.setItem(s,n);l.removeItem(h);}};this.exportConfiguration=function(h,i){var o;this.loadConfiguration(h,j);function j(k){if(!k.isSaved()){m.putMessage(m.createMessageObject({code:"11007",aParameters:[h]}));i(null);}else{var n=a.functions.getApplication(d);o=k.serialize();o.configHeader={Application:d,ApplicationName:n.ApplicationName,SemanticObject:n.SemanticObject,AnalyticalConfiguration:h,AnalyticalConfigurationName:t.getConfiguration(h).AnalyticalConfigurationName,UI5Version:sap.ui.version};p.readEntity("configuration",function(r,q,s){if(s){m.putMessage(m.createMessageObject({code:"5022",aParameters:[h]}));i(null);}else{o.configHeader.CreationUTCDateTime=r.CreationUTCDateTime;o.configHeader.LastChangeUTCDateTime=r.LastChangeUTCDateTime;i(JSON.stringify(o));}},[{name:"AnalyticalConfiguration",value:h}],["CreationUTCDateTime","LastChangeUTCDateTime"],false);}}};this.memorizeConfiguration=function(h){var i,j;j=l.getItem(h);if(!j){return null;}i=j.getInstance();if(i){b.setItem(h,i.copy(h));return h;}return null;};this.restoreMemorizedConfiguration=function(h){var n,i;i=b.removeItem(h);if(i){n=new L(f,undefined,{id:h,instance:i});l.setItem(h,n);return i;}return null;};this.removeConfiguration=function(h,r){function i(j,k){if(!k){c.removeItem(h);l.removeItem(h);}r(h,j,k);}if(h.indexOf("apf1972-")!==0){p.remove("configuration",[{name:"AnalyticalConfiguration",value:h}],i);}else{c.removeItem(h);l.removeItem(h);r(h,undefined,undefined);}};this.removeAllConfigurations=function(){c=new H(m);};function g(){return"apf1972-"+(Math.random()*new Date().getTime());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.applicationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.applicationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.applicationList",{onInit:function(){var v=this.getView();v.addStyleClass("sapUiSizeCompact");this._addApplicationStyleClass();var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();var s=this;this.oCoreApi.getApplicationHandler(function(A){s.applicationHandler=A;s._updateAppList();});}this.oModel=new sap.ui.model.json.JSONModel({});this.oModel.setSizeLimit(1000);this.bIsEditMode=false;this.byId("idAppDescription").attachBrowserEvent("click",this.navToConfigList().fn);this.byId("idSemanticObject").attachBrowserEvent("click",this.navToConfigList().fn);var a=v.byId("idApplicationTable");var b=v.byId("idAppListScrollContainer");b.addEventDelegate({onAfterRendering:function(){var w=jQuery(v.byId("idAppPage").getDomRef()).width();var h=jQuery(window).height();var d=jQuery(v.byId("idAppTitle").getDomRef()).height()+32;var e=jQuery(v.byId("idApplicationToolbar").getDomRef()).height();var f=jQuery(v.byId("idAppPage").getDomRef()).find("header").height();var g=jQuery(v.byId("idAppPage").getDomRef()).find("footer").height();var o;if(e>0){o=d+e+f+g+25;}else{o=270;}b.setHeight(h-o+"px");b.setWidth("100%");sap.apf.modeler.ui.utils.helper.onResize(function(){if(jQuery(s.getView().getDomRef()).css("display")==="block"){w=jQuery(v.byId("idAppPage").getDomRef()).width();h=jQuery(v.byId("idAppPage").getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});sap.ui.core.UIComponent.getRouterFor(s).attachRoutePatternMatched(function(E){if(E.getParameter("name")==="applicationList"){w=jQuery(v.getDomRef()).width();h=jQuery(v.getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});}});},_setDisplayText:function(){this.byId("idAppPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idAppTitle").setText(this.oCoreApi.getText("applicationOverview"));this.byId("idAppNumberTitle").setText(this.oCoreApi.getText("applications"));this.byId("idDescriptionLabel").setText(this.oCoreApi.getText("description"));this.byId("idSemanticObjectLabel").setText(this.oCoreApi.getText("semanticObject"));this.byId("idEditButton").setText(this.oCoreApi.getText("edit"));this.byId("idSaveButton").setText(this.oCoreApi.getText("save"));this.byId("idCancelButton").setText(this.oCoreApi.getText("cancel"));this.byId("idTextCleanupButton").setText(this.oCoreApi.getText("textCleanUp"));this.byId("idImportButton").setText(this.oCoreApi.getText("import"));this.byId("idNewButton").setTooltip(this.oCoreApi.getText("newApplication"));},_addConfigStyleClass:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").addStyleClass("overwriteConfirmationDialogLabels");sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").addStyleClass("overwriteConfirmationDialogLabels");},_setOverwriteConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idOverwriteConfirmationDialog").setTitle(this.oCoreApi.getText("warning"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").setText(this.oCoreApi.getText("overwriteConfirmationMsg"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").addStyleClass("dialogText");sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idNoButton").setText(this.oCoreApi.getText("no"));},_setImportConfigDialogText:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idImportConfigDialog").setTitle(this.oCoreApi.getText("importConfig"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").setText(this.oCoreApi.getText("jsonFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader").setPlaceholder(this.oCoreApi.getText("jsonFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").setText(this.oCoreApi.getText("textFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader").setPlaceholder(this.oCoreApi.getText("textFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idUploadOfConfig").setText(this.oCoreApi.getText("upload"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idCancelImportOfConfig").setText(this.oCoreApi.getText("cancel"));},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_setNewApplicationText:function(){sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idNewApp").setTitle(this.oCoreApi.getText("newApplication"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idDescriptionLabelApp").setText("*"+this.oCoreApi.getText("description"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSemanticObjectLabelApp").setText(this.oCoreApi.getText("semanticObject"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSaveButtonApp").setText(this.oCoreApi.getText("save"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idCancelButtonApp").setText(this.oCoreApi.getText("cancel"));},_addApplicationStyleClass:function(){this.byId("idAppNumberTitle").addStyleClass("appCountLabel");this.byId("idAppDescription").addStyleClass("cursor");this.byId("idSemanticObject").addStyleClass("cursor");this.byId("idNewButton").addStyleClass("newButton");this.byId("idAppListScrollContainer").addStyleClass("applicationListScroll");this.byId("idNoOfConfig").addStyleClass("applicationCount");this.byId("idAppTitle").addStyleClass("applicationTitle");this.byId("idApplicationToolbar").addStyleClass("applicationTitleLayout");},_updateAppList:function(){var a=this.applicationHandler.getList();var b=a.length;var A=[];a.forEach(function(c){var o={};o.id=c.Application;o.description=c.ApplicationName;o.semanticObject=c.SemanticObject;A.push(o);});var j={appCount:"("+b+")",tableData:A};if(this.oModel!==undefined){this.oModel.setSizeLimit(1000);this.oModel.setData(j);this.getView().setModel(this.oModel);}},_enableDisplayMode:function(){this.bIsEditMode=false;this.byId("idEditButton").setVisible(true);this.byId("idSaveButton").setVisible(false);this.byId("idSaveButton").setEnabled(false);this.byId("idTextCleanupButton").setEnabled(false);this.byId("idCancelButton").setVisible(false);this.byId("idTextCleanupButton").setVisible(false);this.byId("idApplicationTable").setMode("None");var i=this.byId("idApplicationTable").getItems();i.forEach(function(a){a.setType("Navigation");a.getCells()[0].setEditable(false);a.getCells()[1].setEditable(false);a.getCells()[2].setVisible(false);});this._updateAppList();},enableEditMode:function(){this.bIsEditMode=true;this.byId("idEditButton").setVisible(false);this.byId("idSaveButton").setVisible(true);this.byId("idCancelButton").setVisible(true);this.byId("idTextCleanupButton").setVisible(true);this.byId("idApplicationTable").setMode("SingleSelectMaster");var i=this.byId("idApplicationTable").getItems();if(i.length!==0){i.forEach(function(a){a.getCells()[0].setEditable(true);a.getCells()[1].setEditable(true);a.getCells()[2].setVisible(true);a.setType("Inactive");});}},handleDeletePress:function(e){var p=e.getSource().getBindingContext().getPath().split("/")[2];var r=this.getView().getModel().getData().tableData[p].id;var c=new sap.ui.core.CustomData({value:{removeId:r,sPath:p}});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",this);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(this.oCoreApi.getText("deleteApp"));this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);this.confirmationDialog.removeAllCustomData();this.confirmationDialog.addCustomData(c);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},handleConfirmDeletion:function(){var r=this.confirmationDialog.getCustomData()[0].getValue().removeId;if(r!==undefined){var s=this;this.applicationHandler.removeApplication(r,function(R,m,a){if(a===undefined&&(typeof R==="string")){s.confirmationDialog.close();s._updateAppList();s.enableEditMode();}else{var M=s.oCoreApi.createMessageObject({code:"12001"});M.setPrevious(a);s.oCoreApi.putMessage(M);}});}},closeDialog:function(){if(this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},handleSavePress:function(){var s=this;var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}u.forEach(function(b){var c={ApplicationName:b.description,SemanticObject:b.semanticObject};s.applicationHandler.setAndSave(c,function(r,m,d){if(d===undefined&&(typeof r==="string")){s._enableDisplayMode();}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(d);s.oCoreApi.putMessage(M);}},b.id);});},handleCancelPress:function(){var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}if(u.length!==0){this.unsavedDataConfirmationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",this);this.getView().addDependent(this.unsavedDataConfirmationDialog);this._setUnsavedDataConfirmationDialogText();jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.unsavedDataConfirmationDialog);this.unsavedDataConfirmationDialog.open();}else{this._enableDisplayMode();}},_handleNavigationWithSave:function(){this.handleSavePress();if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_handleNavigateWithoutSave:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}this._enableDisplayMode();},_handlePreventNavigation:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_setUnsavedDataConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(this.oCoreApi.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(this.oCoreApi.getText("cancel"));var c=new sap.m.Label();c.addStyleClass("dialogText");c.setText(this.oCoreApi.getText("unsavedConfiguration"));this.unsavedDataConfirmationDialog.removeAllContent();this.unsavedDataConfirmationDialog.addContent(c);},handleListItemSelect:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];this.appId=this.getView().getModel().getData().tableData[b].id;this.byId("idTextCleanupButton").setEnabled(true);},handleListItemPress:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];var a=this.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(this).navTo("configurationList",{appId:a});},onLiveChange:function(){this.byId("idSaveButton").setEnabled(true);},addNewApplication:function(){if(!this.addNewItemDialog){this.addNewItemDialog=sap.ui.xmlfragment("idAddNewApplicationFragment","sap.apf.modeler.ui.fragment.newApplication",this);this.getView().addDependent(this.addNewItemDialog);this._setNewApplicationText();}this.addNewItemDialog.getContent()[0].getContent()[1].setValue("");this.addNewItemDialog.getContent()[0].getContent()[3].setValue("FioriApplication");this.addNewItemDialog.getBeginButton().setEnabled(false);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.addNewItemDialog);this.addNewItemDialog.open();},applicationDescChange:function(e){this.isAppDesc=e.getParameters().value!==""?true:false;if(this.isAppDesc){this.addNewItemDialog.getBeginButton().setEnabled(true);}else{this.addNewItemDialog.getBeginButton().setEnabled(false);}},closeNewAppDialog:function(){if(this.addNewItemDialog.isOpen()){this.addNewItemDialog.close();}},handleSaveDialogPress:function(){var s=this;var d=this.getView().getDependents();var a={};d.forEach(function(D){if(D.sId==="idAddNewApplicationFragment--idNewApp"){a.ApplicationName=D.getContent()[0].getContent()[1].getValue()!==""?D.getContent()[0].getContent()[1].getValue():undefined;a.SemanticObject=D.getContent()[0].getContent()[3].getValue()!==""?D.getContent()[0].getContent()[3].getValue():undefined;}});this.applicationHandler.setAndSave(a,function(r,m,b){if(b===undefined&&(typeof r==="string")){s._enableDisplayMode();s.byId('idApplicationTable').rerender();var c=s.byId('idApplicationTable').getItems()[s.byId('idApplicationTable').getItems().length-1].$();if(c.length!==0){c[0].scrollIntoView();}s.addNewItemDialog.close();}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(b);s.oCoreApi.putMessage(M);}});},handleImportButtonPress:function(){if(!this.importConfigurationDialog){this.importConfigurationDialog=sap.ui.xmlfragment("idImportConfigurationFragment","sap.apf.modeler.ui.fragment.importConfiguration",this);this.getView().addDependent(this.importConfigurationDialog);this._setImportConfigDialogText();this._addConfigStyleClass();}sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader").setValue("");sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader").setValue("");jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.importConfigurationDialog);this.importConfigurationDialog.open();},handleUploadOfConfig:function(){this.oJSONFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader");this.oTextPropertyFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader");if((this.oJSONFileUploader.getValue()&&this.oTextPropertyFileUploader.getValue())||this.oJSONFileUploader.getValue()){this.oJSONFileUploader.upload();}else{this.oTextPropertyFileUploader.upload();}},addAcceptAttribute:function(){var j=jQuery("#idImportConfigurationFragment--idJsonFileUploader-fu");var p=jQuery("#idImportConfigurationFragment--idTextFileUploader-fu");j.attr('accept','.json');p.attr('accept','.properties');},closeImportConfigDialog:function(){if(this.importConfigurationDialog.isOpen()){this.importConfigurationDialog.close();}},handleJSONFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingJSONFile");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(a){s.parsedConfigString=JSON.parse(a.target.result);s.appIdFromConfigFile=s.parsedConfigString.configHeader.Application;s._importConfigurationFile(s.parsedConfigString);};r.onerror=function(){sap.m.MessageToast.show(m);};}this.importConfigurationDialog.close();},handleTextFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingPropertiesFile");var a=this.oCoreApi.getText("asyncMsg");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(b){var l=b.target.result.split(/\r?\n/);var c=l.length;var d,i;for(i=0;i<c;i++){d=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(d!==null){s.appIdFromTextFile=l[i].split('=')[1];}}var E;for(i=0;i<s.applicationHandler.getList().length;i++){if(s.appIdFromTextFile===s.applicationHandler.getList()[i].Application){E=true;break;}else{E=false;}}if(!E&&!s.oJSONFileUploader.getValue()){sap.m.MessageToast.show("chooseJsonFile");}else if(s.oJSONFileUploader.getValue()){if(s.appIdFromConfigFile&&s.appIdFromTextFile&&s.appIdFromTextFile!==s.appIdFromConfigFile){sap.m.MessageToast.show(a);}else{s._importPropertiesFile(b.target.result);}}else if(E&&!s.oJSONFileUploader.getValue()){s._importPropertiesFile(b.target.result);}};r.onerror=function(){sap.m.MessageToast.show(m);};}this.importConfigurationDialog.close();},_importConfigurationFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForConfigFileImport");this.oCoreApi.importConfiguration(JSON.stringify(p),function(b,d){s.callbackOverwrite=b;s.callbackCreateNew=d;s._openConfirmationDialog();},c);function c(b,m,d){if(d===undefined){s._updateAppList();sap.m.MessageToast.show(a);if(s.oTextPropertyFileUploader.getValue()){s.oTextPropertyFileUploader.upload();}}else{var M=s.oCoreApi.createMessageObject({code:"12002"});M.setPrevious(d);s.oCoreApi.putMessage(M);}}},_importPropertiesFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForPropertyFileImport");this.oCoreApi.importTexts(p,function(m){if(m===undefined){sap.m.MessageToast.show(a);}else{var M=s.oCoreApi.createMessageObject({code:"12003"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});},handleTypeMissmatchForJSONFile:function(){var m=this.oCoreApi.getText("jsonFileMissmatch");sap.m.MessageToast.show(m);},handleTypeMissmatchForPropertiesFile:function(){var m=this.oCoreApi.getText("propertiesFileMissmatch");sap.m.MessageToast.show(m);},_openConfirmationDialog:function(){if(!this.overwriteConfirmationDialog){this.overwriteConfirmationDialog=sap.ui.xmlfragment("idOverwriteConfirmationFragment","sap.apf.modeler.ui.fragment.overwriteConfirmation",this);this.getView().addDependent(self.overwriteConfirmationDialog);this._setOverwriteConfirmationDialogText();}jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.overwriteConfirmationDialog);this.overwriteConfirmationDialog.open();},handleConfirmOverwriting:function(){this.callbackOverwrite();this.overwriteConfirmationDialog.close();},handleNoButtonPress:function(){this.callbackCreateNew();this.overwriteConfirmationDialog.close();},handleTextCleanUpPress:function(){var s=this;this.oCoreApi.getConfigurationHandler(this.appId,function(c){s.oTextPool=c.getTextPool();s.oCoreApi.getUnusedTextKeys(s.appId,function(u,m){if(m===undefined){s.oTextPool.removeTexts(u,function(m){if(m===undefined){var a=s.oCoreApi.getText("successtextCleanup");sap.m.MessageToast.show(a,{width:"20em"});}});}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});});},navToConfigList:function(){var s=this;return{fn:function(){if(!s.bIsEditMode){var b=this.getBindingContext().getPath().split("/")[2];var a=s.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(s).navTo("configurationList",{appId:a});}}};}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.category.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.category.controller');sap.ui.controller("sap.apf.modeler.ui.controller.category",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idCategoryTitle"));this._setMandatoryFields(m);},_setDisplayText:function(){this.byId("idCategoryTitleLabel").setText("*"+this.getText("category")+": ");this.byId("idCategoryTitle").setPlaceholder(this.getText("newCategory"));this.byId("idTotalStepsLabel").setText(this.getText("totalSteps")+": ");},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var i=this.byId("idCategoryTitle");var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var d={oTranslationFormat:T,type:"text"};t.setAutoCompleteOn(i,d);}},setDetailData:function(){var s=this;if(this.params&&this.params.arguments&&this.params.arguments.categoryId){this.oCategory=this.oConfigurationEditor.getCategory(this.params.arguments.categoryId);}if(this.oCategory){var n=this.oConfigurationEditor.getCategoryStepAssignments(this.oCategory.getId()).length;if(this.oTextPool.get(this.oCategory.labelKey)!==undefined){this.byId("idCategoryTitle").setValue(this.oTextPool.get(this.oCategory.labelKey).TextElementDescription);}else{this.byId("idCategoryTitle").setValue(this.oCategory.labelKey);}this.byId("idTotalSteps").setValue(n);}else{var a=this.oConfigurationEditor.setCategory();this.oCategory=this.oConfigurationEditor.getCategory(a);var c={id:a};this.oViewData.updateSelectedNode(c);}this._addAutoCompleteFeatureOnInputs();},handleChangeDetailValue:function(e){this.oConfigurationEditor.setIsUnsaved();var c=this.byId("idCategoryTitle").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var C=this.oTextPool.setText(c,t);this.categoryObj={labelKey:C};var o={};if(c){this.oConfigurationEditor.setCategory(this.categoryObj,this.oCategory.getId());o.name=c;if(c){this.oViewData.updateSelectedNode(o);}}var T=this.getText("category")+": "+c;this.oViewData.updateTitleAndBreadCrumb(T);},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue()!=="")?true:false;if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configuration.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configuration.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configuration",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oApplicationHandler=this.oViewData.oApplicationHandler;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oTextPool=this.oConfigurationHandler.getTextPool();this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idConfigTitle"));this._setMandatoryFields(m);},_setDisplayText:function(){this.byId("idConfigTitleLabel").setText("*"+this.getText("configTitle")+": ");this.byId("idConfigTitle").setPlaceholder(this.getText("newConfiguration"));this.byId("idConfigurationIdLabel").setText(this.getText("configurationId")+": ");this.byId("idSemanticObjectLabel").setText(this.getText("semanticObject")+": ");this.byId("idNoOfCategoriesLabel").setText(this.getText("noOfCategories")+": ");this.byId("idNoOfStepsLabel").setText(this.getText("noOfSteps")+": ");},setDetailData:function(){if(this.params&&this.params.arguments&&this.params.arguments.configId){var e=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);}if(e){this.byId("idConfigTitle").setValue(e.AnalyticalConfigurationName);if(e.AnalyticalConfiguration.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===-1){this.byId("idConfigurationId").setValue(e.AnalyticalConfiguration);}var n=this.oConfigurationEditor.getCategories().length;var a=this.oConfigurationEditor.getSteps().length;this.byId("idNoOfCategories").setValue(n);this.byId("idNoOfSteps").setValue(a);var b=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(b!==undefined){this.byId("idSemanticObject").setValue(b.SemanticObject);}}else{var c=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(c){this.byId("idSemanticObject").setValue(c.SemanticObject);}}},handleChangeDetailValue:function(){var s=this;var c={};var C=this.byId("idConfigTitle").getValue().trim();var a={AnalyticalConfigurationName:C};if(this.oConfigurationEditor){this.oConfigurationEditor.setIsUnsaved();}var t;var o=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);if(C!==""&&C!==undefined){if(o!==undefined){this.oConfigurationHandler.setConfiguration(a,this.params.arguments.configId);this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);c.name=C;var d=s.getText("configuration")+": "+C;if(C){s.oViewData.updateSelectedNode(c);s.oViewData.updateTitleAndBreadCrumb(d);}});}else{t=this.oConfigurationHandler.setConfiguration(a);this.oConfigurationHandler.loadConfiguration(t,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);var d={appId:s.params.arguments.appId,configId:t};c.name=C;var e=s.getText("configuration")+": "+C;c.id=o===undefined?a.AnalyticalConfiguration:undefined;if(C){s.oViewData.updateSelectedNode(c,d);s.oViewData.updateTitleAndBreadCrumb(e);}});}}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue()!=="")?true:false;if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.facetFilter.controller');sap.ui.controller("sap.apf.modeler.ui.controller.facetFilter",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this.oTextPool=this.oConfigurationHandler.getTextPool();this._addConfigStyleClass();this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idffProperty"));m.push(this.byId("idLabel"));m.push(this.byId("idVHDefaultValues"));m.push(this.byId("idVHfunction"));m.push(this.byId("idVHEntity"));m.push(this.byId("idVHSelectProperties"));m.push(this.byId("idFREntity"));m.push(this.byId("idFRSelectProperties"));this._setMandatoryFields(m);},onAfterRendering:function(){this._setMandatoryFieldsVHD();},_addConfigStyleClass:function(){this.byId("idValueHelpTitle").addStyleClass("formTextTitle");this.byId("idFilterResolutionTitle").addStyleClass("formTextTitle");this.byId("idScrollContent").addStyleClass("scrollContentLayout");},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var d={oTranslationFormat:T,type:"text"};var f=this.byId("idLabel");t.setAutoCompleteOn(f,d);var D={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var F=this.byId("idVHSource");t.setAutoCompleteOn(F,D);var o=this.byId("idFRSource");t.setAutoCompleteOn(o,D);}},_setDisplayText:function(){this.byId("idLabel").setPlaceholder(this.getText("facetFilterName"));this.byId("idValueHelpTitle").setText(this.getText("valueHelp"));this.byId("idFilterResolutionTitle").setText(this.getText("filterResolution"));this.byId("idFfPropertyLabel").setText("*"+this.getText("ffProperty")+": ");this.byId("idFfLabel").setText("*"+this.getText("ffLabel")+": ");this.byId("idFfAliasLabel").setText(this.getText("ffAlias")+": ");this.byId("idSelectionModeLabel").setText(this.getText("ffSelectionMode")+": ");this.byId("idVhSourceLabel").setText(this.getText("vhSource")+": ");this.byId("idVhEntityLabel").setText(this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties")+": ");this.byId("idVhDefaultValueModeLabel").setText(this.getText("vhDefaultValueMode")+": ");this.byId("idVhDefaultValuesLabel").setText(this.getText("vhDefaultValues")+": ");this.byId("idVhFunctionLabel").setText(this.getText("function")+": ");this.byId("idVhSourceLabel1").setText(this.getText("vhSource")+": ");this.byId("idVhEntityLabel1").setText(this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties")+": ");this.byId("single").setText(this.getText("singleSelection"));this.byId("multi").setText(this.getText("multipleSelection"));},setDetailData:function(){var p=[];this._addAutoCompleteFeatureOnInputs();var a=this.oConfigurationEditor.getAllKnownProperties();a.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var d={Properties:p};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idffProperty").setModel(m);var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(d);this.byId("idAlias").setModel(M);var D=[{dvKey:this.getText("fixedValues"),dvName:this.getText("fixedValues")},{dvKey:this.getText("function"),dvName:this.getText("function")}];var o={DVModes:D};var b=new sap.ui.model.json.JSONModel();b.setSizeLimit(500);b.setData(o);this.byId("idVHDefaultValueMode").setModel(b);if(this.params&&this.params.arguments&&this.params.arguments.facetFilterId){this.facetFilter=this.oConfigurationEditor.getFacetFilter(this.params.arguments.facetFilterId);}if(this.facetFilter){if(this.params&&this.params.arguments&&this.params.arguments.facetFilterId){this.facetFilter=this.oConfigurationEditor.getFacetFilter(this.params.arguments.facetFilterId);}if(this.facetFilter.getProperty()!==undefined&&this.facetFilter.getProperty()!==null){this.byId("idffProperty").setValue(this.facetFilter.getProperty());}if(this.facetFilter.getLabelKey()!==undefined&&this.facetFilter.getLabelKey()!==null&&this.oTextPool.get(this.facetFilter.getLabelKey())){this.byId("idLabel").setValue(this.oTextPool.get(this.facetFilter.getLabelKey()).TextElementDescription);}else{this.byId("idLabel").setValue(this.params.arguments.facetFilterId);}if(this.facetFilter.getAlias()!==undefined){this.byId("idAlias").setValue(this.facetFilter.getAlias());}if(this.facetFilter.isMultiSelection()!==undefined){this.byId("multi").setSelected(this.facetFilter.isMultiSelection());this.byId("single").setSelected(!this.facetFilter.isMultiSelection());}if(this.facetFilter.getServiceOfValueHelp()!==undefined){this.byId("idVHSource").setValue(this.facetFilter.getServiceOfValueHelp());var s=this.facetFilter.getServiceOfValueHelp();var A=[];var c=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(s);A.forEach(function(t){var u={};u.entityKey=t;u.entityName=t;c.push(u);});var e={Entities:c};var f=new sap.ui.model.json.JSONModel();f.setSizeLimit(500);f.setData(e);this.byId("idVHEntity").setModel(f);this.byId("idVhEntityLabel").setText("*"+this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel").setText("*"+this.getText("vhSelectProperties")+": ");}if(this.facetFilter.getEntitySetOfValueHelp()!==undefined){this.byId("idVHEntity").setSelectedKey(this.facetFilter.getEntitySetOfValueHelp());var E=this.facetFilter.getEntitySetOfValueHelp();var S=this.facetFilter.getServiceOfValueHelp();var P=[];p=[];P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,E);var g=P[0];P.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var h={Properties:p};var i=new sap.ui.model.json.JSONModel();i.setSizeLimit(500);i.setData(h);this.byId("idVHSelectProperties").setModel(i);}if(this.facetFilter.getSelectPropertiesOfValueHelp()&&this.facetFilter.getSelectPropertiesOfValueHelp().length>0){this.byId("idVHSelectProperties").setSelectedKeys(this.facetFilter.getSelectPropertiesOfValueHelp());}if(!this.facetFilter.isMultiSelection()){this.byId("idVhDefaultValuesLabel").setText("*"+this.getText("vhDefaultValues")+": ");this.byId("idVhFunctionLabel").setText("*"+this.getText("function")+": ");}if(this.facetFilter.getPreselectionFunction()){this.byId("idVhDefaultValuesLabelLayout").setVisible(false);this.byId("idVhFunctionLabelLayout").setVisible(true);this.byId("idVHDefaultValueMode").setSelectedKey(this.getText("function"));this.byId("idVHfunction").setValue(this.facetFilter.getPreselectionFunction());if(!this.facetFilter.isMultiSelection()){this.byId("idVHfunction").isMandatory=true;}}else{this.byId("idVhDefaultValuesLabelLayout").setVisible(true);this.byId("idVhFunctionLabelLayout").setVisible(false);this.byId("idVHDefaultValueMode").setSelectedKey(this.getText("fixedValues"));if(this.facetFilter.getPreselectionDefaults().length>0){var j;if(this.facetFilter.isMultiSelection()){j=this.facetFilter.getPreselectionDefaults().join(',');}else{j=this.facetFilter.getPreselectionDefaults()[0];this.byId("idVHDefaultValueMode").isMandatory=true;}this.byId("idVHDefaultValues").setValue(j);}}if(this.facetFilter.getServiceOfFilterResolution()!==undefined&&this.facetFilter.getServiceOfFilterResolution()!==""&&this.facetFilter.getServiceOfFilterResolution()!==null){s=this.facetFilter.getServiceOfFilterResolution();this.byId("idFRSource").setValue(s);A=[];c=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(s);A.forEach(function(t){var u={};u.entityKey=t;u.entityName=t;c.push(u);});var k={Entities:c};var l=new sap.ui.model.json.JSONModel();l.setSizeLimit(500);l.setData(k);this.byId("idFREntity").setModel(l);this.byId("idVhEntityLabel1").setText("*"+this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel1").setText("*"+this.getText("vhSelectProperties")+": ");}if(this.facetFilter.getEntitySetOfFilterResolution()!==undefined&&this.facetFilter.getEntitySetOfFilterResolution()!==null&&this.facetFilter.getEntitySetOfFilterResolution()!==""){E=this.facetFilter.getEntitySetOfFilterResolution();S=this.facetFilter.getServiceOfFilterResolution();this.byId("idFREntity").setSelectedKey(this.facetFilter.getEntitySetOfFilterResolution());P=[];p=[];P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,E);g=P[0];P.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var n={Properties:p};var q=new sap.ui.model.json.JSONModel();q.setSizeLimit(500);q.setData(n);this.byId("idFRSelectProperties").setModel(q);}if(this.facetFilter.getSelectPropertiesOfFilterResolution()!==undefined&&this.facetFilter.getSelectPropertiesOfFilterResolution().length>0){this.byId("idFRSelectProperties").setSelectedKeys(this.facetFilter.getSelectPropertiesOfFilterResolution());}}else{var F=this.oConfigurationEditor.createFacetFilter();this.facetFilter=this.oConfigurationEditor.getFacetFilter(F);this.facetFilter.setMultiSelection(true);this.byId("multi").setSelected(true);var r={id:F};this.oViewData.updateSelectedNode(r);}},handleChangeForProperty:function(e){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idffProperty").getValue().trim();if(p!==""&&p!==null){this.facetFilter.setProperty(p);}},handleChangeForLabel:function(e){this.oConfigurationEditor.setIsUnsaved();var s=this;var t=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var f=this.byId("idLabel").getValue().trim();var F=s.oTextPool.setText(f,t);if(f!==""&&f!==null){this.facetFilter.setLabelKey(F);}var a={};a.name=f;a.id=this.facetFilter.getId();if(f!==""&&f!==null){this.oViewData.updateSelectedNode(a,this.bIsNew);}var T=this.getText("facetFilter")+": "+f;this.oViewData.updateTitleAndBreadCrumb(T);},handleChangeForAlias:function(){this.oConfigurationEditor.setIsUnsaved();var a=this.byId("idAlias").getValue().trim();this.facetFilter.setAlias(a);},_changeInSelectionMode:function(){if(!this.facetFilter.isMultiSelection()){var p=this.facetFilter.getPreselectionDefaults();if(p&&p.length>0){this.facetFilter.setPreselectionDefaults([p[0]]);if(this.byId("idVHDefaultValues")){this.byId("idVHDefaultValues").setValue(p[0]);}}}},handleChangeForSelectionModeSingle:function(){this.byId("idVhDefaultValuesLabel").setText("*"+this.getText("vhDefaultValues")+": ");this.byId("idVhFunctionLabel").setText("*"+this.getText("function")+": ");this.oConfigurationEditor.setIsUnsaved();this.facetFilter.setMultiSelection(false);if(jQuery(this.byId("idVHfunction").getDomRef()).length>=1){this.byId("idVHfunction").isMandatory=true;this.byId("idVHDefaultValues").isMandatory=false;}else{this.byId("idVHfunction").isMandatory=false;this.byId("idVHDefaultValues").isMandatory=true;}this._changeInSelectionMode();},handleChangeForSelectionModeMulti:function(){this.byId("idVhDefaultValuesLabel").setText(this.getText("vhDefaultValues")+": ");this.byId("idVhFunctionLabel").setText(this.getText("function")+": ");this.oConfigurationEditor.setIsUnsaved();this.facetFilter.setMultiSelection(true);if(jQuery(this.byId("idVHfunction").getDomRef()).length>=1){this.byId("idVHfunction").isMandatory=false;}else{this.byId("idVHDefaultValues").isMandatory=false;}},_checkValidationStateForService:function(v,p){var s=this;var S,o,V={source:undefined,entitySet:undefined,selectProperty:undefined};if(v){S=this.byId("idVHSource").getValue().trim();}else{S=this.byId("idFRSource").getValue().trim();}var b=this.oConfigurationEditor.registerService(S);var a=[];var A=[];if(b){V.source=S;a=this.oConfigurationEditor.getAllEntitySetsOfService(S);var c;if(p==="entitySet"||p==="selectProperties"){if(v){c=this.byId("idVHEntity").getSelectedKey();}else{c=this.byId("idFREntity").getSelectedKey();}}else{if(v){c=this.facetFilter.getEntitySetOfValueHelp();}else{c=this.facetFilter.getEntitySetOfFilterResolution();}}if(c){a.forEach(function(e){if(c===e){V.entitySet=c;if(p==="source"){if(v){s.byId("idVHEntity").setSelectedKey(c);}else{s.byId("idFREntity").setSelectedKey(c);}}}});var d,C=[];if(p==="selectProperties"){if(v){d=this.byId("idVHSelectProperties").getSelectedKeys();}else{d=this.byId("idFRSelectProperties").getSelectedKeys();}}else{if(v){d=this.facetFilter.getSelectPropertiesOfValueHelp();}else{d=this.facetFilter.getSelectPropertiesOfFilterResolution();}}var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,c);P.forEach(function(e){d.forEach(function(f){if(f===e){C.push(f);}});});if(C.length>0){V.selectProperty=C;if(p!=="selectProperties"){if(v){this.byId("idVHSelectProperties").setSelectedKeys(C);}else{this.byId("idFRSelectProperties").setSelectedKeys(C);}}}}}if(V.selectProperty&&V.entitySet&&V.source){if(v){this.facetFilter.setServiceOfValueHelp(V.source);this.facetFilter.setEntitySetOfValueHelp(V.entitySet);o=this.facetFilter.getSelectPropertiesOfValueHelp();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfValueHelp(e);});V.selectProperty.forEach(function(e){s.facetFilter.addSelectPropertyOfValueHelp(e);});}else{this.facetFilter.setServiceOfFilterResolution(V.source);this.facetFilter.setEntitySetOfFilterResolution(V.entitySet);o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfFilterResolution(e);});V.selectProperty.forEach(function(e){s.facetFilter.addSelectPropertyOfFilterResolution(e);});}}},handleChangeForVHSource:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var S=this.byId("idVHSource").getValue().trim();var b;if(S){b=this.oConfigurationEditor.registerService(S);if(b){this.byId("idVhEntityLabel").setText("*"+this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel").setText("*"+this.getText("vhSelectProperties")+": ");}}else{this.facetFilter.setServiceOfValueHelp(S);this.facetFilter.setEntitySetOfValueHelp(undefined);var o=this.facetFilter.getSelectPropertiesOfValueHelp();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfValueHelp(e);});this.byId("idVhEntityLabel").setText(this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties")+": ");}var d,a=[],A=[];a=this.oConfigurationEditor.getAllEntitySetsOfService(S);a.forEach(function(e){var E={};E.entityKey=e;E.entityName=e;A.push(E);});var D={Entities:A};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idVHEntity").setModel(m);var p=[],P=[];if(a.length>=1){this.byId("idVHEntity").setSelectedKey(a[0]);this.facetFilter.setEntitySetOfValueHelp(a[0]);p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,a[0]);p.forEach(function(e){var f={};f.propertyKey=e;f.propertyName=e;P.push(f);});}var c={Properties:P};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(c);this.byId("idVHSelectProperties").setModel(M);this._checkValidationStateForService(true,"source");},handleChangeForVHEntity:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var e=this.byId("idVHEntity").getSelectedKey();var S=this.byId("idVHSource").getValue().trim();var p=[],P=[];if(S&&S!==null&&S!==""){p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);p.forEach(function(a){var o={};o.propertyKey=a;o.propertyName=a;P.push(o);});var d={Properties:P};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idVHSelectProperties").setModel(m);this._checkValidationStateForService(true,"entitySet");}},handleChangeForVHSelectProperties:function(){this.oConfigurationEditor.setIsUnsaved();this._checkValidationStateForService(true,"selectProperties");},_setMandatoryFieldsVHD:function(){if(!this.facetFilter.isMultiSelection()){if(jQuery(this.byId("idVHfunction").getDomRef()).length>=1){this.byId("idVHfunction").isMandatory=true;this.byId("idVHDefaultValues").isMandatory=false;}else{this.byId("idVHfunction").isMandatory=false;this.byId("idVHDefaultValues").isMandatory=true;}}else{this.byId("idVHfunction").isMandatory=false;this.byId("idVHDefaultValues").isMandatory=false;}},handleChangeForDVMode:function(){var d=this.byId("idVHDefaultValueMode").getSelectedKey();if(d===this.getText("fixedValues")){this.byId("idVhDefaultValuesLabelLayout").setVisible(true);this.byId("idVhFunctionLabelLayout").setVisible(false);this.facetFilter.removePreselectionFunction();this.byId("idVHfunction").setValue("");}else{this.byId("idVhDefaultValuesLabelLayout").setVisible(false);this.byId("idVhFunctionLabelLayout").setVisible(true);this.facetFilter.removePreselectionDefaults();this.byId("idVHDefaultValues").setValue("");}this._setMandatoryFieldsVHD();},handleChangeForVHdefaultValues:function(e){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idVHDefaultValues").getValue().trim();var P=p.split(',');var v=[];P.forEach(function(d){var V=d.trim();if(V){v.push(V);}});if(this.facetFilter.isMultiSelection()){this.byId("idVHDefaultValues").isMandatory=false;this.facetFilter.setPreselectionDefaults(v);}else{this.byId("idVHDefaultValues").isMandatory=true;if(v.length>0){this.facetFilter.setPreselectionDefaults([v[0]]);}}},handleChangeForPreselectionFunction:function(e){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idVHfunction").getValue().trim();if(this.facetFilter.isMultiSelection()){this.byId("idVHfunction").isMandatory=false;if(p){this.facetFilter.setPreselectionFunction(p);}}else{this.byId("idVHfunction").isMandatory=true;if(p){this.facetFilter.setPreselectionFunction(p);}}},handleChangeForFRSource:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var S=this.byId("idFRSource").getValue().trim();var b;var a=[];var A=[];if(S){b=this.oConfigurationEditor.registerService(S);if(b){this.byId("idVhEntityLabel1").setText("*"+this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel1").setText("*"+this.getText("vhSelectProperties")+": ");}}else{this.facetFilter.setServiceOfFilterResolution(S);this.facetFilter.setEntitySetOfFilterResolution(undefined);var o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(c){s.facetFilter.removeSelectPropertyOfFilterResolution(c);});this.byId("idVhEntityLabel1").setText(this.getText("vhEntity")+": ");this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties")+": ");}a=this.oConfigurationEditor.getAllEntitySetsOfService(S);a.forEach(function(e){var E={};E.entityKey=e;E.entityName=e;A.push(E);});var d={Entities:A};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idFREntity").setModel(m);var p=[],P=[];if(a.length>=1){this.byId("idFREntity").setSelectedKey(a[0]);this.facetFilter.setEntitySetOfFilterResolution(a[0]);p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,a[0]);p.forEach(function(c){var e={};e.propertyKey=c;e.propertyName=c;P.push(e);});}var D={Properties:P};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idFRSelectProperties").setModel(M);this._checkValidationStateForService(false,"source");},handleChangeForFREntity:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var e=this.byId("idFREntity").getSelectedKey();var S=this.byId("idFRSource").getValue().trim();var p=[],P=[];if(S&&S!==null&&S!==""){p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);var d=p[0];p.forEach(function(a){var o={};o.propertyKey=a;o.propertyName=a;P.push(o);});var D={Properties:P};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idFRSelectProperties").setModel(m);this._checkValidationStateForService(false,"entitySet");}},handleChangeForFRSelectProperties:function(){this.oConfigurationEditor.setIsUnsaved();this._checkValidationStateForService(false,"selectProperties");},_setSourceValidationState:function(){var s=this.byId("idVHSource").getValue().trim();var f=this.byId("idFRSource").getValue().trim();var S;var F;if(s!==""){S=this.oConfigurationEditor.registerService(s);if(S){this.byId("idVHEntity").isMandatory=true;this.byId("idVHSelectProperties").isMandatory=true;}else{this.byId("idVHEntity").isMandatory=false;this.byId("idVHSelectProperties").isMandatory=false;}}else{this.byId("idVHEntity").isMandatory=false;this.byId("idVHSelectProperties").isMandatory=false;}if(f){F=this.oConfigurationEditor.registerService(s);if(F){this.byId("idFREntity").isMandatory=true;this.byId("idFRSelectProperties").isMandatory=true;}else{this.byId("idFREntity").isMandatory=false;this.byId("idFRSelectProperties").isMandatory=false;}}else{this.byId("idFREntity").isMandatory=false;this.byId("idFRSelectProperties").isMandatory=false;}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey().length>=1)?true:false;}if(this.isValidState===false){break;}}}},getValidationState:function(){this._setSourceValidationState();this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.previewContent.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.previewContent.controller');sap.ui.getCore().loadLibrary("sap.viz");sap.ui.controller("sap.apf.modeler.ui.controller.previewContent",{onInit:function(){this.oView=this.getView();this.oView.addStyleClass("sapUiSizeCompact");this.oMainChartHolder=this.oView.byId("idMainChart");this.oThumbnailChartHolder=this.oView.byId("idThumbnailChartLayout");this.mParam=this.oView.getViewData();this._prepareRepresentationInstance();this._drawContent();},_drawContent:function(){this._drawMainChart();this._drawThumbnailContent();this._addStyleClasses();},_drawMainChart:function(){var m=this.oRepresentationInstance.getMainContent(this.mParam.sStepLongTitle,480,330);this.oMainChartHolder.addItem(m);},_drawThumbnailContent:function(){this._drawThumbnailChart();this.oView.byId("idStepTitleText").setText(this.mParam.sStepTitle);this._drawCornerTexts();},_drawThumbnailChart:function(){var t=this.oRepresentationInstance.getThumbnailContent();this.oThumbnailChartHolder.addItem(t);},_drawCornerTexts:function(){this.oView.byId("idLeftUpperCornerText").setText(this.mParam.aCornerTexts.sLeftUpper);this.oView.byId("idRightUpperCornerText").setText(this.mParam.aCornerTexts.sRightUpper);this.oView.byId("idLeftLowerCornerText").setText(this.mParam.aCornerTexts.sLeftLower);this.oView.byId("idRightLowerCornerText").setText(this.mParam.aCornerTexts.sRightLower);},_addStyleClasses:function(){this.oView.byId("idChartHolder").addStyleClass("supressDialogPadding");this.oView.byId("idMainChart").addStyleClass("previewMainChartHolder");this.oView.byId("idThumbnail").addStyleClass("previewThumbnailHolder");this.oView.byId("idThumbnailLayout").addStyleClass("previewThumbnailLayout");this.oView.byId("idThumbnailChartLayout").addStyleClass("previewThumbnailChartLayout");this.oView.byId("idTopLayout").addStyleClass("previewThumbnailTopLayout");this.oView.byId("idBottomLayout").addStyleClass("previewThumbnailBottomLayout");this.oView.byId("idLeftUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idLeftLowerCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightLowerCornerText").addStyleClass("previewThumbnailText");},_generateSampleData:function(){var s=[];var n=3;var i=0;var d=this.mParam.aDimensions;var m=this.mParam.aMeasures;var S=this.mParam.oChartParameter.dimensions;var a=this.mParam.oChartParameter.measures;var I=function(b,f,v,r){var c=b.filter(function(o){return o.fieldName===f;});c.forEach(function(C){if(!C.fieldDesc||!C.fieldDesc.length){C.fieldDesc=C.fieldName;}r[C.fieldDesc]=v;});};var l=Math.pow(n,this.mParam.aDimensions.length);for(i=0;i<l;i++){var r={};d.forEach(function(D,b){var c=D+" - "+(Math.floor(i/Math.pow(n,b))%n+1);r[D]=c;I(S,D,c,r);});m.forEach(function(M){var b=Math.round(Math.random()*500);r[M]=b;I(a,M,b,r);});s.push(r);}if(this.mParam.aSort&&this.mParam.aSort.length){s=this._sortData(s,this.mParam.aSort);}return s;},_sortData:function(d,p){return d.sort(function(r,R){var n,i;for(i=0;i<p.length;i++){n=r[p[i].sSortField]<R[p[i].sSortField]?-1:r[p[i].sSortField]>R[p[i].sSortField]?1:0;n=n*[1,-1][+!!p[i].bDescending];if(n!==0){return n;}}});},_getRepresentationConstructor:function(c){var r=sap.apf.core.representationTypes();var R=r.filter(function(R){return R.id===c;})[0];var C=R.constructor;return C;},_prepareRepresentationInstance:function(){var r=this._getRepresentationConstructor(this.mParam.sChartType);jQuery.sap.require(r);var F=sap.apf.utils.extractFunctionFromModulePathString(r);var a={getTextNotHtmlEncoded:function(t){return t;},getTextHtmlEncoded:function(t){return t;}};this.oRepresentationInstance=new F(a,this.mParam.oChartParameter);var m={getPropertyMetadata:function(){return{};}};var s=this._generateSampleData();this.oRepresentationInstance.setData(s,m);}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.representation.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.representation.controller');sap.ui.controller("sap.apf.modeler.ui.controller.representation",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.getEntityTypeMetadata=this.oViewData.getEntityTypeMetadata;this.getRepresentationTypes=this.oViewData.getRepresentationTypes;this.mParam=this.oViewData.oParams;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.mParam.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._addConfigStyleClass();this._setDisplayText();this.setDetailData();this._oPreviewButton=new sap.m.Button({text:this.getText("preview"),press:this._handlePreviewButtonPress.bind(this)});this._insertPreviewButtonInFooter();},_addConfigStyleClass:function(){this.byId("idDirectionLabel").addStyleClass("repFormRightLabel");this.byId("idRadioBtnGroup").addStyleClass("radioBtnGrp");this.byId("idChartIcon").addStyleClass("chartIcon");this.byId("idBasicData").addStyleClass("formTextTitle");this.byId("idSorting").addStyleClass("formTextTitle");this.byId("idThumbnailTexts").addStyleClass("formTextTitle");this.byId("idCornerTextLayout").addStyleClass("cornerTextHLayout");this.byId("idScrollContent").addStyleClass("scrollContentLayout");this.byId("idCornerTextLayout").addStyleClass("detailPageDataLayout");this.byId("idBasicDataLayout").addStyleClass("detailPageDataLayout");this.byId("idChartDataLayout").addStyleClass("detailPageDataLayout");},_setDisplayText:function(){this.byId("idChartTypeLabel").setText(this.getText("chartType")+":");this.byId("idBasicData").setText(this.getText("basicData"));this.byId("idSorting").setText(this.getText("sorting"));this.byId("idSortingFieldLabel").setText(this.getText("sortingField")+":");this.byId("idDirectionLabel").setText(this.getText("direction")+":");this.byId("idAscending").setText(this.getText("ascending"));this.byId("idDescending").setText(this.getText("descending"));this.byId("idThumbnailTexts").setText(this.getText("cornerTextLabel"));this.byId("idLeftUpper").setPlaceholder(this.getText("leftTop"));this.byId("idRightUpper").setPlaceholder(this.getText("rightTop"));this.byId("idLeftLower").setPlaceholder(this.getText("leftBottom"));this.byId("idRightLower").setPlaceholder(this.getText("rightBottom"));},handleChangeForChartType:function(e){var n=e.getParameter("selectedItem").getKey();this._updateAndSetDatasetsByChartType(n);this.sCurrentChartType=n;this.oRepresentation.setRepresentationType(n);var a,r;if(n!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){a=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;}var s=this._getChartPictureDataset().sSelectedChartPicture;this.oRepresentation.setAlternateRepresentationType(a);var R=this.getText(this.oRepresentation.getRepresentationType());var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({name:R,icon:s});}else{this.oViewData.updateTree();}var t=this.getText("representation")+": "+R;this.oViewData.updateTitleAndBreadCrumb(t);this.oConfigurationEditor.setIsUnsaved();},handleChangeForCornerText:function(e){var c=e.getSource();var C=c.getValue();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT;var s=this.oTextPool.setText(C,t);var a=c.getBindingPath('value').replace("/","");var S=["set",a,"CornerTextKey"].join("");this.oRepresentation[S](s);this.oConfigurationEditor.setIsUnsaved();this.mDataset.oCornerTextsDataset[a]=this._getCornerTextsDataset()[a];this.mModel.oCornerTextsModel.updateBindings();},_addAutoCompleteFeatureOnInputs:function(){var s=this;var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var d={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT,type:"text"};var c=["idLeftUpper","idRightUpper","idLeftLower","idRightLower"];c.forEach(function(i){var I=s.getView().byId(i);t.setAutoCompleteOn(I,d);});},_bindBasicRepresentationData:function(){var s=this;var b=this.byId("idBasicDataLayout");var p=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"Right",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),text:{path:"/",formatter:function(){var c=this.getBindingContext().getProperty("sAggregationRole");var k=this.getBindingContext().getProperty("sKind");if(c&&k){c=s.getText(c);k=s.getText(k);var t=s.getText("dim-measure-label",[c,k]);return t+":";}}}});p.addContent(a);var P=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L4 M3 S3"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"})},selectedKey:"{sSelectedProperty}",change:function(){s._setPropertiesFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}});p.addContent(P);var l=new sap.m.Label({width:"100%",textAlign:"Right",layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),text:this.getText("label")+":"}).addStyleClass("repFormRightLabel");p.addContent(l);var i=new sap.m.Input({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),value:"{sLabel}",visible:{path:"sLabel",formatter:function(){if(!this.mEventRegistry.suggest){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(s.oTextPool);var d={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL,type:"text"};t.setAutoCompleteOn(this,d);}return true;}},change:function(){var c=this.getBindingContext().getProperty("sSelectedProperty");if(c!==s.getText("none")){s._setPropertiesFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}});p.addContent(i);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:s.getText("addButton"),visible:{path:"nMax",formatter:function(n){return(n==="*");}},press:function(){var B=this.getBindingContext();var c=jQuery.extend(true,{},B.getObject());delete c.sSelectedProperty;delete c.sLabel;var n=parseInt(B.getPath().split("/").pop(),10);var d=s.mDataset.oPropertyDataset.aPropertyRows;d.splice(n+1,0,c);s.mModel.oPropertyModel.updateBindings();s._setPropertiesFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:s.getText("deleteButton"),visible:{path:"/",formatter:function(){var c=true;var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);if(n){var d=s.mDataset.oPropertyDataset.aPropertyRows;var C=d[n].sKind;var e=d[n].sAggregationRole;var f=n-1;var g=d[f].sKind;var h=d[f].sAggregationRole;c=!(C===g&&e===h);}return!c;}},press:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);var c=s.mDataset.oPropertyDataset.aPropertyRows;c.splice(n,1);s.mModel.oPropertyModel.updateBindings();s._setPropertiesFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}).addStyleClass("lessIconRepresentation");var I=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});p.addContent(I);b.bindAggregation("items","/aPropertyRows",p);},_bindSortLayoutData:function(){var s=this;var S=this.byId("idSortLayout");var o=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"Right",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),text:this.getText("sortingField")+":"});o.addContent(a);var b=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L4 M3 S3"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"})},selectedKey:"{sSortProperty}",change:function(){s._setSortFieldsFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}});o.addContent(b);var d=new sap.m.Label({width:"100%",textAlign:"Right",layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),text:this.getText("direction")+":"}).addStyleClass("repFormRightLabel");o.addContent(d);var D=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),items:[{key:this.getText("ascending"),text:this.getText("ascending")},{key:this.getText("descending"),text:this.getText("descending")}],selectedKey:"{sDirection}",change:function(){var c=this.getBindingContext().getProperty("sSortProperty");if(c!==s.getText("none")){s._setSortFieldsFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}});o.addContent(D);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:this.getText("addButton"),visible:true,press:function(){var B=this.getBindingContext();var c=jQuery.extend(true,{},B.getObject());delete c.sSortProperty;delete c.sDirection;var n=parseInt(B.getPath().split("/").pop(),10);var e=s.mDataset.oSortDataset.aSortRows;e.splice(n+1,0,c);s.mModel.oSortModel.updateBindings();s._setSortFieldsFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:this.getText("deleteButton"),visible:{path:"/",formatter:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);return!!n;}},press:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);var c=s.mDataset.oSortDataset.aSortRows;c.splice(n,1);s.mModel.oSortModel.updateBindings();s._setSortFieldsFromCurrentDataset();s.oConfigurationEditor.setIsUnsaved();}}).addStyleClass("lessIconRepresentation");var i=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});o.addContent(i);S.bindAggregation("items","/aSortRows",o);},setDetailData:function(){var c=this.mParam.arguments;this.oParentStep=this.oConfigurationEditor.getStep(c.stepId);this.aSelectProperties=this._getSelectPropertiesFromParentStep();this.oRepresentation=this.oParentStep.getRepresentation(c.representationId);if(!this.oRepresentation){this.oRepresentation=this.oParentStep.createRepresentation();this._setDefaultRepresentationType();this._setDefaultProperties();this.oConfigurationEditor.setIsUnsaved();}var C=this._getChartTypeDataset();var p=this._getPropertyDataset();var s=this._getSortDataset();var o=this._getCornerTextsDataset();var a=this._getChartPictureDataset();this.mDataset={oChartTypeDataset:C,oPropertyDataset:p,oSortDataset:s,oCornerTextsDataset:o,oChartPictureDataset:a};var b=new sap.ui.model.json.JSONModel(this.mDataset.oChartTypeDataset);var P=new sap.ui.model.json.JSONModel(this.mDataset.oPropertyDataset);var S=new sap.ui.model.json.JSONModel(this.mDataset.oSortDataset);var d=new sap.ui.model.json.JSONModel(this.mDataset.oCornerTextsDataset);var e=new sap.ui.model.json.JSONModel(this.mDataset.oChartPictureDataset);this.mModel={oChartTypeModel:b,oPropertyModel:P,oSortModel:S,oCornerTextsModel:d,oChartPictureModel:e};this.byId("idChartType").setModel(this.mModel.oChartTypeModel);var f=this.sCurrentChartType;this._updateAndSetDatasetsByChartType(f);this.byId("idBasicDataLayout").setModel(this.mModel.oPropertyModel);this._bindBasicRepresentationData();this.byId("idSortLayout").setModel(this.mModel.oSortModel);this._bindSortLayoutData();this.byId("idCornerTextLayout").setModel(this.mModel.oCornerTextsModel);this.byId("idChartIcon").setModel(this.mModel.oChartPictureModel);this._addAutoCompleteFeatureOnInputs();},_insertPreviewButtonInFooter:function(){var f=this.oViewData.oFooter;f.addContentRight(this._oPreviewButton);},_removePreviewButtonFromFooter:function(){var f=this.oViewData.oFooter;f.removeContentRight(this._oPreviewButton);},_handlePreviewButtonPress:function(){var p=this._getPreviewDetails();var P=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewName:"sap.apf.modeler.ui.view.previewContent",viewData:p});var o=new sap.m.Dialog({title:this.getText("preview"),content:P,endButton:new sap.m.Button({text:this.getText("close"),press:function(){o.close();}})});o.open();},onExit:function(){this._removePreviewButtonFromFooter();},_getPreviewDetails:function(){var s=this;var c=this.mDataset.oChartTypeDataset.sSelectedChartType;var S=this._getParentStepTitle();var a=this._getParentStepLongTitle()||S;var d=[],m=[];this.aSelectProperties.forEach(function(o){if(o.sAggregationRole==="dimension"){d.push(o.sName);}else if(o.sAggregationRole==="measure"){m.push(o.sName);}});var C={dimensions:[],measures:[]};this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){if(p.sSelectedProperty!==s.getText("none")){var A=p.sAggregationRole+"s";C[A].push({fieldDesc:p.sLabel,fieldName:p.sSelectedProperty,kind:p.sKind});}});var b=[];this.mDataset.oSortDataset.aSortRows.forEach(function(o){var f=o.sSortProperty||(o.aAllProperties.length&&o.aAllProperties[0].sName);if(f&&f!==s.getText("none")){var A=!o.sDirection||(o.sDirection===s.getText("ascending"));b.push({sSortField:f,bDescending:!A});}});var e={sLeftUpper:this.mDataset.oCornerTextsDataset.LeftUpper,sRightUpper:this.mDataset.oCornerTextsDataset.RightUpper,sLeftLower:this.mDataset.oCornerTextsDataset.LeftLower,sRightLower:this.mDataset.oCornerTextsDataset.RightLower};return{sChartType:c,sStepTitle:S,sStepLongTitle:a,aDimensions:d,aMeasures:m,oChartParameter:C,aSort:b,aCornerTexts:e};},_getParentStepLongTitle:function(){var s=this.oParentStep.getLongTitleId();s=!this.oTextPool.isInitialTextKey(s)?s:undefined;var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getParentStepTitle:function(){var s=this.oParentStep.getTitleId();var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getSelectPropertiesFromParentStep:function(){var a=this.oParentStep.getService();var e=this.oParentStep.getEntitySet();var E=this.getEntityTypeMetadata(a,e);var s=this.oParentStep.getSelectProperties();var r=s.map(function(p){var m=E.getPropertyMetadata(p);return{sName:p,sAggregationRole:m["aggregation-role"]};});return r;},_getCornerTextsFromConfigObject:function(c){var s=this;var C=["LeftUpper","RightUpper","LeftLower","RightLower"];var d={};C.forEach(function(a){var m=["get",a,"CornerTextKey"].join("");var b=c[m]();b=!s.oTextPool.isInitialTextKey(b)?b:undefined;var o=b&&s.oTextPool.get(b);var e=o&&o.TextElementDescription;d[a]=e;});return d;},_getChartTypeDataset:function(){var s=this;var k=Object.keys(this._getRepresentationMetadata());var c=k.map(function(K){return{sId:K,sText:s.getText(K)};});var d={aChartTypes:c,sSelectedChartType:this.oRepresentation.getRepresentationType()};this.sCurrentChartType=d.sSelectedChartType;return d;},_getChartPictureDataset:function(){var r=this.getRepresentationTypes();var d={};r.forEach(function(o){var i=o.id;d[i]=o.picture;});d.sSelectedChartPicture=d[this.oRepresentation.getRepresentationType()];return d;},_updatePictureDataset:function(c){var d=this.mModel.oChartPictureModel.getData();d.sSelectedChartPicture=d[c];},_getPropertyDataset:function(){var s=this;var p=[];var a=function(t){var g=["get",t,"s"].join("");var P=s.oRepresentation[g]();P.forEach(function(b){var l=["get",t,"TextLabelKey"].join("");var L=s.oRepresentation[l](b);var o=L&&s.oTextPool.get(L);var c=o&&o.TextElementDescription;var k=["get",t,"Kind"].join("");var K=s.oRepresentation[k](b);var C=s.oRepresentation.getRepresentationType();var r=s._getRepresentationMetadata()[C];var S=r[t.toLowerCase()+"s"].supportedKinds;var n,d;S.forEach(function(e){if(e.kind===K){n=e.min;d=e.max;}});p.push({sSelectedProperty:b,sAggregationRole:t.toLowerCase(),sLabel:c,sKind:K,nMin:n,nMax:d});});};a("Dimension");a("Measure");return{aPropertyRows:p};},_getSortDataset:function(){var s=this;var o=this.oRepresentation.getOrderbySpecifications();var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});if(!o.length){o.push({});}var S=o.map(function(O){var b=O.property;var c=O.ascending!==undefined&&!O.ascending?s.getText("descending"):s.getText("ascending");return{sSortProperty:b,sDirection:c,aAllProperties:a};});return{aSortRows:S};},_getCornerTextsDataset:function(){var r=this._getCornerTextsFromConfigObject(this.oRepresentation);var p=this._getCornerTextsFromConfigObject(this.oParentStep);var d=jQuery.extend({},p,r);return d;},_setDefaultRepresentationType:function(){var d;if(this.getRepresentationTypes()[0].metadata){d=this.getRepresentationTypes()[0].id;}this.oRepresentation.setRepresentationType(d);this.oRepresentation.setAlternateRepresentationType(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION);var r=this.getText(this.oRepresentation.getRepresentationType());var s=this._getChartPictureDataset().sSelectedChartPicture;var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({id:this.oRepresentation.getId(),icon:s});}else{var R=[];var a=jQuery.extend(true,{},this.mParam);var o={id:this.oRepresentation.getId(),aStepCategories:S,stepContext:a};this.oViewData.updateTree();}},_setDefaultProperties:function(){var f,F;this.aSelectProperties.forEach(function(s){if(!f){if(s.sAggregationRole==="dimension"){f=s.sName;}}if(!F){if(s.sAggregationRole==="measure"){F=s.sName;}}});if(f){this.oRepresentation.addDimension(f);this.oRepresentation.setDimensionKind(f,sap.apf.core.constants.representationMetadata.kind.XAXIS);}if(F){this.oRepresentation.addMeasure(F);this.oRepresentation.setMeasureKind(F,sap.apf.core.constants.representationMetadata.kind.YAXIS);}},_updateAndSetDatasetsByChartType:function(c){this._updatePropertyDatasetByChartType(c);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this._updateSortDatasetByChartType(c);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this._updatePictureDataset(c);this.mModel.oChartPictureModel.updateBindings();},_updatePropertyDatasetByChartType:function(c){var s=this;var d={aPropertyRows:[]};var r=this._getRepresentationMetadata()[c];var a=["dimensions","measures"];a.forEach(function(A){if(r.hasOwnProperty(A)){var S=r[A].supportedKinds;S.forEach(function(o){var p={sAggregationRole:A.slice(0,-1),sKind:o.kind,nMin:o.min,nMax:o.max,aAllProperties:s.aSelectProperties.filter(function(P){return(P.sAggregationRole===(A.slice(0,-1)));})};if(!parseInt(o.min,10)){p.aAllProperties.unshift({sName:s.getText("none"),sAggregationRole:A.slice(0,-1)});}d.aPropertyRows.push(p);});}});var R={aPropertyRows:[]};d.aPropertyRows.forEach(function(D){var e=false;s.mDataset.oPropertyDataset.aPropertyRows.forEach(function(E){var h=E.sAggregationRole===D.sAggregationRole;var H=E.sKind===D.sKind;var b=E.nMin===D.nMin;var f=E.nMax===D.nMax;if(h&&H&&b&&f){e=true;var C=jQuery.extend(E,D);R.aPropertyRows.push(C);}});if(!e){R.aPropertyRows.push(D);}});this.mDataset.oPropertyDataset.aPropertyRows=R.aPropertyRows;},_updateSortDatasetByChartType:function(c){var r=this._getRepresentationMetadata()[c];if(r.sortable!==undefined&&!r.sortable){var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});this.mDataset.oSortDataset.aSortRows=[{aAllProperties:a,sDirection:this.getText("ascending")}];this.byId("idSortLayout").setVisible(false);this.byId("idSorting").setVisible(false);}else{this.byId("idSortLayout").setVisible(true);this.byId("idSorting").setVisible(true);this.mModel.oSortModel.updateBindings();var s=this.byId("idSortLayout");jQuery.sap.delayedCall(10,s,s.rerender);}},_setPropertiesFromCurrentDataset:function(){var s=this;var d=this.oRepresentation.getDimensions();d.forEach(function(D){s.oRepresentation.removeDimension(D);});var m=this.oRepresentation.getMeasures();m.forEach(function(M){s.oRepresentation.removeMeasure(M);});this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){var S=p.sSelectedProperty||(p.aAllProperties.length&&p.aAllProperties[0].sName);if(S&&S!==s.getText("none")){var a=p.sAggregationRole;var A=[a.charAt(0).toUpperCase(),a.substring(1)].join("");var l=p.sLabel;var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL;var L=s.oTextPool.setText(l,t);var b=["add",A].join("");var c=["set",A,"Kind"].join("");var e=["set",A,"TextLabelKey"].join("");s.oRepresentation[b](S);s.oRepresentation[c](S,p.sKind);s.oRepresentation[e](S,L);}});},_setSortFieldsFromCurrentDataset:function(){var s=this;this.oRepresentation.getOrderbySpecifications().forEach(function(o){s.oRepresentation.removeOrderbySpec(o.property);});this.mDataset.oSortDataset.aSortRows.forEach(function(S){var a=S.sSortProperty||(S.aAllProperties.length&&S.aAllProperties[0].sName);if(a&&a!==s.getText("none")){var A=!S.sDirection||(S.sDirection===s.getText("ascending"));s.oRepresentation.addOrderbySpec(a,A);}});},_getRepresentationMetadata:function(){var r={};this.getRepresentationTypes().forEach(function(a){if(a.metadata){r[a.id]=a.metadata;}});return r;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.step.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.step.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.modeler.ui.controller.step",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this.oTextPool=this.oConfigurationHandler.getTextPool();this._addConfigStyleClass();this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idstepTitle"));m.push(this.byId("idSourceSelect"));m.push(this.byId("idSelectPropCombo"));m.push(this.byId("idCategorySelect"));m.push(this.byId("idFilterMapEntitySelect"));m.push(this.byId("idFilterMapTargetFilterCombo"));this._setMandatoryFields(m);if(this.step.getFilterMappingService()===undefined||this.step.getFilterMappingService()===""){this._removeMandatoryFromFilterMap();}},_setDisplayText:function(){this.byId("idStepTitleLabel").setText("*"+this.getText("stepTitle")+": ");this.byId("idstepTitle").setPlaceholder(this.getText("newStep"));this.byId("idStepLongTitleLabel").setText(this.getText("stepLongTitle")+": ");this.byId("idstepLongTitle").setPlaceholder(this.getText("stepLongTitle"));this.byId("idCategoryTitleLabel").setText("*"+this.getText("categoryTitle")+": ");this.byId("idSourceSelectLabel").setText("*"+this.getText("source")+": ");this.byId("idEntitySelectLabel").setText("*"+this.getText("entity")+": ");this.byId("idSelectPropComboLabel").setText("*"+this.getText("selectProperties")+": ");this.byId("idReqFilterSelectLabel").setText(this.getText("requiredFilters")+": ");this.byId("idDataRequest").setText(this.getText("dataRequest"));this.byId("idCornerTextLabel").setText(this.getText("cornerTextLabel"));this.byId("idLeftTop").setPlaceholder(this.getText("leftTop"));this.byId("idRightTop").setPlaceholder(this.getText("rightTop"));this.byId("idLeftBottom").setPlaceholder(this.getText("leftBottom"));this.byId("idRightBottom").setPlaceholder(this.getText("rightBottom"));},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var s=this.byId("idstepTitle");var T=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var d={oTranslationFormat:T,type:"text"};t.setAutoCompleteOn(s,d);var S=this.byId("idstepLongTitle");var o=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var D={oTranslationFormat:o,type:"text"};t.setAutoCompleteOn(S,D);var a=this.byId("idLeftTop");var b=this.byId("idRightTop");var c=this.byId("idLeftBottom");var e=this.byId("idRightBottom");var f=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var g={oTranslationFormat:f,type:"text"};t.setAutoCompleteOn(a,g);t.setAutoCompleteOn(b,g);t.setAutoCompleteOn(c,g);t.setAutoCompleteOn(e,g);var h={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var i=this.byId("idSourceSelect");t.setAutoCompleteOn(i,h);var j=this.byId("idFilterMapSourceSelect");t.setAutoCompleteOn(j,h);}},_addConfigStyleClass:function(){this.byId("idChartIcon").addStyleClass("chartIcon");this.byId("idDataRequest").addStyleClass("formTextTitle");this.byId("idCornerTextLabel").addStyleClass("formTextTitle");this.byId("idCornerTextLayout").addStyleClass("cornerTextHLayout");this.byId("idScrollContent").addStyleClass("scrollContentLayout");this.byId("DataRequestLayout").addStyleClass("detailPageDataLayout");this.byId("FilterMapLayout").addStyleClass("detailPageDataLayout");this.byId("idCornerTextLayout").addStyleClass("detailPageDataLayout");},setDetailData:function(){var s=this;var C=[];this.oTextPool=this.oConfigurationHandler.getTextPool();var a=this.oConfigurationEditor.getCategories();a.forEach(function(L){var N={};N.CategoryId=L.getId();N.CategoryTitle=s.oTextPool.get(L.labelKey)?s.oTextPool.get(L.labelKey).TextElementDescription:L.labelKey;C.push(N);});var d={Categories:C};var m=new sap.ui.model.json.JSONModel();m.setData(d);this.byId("idCategorySelect").setModel(m);var p={propertyKey:this.getText("none"),propertyName:this.getText("none")};var D={Properties:[p]};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);var S=[];var o=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];o.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;S.push(p);});var b=new sap.ui.model.json.JSONModel();b.setSizeLimit(500);b.setData(S);this.byId("idFilterMapTargetFilterCombo").setModel(b);if(this.params&&this.params.arguments&&this.params.arguments.stepId){this.step=this.oConfigurationEditor.getStep(this.params.arguments.stepId);}if(this.step){var n=this.getText("none");var c=[n];if(this.step.getTitleId&&this.step.getTitleId()!==undefined&&this.step.getTitleId()!==null&&s.oTextPool.get(this.step.getTitleId())){this.byId("idstepTitle").setValue(s.oTextPool.get(this.step.getTitleId()).TextElementDescription);}else{this.byId("idstepTitle").setValue(this.params.arguments.stepId);}if(this.step.getLongTitleId&&this.step.getLongTitleId()!==undefined&&this.step.getLongTitleId()!==null&&s.oTextPool.get(this.step.getLongTitleId())){this.byId("idstepLongTitle").setValue(s.oTextPool.get(this.step.getLongTitleId()).TextElementDescription);}else{this.byId("idstepLongTitle").setValue("");}if(this.step.getService&&this.step.getService()!==undefined&&this.step.getService()!==null){this.byId("idSourceSelect").setValue(this.step.getService());var e=this.step.getService();var A=[];var f=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(e);A.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;f.push(N);});var g={Entities:f};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);this.byId("idEntitySelect").setModel(h);}if(this.step.getEntitySet&&this.step.getEntitySet()!==undefined&&this.step.getEntitySet()!==null){this.byId("idEntitySelect").setSelectedKey(this.step.getEntitySet());var E=this.step.getEntitySet();var i=this.step.getService();var P=[],j=[];if(i&&i!==null&&i!==""){P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(i,E);P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});var k={Properties:j};var l=new sap.ui.model.json.JSONModel();l.setSizeLimit(500);l.setData(k);this.byId("idSelectPropCombo").setModel(l);}}if(this.step.getSelectProperties&&this.step.getSelectProperties()!==undefined&&this.step.getSelectProperties().length!==0){this.byId("idSelectPropCombo").setSelectedKeys(this.step.getSelectProperties());P=c.concat(this.step.getSelectProperties());j=[];P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});D={Properties:j};M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);}if(this.step.getFilterProperties&&this.step.getFilterProperties()!==undefined&&this.step.getFilterProperties().length!==0){this.byId("idReqFilterSelect").setSelectedKey(this.step.getFilterProperties()[0]);this._showFilterMappingField();}else{this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));this._hideAndResetFilterMapField();}if(this.step.getFilterMappingService&&this.step.getFilterMappingService()!==undefined&&this.step.getFilterMappingService().length!==0){this.byId("idFilterMapSourceSelect").setValue(this.step.getFilterMappingService());var F=this.step.getFilterMappingService();var q=[];var r=[];var R=this.step.getFilterProperties();q=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(F,R);q.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;r.push(N);});var t={Entities:r};var u=new sap.ui.model.json.JSONModel();u.setSizeLimit(500);u.setData(t);this.byId("idFilterMapEntitySelect").setModel(u);this._addMandatoryfromFilterMap();}else{this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();}if(this.step.getFilterMappingEntitySet&&this.step.getFilterMappingEntitySet()!==undefined&&this.step.getFilterMappingEntitySet().length!==0){this.byId("idFilterMapEntitySelect").setSelectedKey(this.step.getFilterMappingEntitySet());var v=this.step.getFilterMappingEntitySet();var w=this.step.getFilterMappingService();var x=[],y=[];if(w&&w!==null&&w!==""){x=this.oConfigurationEditor.getAllPropertiesOfEntitySet(w,v);x.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;y.push(p);});var z={Properties:y};var B=new sap.ui.model.json.JSONModel();B.setSizeLimit(500);B.setData(z);this.byId("idFilterMapTargetFilterCombo").setModel(B);}}if(this.step.getFilterMappingTargetProperties&&this.step.getFilterMappingTargetProperties()!==undefined&&this.step.getFilterMappingTargetProperties().length!==0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(this.step.getFilterMappingTargetProperties());}if(this.step.getFilterMappingKeepSource&&this.step.getFilterMappingKeepSource()!==undefined){this.byId("idFilterKeepSourceCheckBox").setSelected(this.step.getFilterMappingKeepSource());}var G=s.oConfigurationEditor.getCategoriesForStep(this.step.getId());if(G&&G.length!==0){this.byId("idCategorySelect").setSelectedKeys(G);}if(this.step.getLeftLowerCornerTextKey()&&s.oTextPool.get(this.step.getLeftLowerCornerTextKey())){this.byId("idLeftBottom").setValue(s.oTextPool.get(this.step.getLeftLowerCornerTextKey()).TextElementDescription);}else{this.byId("idLeftBottom").setValue(this.step.getLeftLowerCornerTextKey());}if(this.step.getLeftUpperCornerTextKey()&&s.oTextPool.get(this.step.getLeftUpperCornerTextKey())){this.byId("idLeftTop").setValue(s.oTextPool.get(this.step.getLeftUpperCornerTextKey()).TextElementDescription);}else{this.byId("idLeftTop").setValue(this.step.getLeftUpperCornerTextKey());}if(this.step.getRightUpperCornerTextKey()&&s.oTextPool.get(this.step.getRightUpperCornerTextKey())){this.byId("idRightTop").setValue(s.oTextPool.get(this.step.getRightUpperCornerTextKey()).TextElementDescription);}else{this.byId("idRightTop").setValue(this.step.getRightUpperCornerTextKey());}if(this.step.getRightLowerCornerTextKey()&&s.oTextPool.get(this.step.getRightLowerCornerTextKey())){this.byId("idRightBottom").setValue(s.oTextPool.get(this.step.getRightLowerCornerTextKey()).TextElementDescription);}else{this.byId("idRightBottom").setValue(this.step.getRightLowerCornerTextKey());}}else{var H=this.params.arguments.categoryId;var I=s.oConfigurationEditor.createStep(H);this.step=s.oConfigurationEditor.getStep(I);var J=[H];this.byId("idCategorySelect").setSelectedKeys(J);var K={id:I};this.oViewData.updateSelectedNode(K);}this._addAutoCompleteFeatureOnInputs();},handleChangeDetailValueForTree:function(e){this.oConfigurationEditor.setIsUnsaved();var s=this;var S=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var a=this.byId("idstepTitle").getValue().trim();var b=s.oTextPool.setText(a,t);if(a!==""&&a!==null){this.step.setTitleId(b);}var c={};c.name=a;c.id=this.step.getId();if(a!==""&&a!==null){if(S.length>1){this.oViewData.updateTree();}else{this.oViewData.updateSelectedNode(c);}}var T=this.getText("step")+": "+a;this.oViewData.updateTitleAndBreadCrumb(T);},handleChangeForLongTitle:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idstepLongTitle").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var S=this.oTextPool.setText(s,t);this.step.setLongTitleId(S);},handleChangeForService:function(e){this.oConfigurationEditor.setIsUnsaved();var s,a=[],A=[],p=[],S=[],r;var b=this.byId("idReqFilterSelect").getSelectedKey();if(b!==this.getText("none")){r=[b];}else{r=this.step.getFilterProperties();}var c=e?e.getParameter("id"):"";var i=c.search("FilterMap")!==-1?true:false;var d;if(i){s=this.byId("idFilterMapSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);if(d){this._addMandatoryfromFilterMap();a=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(s,r);}else{this._removeMandatoryFromFilterMap();}}else{if(b===this.getText("none")||b===""){this._hideAndResetFilterMapField();}else{this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();}s=this.byId("idSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);a=this.oConfigurationEditor.getAllEntitySetsOfService(s);}a.forEach(function(q){var t={};t.entityKey=q;t.entityName=q;A.push(t);});var E={Entities:A};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(E);var f;if(a.length>=1){if(i){if(this.step.getFilterMappingEntitySet()){f=this.step.getFilterMappingEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setFilterMappingEntitySet(a[0]);this.byId("idFilterMapEntitySelect").setSelectedKey(a[0]);}else{if(this.step.getEntitySet()){f=this.step.getEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setEntitySet(a[0]);this.byId("idEntitySelect").setSelectedKey(a[0]);}p.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;S.push(P);});}var g={Properties:S};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);var j=[],k=[];var l=this.byId("idSelectPropCombo").getSelectedKeys();l.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;j.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var N=[n];N=N.concat(j);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);R.setData(N);var m=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];m.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;k.push(P);});if(i){this.byId("idFilterMapEntitySelect").setModel(o);this.byId("idFilterMapTargetFilterCombo").setModel(h);}else{this.byId("idEntitySelect").setModel(o);this.byId("idSelectPropCombo").setModel(h);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("source",c);},_addMandatoryfromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=true;this.byId("idFilterMapTargetFilterCombo").isMandatory=true;this.byId("idFilterMapEntityLabel").setText("*"+this.getText("entity")+" : ");this.byId("idFilterMapTargetFilterLabel").setText("*"+this.getText("filterMapTarget")+" : ");this.byId("idFilterMapKeepSourceLabel").setText("*"+this.getText("filterMapKeepSource")+" : ");},_removeMandatoryFromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=false;this.byId("idFilterMapTargetFilterCombo").isMandatory=false;this.byId("idFilterMapEntityLabel").setText(this.getText("entity")+" : ");this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget")+" : ");this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource")+" : ");},_resetFilterMappingFields:function(){var s=this;this.step.setFilterMappingService("");this.step.setFilterMappingEntitySet(undefined);this.step.setFilterMappingKeepSource(undefined);var o=this.step.getFilterMappingTargetProperties();var O=this.step.getFilterMappingSelectProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});O.forEach(function(p){s.step.removeFilterMappingSelectProperty(p);});var e=new sap.ui.model.json.JSONModel();var E={NoData:[]};e.setData(E);this.byId("idFilterMapSourceSelect").setValue("");this.byId("idFilterMapEntitySelect").setModel(e);this.byId("idFilterMapEntitySelect").setSelectedKey();this.byId("idFilterMapTargetFilterCombo").setModel(e);var S=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();this.byId("idFilterMapTargetFilterCombo").removeSelectedKeys(S);},handleChangeForEntity:function(e){this.oConfigurationEditor.setIsUnsaved();var E,s,p=[],P=[];var a=e.getParameter("id");var i=a.search("FilterMap")!==-1?true:false;if(i){E=this.byId("idFilterMapEntitySelect").getSelectedKey();s=this.byId("idFilterMapSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}else{E=this.byId("idEntitySelect").getSelectedKey();s=this.byId("idSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}p.forEach(function(c){var d={};d.propertyKey=c;d.propertyName=c;P.push(d);});var S={Properties:P};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(S);var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(P);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);R.setData(r);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(P);if(i){this.byId("idFilterMapTargetFilterCombo").setModel(o);}else{this.byId("idSelectPropCombo").setModel(o);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("entitySet",a);var b=this.byId("idReqFilterSelect").getSelectedKey();if(b===this.getText("none")){this._hideAndResetFilterMapField();}},handleChangeForSelectProperty:function(e){var s=this;this.oConfigurationEditor.setIsUnsaved();var S,a=[];var b=e.getParameter("id");S=this.byId("idSelectPropCombo").getSelectedKeys();S.forEach(function(p){s.step.addSelectProperty(p);var P={};P.propertyKey=p;P.propertyName=p;a.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(a);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);R.setData(r);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(a);this.byId("idReqFilterSelect").setModel(R);this._checkValidationStateForService("selectProperties",b);var c=this.byId("idReqFilterSelect").getSelectedKey();if(c===this.getText("none")){this._hideAndResetFilterMapField();}},handleChangeForRequiredFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var o=this.step.getFilterProperties();o.forEach(function(p){s.step.removeFilterProperty(p);});var r=this.byId("idReqFilterSelect").getSelectedKey();if(r!==this.getText("none")){this.step.addFilterProperty(r);this._showFilterMappingField();}else{this._hideAndResetFilterMapField();}this._checkValidationStateForService("requiredFilter",a);},_showFilterMappingField:function(){this.byId("idFilterMapping").setVisible(true);this.byId("FilterMapLayout").setVisible(true);this.byId("idFilterMapping").setText(this.getText("filterMap")+" : ");this.byId("idFilterMapSourceLabel").setText(this.getText("source")+" : ");this.byId("idFilterMapEntityLabel").setText(this.getText("entity")+" : ");this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget")+" : ");this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource")+" : ");this.byId("idFilterMapping").addStyleClass("formTextTitle");},_hideAndResetFilterMapField:function(){this.byId("idFilterMapping").setVisible(false);this.byId("FilterMapLayout").setVisible(false);this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();},handleChangeForTargetFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();if(t.length>0){var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});t.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}this._checkValidationStateForService("targetProperties",a);},handleFilterMapKeepSource:function(){var i=this.byId("idFilterKeepSourceCheckBox").getSelected();this.oConfigurationEditor.setIsUnsaved();this.step.setFilterMappingKeepSource(i);},_checkValidationStateForService:function(p,s){var a=this;var v={source:undefined,entitySet:undefined,selectProperty:undefined,requiredFilter:undefined,targetFilter:undefined};var S,r,A=[],b=[];var i=s.search("FilterMap")!==-1?true:false;S=i?this.byId("idFilterMapSourceSelect").getValue().trim():this.byId("idSourceSelect").getValue().trim();var c=this.oConfigurationEditor.registerService(S);if(c){v.source=S;var d=this.byId("idReqFilterSelect").getSelectedKey();if(d!==this.getText("none")){r=[d];}else{r=this.step.getFilterProperties();}A=i?this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(S,r):this.oConfigurationEditor.getAllEntitySetsOfService(S);var e;if(p==="entitySet"||p==="selectProperties"||p==="targetProperties"||p==="requiredFilter"){e=i?this.byId("idFilterMapEntitySelect").getSelectedKey():this.byId("idEntitySelect").getSelectedKey();}else{e=i?this.step.getFilterMappingEntitySet():this.step.getEntitySet();}if(e){A.forEach(function(u){if(e===u){v.entitySet=e;if(p==="source"){if(i){a.byId("idFilterMapEntitySelect").setSelectedKey(e);}else{a.byId("idEntitySelect").setSelectedKey(e);}}}});var f,C=[];if(p==="selectProperties"){f=this.byId("idSelectPropCombo").getSelectedKeys();}else{f=this.step.getSelectProperties();}var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);var g=[];P.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;g.push(w);});var D={Properties:g};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idSelectPropCombo").setModel(m);this.byId("idFilterMapTargetFilterCombo").setModel(m);P.forEach(function(u){f.forEach(function(w){if(w===u){C.push(w);}});});var h=[];var o=[{propertyKey:this.getText("none"),propertyName:this.getText("none")}];if(this.step.getFilterMappingTargetProperties().length===0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys([]);}if(C.length>0){v.selectProperty=C;if(p!=="selectProperties"){this.byId("idSelectPropCombo").setSelectedKeys(C);}C.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;h.push(w);});}else{var j;if(!i){j=this.byId("idSelectPropCombo").getSelectedKeys();this.byId("idSelectPropCombo").removeSelectedKeys(j);this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}o=o.concat(h);var R={Properties:o};var k=new sap.ui.model.json.JSONModel();k.setData(R);var t=[],l=[];if(p==="targetProperties"){t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();}else{t=this.step.getFilterMappingTargetProperties();}if(t.length>0){v.targetFilter=t;this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(t);}if(p==="requiredFilter"){l.push(this.byId("idReqFilterSelect").getSelectedKey());}else{l=this.step.getFilterProperties();}var n=[];l.forEach(function(u){if(u!==a.getText("none")){h.forEach(function(w){if(w.propertyKey===u){n.push(u);}});}});if(n.length!==0){v.requiredFilter=n;}else{if(!i){this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}var T={Properties:h};var q=new sap.ui.model.json.JSONModel();q.setSizeLimit(500);q.setData(T);if(!i){this.byId("idReqFilterSelect").setModel(k);}}if(i){this._validateStepServiceForFilterMapping(v);}else{this._validateStepServiceForDataSource(v);}}else{if(i){this._resetFilterMappingFields();}else{this._resetStepRequestProperties();}}},_resetStepRequestProperties:function(){var s=this;this.step.setEntitySet(undefined);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});this.byId("idEntitySelect").setSelectedKey();this.byId("idReqFilterSelect").setSelectedKey();},_validateStepServiceForDataSource:function(v){var s=this;if(v.selectProperty&&v.entitySet&&v.source){this.step.setService(v.source);this.step.setEntitySet(v.entitySet);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});v.selectProperty.forEach(function(p){s.step.addSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});if(v.requiredFilter){v.requiredFilter.forEach(function(p){s.step.addFilterProperty(p);});}}},_validateStepServiceForFilterMapping:function(v){var s=this;if(v.selectProperty&&v.entitySet&&v.source&&v.targetFilter){this.step.setFilterMappingService(v.source);this.step.setFilterMappingEntitySet(v.entitySet);var o=this.step.getFilterMappingSelectProperties();o.forEach(function(p){s.step.removeFilterMappingSelectProperty(p);});v.selectProperty.forEach(function(p){s.step.addFilterMappingSelectProperty(p);});var O=this.step.getFilterMappingTargetProperties();O.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});v.targetFilter.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}},handleChangeForCategory:function(){this.oConfigurationEditor.setIsUnsaved();var s=this;var a=s.step.getId();var c=this.params.arguments.categoryId;var p=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var S=this.byId("idCategorySelect").getSelectedKeys();var b=S.indexOf(c);var d=[];var u=[];var i,j;for(i=0;i<p.length;i++){var m=false;for(j=0;j<S.length;j++){if(p[i]===S[j]){m=true;break;}}if(!m){u.push(p[i]);}}if(S.length!==0){S.forEach(function(e){s.oConfigurationEditor.addCategoryStepAssignment(e,a);var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}}};if(e!==c){d.push(o);}});p.forEach(function(C){if(S.indexOf(C)===-1){s.oConfigurationEditor.removeCategoryStepAssignment(C,s.step.getId());}});if(u.length!==0){var n=jQuery.extend(true,{},s.params);u.forEach(function(e){var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}},removeStep:true};if(b===-1&&e===c){var f={arguments:{appId:s.params.arguments.appId,configId:s.params.arguments.configId,categoryId:S[0],stepId:a}};o.categoryChangeContext=f;o.changeCategory=true;}d.push(o);});}}if(d.length!==0){this.oViewData.updateConfigTree(d);}},handleChangeForLeftTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftUpperCornerTextKey(S);},handleChangeForRightTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightUpperCornerTextKey(S);},handleChangeForLeftBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftLowerCornerTextKey(S);},handleChangeForRightBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightLowerCornerTextKey(S);},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey().length>=1)?true:false;}if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFTree')){
/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
jQuery.sap.declare('sap.apf.modeler.ui.utils.APFTree');sap.ui.getCore().loadLibrary("sap.ui.commons");sap.ui.commons.Tree.extend("sap.apf.modeler.ui.utils.APFTree",{metadata:{events:{},properties:{translationFunction:{},defaultRepresentationType:{}}},renderer:function(c,r){sap.ui.commons.TreeRenderer.render(c,r);},setTranslationFunction:function(t){this.fnTranslationFunction=t;},setDefaultRepresentationType:function(d){this.defaultRepresentationType=d;},getNodeContext:function(n){if(n){var N=n?n.getBindingContext():undefined;var o=N.getObject()?N.getObject().type:undefined;var O;if(N.getObject()&&N.getObject().id){O=N.getObject().id;}else if(N.getObject()&&N.getObject().AnalyticalConfiguration){O=N.getObject().AnalyticalConfiguration;}return{oNode:n,nodeContext:N.sPath,nodeObjectType:o,nodeTitle:n.getText(),nodeAPFId:O};}return null;},getParentNodeContext:function(s){var m=this.getModel();if(s!==null){var c=s.nodeContext.split('/')[2];var a=m.getData().aConfigDetails[c]?m.getData().aConfigDetails[c].AnalyticalConfiguration:undefined;var r,S;var b=s.nodeContext.split('/')[6];var f=s.nodeContext.split('/')[6];var n=s.nodeContext.split('/')[6];var d=s.nodeContext.split('/')[8];var o={};if(s!==null){switch(s.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:o.facetFilterId=m.getData().aConfigDetails[c].configData[0].filters[f].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.facetFilterName=m.getData().aConfigDetails[c].configData[0].filters[f].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:S=s.oNode;o.configurationId=a;o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;o.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:r=s.oNode;o.configurationId=a;o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;o.representationId=r.getBindingContext().getObject().id;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;o.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;o.representationName=r.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:o.configurationId=s.oNode.getBindingContext().getObject().AnalyticalConfiguration;o.configurationName=s.oNode.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:o.navTargetId=m.getData().aConfigDetails[c].configData[2].navTargets[n].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.navTargetName=m.getData().aConfigDetails[c].configData[2].navTargets[n].name;break;case"default":break;}}return o;}},isConfigurationSwitched:function(p,c){var i=false;var P=this.getParentNodeContext(this.getNodeContext(p));var C=this.getParentNodeContext(this.getNodeContext(c));if(P&&!jQuery.isEmptyObject(P)&&(P.configurationId!==C.configurationId)){i=true;}return i;},removeSelectionOnTree:function(s){var S=this.getSelection();if(s){s.getBindingContext().getObject().isSelected=false;}else if(S){S.getBindingContext().getObject().isSelected=false;}this.getModel().updateBindings();},setSelectionOnTree:function(b){this.selectedNode=this.getNodeByContext(b);var s=this.getSelection();if(s!==this.selectedNode){if(s&&s.getBindingContext().getObject()){s.getBindingContext().getObject().isSelected=false;s.setIsSelected(false);}this.selectedNode.setIsSelected(true);}},_scrollTreeToNewNode:function(n){if(n&&n.$().length!==0){jQuery(n.$())[0].scrollIntoView();}},setSelectedNode:function(n){this.setSelection(this.getNodeByContext(n.getBindingContext().sPath));this._scrollTreeToNewNode(n);},_getObjectNodesArray:function(o,c,a,s){var O;switch(o){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:O=this.getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:O=this.getNodes()[c].getNodes()[0].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:O=this.getNodes()[c].getNodes()[1].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes()[s].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:O=this.getNodes()[c].getNodes()[2].getNodes();break;}return O;},addNodeInTree:function(o,p){var m=this.getModel();var M;var s=this.getNodeContext(this.getSelection());var c=s?s.nodeContext.split('/')[2]:undefined;var a=s?s.nodeContext.split('/')[6]:undefined;var b=s?s.nodeContext.split('/')[8]:undefined;M=["_add",o].join("");this[M](c,a,b,p);var O=this._getObjectNodesArray(o,c,a,b);var n=O[O.length-1];if(o!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){if(n.getParent()){n.getParent().setExpanded(true);}}this.setSelectedNode(n);},_addconfiguration:function(){var s=this;this.configNewIndex=this.configNewIndex||1;var m=this.getModel();var i;i="I"+this.configNewIndex;this.configNewIndex++;var a=[],f=[],c=[],n=[];a.push({filters:f,name:s.fnTranslationFunction("facetFilters"),isSelected:false,expanded:false,selectable:false});a.push({categories:c,name:s.fnTranslationFunction("categories"),isSelected:false,expanded:false,selectable:false});a.push({navTargets:n,name:s.fnTranslationFunction("navigationTargets"),isSelected:false,expanded:false,selectable:false});var C={};C.configData=a;var b=this.fnTranslationFunction("newConfiguration");var d={name:"< "+b+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,AnalyticalConfiguration:"newConfig"+i,configData:a,bIsLoaded:true,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails.push(d);m.updateBindings();},_addfacetFilter:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newFacetFilter");var i=m.getData().aConfigDetails[c].configData[0].filters.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,id:"newFilter"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[0].expanded=true;m.getData().aConfigDetails[c].configData[0].filters.push(a);m.updateBindings();},_addnavigationTarget:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newNavigationTarget");var i=m.getData().aConfigDetails[c].configData[2].navTargets.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,id:"newNavTarget"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[2].expanded=true;m.getData().aConfigDetails[c].configData[2].navTargets.push(a);m.updateBindings();},_addcategory:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newCategory");var i=m.getData().aConfigDetails[c].configData[1].categories.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,id:"newCategory"+i,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories.push(a);m.updateBindings();},_addstep:function(c,a,s,p){var m=this.getModel();var n;if(m.getData().aConfigDetails[c].configData[1].categories[a].steps===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps=[];}if(!p){var b=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length;var d=this.fnTranslationFunction("newStep");n={name:"< "+d+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:"newStep"+b,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(n);}else{var e,i,j;for(i=0;i<p.noOfSteps;i++){e={name:p.aExistingStepsToBeAdded[i].step.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:p.aExistingStepsToBeAdded[i].step.id,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(e);if(p.aExistingStepsToBeAdded[i].noOfReps!==0){s=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length-1;for(j=0;j<p.aExistingStepsToBeAdded[i].noOfReps;j++){var r={id:p.aExistingStepsToBeAdded[i].representations[j].id,name:p.aExistingStepsToBeAdded[i].representations[j].name,icon:p.aExistingStepsToBeAdded[i].representations[j].icon};this._addrepresentation(c,a,s,r);}}}}m.updateBindings();},_addrepresentation:function(c,a,s,p){var m=this.getModel();var b=this;var d;if(p===undefined){var e=this.getNodeContext(this.getSelection());if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){d=this.getParentNodeContext(e,m).stepId;}else if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=e.nodeAPFId;}var S=[];m.getData().aConfigDetails[c].configData[1].categories.forEach(function(f,g){if(m.getData().aConfigDetails[c].configData[1].categories[g].steps){m.getData().aConfigDetails[c].configData[1].categories[g].steps.forEach(function(h,i){var j={};if(h.id===d){j.stepIndex=i;j.categoryIndex=g;S.push(j);}});}});S.forEach(function(f){if(m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations=[];}var i=m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.length;var n={name:b.fnTranslationFunction(b.defaultRepresentationType),type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:"newRepresentation"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.push(n);});}else{if(m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations=[];}var r={name:p.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:p.id,isSelected:false,selectable:true,icon:p.icon};m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations.push(r);}m.updateBindings();}});};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseUI5ChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseUI5ChartRepresentation");sap.apf.ui.representations.BaseUI5ChartRepresentation=function(a,p){this.oMessageObject="";this.legendBoolean=true;this.aDataResponse=undefined;this.dataset={};this.oModel=new sap.ui.model.json.JSONModel();this.bDataHasBeenSelected=false;this.parameter=p;this.orderby=p.orderby;this.dimension=p.dimensions;this.measure=p.measures;this.alternateRepresentation=p.alternateRepresentationType;this.requiredFilters=p.requiredFilters;this.UI5ChartHelper=new sap.apf.ui.representations.utils.UI5ChartHelper(a,this.parameter);this.chartInstance={};this.chartParam="";this.thumbnailChartParam="";this.disableSelectEvent=false;this.oApi=a;var s=this;this.showXaxisLabel=true;this.axisType=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;};sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype={getParameter:function(){return this.parameter;},setData:function(d,m){this.bIsGroupTypeChart=this.getIsGroupTypeChart();this.oDataSetHelper=this.getDataSetHelper();this.UI5ChartHelper.init(d,m,this.bIsGroupTypeChart,this.oDataSetHelper);this.formatter=new sap.apf.ui.representations.utils.formatter(this.oApi,m,d);this.aDataResponse=d||[];this.metadata=m;if(!this.metadata){this.oMessageObject=this.oApi.createMessageObject({code:"6004",aParameters:[this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}},attachSelectionAndFormatValue:function(s){var a=this;if(!s){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["title",this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}if(this.dimension.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["dimensions",s]});this.oApi.putMessage(this.oMessageObject);}if(this.measure.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["measures",s]});this.oApi.putMessage(this.oMessageObject);}if(!this.aDataResponse||this.aDataResponse.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[s]});this.oApi.putMessage(this.oMessageObject);}this.chart.attachSelectData(function(e){a.handleSelection(e);});this.chart.attachDeselectData(function(e){a.handleDeselection(e);});},getFormatStringForMeasure:function(m){var f=this.formatter.getFormatString(m);return f;},getIsAllMeasureSameUnit:function(){var a=true;var s=this;var f=this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit?this.metadata.getPropertyMetadata(this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit).semantics:undefined;var m;this.measure.forEach(function(b,i){m=s.metadata.getPropertyMetadata(s.measure[i].fieldName).unit?s.metadata.getPropertyMetadata(s.metadata.getPropertyMetadata(b.fieldName).unit).semantics:undefined;if(a&&f!==undefined&&m&&(f!==m)){a=false;}});return a;},createThumbnailLayout:function(){var s=this;this.thumbnailLayout=new sap.ui.layout.HorizontalLayout().addStyleClass('thumbnailLayout');if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){this.thumbnailChart.setModel(this.oModel);this.thumbnailLayout.removeAllContent();this.thumbnailLayout.addContent(this.thumbnailChart);}else{var n=new sap.m.Text({text:this.oApi.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');this.thumbnailLayout.removeAllContent();this.thumbnailLayout.addContent(n);}},getAlternateRepresentation:function(){return this.alternateRepresentation;},getMetaData:function(){return this.metadata;},getData:function(){return this.aDataResponse;},getRequestOptions:function(){if(this.orderby&&this.orderby.length){var o=this.orderby.map(function(O){return{property:O.property,descending:!O.ascending};});return{orderby:o};}else{return{};}},createDataset:function(){this.dataset=this.UI5ChartHelper.getDataset();this.oModel=this.UI5ChartHelper.getModel();},drawSelectionOnMainChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.disableSelectEvent=true;this.setSelectionOnMainChart(s);}},drawSelectionOnThumbnailChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.clearSelectionFromThumbnailChart();this.setSelectionOnThumbnailChart(s);}},handleSelection:function(e){if(!this.disableSelectEvent){var s=this.getSelectionFromChart();var c=this.UI5ChartHelper.getHighlightPointsFromSelectionEvent(s);this.setSelectionOnThumbnailChart(c);this.setSelectionOnMainChart(c);this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},handleDeselection:function(e){if(!this.disableSelectEvent){this.disableSelectEvent=true;var s=this.getSelectionFromChart();var n=this.UI5ChartHelper.getHighlightPointsFromDeselectionEvent(s);this.removeAllSelection();this.setSelectionOnThumbnailChart(n);this.setSelectionOnMainChart(n);if(!n.length){this.disableSelectEvent=false;}this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},getSelections:function(){return this.UI5ChartHelper.getFilters();},getSelectionCount:function(){return this.UI5ChartHelper.getFilterCount();},hasSelection:function(){return this.bDataHasBeenSelected;},removeAllSelection:function(){this.clearSelectionFromThumbnailChart();this.clearSelectionFromMainChart();},getFilterMethodType:function(){return sap.apf.core.constants.filterMethodTypes.filter;},getFilter:function(){this.filter=this.UI5ChartHelper.getFilterFromSelection();return this.filter;},setFilter:function(f){this.filter=f;this.bDataHasBeenSelected=false;},adoptSelection:function(s){if(s&&s.getFilter){this.UI5ChartHelper.filterValues=s.getFilter().getInternalFilter().getFilterTerms().map(function(t){return[t.getValue()];});}},serialize:function(){return{oFilter:this.UI5ChartHelper.filterValues,bIsAlternateView:this.bIsAlternateView};},deserialize:function(s){this.UI5ChartHelper.filterValues=s.oFilter;this.bIsAlternateView=s.bIsAlternateView;},getPrintContent:function(s){var c;c=this.getMainContent(s,1000,600);return c;}};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizChartRepresentation");sap.apf.ui.representations.BaseVizChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizChartRepresentation;sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;this.createDataset();this.chartParam={width:d,height:c,title:{visible:true,text:this.title},xAxis:{title:{visible:true},label:{visible:this.showXaxisLabel}},yAxis:{title:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean}},plotArea:{animation:{dataLoading:false,dataUpdating:false}},dataset:this.dataset};if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.chart=new sap.viz.ui5[this.chartType](this.chartParam);this.validateSelectionModes();this.chart.setModel(this.oModel);if(this.metadata){var f={},t=[];this.measure.forEach(function(m){var F=b.getFormatStringForMeasure(m);t.push([F]);a.setFormatStringOnChart(F);});this.setFormatString("tooltip",t);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}this.chart.attachInitialized(function(){a.drawSelectionOnMainChart();});b.attachSelectionAndFormatValue.call(this,s);return this.chart;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.validateSelectionModes=function(){var s=new sap.viz.ui5.types.controller.Interaction_selectability();var i=new sap.viz.ui5.types.controller.Interaction();i.setSelectability(s);this.chart.setInteraction(i);if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){s.setMode("none");}else{s.setMode("multiple");if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){s.setAxisLabelSelection(false);}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){s.setLegendSelection(false);}}}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;this.createDataset();this.thumbnailChartParam={width:w,height:h,title:{visible:false},xAxis:{visible:false,title:{visible:false}},yAxis:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},sizeLegend:{visible:false,title:{visible:false}},toolTip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0}},plotArea:{animation:{dataLoading:false,dataUpdating:false},markerSize:4,marker:{visible:true,size:4}},dataset:this.dataset};if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.thumbnailChart=new sap.viz.ui5[this.chartType](this.thumbnailChartParam);this.thumbnailChart.attachInitialized(function(){s.drawSelectionOnThumbnailChart();});a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.clearSelectionFromThumbnailChart();this.thumbnailChart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.selection();return s;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatStringOnChart=function(f){var s=this;var a=s.getIsAllMeasureSameUnit();if(this.chart.getYAxis!==undefined&&f!==""&&a){this.setFormatString("yAxis",f);}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatString=function(c,f){var C;switch(c){case"xAxis":C=this.chart.getYAxis().getLabel();break;case"yAxis":C=this.chart.getXAxis().getLabel();break;case"tooltip":C=this.chart.getToolTip();break;case"sizeLegend":C=this.chart.getSizeLegend().getLabel();}C.setFormatString(f);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getFormatString=function(m){var f=this.getFormatStringForMeasures(m);return f.labelFormatString;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getChartTypeFromRepresentationType=function(r){var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var v=sap.apf.ui.utils.CONSTANTS.vizChartTypes;var V;switch(r){case R.COLUMN_CHART:V=v.COLUMN;break;case R.LINE_CHART:V=v.LINE;break;case R.PIE_CHART:V=v.PIE;break;case R.STACKED_COLUMN_CHART:V=v.STACKED_COLUMN;break;case R.PERCENTAGE_STACKED_COLUMN_CHART:V=v.PERCENTAGE_STACKED_COLUMN;break;case R.SCATTERPLOT_CHART:V=v.SCATTERPLOT;break;case R.BUBBLE_CHART:V=v.BUBBLE;break;default:this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[r]});this.oApi.putMessage(this.oMessageObject);break;}return V;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getIsGroupTypeChart=function(){var i;if(this.axisType===sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS){i=false;}else{i=true;}return i;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getDataSetHelper=function(){var i=this.getIsGroupTypeChart();var d=new sap.apf.ui.representations.utils.VizDatasetHelper(i);return d;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizFrameChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizFrameChartRepresentation");sap.apf.ui.representations.BaseVizFrameChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizFrameChartRepresentation;sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;this.createDataset();if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.chart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,dataset:this.dataset,width:d,height:c,uiConfig:{applicationSet:"fiori"}});this.chart.setVizProperties({title:{visible:true,text:this.title},categoryAxis:{title:{visible:true},label:{visible:true}},valueAxis:{title:{visible:true},label:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean},isScrollable:true},sizeLegend:{visible:true},valueAxis2:{visible:true,title:{visible:true},label:{visible:true}},plotArea:{animation:{dataLoading:false,dataUpdating:false},isFixedDataPointSize:false},tooltip:{visible:true,label:{visible:true}},interaction:{behaviorType:null}});this.validateSelectionModes();this.chart.attachRenderComplete(function(){a.drawSelectionOnMainChart();});this.chart.setModel(this.oModel);if(this.metadata){var m={},M=[];var f;this.measure.forEach(function(e){var F=b.getFormatStringForMeasure(e);f=F;m.measure=e;m.formatString=F;a.setFormatStringOnChart(m);});this.setFormatString("tooltip",f);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}this._createAndAddFeedItemBasedOnId(this.chart);b.attachSelectionAndFormatValue.call(this,s);return this.chart;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatStringOnChart=function(m){var f=m.formatString;var c=m.measure.axisfeedItemId;this.setFormatString(c,f);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatString=function(c,f){var s=this;var i=s.getIsAllMeasureSameUnit();switch(c){case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:if(i){this.chart.setVizProperties({valueAxis:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2:if(i){this.chart.setVizProperties({valueAxis2:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:this.chart.setVizProperties({categoryAxis:{label:{formatString:f}}});break;case sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH:this.chart.setVizProperties({sizeLegend:{formatString:f}});break;case"tooltip":this.chart.setVizProperties({tooltip:{formatString:f}});break;}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createAndAddFeedItemBasedOnId=function(c){var f=this.UI5ChartHelper.datasetObj;var s=this._createFeedItemGroup(f.measures);this._addFeedItemsToChart(c,s,"Measure");var a=this._createFeedItemGroup(f.dimensions);this._addFeedItemsToChart(c,a,"Dimension");};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createFeedItemGroup=function(d){var s={};d.forEach(function(a){var f=s[a.axisfeedItemId];if(f){var F=f.some(function(D){return D.name===a.name;});if(!F){f.push(a);}}else{s[a.axisfeedItemId]=[a];}});return s;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._addFeedItemsToChart=function(c,g,f){for(var k in g){var F={};var a=[];for(var i=0 in g[k]){a.push(g[k][i].name);F.feedItemId=g[k][0].axisfeedItemId;}F.value=a;var b=new sap.viz.ui5.controls.common.feeds.FeedItem({uid:F.feedItemId,type:f,values:F.value});c.addFeed(b);}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.validateSelectionModes=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){this.chart.setVizProperties({interaction:{selectability:{mode:'none'},behaviorType:null}});}else{this.chart.setVizProperties({interaction:{selectability:{mode:'multiple'},behaviorType:null}});if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){this.chart.setVizProperties({interaction:{selectability:{axisLabelSelection:false}}});}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){this.chart.setVizProperties({interaction:{selectability:{legendSelection:false}}});}}}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;this.createDataset();if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.thumbnailChart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,width:w,height:h,dataset:this.dataset});this.thumbnailChart.setVizProperties({title:{visible:false},categoryAxis:{visible:false,title:{visible:false}},valueAxis:{visible:false,title:{visible:false}},valueAxis2:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},sizeLegend:{visible:false},tooltip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0}},plotArea:{markerSize:4,marker:{visible:true,size:4},animation:{dataLoading:false,dataUpdating:false},gridline:{visible:false},dataLabel:{visible:false},lineStyle:{rules:[{properties:{width:1}}]}}});this.thumbnailChart.attachRenderComplete(function(){s.drawSelectionOnThumbnailChart();});this._createAndAddFeedItemBasedOnId(this.thumbnailChart);a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.clearSelectionFromThumbnailChart();this.thumbnailChart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.vizSelection();return s;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getChartTypeFromRepresentationType=function(r){var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var v=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes;var V;switch(r){case R.COLUMN_CHART:V=v.COLUMN;break;case R.LINE_CHART:V=v.LINE;break;case R.PIE_CHART:V=v.PIE;break;case R.STACKED_COLUMN_CHART:V=v.STACKED_COLUMN;break;case R.PERCENTAGE_STACKED_COLUMN_CHART:V=v.PERCENTAGE_STACKED_COLUMN;break;case R.SCATTERPLOT_CHART:V=v.SCATTERPLOT;break;case R.BUBBLE_CHART:V=v.BUBBLE;break;default:this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[r]});this.oApi.putMessage(this.oMessageObject);break;}return V;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getIsGroupTypeChart=function(){return this.bIsGroupTypeChart?this.bIsGroupTypeChart:false;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getDataSetHelper=function(){var i=this.getIsGroupTypeChart();var d=new sap.apf.ui.representations.utils.vizFrameDatasetHelper(i);return d;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.bubbleChart')){jQuery.sap.declare("sap.apf.ui.representations.bubbleChart");sap.apf.ui.representations.bubbleChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.BUBBLE_CHART;this.bIsGroupTypeChart=true;this._createDefaultFeedItemId();};sap.apf.ui.representations.bubbleChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.bubbleChart.prototype.constructor=sap.apf.ui.representations.bubbleChart;sap.apf.ui.representations.bubbleChart.prototype._createDefaultFeedItemId=function(){var s=this;this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){m.axisfeedItemId=i<2?(i===0?sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2):(i===2?sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH:sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGTH);}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.COLOR:sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.columnChart')){jQuery.sap.declare("sap.apf.ui.representations.columnChart");sap.apf.ui.representations.columnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.columnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.columnChart.prototype.constructor=sap.apf.ui.representations.columnChart;sap.apf.ui.representations.columnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.lineChart')){jQuery.sap.declare("sap.apf.ui.representations.lineChart");sap.apf.ui.representations.lineChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.LINE_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.lineChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.lineChart.prototype.constructor=sap.apf.ui.representations.lineChart;sap.apf.ui.representations.lineChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.percentageStackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.percentageStackedColumnChart");sap.apf.ui.representations.percentageStackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PERCENTAGE_STACKED_COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.percentageStackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.percentageStackedColumnChart.prototype.constructor=sap.apf.ui.representations.percentageStackedColumnChart;sap.apf.ui.representations.percentageStackedColumnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};sap.apf.ui.representations.percentageStackedColumnChart.prototype.setFormatString=function(){return;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.pieChart')){jQuery.sap.declare("sap.apf.ui.representations.pieChart");sap.apf.ui.representations.pieChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PIE_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.pieChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.pieChart.prototype.constructor=sap.apf.ui.representations.pieChart;sap.apf.ui.representations.pieChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.SIZE;}});this.parameter.dimensions.forEach(function(d){if(d.kind===undefined){d.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.scatterPlotChart')){jQuery.sap.declare("sap.apf.ui.representations.scatterPlotChart");sap.apf.ui.representations.scatterPlotChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.SCATTERPLOT_CHART;this.bIsGroupTypeChart=true;this._createDefaultFeedItemId();};sap.apf.ui.representations.scatterPlotChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.scatterPlotChart.prototype.constructor=sap.apf.ui.representations.scatterPlotChart;sap.apf.ui.representations.scatterPlotChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){m.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.COLOR:sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.stackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.stackedColumnChart");sap.apf.ui.representations.stackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.STACKED_COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.stackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.stackedColumnChart.prototype.constructor=sap.apf.ui.representations.stackedColumnChart;sap.apf.ui.representations.stackedColumnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.table')){jQuery.sap.declare("sap.apf.ui.representations.table");sap.apf.ui.representations.table=function(a,p){var s=this;this.parameter=p;this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;this.fields=p.dimensions.concat(p.measures);this.columns={name:[],value:[],width:[]};jQuery.sap.require({modName:"sap.ui.thirdparty.d3"});this.aDataResponse=[];this.alternateRepresentation=p.defaultListConfigurationTypeID;this.filter=a.createFilter();var b=0;var t=100;var c;var d;var f;var g=false;var h=0;var j=0;var r=[];this.printMode=false;this.oModel=new sap.ui.model.json.JSONModel();this.oModel.setSizeLimit(10000);this.isAlternateRepresentation=p.isAlternateRepresentation;this.getParameter=function(){return this.parameter;};this.setData=function(D,m){if(j===0){if(g){D.map(function(o){s.aDataResponse.push(o);});j++;}else{b=0;s.aDataResponse=[];D.map(function(o){s.aDataResponse.push(o);});}}r=D;this.metadata=m;g=false;this.formatter=new sap.apf.ui.representations.utils.formatter(a,m,D);};this.getAlternateRepresentation=function(){return this.alternateRepresentation;};this.getMetaData=function(){return this.metadata;};this.getData=function(){return this.aDataResponse;};this.getRequestOptions=function(){if(!g){t=100;b=0;j=0;}var e={paging:{top:t,skip:b,inlineCount:true}};var o;if(d!==undefined){o=[{property:d,descending:f}];e.orderby=o;}else{if(this.getParameter().orderby&&this.getParameter().orderby.length){var O=this.getParameter().orderby.map(function(i){return{property:i.property,descending:!i.ascending};});e.orderby=O;}}return e;};this.createDataset=function(){if(s.getData().length!==0){for(var i=0;i<s.fields.length;i++){s.columns.value[i]=s.fields[i].fieldName;var n="";var u="";if(s.getMetaData()!==undefined&&s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).unit!==undefined){var U=s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).unit;u=s.getData()[0][U];n=s.fields[i].fieldDesc===undefined||!a.getTextNotHtmlEncoded(s.fields[i].fieldDesc).length?s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).label+" ("+u+")":a.getTextNotHtmlEncoded(s.fields[i].fieldDesc)+" ("+u+")";s.columns.name[i]=n;}else s.columns.name[i]=this.fields[i].fieldDesc===undefined||!a.getTextNotHtmlEncoded(s.fields[i].fieldDesc).length?s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).label:a.getTextNotHtmlEncoded(s.fields[i].fieldDesc);if(s.parameter.width!==undefined){s.columns.width[i]=s.parameter.width[s.columns.value[i]];}}}};this.drawSelection=function(e){var R=s.getFilter().getInternalFilter().getProperties()[0],F=s.getFilter().getInternalFilter().getFilterTermsForProperty(R),i=F.map(function(k){return k.getValue();}),l=this.getItems(),S=l.filter(function(k){var m=k.getBindingContext().getProperty(R);return i.indexOf(m)!==-1;});S.forEach(function(k){k.addStyleClass('sapMLIBSelected');});};this.getMainContent=function(S,e,w){s.createDataset();var m;if(!S){m=a.createMessageObject({code:"6002",aParameters:["title",a.getTextNotHtmlEncoded("step")]});a.putMessage(m);}if(this.fields.length===0){m=a.createMessageObject({code:"6002",aParameters:["dimensions",S]});a.putMessage(m);}if(!this.aDataResponse||this.aDataResponse.length===0){m=a.createMessageObject({code:"6000",aParameters:[S]});a.putMessage(m);}var k=e||600;k=k+"px";var l=w||1000;l=l+"px";s.title=S;var o=s.aDataResponse;s.oModel.setData({tableData:o});var n=[];var i;for(i=0;i<s.columns.name.length;i++){s.cellValues=new sap.m.Text().bindText(s.columns.value[i],function(G){return function(H){if(s.metadata===undefined){return H;}else{var J=s.formatter.getFormattedValue(s.columns.value[G],H);if(J!==undefined){return J;}else{return H;}}};}(i),sap.ui.model.BindingMode.OneWay);n.push(s.cellValues);}var q=[];var u=[];var W;var v;var x;var y;for(i=0;i<s.columns.name.length;i++){W=false;if(s.columns.width!==undefined&&s.columns.width instanceof Array&&s.columns.width.length!==0)W=true;v=d3.scale.linear().domain([0,8]).range([0,72]);x=W?s.columns.width[i]:(v(s.columns.name[i].length))+"px";s.columnName=new sap.m.Column({width:x,header:new sap.m.Text({text:s.columns.name[i]})});q.push(s.columnName);s.columnName1=new sap.m.Column({width:x});u.push(s.columnName1);}var T=new sap.m.Table({headerText:s.title,showNoData:false,columns:q}).addStyleClass("tableWithHeaders");this.oTableWithoutHeaders=new sap.m.Table({columns:u,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:n})}});T.setModel(s.oModel);this.oTableWithoutHeaders.setModel(s.oModel);this.oTableWithoutHeaders.attachUpdateFinished(this.drawSelection.bind(this.oTableWithoutHeaders));var z=function(G){var H=G.getParameters();s.oTableWithoutHeaders.setBusy(true);j=0;d=H.sortItem.getKey();f=H.sortDescending;t=100;b=0;var A=[];if(H.sortItem){if(s.isAlternateRepresentation){var B=s.oTableWithoutHeaders.getBinding("items");A.push(new sap.ui.model.Sorter(d,f));B.sort(A);s.oTableWithoutHeaders.setBusy(false);return;}a.updatePath(function(J,K){if(J===a.getActiveStep()){s.oModel.setData({tableData:s.aDataResponse});s.oTableWithoutHeaders.rerender();s.oTableWithoutHeaders.setBusy(false);}}.bind(this));}};this.viewSettingsDialog=new sap.m.ViewSettingsDialog({confirm:z});for(i=0;i<T.getColumns().length;i++){var I=new sap.m.ViewSettingsItem({text:s.columns.name[i],key:s.columns.value[i]});this.viewSettingsDialog.addSortItem(I);}if(d===undefined&&f===undefined){if(this.getParameter().orderby&&this.getParameter().orderby.length){for(i=0;i<this.viewSettingsDialog.getSortItems().length;i++){if(this.getParameter().orderby[0].property===this.viewSettingsDialog.getSortItems()[i].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[i]);this.viewSettingsDialog.setSortDescending(!this.getParameter().orderby[0].ascending);}}}else{this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[0]);this.viewSettingsDialog.setSortDescending(false);}}else{for(i=0;i<this.viewSettingsDialog.getSortItems().length;i++){if(d===this.viewSettingsDialog.getSortItems()[i].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[i]);}}this.viewSettingsDialog.setSortDescending(f);var A=[];if(this.isAlternateRepresentation){var B=s.oTableWithoutHeaders.getBinding("items");A.push(new sap.ui.model.Sorter(d,f));B.sort(A);}}if(s.metadata!==undefined){for(i=0;i<s.columns.name.length;i++){var M=s.metadata.getPropertyMetadata(s.columns.value[i]);if(M.unit){var C=s.oTableWithoutHeaders.getColumns()[i];C.setHAlign(sap.ui.core.TextAlign.Right);}}}var D=new sap.m.ScrollContainer({content:s.oTableWithoutHeaders,height:"480px",horizontal:false,vertical:true}).addStyleClass("tableWithoutHeaders");var E=new sap.m.Link({text:"More"}).addStyleClass("loadMoreLink");var F=new sap.m.ScrollContainer({content:[T,D],width:l,horizontal:true,vertical:false}).addStyleClass("scrollContainer");s.oModel.setSizeLimit(10000);T.addEventDelegate({onAfterRendering:function(){jQuery(".scrollContainer > div:first-child").css({"display":"table","width":"inherit"});var G;if(s.offsetTop===undefined){s.offsetTop=jQuery(".tableWithoutHeaders").offset().top;}if(jQuery(".tableWithoutHeaders").offset().top!==s.offsetTop){G=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top))+"px";}else{G=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-(jQuery(".applicationFooter").height())-20)+"px";}document.querySelector('.tableWithoutHeaders').style.cssText+="height : "+G;var L=sap.ui.getCore().getRenderManager().getHTML(E);var H;sap.ui.Device.orientation.attachHandler(function(){F.rerender();});var J=a.getActiveStep();if(J.getSelectedRepresentation().bIsAlternateView===undefined||J.getSelectedRepresentation().bIsAlternateView===false){if(sap.ui.Device.browser.mobile){jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(L);E.attachPress(function(){if(!jQuery(".openToggleImage").length&&(r.length>0)){if(h===0){K();j=0;h++;jQuery(".loadMoreLink").remove();jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(L);}}else{jQuery(".loadMoreLink").remove();}});}else{jQuery('.tableWithoutHeaders').on("scroll",function(){var s=jQuery(this);var N=s.prop("scrollTop");var O=s.prop("scrollHeight");var P=s.prop("offsetHeight");var Q=O-P-5;if((Q<=N)&&!jQuery(".openToggleImage").length&&(r.length>0)){if(h===0){K();j=0;h++;}}});}}var K=function(){s.oTableWithoutHeaders.setBusy(true);sap.ui.getCore().applyChanges();var N=s.oModel.getData();b+=o.length;t=10;g=true;a.updatePath(function(O,P){if(O===a.getActiveStep()){s.oModel.setData(N);s.oTableWithoutHeaders.rerender();s.oTableWithoutHeaders.setBusy(false);h=0;}}.bind(this));};}});return new sap.ui.layout.VerticalLayout({content:[F]});};this.getThumbnailContent=function(){if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){var i=new sap.ui.core.Icon({src:"sap-icon://table-chart",size:"70px"}).addStyleClass('thumbnailTableImage');return i;}else{var n=new sap.m.Text({text:a.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');return new sap.ui.layout.VerticalLayout({content:n});}};this.serialize=function(){return{oFilter:this.getFilter().serialize()};};this.deserialize=function(S){var e=a.createFilter();this.setFilter(e.deserialize(S.oFilter));};this.getFilterMethodType=function(){return sap.apf.core.constants.filterMethodTypes.filter;};this.getSelectionCount=function(){var R=s.getFilter().getInternalFilter().getProperties()[0],F=s.getFilter().getInternalFilter().getFilterTermsForProperty(R);return F.length;};this.getFilter=function(){return this.filter;};this.setFilter=function(F){this.filter=F;};this.adoptSelection=function(S){if(S&&S.getFilter){this.setFilter(S.getFilter());}};this.removeAllSelection=function(){this.setFilter(a.createFilter());a.selectionChanged();s.oTableWithoutHeaders.getItems().forEach(function(i){i.removeStyleClass('sapMLIBSelected');});};this.getPrintContent=function(S){this.createDataset();var o=this.aDataResponse;this.oModel.setData({tableData:o});var i;var e=[];for(i=0;i<s.columns.name.length;i++){s.columnName=new sap.m.Column({width:"75px",header:new sap.m.Label({text:s.columns.name[i]})});e.push(s.columnName);}var k=[];for(i=0;i<s.columns.name.length;i++){s.cellValues=new sap.m.Text().bindText(s.columns.value[i],function(n){return function(q){if(s.metadata===undefined){return q;}else{var m=s.metadata.getPropertyMetadata(s.columns.value[n]);if(m.dataType.type==="Edm.DateTime"){if(q===null){return"-";}var u=new Date(parseInt(q.slice(6,q.length-2),10));u=u.toLocaleDateString();if(u==="Invalid Date"){return"-";}return u;}if(m.unit){if(q===null){return"-";}var v=s.metadata.getPropertyMetadata(m.unit);if(v.semantics==="currency-code"){var w=s.aDataResponse[0][m.scale];q=parseFloat(q,10).toFixed(w).toString();var x=q.split(".");var y=parseFloat(x[0]).toLocaleString();var z=0.1;z=z.toLocaleString();if(y.split(z.substring(1,2)).length>1){y=y.split(z.substring(1,2))[0];}y=y.concat(z.substring(1,2),x[1]);return y;}}else{return q;}}};}(i),sap.ui.model.BindingMode.OneWay);k.push(s.cellValues);}var T=new sap.m.Table({headerText:S,headerDesign:sap.m.ListHeaderDesign.Standard,columns:e,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:k})}}).addStyleClass("printTable");if(s.metadata!==undefined){for(i=0;i<s.columns.name.length;i++){var m=s.metadata.getPropertyMetadata(s.columns.value[i]);if(m.unit){var l=T.getColumns()[i];l.setHAlign(sap.ui.core.TextAlign.Right);}}}T.setModel(s.oModel);T.attachUpdateFinished(this.drawSelection.bind(T));return new sap.ui.layout.VerticalLayout({content:[T]});};};};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepGallery.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepGallery.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.stepGallery",{getGalleryElementsData:function(){var s=this;var g=[];var c=this.oCoreApi.getCategories();var l=this.oCoreApi.getTextNotHtmlEncoded("label");var a=this.oCoreApi.getTextNotHtmlEncoded("steps");var b=this.oCoreApi.getTextNotHtmlEncoded("category");var m;if(c.length===0){m=this.oCoreApi.createMessageObject({code:"6001",aParameters:["Categories"]});this.oCoreApi.putMessage(m);}var i;for(i=0;i<c.length;i++){var G={};var C=c[i];var o={};var d;if(!C.label){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[l,b+": "+d]});this.oCoreApi.putMessage(m);}else{d=this.oCoreApi.getTextNotHtmlEncoded(C.label);o.title=this.oCoreApi.getTextNotHtmlEncoded(C.label);}o.id=C.id;G.categoryDetails=o;G.stepTemplates=[];C.stepTemplates.forEach(function(e){var f={};if(!e.title){m=s.oCoreApi.createMessageObject({code:"6003",aParameters:["Title"]});s.oCoreApi.putMessage(m);}else{f.maintitle=s.oCoreApi.getTextNotHtmlEncoded(e.title);}f.id=e.id;f.representationtypes=e.getRepresentationInfo();f.representationtypes.forEach(function(r){r.title=s.oCoreApi.getTextNotHtmlEncoded(r.label);if(r.parameter&&r.parameter.orderby){var h=new sap.apf.ui.utils.Helper(s.oCoreApi).getRepresentationSortInfo(r);r.sortDescription=h;}});f.defaultRepresentationType=f.representationtypes[0];G.stepTemplates.push(f);});g.push(G);}var S=this.oCoreApi.getStepTemplates();if(S.length===0){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[a,b]});this.oCoreApi.putMessage(m);}var j={GalleryElements:g};return j;},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;var g=this.getGalleryElementsData().GalleryElements;var m=new sap.ui.model.json.JSONModel({"GalleryElements":g});this.getView().setModel(m,"json");},getStepDetails:function(c,s){var g=this.getGalleryElementsData().GalleryElements;var a=g[c].stepTemplates[s];return a;},openHierarchicalSelectDialog:function(){if(this.oHierchicalSelectDialog){this.oHierchicalSelectDialog.destroy();}this.oHierchicalSelectDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",this);this.oHierchicalSelectDialog.setModel(this.getView().getModel("json"),"json");this.oHierchicalSelectDialog.open();},onStepPress:function(i,r){this.oHierchicalSelectDialog.close();this.oUiApi.getLayoutView().setBusy(true);this.oCoreApi.createStep(i,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(this.oUiApi.getAnalysisPath().getController()),r);this.oUiApi.getLayoutView().setBusy(true);this.oUiApi.getAnalysisPath().getController().refresh(-1);}});};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepToolbar.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepToolbar.controller');sap.ui.controller("sap.apf.ui.reuse.controller.stepToolbar",{chartIconInserted:false,alternateRepresentationIcon:false,alternateRepresentationBool:false,selectedRepresentation:null,alternateRepresentationBtn:{},selectedNumber:null,selectedNumberLink:null,isSwitchRepresentation:false,viewSettingsIcon:null,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},drawAlternateRepresentation:function(){var t=this;this.alternateRepresentationBtn=new sap.m.Button({icon:this.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded("TableRepresentation"),press:function(){var s=t.oCoreApi.getActiveStep();var c=s.getSelectedRepresentation();var a=t.oCoreApi.getSteps().indexOf(s);t.selectedRepresentation="table";c.bIsAlternateView=true;if(c.toggleInstance===undefined){c.toggleInstance=t.oUiApi.getStepContainer().getController().createAlternateRepresentation(a);}else{var d=c.getData(),m=c.getMetaData();if(d!==undefined&&m!==undefined){c.toggleInstance.setData(d,m);}c.toggleInstance.adoptSelection(c);}t.oUiApi.getAnalysisPath().getController().refresh(-1);t.oUiApi.getStepContainer().getController().drawStepContent();t.oUiApi.getAnalysisPath().getCarousel().getStepView(a).getController().drawThumbnailContent(true);}}).addStyleClass("alternateButton");this.insertViewSettingsIcon();this.getView().chartToolbar.getToolBar().insertContentRight(this.alternateRepresentationBtn);},insertViewSettingsIcon:function(){var t=this;this.sortButton=new sap.m.Button({icon:"sap-icon://drop-down-list",tooltip:this.oCoreApi.getTextNotHtmlEncoded("view-Settings"),press:function(){if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.viewSettingsDialog.open();}else{t.oCoreApi.getActiveStep().getSelectedRepresentation().viewSettingsDialog.open();}}}).addStyleClass("sortButton");this.getView().chartToolbar.getToolBar().insertContentRight(this.sortButton);},showSelectionCount:function(){var a=this.oCoreApi.getActiveStep();var s=a.getSelectedRepresentation();var b=typeof(s.getSelections)==="function"?s.getSelections().length:(typeof(s.getSelectionCount)==="function"?s.getSelectionCount():0);var r=s.getParameter().requiredFilters!==undefined&&s.getParameter().requiredFilters.length!==0;var m=s.getMetaData!==undefined&&s.getMetaData()!==undefined&&s.getMetaData().hasOwnProperty("getPropertyMetadata");var c=r&&m?s.getMetaData().getPropertyMetadata(s.getParameter().requiredFilters[0]).label:null;if(c===null||b===0){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();}else if(b>0){this.selectedNumber.setText("("+this.oCoreApi.getTextNotHtmlEncoded("selected-objects",[c]));this.selectedNumberLink.setText(b);jQuery(".showSelection").show();jQuery(".resetSelection").show();}},insertContentLeft:function(){var t=this;this.currentStepText=new sap.m.Label({wrapping:true,text:this.oCoreApi.getTextNotHtmlEncoded("currentStep")}).addStyleClass("currentStep");this.selectedNumber=new sap.m.Label({wrapping:true}).addStyleClass("showSelection");var s=new sap.m.Label({text:")"}).addStyleClass("showSelection");s.addStyleClass("selectedNumberEndText");this.selectedNumberLink=new sap.m.Link({press:function(){if(t.selectionDisplayDialog){t.selectionDisplayDialog.destroy();}t.selectionDisplayDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",t);t.selectionDisplayDialog.open();}}).addStyleClass("showSelection");this.selectedNumberLink.addStyleClass("selectedNumberLink");this.resetSelection=new sap.m.Link({text:this.oCoreApi.getTextNotHtmlEncoded("resetSelection")}).attachPress(function(){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView){t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.removeAllSelection();}t.oCoreApi.getActiveStep().getSelectedRepresentation().removeAllSelection();}).addStyleClass("resetSelection");this.getView().chartToolbar.getToolBar().insertContentRight(this.resetSelection);this.getView().chartToolbar.getToolBar().insertContentLeft(s);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumberLink);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumber);this.getView().chartToolbar.getToolBar().insertContentLeft(this.currentStepText);},drawSingleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+a.selectedRepresentaionType.sortDescription:""),press:function(){var S=a;var c=S.getSelectedRepresentation();c.bIsAlternateView=false;t.oUiApi.getStepContainer().getController().drawStepContent();var b=t.oCoreApi.getSteps().indexOf(S);t.oUiApi.getAnalysisPath().getCarousel().getStepView(b).getController().drawThumbnailContent(true);}});this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawMultipleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.representationtypes=a.getRepresentationInfo();a.representationtypes.forEach(function(R){if(R.parameter&&R.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(R);R.sortDescription=r;}});a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(this.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var b=a.representationtypes.length;var s;var d=function(e){e.oCurrentActiveStep.getSelectedRepresentation().bIsAlternateView=false;e.oCurrentActiveStep.setSelectedRepresentation(e.oRepresentationType.representationId);t.oUiApi.getAnalysisPath().getController().refresh(e.nActiveStepIndex);t.oCoreApi.updatePath(t.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(t.oUiApi.getAnalysisPath().getController()));};this.openList=function(e){var f=e.getParameter("listItem").getCustomData()[0].getValue();d(f);s.setIcon(f.icon);s.setTooltip(t.oCoreApi.getTextNotHtmlEncoded(f.oRepresentationType.label)+"\n"+(f.oRepresentationType.sortDescription!==undefined?t.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+f.oRepresentationType.sortDescription:""));};var A=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,showSeparators:sap.m.ListSeparators.None,includeItemInSelection:true,select:jQuery.proxy(function(e){this.openList(e);},this)});for(var j=0;j<b;j++){A.addItem(new sap.m.StandardListItem({description:a.representationtypes[j].sortDescription&&this.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+a.representationtypes[j].sortDescription,icon:a.representationtypes[j].picture,title:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[j].label),customData:[new sap.ui.core.CustomData({key:'data',value:{oCurrentActiveStep:t.oCoreApi.getActiveStep(),oRepresentationType:a.representationtypes[j],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[j].picture}})]}));}var S=new sap.m.Popover({placement:sap.m.PlacementType.Bottom,showHeader:false,content:[A]}).addStyleClass("sapCaUiChartToolBarShowAllChartListPopover");for(var k=0;k<b;k++){var c=new sap.m.Button({tooltip:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[k].label)+"\n"+((a.representationtypes[k].sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+a.representationtypes[k].sortDescription:""),icon:a.representationtypes[k].picture,customData:[new sap.ui.core.CustomData({key:'data',value:{oCurrentActiveStep:t.oCoreApi.getActiveStep(),oRepresentationType:a.representationtypes[k],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[k].picture}})],press:function(e){var f=e.getSource().getCustomData()[0].getValue();d(f);}});c.addStyleClass("iconLeft");this.getView().chartToolbar.getToolBar().insertContentRight(c);}s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+" : "+a.selectedRepresentaionType.sortDescription:""),press:function(){S.openBy(this);}}).addStyleClass("iconList");this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawToolBar:function(){var t=this;this.showAndHideIcons=function(){var t=this;t.isSwitchRepresentation=false;if(t.getView().chartToolbar.getFullScreen()===true){jQuery(".iconList").hide();jQuery(".iconLeft").show();}else{jQuery(".iconList").show();jQuery(".iconLeft").hide();}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){jQuery(".sortButton").show();}else{jQuery(".sortButton").hide();}if(t.oCoreApi.getSteps().length>=1){t.showSelectionCount();}var a=t.getView().chartToolbar.getId();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation()!==undefined){if((!t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if((window.innerWidth===jQuery("#"+a+" > div:first-child > div:nth-child(2)").width())){jQuery(t.getView().chartToolbar._oShowLegendButton.getDomRef()).show();}}}};this.renderIcons=function(){var t=this;var a=t.oCoreApi.getActiveStep();if(a!==undefined){t.getView().chartToolbar._oFullScreenButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));t.getView().chartToolbar._oFullScreenExitButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));var s=a.getSelectedRepresentation().chart||{};if(t.alternateRepresentationIcon===false&&t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){t.drawAlternateRepresentation();t.alternateRepresentationIcon=true;}if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if(t.viewSettingsIcon===false){t.insertViewSettingsIcon();}t.viewSettingsIcon=true;}if(t.oCoreApi.getActiveStep().getRepresentationInfo().length>1){if(t.chartIconInserted===false){t.drawMultipleRepresentation();}t.chartIconInserted=true;}else if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION&&t.oCoreApi.getActiveStep().getRepresentationInfo().length===1){if(t.chartIconInserted===false){t.drawSingleRepresentation();}t.chartIconInserted=true;}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION||sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP)){t.getView().chartToolbar._oShowLegendButton.setVisible(false);}else{t.getView().chartToolbar._oShowLegendButton.setVisible(true);t.getView().chartToolbar._oShowLegendButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("legend"));}if(t.isSwitchRepresentation===true){t.getView().chartToolbar.setShowLegend(true);}}};this.getView().chartToolbar.addEventDelegate({onAfterRendering:function(){if(t.oCoreApi.getSteps().length>0){t.showAndHideIcons();}var s=t.oCoreApi.getActiveStep();if(s){var c=s.getSelectedRepresentation();var f;var a=s.getSelectedRepresentation().chart||{};if(c.bIsLegendVisible===true||c.bIsLegendVisible===undefined){if(a.setVizProperties){a.setVizProperties({legend:{visible:true},sizeLegend:{visible:true}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}else{if(a.setVizProperties){a.setVizProperties({legend:{visible:false},sizeLegend:{visible:false}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}}},onBeforeRendering:function(){if(t.oCoreApi.getSteps().length>0){t.renderIcons();}}});},drawRepresentation:function(c){var t=this;this.isSwitchRepresentation=true;this.getView().chartToolbar.getToolBar().removeAllContentLeft();this.getView().chartToolbar.getToolBar().removeAllContentRight();this.chartIconInserted=false;this.alternateRepresentationIcon=false;this.viewSettingsIcon=false;this.getView().chartToolbar.removeAllCharts();this.getView().chartToolbar.insertChart(c);if(this.getView().chartToolbar.getFullScreen()===true){this.getView().chartToolbar.rerender();}this.drawToolBar();this.getView().chartToolbar.onAfterRendering=function(){var l=this._oShowLegendButton.getDomRef();var e=sap.ui.Device.browser.mobile?"tap":"click";$(l).on(e,function(){var s=t.oCoreApi.getActiveStep();var a=s.getSelectedRepresentation();var E=arguments[0];var b=s.getSelectedRepresentation().chart||{};if(a.bIsLegendVisible===true||a.bIsLegendVisible===undefined){a.bIsLegendVisible=false;}else{a.bIsLegendVisible=true;}});};}});};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterListHandler')){jQuery.sap.declare('sap.apf.ui.utils.facetFilterListHandler');sap.apf.ui.utils.FacetFilterListHandler=function(c,u,p,f){"use strict";var F=f.label;var s=f.property;var a=f.alias;var S=a||s;var b=f.filterResolutionRequest;var v=f.valueHelpRequest;var m;var o;var t=false;var h=false;this.fetchValueHelpData=function(){m=new jQuery.Deferred();if(v){var V=new sap.apf.ui.utils.PromiseBasedCreateReadRequest(c,v);V.then(this._getFormattedData).then(this._resolveMasterDataPromiseWith,this._handleVhrError);}else{this._resolveMasterDataPromiseWith([]);}return m.promise();};this.fetchSelectedFilterData=function(){o=new jQuery.Deferred();var P=p.getAllIds().indexOf(s)!==-1;if(P){var d=p.get(s);var O=d.getInternalFilter().getFilterTerms().map(function(g){return g.getOp();});var H=O.some(function(g){return g!=="EQ";});if(H||(!v&&!t)){t=true;if(b){var e=new sap.apf.ui.utils.PromiseBasedCreateReadRequest(c,b,d);e.then(this._resolveRelationalOperatorFromPCH,this._handleFrrError).then(this._getFormattedData).then(this._resolveSelectDataPromiseWith);return o.promise();}if(H){this._handleFrrError();return o.promise();}}var D=d.getInternalFilter().getFilterTerms().map(function(g){return{key:g.getValue(),text:g.getValue()};});this._resolveSelectDataPromiseWith(D);}else{this._resolveSelectDataPromiseWith([]);}return o.promise();};this._resolveMasterDataPromiseWith=function(V,e){m.resolveWith(this,[V,e]);};this._resolveSelectDataPromiseWith=function(V,e){h=true;o.resolveWith(this,[V,e]);};this._getFormattedData=function(A){var d=A.aData;var M=A.oMetadata;var e=new sap.apf.ui.representations.utils.formatter({getEventCallback:u.getEventCallback.bind(u),getTextNotHtmlEncoded:c.getTextNotHtmlEncoded},M,d);var T=M.getPropertyMetadata(S).text;var g=d.map(function(D){var i=e.getFormattedValue(S,D[S]);var j;if(T){var k=e.getFormattedValue(T,D[T]);j=i+" - "+k;}else{j=i;}return{key:D[S],text:j};});return g;};this._resolveRelationalOperatorFromPCH=function(A){var d=A.aData;var M=A.oMetadata;var e=c.createFilter();var O=e.getTopAnd().addOr();d.forEach(function(D){var V=D[s];O.addExpression({name:s,operator:"EQ",value:V});});p.update(s,e);if(!h){p.saveInitialContext([s]);}return{aData:d,oMetadata:M};};this._handleVhrError=function(){var M=c.createMessageObject({code:"6010",aParameters:[c.getTextNotHtmlEncoded(F)]});c.putMessage(M);};this._handleFrrError=function(){var M=c.createMessageObject({code:"6010",aParameters:[c.getTextNotHtmlEncoded(F)]});c.putMessage(M);this._resolveSelectDataPromiseWith([],M);};};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filter')){jQuery.sap.declare('sap.apf.core.utils.filter');sap.apf.core.utils.Filter=function(m,a,b,c,d){var e="%20and%20";var f="%20or%20";var t=this;this.type="internalFilter";var l;if(a&&a.type&&(a.type==="filterTerm"||a.type==="internalFilter")){l=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){l=new sap.apf.core.utils.FilterTerm(m,a,b,c,d);}else if(a===undefined&&b===undefined&&c===undefined){}else{m.check(false,"wrong arguments in construction of  sap.apf.core.utils.Filter");}var r=[];var g;this.getProperties=function(){var i;var p=[];var P=[];var j="";if(l===undefined){return p;}else if(l instanceof sap.apf.core.utils.FilterTerm){j=l.getProperty();p.push(j);}else if(l instanceof sap.apf.core.utils.Filter){p=l.getProperties();}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){p.push(r[i].getProperty());}else{P=r[i].getProperties();p=p.concat(P);}}return sap.apf.utils.eliminateDuplicatesInArray(m,p);};this.copy=function(){var F;var i=0;if(l===undefined){return new sap.apf.core.utils.Filter(m);}else{F=new sap.apf.core.utils.Filter(m,l);if(g===undefined){return F;}for(i=0;i<r.length;i++){if(g===sap.apf.core.constants.BooleFilterOperators.AND){F.addAnd(r[i].copy());}else{F.addOr(r[i].copy());}}return F;}};this.isRestrictedToSingleValue=function(){if(l===undefined||r.length>0){return false;}if(l instanceof sap.apf.core.utils.FilterTerm&&l.getOp()===sap.apf.core.constants.FilterOperators.EQ){return true;}return false;};this.getNumberOfTerms=function(){if(l===undefined){return 0;}else{return 1+r.length;}};this.isEqual=function(F){if(this===F){return true;}if(F===undefined){return false;}return(this.getHash()===F.getHash());};this.getHash=function(L){var n=L||1;var j=0;if(r.length===0){j=n;}else{j=n+1;}if(l===undefined){return 0;}var H=l.getHash(j);var i;if(g===undefined){return H;}else if(g===sap.apf.core.constants.BooleFilterOperators.AND){H=H+Math.pow(2,n);}else if(g===sap.apf.core.constants.BooleFilterOperators.OR){H=H+Math.pow(3,n);}for(i=0;i<r.length;i++){H=H+r[i].getHash(j);}return H;};this.filterArray=function(D){var F=[];var i;var j=0;var k=D.length;if(k===0){return F;}var C=false;var n=this.getProperties();var o=[];for(var p in D[0]){if(jQuery.inArray(p,n)>-1){o.push(p);}}if(o.length===0){return D;}for(i=0;i<k;i++){C=true;for(j in o){p=o[j];if(this.contains(p,D[i][p])===false){C=false;break;}}if(C){F.push(D[i]);}}return F;};this.getFilterTermsForProperty=function(p){var T=[];var i;if(l===undefined){return T;}if(l instanceof sap.apf.core.utils.Filter){T=l.getFilterTermsForProperty(p);}else if(p===l.getProperty()){T.push(l);}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){if(p===r[i].getProperty()){T.push(r[i]);}}else{T=T.concat(r[i].getFilterTermsForProperty(p));}}return T;};this.getFilterTerms=function(){var T=[];var i;if(l===undefined){return T;}if(l instanceof sap.apf.core.utils.Filter){T=l.getFilterTerms();}else{T.push(l);}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){T.push(r[i]);}else{T=T.concat(r[i].getFilterTerms());}}return T;};this.contains=function(p,v){var R=false;var i=0;if(l===undefined){return true;}if(g===undefined){return l.contains(p,v);}else if(g===sap.apf.core.constants.BooleFilterOperators.AND){R=l.contains(p,v);if(R===false){return false;}for(i=0;i<r.length;i++){R=r[i].contains(p,v);if(R===false){return false;}}return true;}else if(g===sap.apf.core.constants.BooleFilterOperators.OR){R=l.contains(p,v);if(R===true){return true;}for(i=0;i<r.length;i++){R=r[i].contains(p,v);if(R===true){return true;}}return false;}};this.removeTermsByProperty=function(p){var i,R,o;if(l===undefined){return this.copy();}R=l.removeTermsByProperty(p);if(R instanceof sap.apf.core.utils.FilterTerm){R=new sap.apf.core.utils.Filter(m,R.getProperty(),R.getOp(),R.getValue(),R.getHighValue());}if(g===undefined){return R;}for(i=0;i<r.length;i++){o=r[i].removeTermsByProperty(p);if(R===undefined){if(o instanceof sap.apf.core.utils.FilterTerm){R=new sap.apf.core.utils.Filter(m,o);}else{R=o;}}else if(o!==undefined){if(g===sap.apf.core.constants.BooleFilterOperators.AND){R.addAnd(o);}else{R.addOr(o);}}}if(R){return new sap.apf.core.utils.Filter(m,R);}};this.removeTerms=function(p,o,v){var i;if(l===undefined){return this.copy();}var F=l.removeTerms(p,o,v);var j;if(F instanceof sap.apf.core.utils.FilterTerm){F=new sap.apf.core.utils.Filter(m,F.getProperty(),F.getOp(),F.getValue(),F.getHighValue());}if(g===undefined){return F;}for(i=0;i<r.length;i++){j=r[i].removeTerms(p,o,v);if(F===undefined){if(j instanceof sap.apf.core.utils.FilterTerm){F=new sap.apf.core.utils.Filter(m,j);}else{F=j;}}else if(j!==undefined){if(g===sap.apf.core.constants.BooleFilterOperators.AND){F.addAnd(j);}else{F.addOr(j);}}}return F;};this.addOr=function(a,b,c){var F;if(a instanceof sap.apf.core.utils.Filter||a instanceof sap.apf.core.utils.FilterTerm){F=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){F=new sap.apf.core.utils.FilterTerm(m,a,b,c);}else{m.check(false,"sap.apf.core.utils.Filter.addOr: wrong arguments in construction of  Filter");}if(l===undefined){l=F;return t;}if(g===undefined){g=sap.apf.core.constants.BooleFilterOperators.OR;}r.push(F);m.check(g===sap.apf.core.constants.BooleFilterOperators.OR,"sap.apf.core.utils.Filter - addOr wrong operation");return t;};this.addAnd=function(a,b,c){var F;if(a instanceof sap.apf.core.utils.Filter||a instanceof sap.apf.core.utils.FilterTerm){F=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){F=new sap.apf.core.utils.FilterTerm(m,a,b,c);}else{m.check(false,"sap.apf.core.utils.Filter.addAnd: wrong arguments in construction of  Filter");}if(l===undefined){l=F;return t;}if(g===undefined){g=sap.apf.core.constants.BooleFilterOperators.AND;}m.check(g===sap.apf.core.constants.BooleFilterOperators.AND,"sap.apf.core.utils.Filter - addAnd wrong operation");r.push(F);return t;};this.toUrlParam=function(j){var A=false;var p=[];var E="";if(j!==undefined&&j.asFilterArray===true){A=true;}if(l===undefined){if(A===true){return[];}else{return"";}}if(A===true){p=l.toUrlParam(j);}else{E=l.toUrlParam(j);}var i=0;var k=r.length;var C="";if(k===0){if(A===true){return p;}else{return E;}}if(g===sap.apf.core.constants.BooleFilterOperators.AND){C=e;}else{C=f;}var R="";if(A===true){for(i=0;i<k;i++){p=p.concat(r[i].toUrlParam(j));}return p;}for(i=0;i<k;i++){R=r[i].toUrlParam(j);if(E===""){E=R;}else if(R!==""){E=E+C+R;}}return'('+E+')';};this.mapToSelectionVariant=function(){m.check(g===sap.apf.core.constants.BooleFilterOperators.AND,"sap.apf.core.utils.Filter.mapToSelectionVariant: filter structure too complex");var i={operator:sap.apf.core.constants.BooleFilterOperators.AND,terms:[]};this._getAndFilterTermsForSelectionVariant().forEach(function(j){i.terms.push(j._mapOrFilterToSelectionVariant());});return i;};this._mapOrFilterToSelectionVariant=function(){if(r.length>0){m.check(g===sap.apf.core.constants.BooleFilterOperators.OR,"sap.apf.core.utils.Filter._mapOrFilterToSelectionVariant: filter structure too complex");}var i=[];h().forEach(function(n){if(n.type==="filterTerm"){i.push(n);}else{Array.prototype.push.apply(i,n._getOrFilterTermsForSelectionVariant(n));}});if(i.length>0){var j=i[0].getProperty();}i.forEach(function(n){m.check(n.getProperty()===j,"sap.apf.core.utils.Filter._mapOrFilterToSelectionVariant: filter structure too complex");});var k={property:j,operator:sap.apf.core.constants.BooleFilterOperators.OR,expressions:[]};i.forEach(function(n){k.expressions.push(n.mapToSelectionVariant());});return k;};this.mapToSapUI5FilterExpression=function(){var i,j,F=[];if(l===undefined){return{};}if(r.length===0){return l.mapToSapUI5FilterExpression();}else{F.push(l.mapToSapUI5FilterExpression());for(i=0;i<r.length;i++){F.push(r[i].mapToSapUI5FilterExpression());}j={filters:F,and:(g===sap.apf.core.constants.BooleFilterOperators.AND)}}return j;};this._getOrFilterTermsForSelectionVariant=function(){var i=[];if(r.length>0){m.check(g===sap.apf.core.constants.BooleFilterOperators.OR,"sap.apf.core.utils.Filter._getOrFilterTermsForSelectionVariant: filter structure too complex");}h().forEach(function(j){if(j.type==="filterTerm"){i.push(j);}else{Array.prototype.push.apply(i,j._getOrFilterTermsForSelectionVariant());}});return i;};this._getAndFilterTermsForSelectionVariant=function(){var i=[];if(r.length>0&&g!==sap.apf.core.constants.BooleFilterOperators.AND){i.push(this);return i;}h().forEach(function(j){if(j.type==="filterTerm"){i.push(j);}else{Array.prototype.push.apply(i,j._getAndFilterTermsForSelectionVariant());}});return i;};this.overwriteWith=function(F){var p=F.getProperties();var R;if(p.length!==0){R=this.removeTermsByProperty(p);if(R===undefined){return F.copy();}R.addAnd(F);return R;}return this.copy();};this.mapProperties=function(M){var i=0;if(l===undefined){return undefined;}l.mapProperties(M);if(g===undefined){return;}for(i=0;i<r.length;i++){r[i].mapProperties(M);}};this.reduceToProperty=function(){var p=[];var P;switch(arguments.length){case 1:P=arguments[0];if(P instanceof Array){p=P;}else{p.push(P);}break;default:p=Array.prototype.slice.call(arguments,0);}var F=S(this.getProperties(),p);return this.copy().removeTermsByProperty(F)||new sap.apf.core.utils.Filter(m);function S(s,j){var i;var k=[];var n={};var o=s?s.length:0;var q=j?j.length:0;for(i=0;i<q;i++){n[j[i]]=undefined;}for(i=0;i<o;i++){if(!(s[i]in n)){k.push(s[i]);}}return k;}};function h(){var i=[];if(l===undefined){return i;}i.push(l);r.forEach(function(j){i.push(j);});return i;};};sap.apf.core.utils.Filter.createFromArray=function(m,p,d,I){m.check(p instanceof Array&&p.length>0,"sap.apf.core.utils.Filter.createFromArray incorrect argument aProperties");m.check(d instanceof Array,"sap.apf.core.utils.Filter.createFromArray incorrect argument aData");if(I.length>0){var l=p.length;var i;var n;var j;var f;var F;var o;for(i in I){F=undefined;n=I[i];if(!d[n]){continue;}for(j=0;j<l;j++){o=new sap.apf.core.utils.Filter(m,p[j],sap.apf.core.constants.FilterOperators.EQ,d[n][p[j]]);if(F===undefined){F=new sap.apf.core.utils.Filter(m,o);}else{F.addAnd(o);}}if(f===undefined){f=new sap.apf.core.utils.Filter(m,F);}else{f.addOr(F);}}return f;}return new sap.apf.core.utils.Filter(m);};sap.apf.core.utils.Filter.createEmptyFilter=function(m,p){m.check(jQuery.isArray(p)&&p.length>0,"sap.apf.core.utils.Filter.createEmptyFilter - array with property names expected");return new sap.apf.core.utils.Filter(m,p[0],sap.apf.core.constants.FilterOperators.EQ,'').addAnd(p[0],sap.apf.core.constants.FilterOperators.NE,'');};};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textPool')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.textPool");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.modeler.core.TextPool=function(c,d,e){var m=c.instance.messageHandler;var p=c.instance.persistenceProxy;var H=c.constructor.hashtable;var h=new H(m);var k=new H(m);var g=new H(m);var f;var l=0;var n={TextElement:sap.apf.core.constants.textKeyForInitialText,Language:sap.apf.core.constants.developmentLanguage,TextElementType:"XFLD",TextElementDescription:"",MaximumLength:10,Application:d,TranslationHint:""};function o(t,a){var b=h.getKeys();var i,j=b.length;var u=a.MaximumLength||10;var v=a.TranslationHint||"";var w;for(i=0;i<j;i++){w=h.getItem(b[i]);if((w.TextElementDescription===t)&&(w.MaximumLength===u)&&(w.TranslationHint===v)){return b[i];}}return undefined;}function r(){var t=d.toLowerCase();var a=/^[0-9a-f]+$/;var i=a.test(t);if(!i||d.length!==32){m.putMessage(m.createMessageObject({code:"11009",aParameters:[d]}));t="<please enter valid translation uuid, if you want to upload into a SAP translation system>";}else{t=t.substring(0,8)+'-'+t.substring(8,12)+'-'+t.substring(12,16)+'-'+t.substring(16,20)+'-'+t.substring(20);}return"#FIORI: insert Fiori-Id\n"+"# __ldi.translation.uuid="+t+"\n"+"#ApfApplicationId="+d+"\n\n";}function q(t){var a,D;if(!f&&(!t.TextElementType||!t.MaximumLength)){f=true;m.putMessage(m.createMessageObject({code:"11008",aParameters:[t.TextElement]}));}var b="#"+(t.TextElementType||"<Add text type>")+","+(t.MaximumLength||"<Add maximum length>");if(t.TranslationHint&&t.TranslationHint!==""){b=b+':'+t.TranslationHint;}b=b+"\n"+t.TextElement+"="+t.TextElementDescription+"\n";var i=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});if(t.LastChangeUTCDateTime&&t.LastChangeUTCDateTime!==""){a=t.LastChangeUTCDateTime.replace(/\/Date\(/,'').replace(/\)\//,'');D=new Date(parseInt(a,10));}else{D=new Date();}b=b+"# LastChangeDate="+i.format(D)+'\n\n';return b;}this.removeTexts=function(t,a){var b=[];var i,u;function v(w){var j;if(!w){for(j=0;j<u;j++){h.removeItem(t[j]);}}a(w);}u=t.length;if(u===0){a(undefined);return;}for(i=0;i<u;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}b.push({method:"DELETE",entitySetName:"texts",inputParameters:[{name:'TextElement',value:t[i]},{name:'Language',value:sap.apf.core.constants.developmentLanguage}]});}p.doChangeOperationsInBatch(b,v);};this.isInitialTextKey=function(t){return(t===sap.apf.core.constants.textKeyForInitialText);};this.addTextsAndSave=function(t,a){function b(z,A){return(z.TextElement===A.TextElement&&z.TextElementDescription===A.TextElementDescription&&z.MaximumLength===A.MaximumLength&&z.Language===A.Language&&z.TranslationHint===A.TranslationHint);}var i;var j=t.length;var u;var v=[];var w=[];var x=[];var y;for(i=0;i<j;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}u=h.getItem(t[i].TextElement);if(u){if(!b(u,t[i])){v.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}else{w.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}j=v.length;for(i=0;i<j;i++){y=[{name:'TextElement',value:v[i].TextElement},{name:'Language',value:v[i].Language}];v[i].MaximumLength=parseInt(v[i].MaximumLength,10);x.push({method:"PUT",entitySetName:"texts",data:v[i],inputParameters:y});}j=w.length;for(i=0;i<j;i++){w[i].MaximumLength=parseInt(w[i].MaximumLength,10);x.push({method:"POST",entitySetName:"texts",data:w[i]});}if(x.length>0){p.doChangeOperationsInBatch(x,a);}else{a(undefined);}};this.exportTexts=function(){var t=r();var i,j;f=false;var u=h.getKeys();u.sort(function(a,b){var v=h.getItem(a);var w=h.getItem(b);if(v.LastChangeUTCDateTime<w.LastChangeUTCDateTime){return-1;}if(v.LastChangeUTCDateTime>w.LastChangeUTCDateTime){return 1;}return 0;});j=u.length;for(i=0;i<j;i++){t=t+q(h.getItem(u[i]));}return t;};this.get=function(i){var a,b;if(i===sap.apf.core.constants.textKeyForInitialText){return n;}if(h.hasItem(i)){return h.getItem(i);}if(k.hasItem(i)){a=k.getItem(i);if(a.TextElementDescription){return a;}return h.getItem(a);}b=jQuery.extend({},true,n);b.TextElement=i;b.TextElementDescription=i;return b;};this.getPersistentKey=function(i){return i;};this.setText=function(t,a){var b;var i;var u=function(v,w,x){if(x){m.putMessage(x);}if(v){h.setItem(v.TextElement,v);i=v.TextElement;}};var j={TextElement:"",Language:sap.apf.core.constants.developmentLanguage,TextElementType:a.TextElementType,TextElementDescription:t,MaximumLength:a.MaximumLength||10,Application:d,TranslationHint:a.TranslationHint||""};if(!t){return sap.apf.core.constants.textKeyForInitialText;}i=o(t,a);if(i){return i;}l++;b="textKey"+l;p.create('texts',j,u,false);return i;};this.getTextKeys=function(t){var a=h.getKeys();var i,b,j=a.length;var u=[];for(i=0;i<j;i++){b=h.getItem(a[i]);if(t&&b.TextElementType!==t){continue;}if(g.hasItem(a[i])){u.push(g.getItem(a[i]));}else{u.push(a[i]);}}return u;};this.getTextsByTypeAndLength=function(t,a){var b=h.getKeys();var i,j,u=b.length;var v=[];for(i=0;i<u;i++){j=h.getItem(b[i]);if(j.TextElementType===t&&j.MaximumLength===a){if(g.hasItem(b[i])){v.push({TextElement:g.getItem(b[i]),TextElementDescription:j.TextElementDescription});}else{v.push({TextElement:b[i],TextElementDescription:j.TextElementDescription});}}}return v;};function s(){var i,a;a=e.length;for(i=0;i<a;i++){h.setItem(e[i].TextElement,e[i]);}}s();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configurationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configurationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configurationList",{onInit:function(){var s=this;var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();}this._instantiateToolbarView();this._instantiateAPFTree();this._instantiateTitleAndBreadCrumbView();this._addConfigStyleClass();this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);this.bProgramaticSelection=false;sap.apf.modeler.ui.utils.APFRouter.patternMatch(this);},_instantiateToolbarView:function(){var t=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.toolbar",type:"XML",viewData:{oConfigListInstance:this}});this.toolbarController=t.getController();this.byId("idConfigMasterData").insertItem(t,0);},_instantiateAPFTree:function(){this.oTreeInstance=this.byId("idConfigTree");this.oTreeInstance.setTranslationFunction(this.oCoreApi.getText);var d;if(this.oCoreApi.getRepresentationTypes()[0].metadata){d=this.oCoreApi.getRepresentationTypes()[0].id;}this.oTreeInstance.setDefaultRepresentationType(d);},_instantiateTitleAndBreadCrumbView:function(){this.oTitleBreadCrumbView=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.titleBreadCrumb",type:"XML",viewData:{getText:this.oCoreApi.getText}});this.oTitleBreadCrumbController=this.oTitleBreadCrumbView.getController();this.byId("idConfigDetail").insertItem(this.oTitleBreadCrumbView,0);},setConfigListMasterTitle:function(t){this.byId("idConfigTitleMaster").setText(this.oCoreApi.getText("configurationObjectTitle")+" : "+t);},onAfterRendering:function(){var s=this;this.oTreeInstance.onAfterRendering=function(){s._setHeightForTree();};},_setHeightForTree:function(){var s=this;var v=this;var t=this.oTreeInstance;var w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();var h=jQuery(window).height();var a=60;var b=jQuery(v.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(v.byId("configPage").getDomRef()).find("header").height();var f=jQuery(v.byId("configPage").getDomRef()).find("footer").height();var o;if(b>0){o=a+b+c+f;}else{o=205;}t.setHeight(h-o+"px");t.setWidth(w+"px");sap.apf.modeler.ui.utils.helper.onResize(function(){w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();h=jQuery(v.byId("configPage").getDomRef()).height();t.setHeight(h-o+"px");t.setWidth(w+"px");});},_setDisplayText:function(){this.byId("configPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idSavebutton").setText(this.oCoreApi.getText("save"));this.byId("idCancelbutton").setText(this.oCoreApi.getText("cancel"));this.byId("idExportbutton").setText(this.oCoreApi.getText("export"));},_addConfigStyleClass:function(){this.getView().addStyleClass("sapUiSizeCompact");this.byId("idConfigTree").addStyleClass("configTree");this.byId("idConfigTitleMaster").addStyleClass("configTitle");this.byId("idConfigMasterData").addStyleClass("configMasterData");this.byId("idConfigDetailData").addStyleClass("configDetailData");},_setSubViewContainerHeight:function(s){var S=this;var a=s.getContent()[0].getItems()[0];var h=jQuery(window).height();var t=jQuery(this.byId("idConfigTitleMaster").getDomRef()).outerHeight()+jQuery(this.byId("idConfigTitleMaster").getDomRef()).offset().top;var b=jQuery(this.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(this.byId("configPage").getDomRef()).find("header").height();var f=jQuery(this.byId("configPage").getDomRef()).find("footer").height();var o;if(b>0){o=t+b+c+f;}else{o=265;}var d=h-o+"px";a.setHeight(d);var w=jQuery(this.byId("configPage").getDomRef()).width();var e=jQuery(this.byId("idConfigDetailData").getDomRef()).width();var g=jQuery(this.byId("idConfigMasterData").getDomRef()).offset().left;var i=e-g;var j=i+"px";a.setWidth(j);sap.apf.modeler.ui.utils.helper.onResize(function(){h=jQuery(S.byId("configPage").getDomRef()).height();d=h-o+"px";a.setHeight(d);w=jQuery(S.byId("configPage").getDomRef()).width();e=jQuery(S.byId("idConfigDetailData").getDomRef()).width();i=e-g;j=i+"px";a.setWidth(j);});},_setSubView:function(s){this.oSubView=s;},_getSubView:function(){return this.oSubView;},updateSubView:function(p){var s=this;var P=this._getSubView();var d=this.byId("idConfigDetailData");var v=this.getSPathFromURL(p);if(P){P.destroy();}var S=new sap.ui.view({viewName:"sap.apf.modeler.ui.view."+v.objectType,type:"XML",viewData:{oParams:p,updateConfigTree:s.updateConfigTree.bind(s),updateSelectedNode:s.updateSelectedNode.bind(s),updateTitleAndBreadCrumb:s.updateTitleAndBreadCrumb.bind(s),updateTree:s.updateTree.bind(s),oConfigurationHandler:s.configurationHandler,oApplicationHandler:s.applicationHandler,oConfigurationEditor:s.configEditor,getText:s.oCoreApi.getText,getEntityTypeMetadata:s.oCoreApi.getEntityTypeMetadata,getRepresentationTypes:s.oCoreApi.getRepresentationTypes,oFooter:s.byId("idFooterBarMain"),createMessageObject:s.oCoreApi.createMessageObject,putMessage:s.oCoreApi.putMessage,getAllAvailableSemanticObjects:s.oCoreApi.getAllAvailableSemanticObjects,getSemanticActions:s.oCoreApi.getSemanticActions}});if(p.name!=="applicationList"){d.removeAllContent();S.placeAt(d);if(d.$().height()!==0){this._setSubViewContainerHeight(S);}this._setSubView(S);}},clearTitleAndBreadCrumb:function(){this.oTitleBreadCrumbView.byId("IdFormTitle").setText("");this.oTitleBreadCrumbView.byId("IdBreadCrumb").setText("");},updateTitleAndBreadCrumb:function(t){var f;var b;var s=this.oTreeInstance.getSelection();var S=s?this.oTreeInstance.getNodeContext(s):undefined;var n=S?S.nodeObjectType:undefined;var p=S?this.oTreeInstance.getParentNodeContext(S):undefined;if(t){f=t;}else{if(n){var a=s.getText();f=this.oCoreApi.getText(n)+": "+a;}}if(p){switch(n){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:b=p.configurationName;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:b=p.configurationName+" > "+this.oCoreApi.getText("facetFilter")+" > "+p.facetFilterName;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:b=p.configurationName+" > "+this.oCoreApi.getText("category")+" > "+p.categoryName;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:b=p.configurationName+" > "+p.categoryName+" > "+p.stepName;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:b=p.configurationName+" > "+p.categoryName+" > "+p.stepName+" > "+p.representationName;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:b=p.configurationName+" > "+this.oCoreApi.getText("navigationTarget")+" > "+p.navTargetName;break;}}this.oTitleBreadCrumbController.setTitleAndBreadCrumb(f,b);},setSelectionOnTree:function(b){this.toolbarController.enableCopyDeleteButton();this._enableExportButton();this.oTreeInstance.setSelectionOnTree(b);},removeSelectionOnTree:function(){this.oTreeInstance.removeSelectionOnTree(this.selectedNode);},updateConfigTree:function(o){var a,n,O,m,i,b,c,d,e,f;var s=this;o.forEach(function(S){var h;a=s.getSPathFromURL(S.oldContext).sPath;O=a.split("/");i=O[2];b=O[6];d=O[8];e=jQuery.extend(true,{},s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[d]);f=e.id;e.isSelected=false;n=s.getSPathFromURL(S.newContext).sPath;c=n.split("/")[6];if(S.removeStep===undefined){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(q){if(q.id===f){h=true;}});if(h===undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else{s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=[];s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else if(S.removeStep===true){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(q,r){if(q.id===f){var t=s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps;var u=t.splice(r,1);s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=t;}});if(S.changeCategory===true){var j=s.getSPathFromURL(S.categoryChangeContext).sPath;var k=j.split("/");i=k[2];var l=k[6];var p=k[8];s.oModel.getData().aConfigDetails[i].configData[1].categories[l].steps[p].isSelected=true;s.oModel.getData().aConfigDetails[i].configData[1].categories[l].expanded=true;}}}});this.oModel.updateBindings();var g=o.length;if(o[g-1].changeCategory){sap.ui.core.UIComponent.getRouterFor(this).navTo(o[g-1].oldContext.name,o[g-1].categoryChangeContext.arguments);}this.configEditor.setIsUnsaved();},updateSelectedNode:function(p,c){if(p){if(this.oTreeInstance.getSelection()){this.selectedNode=this.oTreeInstance.getSelection();}if(this.selectedNode){if(p.name&&this.selectedNode.getBindingContext()&&this.selectedNode.getBindingContext().getObject()){this.selectedNode.getBindingContext().getObject().name=p.name;this.selectedNode.getBindingContext().getObject().isSelected=true;if(this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){this.selectedNode.getBindingContext().getObject().icon=p.icon;}this.oModel.updateBindings();}if(p.id&&this.selectedNode.getBindingContext().getObject().id){this.selectedNode.getBindingContext().getObject().id=p.id;if(this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){this.selectedNode.getBindingContext().getObject().icon=p.icon;}}else if(p.id&&this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration){this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration=p.id;this.selectedNode.getBindingContext().getObject().expanded=true;}}if((this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION)&&c){sap.ui.core.UIComponent.getRouterFor(this).navTo(this.selectedNode.getBindingContext().getObject().type,c);}}},createConfigList:function(){var s=this;this.configList=this.configurationHandler.getList();this.configList.forEach(function(c,i){var C={};C.AnalyticalConfiguration=c.AnalyticalConfiguration;C.name=c.AnalyticalConfigurationName;C.Application=c.Application;C.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;C.bIsLoaded=false;C.bToggleState=false;C.isSelected=false;C.expanded=false;C.selectable=true;C.hasExpander=true;s.oModel.getData().aConfigDetails.push(C);});this.oModel.updateBindings();},showNoConfigSelectedText:function(){this.byId("idConfigDetailData").removeAllContent();this.clearTitleAndBreadCrumb();var n=new sap.m.Label().addStyleClass("noConfigSelected");n.setText(this.oCoreApi.getText("noConfigSelected"));n.placeAt(this.byId("idConfigDetailData"));this.toolbarController.disableCopyDeleteButton();this.disableExportButton();},updateConfigListView:function(){this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode===null){if(this.configList.length>1){this.showNoConfigSelectedText();}else{this.oModel.getData().aConfigDetails[0].isSelected=true;this.oModel.getData().aConfigDetails[0].expanded=true;this.configId=this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration;this.oModel.updateBindings();var c={appId:this.appId,configId:this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration};this.selectedNode=this.oTreeInstance.getNodes()[0];this.toolbarController.enableCopyDeleteButton();this._enableExportButton();sap.ui.core.UIComponent.getRouterFor(this).navTo(this.oModel.getData().aConfigDetails[0].type,c);}}},_getNodeData:function(p,t){var c=this.oModel.getData().aConfigDetails;var n={};var g=function(h){var j={};var k=h||this.configId;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===k){j.index=i;j.data=c[i];j.id=c[i].AnalyticalConfiguration;break;}}return j;};var a=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].filters instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].filters.length;j++){if(c[k].configData[i].filters[j].id===h){l.index=j;l.data=c[k].configData[i].filters[j];l.id=c[k].configData[i].filters[j].id;l.ffExpansion=c[k].configData[i].expanded;}}}}return l;};var b=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].categories instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].categories.length;j++){if(c[k].configData[i].categories[j].id===h){l.index=j;l.data=c[k].configData[i].categories[j];l.id=c[k].configData[i].categories[j].id;l.categoryExpansion=c[k].configData[i].expanded;}}}}return l;};var d=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m={};for(var i=0;i<c[j].configData[k].categories[l].steps.length;i++){if(c[j].configData[k].categories[l].steps[i].id===h){m.index=i;m.data=c[j].configData[k].categories[l].steps[i];m.id=c[j].configData[k].categories[l].steps[i].id;}}return m;};var e=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]).index;var o={};for(var i=0;i<c[j].configData[k].categories[l].steps[m].representations.length;i++){if(c[j].configData[k].categories[l].steps[m].representations[i].id===h){o.index=i;o.data=c[j].configData[k].categories[l].steps[m].representations[i];o.id=c[j].configData[k].categories[l].steps[m].representations[i].id;}}return o;};var f=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].navTargets instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].navTargets.length;j++){if(c[k].configData[i].navTargets[j].id===h){l.index=j;l.data=c[k].configData[i].navTargets[j];l.id=c[k].configData[i].navTargets[j].id;l.nTExpansion=c[k].configData[i].expanded;}}}}return l;};switch(t){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:n=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:n=a.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:n=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:n=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:n=e.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:n=f.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]);break;}return n;},_retainNodeState:function(p,t){var m=this.oModel;var c=p.configId;var i="";var a=this._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;if(!this.oModel.getData().aConfigDetails[a].bIsLoaded){return{};}var n=this._getNodeData(p,t);if(!n.data){return{};}return{expanded:n.data.expanded,isSelected:n.data.isSelected};},updateTree:function(){var s=this;var c=[],S=[],f=[],n=[],C=[],a=[],b=[];this.oTextPool=this.configurationHandler.getTextPool();var p={};p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=this.configId;var d=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;var F=false;var e=false;var g=false;c=this.configEditor.getCategories();f=this.configEditor.getFacetFilters();n=this.configEditor.getNavigationTargets();var r=this.oCoreApi.getRepresentationTypes();var R={};r.forEach(function(o){var i=o.id;R[i]=o.picture;});c.forEach(function(i){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=i.getId();var o=i;var j=o.getId();b=[];s.configEditor.getCategoryStepAssignments(j).forEach(function(t){var v=s.configEditor.getStep(t);p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=j;p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=v.getId();var w=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP);var x=v.getRepresentations();var y=x.map(function(z){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=z.getId();var A=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION);return{id:z.getId(),name:s.oCoreApi.getText(z.getRepresentationType()),type:"representation",isSelected:A.isSelected||false,expanded:A.expanded||false,selectable:true,icon:R[z.getRepresentationType()]};});b.push({id:v.getId(),name:s.oTextPool.get(v.getTitleId())?s.oTextPool.get(v.getTitleId()).TextElementDescription:v.getTitleId(),type:"step",representations:y,isSelected:w.isSelected||false,expanded:w.expanded||false,selectable:true});});var m=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var q=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(q.categoryExpansion){g=true;}}C.push({id:i.getId(),name:s.oTextPool.get(i.labelKey)?s.oTextPool.get(i.labelKey).TextElementDescription:i.labelKey,type:"category",steps:b,isSelected:m.isSelected||false,expanded:m.expanded||false,selectable:true});});var h=[];f.forEach(function(o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=o.getId();var i=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var j=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(j.ffExpansion){F=true;}}h.push({id:o.getId(),name:s.oTextPool.get(o.getLabelKey())?s.oTextPool.get(o.getLabelKey()).TextElementDescription:o.getLabelKey(),type:"facetFilter",isSelected:i.isSelected||false,expanded:i.expanded||false,selectable:true});});a.push({filters:h,name:s.oCoreApi.getText("facetFilters"),expanded:F,selectable:false});a.push({categories:C,name:s.oCoreApi.getText("categories"),expanded:g,selectable:false});var N=[];var k=function(j,o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=o.getId();var m=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var q=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(q.nTExpansion){e=true;}}var i,t;for(i=0;i<j.length;i++){if(j[i].id===o.getAction()){t=j[i].text;break;}}N.push({id:o.getId(),name:t||o.getSemanticObject(),type:"navigationTarget",isSelected:m.isSelected||false,expanded:m.expanded||false,selectable:true});};var l=function(){var m=n.map(function(o){return o.getId();});var t=[];for(var i=0;i<m.length;i++){for(var j=0;j<N.length;j++){if(m[i]===N[j].id){t[i]=N[j];break;}}}N=t;};var u=function(){var o={};o.configData=a;s.oModel.getData().aConfigDetails[d].bIsLoaded=true;var t=s.oModel.getData().aConfigDetails[d];jQuery.extend(t,o);s.oModel.getData().aConfigDetails[d]=t;s.oModel.getData().aConfigDetails[d].name=s.configurationHandler.getConfiguration(s.configId).AnalyticalConfigurationName;s.oModel.updateBindings();};n.forEach(function(o){var P=s.oCoreApi.getSemanticActions(o.getSemanticObject());P.then(function(i){k(i.semanticActions,o);if(N.length===n.length){l();if(a[2]){a.splice(2,2);a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:e,selectable:false});u();var j=sap.apf.modeler.ui.utils.APFRouter.params;if(j.name==="navigationTarget"){sap.apf.modeler.ui.utils.APFRouter.setCurrentSelectionState(j,s);}}}});});a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:e,selectable:false});u();},_handleToggleTreeNode:function(e){var s=this;var c=e.getSource();c.setExpanded(!c.getExpanded());var p=c.getBindingContext().sPath;var a=c.getBindingContext().getObject().type;if(a===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){var b=p.split('/')[2];if(s.oModel.getData().aConfigDetails[b].bIsLoaded===true){this.oModel.updateBindings();}else{this.configurationHandler.loadConfiguration(this.oModel.getData().aConfigDetails[b].AnalyticalConfiguration,function(d){s.configEditor=d;s.configId=s.oModel.getData().aConfigDetails[b].AnalyticalConfiguration;s.updateTree();});}}},getSPathForConfig:function(c){var p;this.oModel.getData().aConfigDetails.forEach(function(a,i){if(a.AnalyticalConfiguration===c){p="/aConfigDetails/"+i;}});return p;},getSPathFromURL:function(p){var v={sPath:undefined,objectType:undefined};var s=this;this.oModel.getData().aConfigDetails.forEach(function(c,i){if(c.AnalyticalConfiguration===p.arguments.configId){v.sPath="/aConfigDetails/"+i;v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;s.oModel.getData().aConfigDetails[i].expanded=true;if(p.arguments.categoryId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(a,b){if(a.id===p.arguments.categoryId){v.sPath=v.sPath.concat("/configData/1/categories/"+b);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY;s.oModel.getData().aConfigDetails[i].configData[1].expanded=true;if(p.arguments.stepId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps.forEach(function(d,e){if(d.id===p.arguments.stepId){v.sPath=v.sPath.concat("/steps/"+e);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;s.oModel.getData().aConfigDetails[i].configData[1].categories[b].expanded=true;if(p.arguments.representationId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].representations.forEach(function(r,f){if(r.id===p.arguments.representationId){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].expanded=true;v.sPath=v.sPath.concat("/representations/"+f);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION;}});}}});}}});}if(p.arguments.facetFilterId!==undefined){s.oModel.getData().aConfigDetails[i].configData[0].filters.forEach(function(f,a){if(f.id===p.arguments.facetFilterId){v.sPath=v.sPath.concat("/configData/0/filters/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER;s.oModel.getData().aConfigDetails[i].configData[0].expanded=true;}});}if(p.arguments.navTargetId!==undefined){s.oModel.getData().aConfigDetails[i].configData[2].navTargets.forEach(function(n,a){if(n.id===p.arguments.navTargetId){v.sPath=v.sPath.concat("/configData/2/navTargets/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET;s.oModel.getData().aConfigDetails[i].configData[2].expanded=true;}});}}});return v;},_navHandleExpandDelete:function(n,p,a){var s=this;var c=this.oModel.getData().aConfigDetails;var I=a||this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);var g=function(j){var r;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===j){r=i;break;}}return r;};var b=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].filters instanceof Array){t=i;for(var j=0;j<c[h].configData[i].filters.length;j++){if(c[h].configData[i].filters[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexFilter:u};};var d=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].navTargets instanceof Array){t=i;for(var j=0;j<c[h].configData[i].navTargets.length;j++){if(c[h].configData[i].navTargets[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexNavTarget:u};};var e=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].categories instanceof Array){t=i;for(var j=0;j<c[h].configData[i].categories.length;j++){if(c[h].configData[i].categories[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexCategory:u};};var f=function(j){var h=g.call(this,p.configId);var k=e.call(this,p.categoryId).indexConfig;var m=e.call(this,p.categoryId).indexCategory;var r;for(var i=0;i<c[h].configData[k].categories[m].steps.length;i++){if(c[h].configData[k].categories[m].steps[i].id===j){r=i;break;}else{r=i;}}return r;};if(p.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0&&I){this.configurationHandler.removeConfiguration(p.configId,function(i){var C=s.oModel.getData().aConfigDetails;var h=g.call(s,p.configId);C.splice(h,1);s.oModel.getData().aConfigDetails=C;});}else{var h,k,l,m,o,q;switch(n.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:h=g.call(this,p.configId);this.oModel.getData().aConfigDetails[h].isSelected=true;this.oModel.getData().aConfigDetails[h].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:h=g.call(this,p.configId);k=b.call(this,p.facetFilterId).indexConfig;l=b.call(this,p.facetFilterId).indexFilter;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].filters[l].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].steps[o].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:h=g.call(this,p.configId);k=d.call(this,p.navTargetId).indexConfig;q=d.call(this,p.navTargetId).indexNavTarget;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].navTargets[q].expanded=true;break;}}this.oModel.updateBindings();},_isNewSubView:function(p){var i=false;if(p.arguments.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){i=true;}else{if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){i=(this.configurationHandler.getConfiguration(p.arguments.configId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY){i=(this.configEditor.getCategory(p.arguments.categoryId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER){i=(this.configEditor.getFacetFilter(p.arguments.facetFilterId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){i=(this.configEditor.getStep(p.arguments.stepId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){i=(this.configEditor.getRepresentation(p.arguments.representationId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET){i=(this.configEditor.getNavigationTarget(p.arguments.navTargetId)!==undefined)?false:true;}}return i;},_getCurrentConfigurationNode:function(){var p=this.oTreeInstance.getNodes();var c=this.configId;for(var i=0;i<p.length;i++){if(c===p[i].getBindingContext().getObject().AnalyticalConfiguration){return p[i];}}return undefined;},_navMandatoryResetState:function(c,a){var s=c;s.bIsSaved=s.configEditor?s.configEditor.isSaved():undefined;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var i=this._isNewSubView(b.oViewData.oParams);if(!i){s.updateTree();var d=s.selectedNode.getBindingContext().getObject();if(d){d.isSelected=true;b.oConfigurationEditor=s.configEditor;b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}}else{s.handleConfirmDeletion();}return{bIsSaved:s.bIsSaved,isNewView:i};},_navSaveState:function(s){s();},_navConfigResetState:function(c,a){var s=c;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var i=this._isNewSubView(b.oViewData.oParams);if(!i){s.configurationHandler.loadConfiguration(s.configId,function(d){var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;s.configEditor=d;s.updateTree();var e=s.selectedNode.getBindingContext().getObject();if(e){e.isSelected=true;b.oConfigurationEditor=s.configEditor;b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}});}else{s.handleConfirmDeletion();}},getRouteContext:function(n){var s=this;if(!n){this.oSelectedNodeDetails=this.oTreeInstance.getNodeContext(this.oTreeInstance.getSelection());this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);n=this.oParentNodeDetails;}var r={appId:s.appId,configId:n.configurationId,categoryId:n.categoryId,facetFilterId:n.facetFilterId,stepId:n.stepId,representationId:n.representationId};return r;},_onTreeNodeSelection:function(e){this.selectedNode=e.getParameter("node");var s=this;if(!this.bProgramaticSelection){this.oPreviousSelectedNode=this.oTreeInstance.getSelection();this.bIsDifferntConfig=this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);var a=e.getParameters().nodeContext.getObject().type;this.oSelectedNodeDetails=this.oTreeInstance.getNodeContext(this.selectedNode);this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);this.toolbarController.enableCopyDeleteButton();this._enableExportButton();var b;if(this.byId("idConfigDetailData").getContent().length>=1){b=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var c=this.selectedNode?this.selectedNode.getId():null;var p=this.oPreviousSelectedNode?this.oPreviousSelectedNode.getId():null;var r=function(){var g=s.oPreviousSelectedNode.getBindingContext().getObject();var h=s.selectedNode.getBindingContext().getObject();g.isSelected=true;h.isSelected=false;s.oModel.updateBindings();};if(c!==p||this.bNavDeletionMode){var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i=(b!==undefined)?(typeof b.getValidationState==="function"?b.getValidationState.call(b):true):true;this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var o;var d=false;var f=this.configurationHandler.getList();if(!i&&(f.length>0)){n.throwMandatoryPopup(s,{yes:function(){var g=s.getRouteContext(s.oParentNodeDetails);var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var h=s._isNewSubView(b.oViewData.oParams);if(!h){var y=function(l){if(typeof l==="function"){l();}this.updateTree();var m=this.selectedNode.getBindingContext().getObject();this.navigateToDifferntView(this.oParentNodeDetails,this.oSelectedNodeDetails);m.isSelected=true;this.oModel.updateBindings();};if(!s.bIsSaved&&s.bIsDifferntConfig){o(false,function(){y.call(s,callback);});}else{y.call(s);}}else{if(!s.bIsSaved&&s.bIsDifferntConfig){o(false,function(){var j=s.selectedNode.getBindingContext().sPath;var k=s.oPreviousSelectedNode;s.handleConfirmDeletion(k,j);});}else{var j=s.selectedNode.getBindingContext().sPath;var k=s.oPreviousSelectedNode;s.handleConfirmDeletion(k,j);}}s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,g);},no:function(){r();}});d=true;}o=function(g){n.throwLossOfDataPopup(s,{yes:function(h){var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var j=(b!==undefined)?(typeof b.getValidationState==="function"?b.getValidationState.call(b):true):true;if(typeof g==="function"){g(function(){h(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var k=C[2];}s.oModel.getData().aConfigDetails[k].AnalyticalConfiguration=s.configId;});});}else{h(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var k=C[2];}s.oModel.getData().aConfigDetails[k].AnalyticalConfiguration=s.configId;var l=s.selectedNode.getBindingContext().getObject();s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);l.isSelected=true;s.oModel.updateBindings();});}},no:function(){var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var h=s.getRouteContext(s.oParentNodeDetails);s.configurationHandler.loadConfiguration(s.configId,function(j){s.configEditor=j;if(s.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){s._navHandleExpandDelete.call(s,{},{configId:s.configId},h);}else{s.updateTree();}s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,h);});},cancel:function(){r();}});};if(!s.bIsSaved&&s.bIsDifferntConfig&&i){o();d=true;}if(!d){if(this.oPreviousSelectedNode&&this.oPreviousSelectedNode.getId()!==this.selectedNode.getId()){var P=this.oPreviousSelectedNode.getBindingContext().getObject();if(P){this.oPreviousSelectedNode.getBindingContext().getObject().isSelected=false;this.oPreviousSelectedNode.setIsSelected(false);}}else{this.selectedNode.getBindingContext().getObject().isSelected=true;}this.navigateToDifferntView(this.oParentNodeDetails,this.oSelectedNodeDetails,this.bIsSaved,this.bIsDifferntConfig);}}}this.bProgramaticSelection=false;this.bNavDeletionMode=false;},navigateToDifferntView:function(p,s,i,I){var c={appId:this.appId,configId:p.configurationId,categoryId:p.categoryId,facetFilterId:p.facetFilterId,stepId:p.stepId,representationId:p.representationId,navTargetId:p.navTargetId};if((!jQuery.isEmptyObject(c)&&(i===undefined||i))||(!I)){sap.ui.core.UIComponent.getRouterFor(this).navTo(s.nodeObjectType,c);}},handleConfirmDeletion:function(s,a){var b=((s===undefined)||(typeof s.preventDefault==="function"))?this.oTreeInstance.getNodeContext(this.oTreeInstance.getSelection()):this.oTreeInstance.getNodeContext(s);var c=this;this.selectedNode=this.oTreeInstance.getSelection();var n,N,o,d,i,e,f,g,h,j;d=b.nodeContext;o=d.split("/");i=o[2];switch(b.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:this.configEditor.removeFacetFilter(b.nodeAPFId);e=o[6];var F=this.oModel.getData().aConfigDetails[i].configData[0].filters;F.splice(e,1);this.oModel.getData().aConfigDetails[i].configData[0].filters=F;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:this.configEditor.removeCategory(b.nodeAPFId);f=o[6];var C=this.oModel.getData().aConfigDetails[i].configData[1].categories;C.splice(f,1);this.oModel.getData().aConfigDetails[i].configData[1].categories=C;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:this.configEditor.removeNavigationTarget(b.nodeAPFId);g=o[6];var k=this.oModel.getData().aConfigDetails[i].configData[2].navTargets;k.splice(g,1);this.oModel.getData().aConfigDetails[i].configData[2].navTargets=k;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var l=this.configEditor.getStep(b.nodeAPFId);var S=this.configEditor.getCategoriesForStep(b.nodeAPFId);var m=b.nodeContext.split("/");i=m[2];S.forEach(function(y){c.configEditor.removeCategoryStepAssignment(y,b.nodeAPFId);c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(z,A){if(z.id===y){c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps.forEach(function(l,B){if(l.id===b.nodeAPFId){var D=c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps;D.splice(B,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps=D;}});}});});N=o.slice(0,7);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:f=o[6];h=o[8];j=o[10];var p=this.oModel.getData().aConfigDetails[i].configData[1].categories[f].steps[h].id;var P=this.configEditor.getStep(p);var q=this.configEditor.getCategoriesForStep(p);P.removeRepresentation(b.nodeAPFId);q.forEach(function(y){c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(z,A){if(z.id===y){c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps.forEach(function(l,B){if(l.id===p){c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps[B].representations.forEach(function(D,E){if(D.id===b.nodeAPFId){var R=c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps[B].representations;R.splice(E,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[A].steps[B].representations=R;}});}});}});});N=o.slice(0,9);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var r=false;if(b.nodeAPFId.indexOf("newConfig")===0){r=true;}if(!r){this.configurationHandler.removeConfiguration(b.nodeAPFId,function(y){var t;var u=c.oModel.getData().aConfigDetails;var w=(c.configurationHandler.getList().length>0)?true:false;u.splice(i,1);c.oModel.getData().aConfigDetails=u;c.oModel.updateBindings();if(a){var v={appId:c.appId,configId:c.selectedNode.getBindingContext().getObject().AnalyticalConfiguration};sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,v);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();if(w){t=new sap.m.Label().addStyleClass("noConfigSelected");t.setText(c.oCoreApi.getText("noConfigSelected"));t.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}else{t=new sap.m.Label().addStyleClass("addNewConfig");t.setText(c.oCoreApi.getText("addNewConfig"));t.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}}});}else{var t;var u=c.oModel.getData().aConfigDetails;u.splice(i,1);c.oModel.getData().aConfigDetails=u;c.oModel.updateBindings();if(a){var v={appId:c.appId,configId:c.selectedNode.getBindingContext().getObject().AnalyticalConfiguration};sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,v);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();var w=(this.configurationHandler.getList().length>0)?true:false;if(w){t=new sap.m.Label().addStyleClass("noConfigSelected");t.setText(c.oCoreApi.getText("noConfigSelected"));t.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}else{t=new sap.m.Label().addStyleClass("addNewConfig");t.setText(c.oCoreApi.getText("addNewConfig"));t.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}}}case"default":break;}if(a){this.bNavDeletionMode=true;}if(b.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.configEditor.setIsUnsaved();this.clearTitleAndBreadCrumb();this.byId("idConfigDetailData").removeAllContent();n=a||n;this.oModel.updateBindings();this.selectedNode=this.oTreeInstance.getNodeByContext(n);this.bProgramaticSelection=false;this.oTreeInstance.setSelection(this.selectedNode);if(a){this.selectedNode.getBindingContext().getObject().isSelected=true;this.oModel.updateBindings();}}var x=(this.toolbarController.confirmationDialog===undefined)?false:this.toolbarController.confirmationDialog.isOpen;if(x&&!a){this.toolbarController.confirmationDialog.close();}},handleNavBack:function(){var s;var a=this;if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var c=(a.configurationHandler.getList().length>0)?true:false;var b=false;var d=function(e){if(this.selectedNode){this.selectedNode=null;}this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);sap.ui.core.UIComponent.getRouterFor(this).navTo("applicationList");};if(c){if(!i){n.throwMandatoryPopup(a,{yes:function(){var e=a._navMandatoryResetState(a);var f=a.configurationHandler.getList();if(e.bIsSaved===false&&f.length>0){n.throwLossOfDataPopup(a,{yes:function(g){g();d.call(a);},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);}d.call(a);}});}else{d.call(a);}}});b=true;}var S=(a.bIsSaved===undefined)?true:a.bIsSaved;if(!S&&i){n.throwLossOfDataPopup(a,{yes:function(e){e();d.call(a);},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);}d.call(a);}});b=true;}}if(!b){d.call(a);}},handleSavePress:function(){var s;var a=this;this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode){var b=this.selectedNode.getBindingContext().sPath;var c=b.split("/");var i=c[2];}if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var d=function(){var a=this;a.configEditor.save(function(g,m,h){if(h===undefined){a.oModel.getData().aConfigDetails[i].AnalyticalConfiguration=g;a.oModel.updateBindings();a.oSelectedNodeDetails=a.oTreeInstance.getNodeContext(a.selectedNode);a.oParentNodeDetails=a.oTreeInstance.getParentNodeContext(a.oSelectedNodeDetails);a.navigateToDifferntView(a.oParentNodeDetails,a.oSelectedNodeDetails,true,false);var j=a.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(j,{width:"20em"});}else{var M=a.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(h);a.oCoreApi.putMessage(M);var k=a.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(k,{width:"20em"});}});};var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var e=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var f=false;if(!e){n.throwMandatoryPopup(a,{yes:function(){a._navMandatoryResetState(a);d.call(a);}});f=true;}if(!f){d.call(this);this.toolbarController.closeDialog();}},_handleExportButtonPress:function(){var s;var a=this;if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var b=false;var e=function(){if(!this.exportConfigurationDialog){this.exportConfigurationDialog=sap.ui.xmlfragment("idExportConfigurationFragment","sap.apf.modeler.ui.fragment.exportConfiguration",this);this.getView().addDependent(this.exportConfigurationDialog);this._setExportConfigDialogText();this._addStyleClassForExportDialog();}jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.exportConfigurationDialog);this.exportConfigurationDialog.open();};var d=function(){var c=new sap.m.Label().addStyleClass("noConfigSelected");c.setText(a.oCoreApi.getText("noConfigSelected"));c.placeAt(a.byId("idConfigDetailData"));a.toolbarController.disableCopyDeleteButton();a.disableExportButton();};var o;if(!i){n.throwMandatoryPopup(a,{yes:function(){var c=a._navMandatoryResetState(a);var f=(a.configurationHandler.getList().length>0)?true:false;if(f){if(!c.bIsSaved){o(a);}else{if(a.oParentNodeDetails.configurationId.indexOf("newConfig")!==0){e.call(a);}}}else{d();}}});b=true;}o=function(c){n.throwLossOfDataPopup(c,{yes:function(f){a._navSaveState(function(){f(function(g){if(a.selectedNode){var B=a.selectedNode.getBindingContext().sPath;var C=B.split("/");var h=C[2];}a.oModel.getData().aConfigDetails[h].AnalyticalConfiguration=a.configId;a.oModel.updateBindings();e.call(a);});});},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);a.clearTitleAndBreadCrumb();a.byId("idConfigDetailData").removeAllContent();var f=(a.configurationHandler.getList().length>0)?true:false;var g;if(!f){d();}}else{a._navConfigResetState(a,function(){a._navHandleExpandDelete.call(a,a.oSelectedNodeDetails,r);e.call(a);});}}});};if(!a.bIsSaved&&i){o(a);b=true;}if(!b){e.call(a);}},_enableExportButton:function(){if(!this.byId("idExportbutton").getEnabled()){this.byId("idExportbutton").setEnabled(true);}},disableExportButton:function(){if(this.byId("idExportbutton").getEnabled()){this.byId("idExportbutton").setEnabled(false);}},_setExportConfigDialogText:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idExportConfigDialog").setTitle(this.oCoreApi.getText("exportConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").setText(this.oCoreApi.getText("openConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").setText(this.oCoreApi.getText("openTextProperty"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idCloseButton").setText(this.oCoreApi.getText("close"));},_addStyleClassForExportDialog:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").addStyleClass("configLink");sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").addStyleClass("textPropertyLink");},_handleCloseOfExportDialog:function(){if(this.exportConfigurationDialog.isOpen()){this.exportConfigurationDialog.close();}},_handleOpenConfigLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){s._openFile(c);});},_handleOpenTextsLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){var e=s.configurationHandler.exportTexts();s._openFile(e);});},_openFile:function(f){var e=encodeURIComponent(f);var n;n=window.open("about:blank","","_blank");n.document.write("<textarea rows='50' cols='160'readonly>"+decodeURIComponent(e)+"</textarea>");}});};if(!jQuery.sap.isDeclared('sap.apf.ui.instance')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.instance");sap.apf.ui.Instance=function(i){i.uiApi=this;var c=i.oCoreApi;var C=i.oComponent;var s=i.oSBHandler;var S=i.oStartParameter;var a;var b;var m;var o;var d=c.getUriGenerator().getApfLocation();this.oEventCallbacks={};jQuery.sap.includeStyleSheet(d+"resources/css/apfUi.css","apfCss");jQuery.sap.includeStyleSheet(d+"resources/css/apfPrint.css","printCss");jQuery("#printCss").attr("media","print");this.getAnalysisPath=function(){if(b===undefined){b=sap.ui.view({viewName:"sap.apf.ui.reuse.view.analysisPath",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return b;};this.getNotificationBar=function(){if(m===undefined){m=sap.ui.view({viewName:"sap.apf.ui.reuse.view.messageHandler",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return m;};this.getStepContainer=function(){if(a===undefined){a=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepContainer",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return a;};this.selectionChanged=function(r){if(r){this.getAnalysisPath().getController().refresh(0);}else{var n=c.getSteps().indexOf(c.getActiveStep());this.getAnalysisPath().getController().refresh(n+1);}c.updatePath(this.getAnalysisPath().getController().callBackForUpdatePath.bind(this.getAnalysisPath().getController()));};var e;var f;var g=new sap.m.App().addStyleClass("sapApf");var I=false;this.createApplicationLayout=function(){if(!I){g.addPage(this.getLayoutView());I=true;}return g;};this.getLayoutView=function(){if(e===undefined){e=sap.ui.view({viewName:"sap.apf.ui.reuse.view.layout",type:sap.ui.core.mvc.ViewType.XML,viewData:i});}return e;};this.addDetailFooterContent=function(h){this.getLayoutView().getController().addDetailFooterContentLeft(h);};this.addMasterFooterContentRight=function(h){this.getLayoutView().getController().addMasterFooterContentRight(h);};this.setEventCallback=function(E,h){this.oEventCallbacks[E]=h;};this.getEventCallback=function(E){return this.oEventCallbacks[E];};var F;this.initializeContextHandling=function(s,h){var j={oCoreApi:c,oPathContextHandler:i.oPathContextHandler,oSBHandler:s,oUiApi:this,mode:h};F=new sap.apf.ui.utils.FacetFilterHandler(j);F.initialize();};this.drawFacetFilter=function(h){if(F){F.drawFacetFilter(h);}};this.contextChanged=function(r){if(F){F.contextChanged();}var h=this.getEventCallback(sap.apf.core.constants.eventTypes.contextChanged);if(typeof h==="function"){var j;if(!r){j=c.getContext().serialize();}h(j);}};this.getFormattedFilters=function(p){if(F){return F.getFormattedFilters(p);}};this.handleStartup=function(p){var t=this;var h=jQuery.Deferred();var j=jQuery.Deferred();var s;p.done(function(k){if(k.navigationMode==='backward'){h.done(function(){t.getAnalysisPath().getController().bIsBackNavigation=true;c.updatePath(t.getAnalysisPath().getController().callBackForUpdatePath.bind(t.getAnalysisPath().getController()));j.resolve();});}if(k.navigationMode==='forward'){if(S.getEvaluationId()){var l={getApplicationConfigProperties:c.getApplicationConfigProperties,createReadRequestByRequiredFilter:c.createReadRequestByRequiredFilter,getTextNotHtmlEncoded:c.getTextNotHtmlEncoded,startParameter:S,oMessageHandler:c.getMessageHandler()};s=new sap.apf.utils.SmartBusinessHandler(l);}h.done(function(){if(k.sapApfCumulativeFilter){i.oPathContextHandler.update('ApfInitialContext',sap.apf.utils.Filter.createFilterFromSapUi5FilterJSON(c.getMessageHandler(),k.sapApfCumulativeFilter));}if(c.getStartParameterFacade().getSteps()){var n=c.getStartParameterFacade().getSteps()[0].stepId;var r=c.getStartParameterFacade().getSteps()[0].representationId;var q=t.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(t.getAnalysisPath().getController());c.createFirstStep(n,r,q);}j.resolve();});}t.initializeContextHandling(s,k.navigationMode);t.drawFacetFilter(t.getLayoutView().byId("subHeader"));if(s){s.getAllFilters().then(function(){h.resolve();});}else{h.resolve();}});return j.promise();};};};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.facetFilter.controller');
/*!
* SAP APF Analysis Path Framework
* 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
sap.ui.controller("sap.apf.ui.reuse.controller.facetFilter",{onInit:function(){var s=this;this.oView=this.getView();this.oCoreApi=this.oView.oCoreApi;this.oUiApi=this.oView.oUiApi;this.oPathContextHandler=this.oView.oPathContextHandler;this.aFacetFilterListData=this.oView.aFacetFilterListData;this.aFacetFilterListControls=this.oView.aFacetFilterListControls;this.aFacetFilterListHandlers=this.aFacetFilterListData.map(function(f){return new sap.apf.ui.utils.FacetFilterListHandler(s.oCoreApi,s.oUiApi,s.oPathContextHandler,f);});this.aFacetFilterListDatasets=this.aFacetFilterListData.map(function(){return[];});this.aCachedSelections=this.aFacetFilterListData.map(function(){return[];});this.aSizeLimitForLists=this.aFacetFilterListData.map(function(){return 100;});this._setInitialBinding();this._populateValueHelpData();this._updateSelectedFilters();},_setInitialBinding:function(){var s=this;this.aFacetFilterListControls.forEach(function(f,i){f.bindItems("/",new sap.m.FacetFilterItem({key:'{key}',text:'{text}',selected:'{selected}'}));var m=new sap.ui.model.json.JSONModel(s.aFacetFilterListDatasets[i]);f.setModel(m);});},_populateValueHelpData:function(){var s=this;this.aFacetFilterListHandlers.forEach(function(f,i){f.fetchValueHelpData().then(s._populateValueHelpDataFor(i));});},_updateSelectedFilters:function(){var s=this;this.aFacetFilterListHandlers.forEach(function(f,i){f.fetchSelectedFilterData().then(s._updateSelectedFilterFor(i));});},_populateValueHelpDataFor:function(i){var f=this.aFacetFilterListControls[i];var F=this.aFacetFilterListData[i];var a=this.aFacetFilterListDatasets[i];var o=f.getModel();var n=this.aSizeLimitForLists[i];return function(d){d.forEach(function(D){var s=false;var b=-1;a.forEach(function(c,i){if(c.key===D.key){b=i;return;}});if(b!==-1){s=a[b].selected;a.splice(b,1);}a.push({key:D.key,text:D.text,selected:s});});if(n<d.length){n=d.length;o.setSizeLimit(n);}o.updateBindings();};},_updateSelectedFilterFor:function(i){var f=this.aFacetFilterListControls[i];var F=this.aFacetFilterListData[i];var a=this.aFacetFilterListDatasets[i];var o=f.getModel();var c=this.aCachedSelections[i];var n=this.aSizeLimitForLists[i];return function(d,e){if(e){var b=f.getParent();b.removeList(i);return;}a.forEach(function(D){D.selected=false;});c.splice(0,c.length);d.forEach(function(D){var m=a.filter(function(g){return g.key===D.key;});m.forEach(function(g){g.selected=true;});if(!m.length){a.push({key:D.key,text:D.text,selected:true});}c.push(D.key);});if(n<d.length){n=d.length;o.setSizeLimit(n);}o.updateBindings();};},onListClose:function(e){var c=e.getSource();var n=this.aFacetFilterListControls.indexOf(c);var p=this.aFacetFilterListData[n].property;var i=e.getParameter('allSelected');var s=[];if(i){var I=c.getBinding("items");var a=I.getModel().getData();s=a.map(function(D){return D.key;});}else{var S=e.getParameter('selectedItems');s=S.map(function(g){return g.getKey();});}var C=this.aCachedSelections[n];if(s.length===C.length){var b=JSON.stringify(s.sort());var d=JSON.stringify(C.sort());var f=(b===d);if(f){return;}}this.aCachedSelections[n]=s;var F=this.oCoreApi.createFilter();var o=F.getTopAnd().addOr();s.forEach(function(v){o.addExpression({name:p,operator:"EQ",value:v});});this.oPathContextHandler.update(p,F);this.oUiApi.selectionChanged(true);},onResetPress:function(){var f=this.aFacetFilterListData.map(function(F){return F.property;});this.oPathContextHandler.restoreInitialContext(f);this.onContextChanged();this.oUiApi.selectionChanged(true);},onContextChanged:function(){this._updateSelectedFilters();},getFormattedFilters:function(p){var a=this.aFacetFilterListData.map(function(F){return F.property;});var n=a.indexOf(p);if(n===-1){return null;}var f=this.aFacetFilterListControls[n];var r=f.getSelectedItems().map(function(i){return{name:f.getTitle(),operator:"EQ",value:i.getText(),formatted:true};});return r;}});};if(!jQuery.sap.isDeclared('sap.apf.utils.filter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.utils.filter');sap.apf.utils.Filter=function(m,s){if(s){return c(m,s);}var t;var a=this;var b=function(){t=new sap.apf.utils.FilterAnd(m,sap.apf.utils.Filter.topAndId);};this.getById=function(i){if(t){if(i===sap.apf.utils.Filter.topAndId){return t;}return t.getById(i);}return undefined;};this.type="filter";this.getExpressions=function(){if(t){return t.getExpressions();}return[];};this.getInternalFilter=function(){return t.getInternalFilter();};this.getTopAnd=function(){return t;};this.updateExpression=function(i,e){m.check(i===e.id,"sId differs from oExpression.id");var E=this.getById(i);E.update(e);};this.updateValue=function(i,v,h){m.check(i!==undefined,"Filter updateValue: parameter id required");m.check(v!==undefined,"Filter updateValue: parameter value is required");var e=this.getById(i);m.check(e!==undefined,"Filter updateValue: id for expression not valid");e.updateValue(v,h);};this.serialize=function(){function d(C,T){var S={id:T.getId(),type:T.type,expressions:[],terms:[]};C.forEach(function(e,i){if(e instanceof Array){if(T.type==="filterAnd"){S.terms.push(d(e,T.getAndTerms()[i]));}else if(T.type==="filterOr"){S.terms.push(d(e,T.getOrTerms()[i]));}}else{S.expressions.push(e);}});return S;}return d(this.getTopAnd().getExpression(),this.getTopAnd());};this.deserialize=function(S){t=undefined;b();function d(S,T){if(S.type==="filterAnd"&&S.id!==sap.apf.utils.Filter.topAndId){T=T.addAnd(S.id);}else if(S.type==="filterOr"&&S.id!==sap.apf.utils.Filter.topAndId){T=T.addOr(S.id);}S.expressions.forEach(function(e){T.addExpression(e);});S.terms.forEach(function(e){d(e,T);});}d(S,this.getTopAnd());return this;};this.addAnd=function(i){jQuery.sap.log.error("Method 'addAnd' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.intersectWith=function(d){var i=0;var f=[];var F;var r=new sap.apf.utils.Filter(m);var R=a.serialize();e(R);switch(arguments.length){case 1:F=arguments[0];if(F instanceof Array){f=F;}else{f.push(F);}break;default:f=Array.prototype.slice.call(arguments,0);}f.forEach(function(o){m.check((o instanceof sap.apf.utils.Filter),"Parameter value is not of type sap.apf.utils.Filter");var I=o.serialize();e(I);Array.prototype.push.apply(R.expressions,I.expressions);Array.prototype.push.apply(R.terms,I.terms);});r.deserialize(R);return r;function e(S){if(S.id!==sap.apf.utils.Filter.topAndId){S.id='#'+i++ +'#';}S.terms.forEach(e);}};b();return this;function c(m,s){if(!s.operator||s.operator!==sap.apf.core.constants.BooleFilterOperators.AND||!s.terms||!s.terms instanceof Array){m.check(false,"sap.apf.utils.Filter - createFromSelectionVariant - wrong structure of selection variant");}var r=new sap.apf.utils.Filter(m),f;s.terms.forEach(function(T){if(!T.property||!T.operator||T.operator!==sap.apf.core.constants.BooleFilterOperators.OR||!T.expressions||!T.terms instanceof Array){m.check(false,"sap.apf.utilsFilter - createFromSelectionVariant - wrong structure of selection variant");}f=r.getTopAnd().addOr();T.expressions.forEach(function(e){if(!e.option||!e.low){m.check(false,"sap.apf.utils.Filter - createFromSelectionVariant - wrong structure of selection variant");}f.addExpression({name:T.property,operator:e.option,value:e.low,high:e.high});});});return r;}};function g(p,f){var r=[];var i,l;if(f.filters){f.filters.forEach(function(a){r=r.concat(g(p,a));});return r;}else if(f.path){if(f.path===p){return[f];}else{return[];}}}sap.apf.utils.Filter.createFilterFromSapUi5FilterJSON=function(m,s){var r=new sap.apf.utils.Filter(m);function a(f,l,b){var c;l++;if(b.filters){if(b.and){if(l!==1){c=f.addAnd();}else{c=f;}}else{c=f.addOr();}b.filters.forEach(function(e){a(c,l,e);});}else{if(b.operator){f.addExpression({name:b.path,operator:b.operator,value:b.value1,high:b.value2});}}}a(r.getTopAnd(),0,s);return r;};sap.apf.utils.Filter.getOperators=function(){return sap.apf.core.constants.FilterOperators;};sap.apf.utils.Filter.prototype.getOperators=sap.apf.utils.Filter.getOperators;sap.apf.utils.Filter.topAndId='filterTopAnd';sap.apf.utils.FilterAnd=function(m,I){var a=I;var A=[];var t=this;this.type="filterAnd";this.getById=function(I){if(I===a){return this;}var T;var i;for(i=0;i<A.length;i++){T=A[i].getById(I);if(T!==undefined){return T;}}return undefined;};this.getExpressions=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}if(T instanceof Array){e.push(T);}else{e.push([T]);}}return e;};this.getExpression=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}e.push(T);}return e;};this.getCompoundExpressions=function(){jQuery.sap.log.error("Method 'getExpressions' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);var l=A.length;var i;for(i=0;i<l;i++){f.addAnd(A[i].getInternalFilter());}return f;};this.addAndTerm=function(T){jQuery.sap.log.error("Method 'addAndTerm' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getAndTerms=function(){return A;};this.addOr=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var o=new sap.apf.utils.FilterOr(m,I,t);A.push(o);return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");A.push(new sap.apf.utils.FilterExpression(m,e));return this;};};sap.apf.utils.FilterOr=function(m,I,a){var b=I;var o=[];var A=a;this.type="filterOr";this.getById=function(I){if(I===b){return this;}var t;for(var i=0;i<o.length;i++){t=o[i].getById(I);if(t!==undefined){return t;}}return undefined;};this.getExpression=function(){var e=[];var t;for(var i=0;i<o.length;i++){t=o[i].getExpression();if(t instanceof Array&&t.length===0){continue;}e.push(t);}return e;};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);for(var i=0;i<o.length;i++){f.addOr(o[i].getInternalFilter());}return f;};this.getAndObject=function(){return A;};this.addOrTerm=function(t){jQuery.sap.log.error("Method 'addOr' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getOrTerms=function(){return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getAndObject().getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");o.push(new sap.apf.utils.FilterExpression(m,e));return this;};this.addAnd=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var c=new sap.apf.utils.FilterAnd(m,I);o.push(c);return c;};};sap.apf.utils.FilterExpression=function(m,e){c(e.high,e.operator);var i=e.id;var n=e.name;var o=e.operator;var v=e.value;var h=e.high;this.getById=function(a){if(i===a){return this;}return undefined;};this.getExpression=function(){if(!o||o!==sap.apf.core.constants.FilterOperators.BT){return{name:n,operator:o,value:v};}return{name:n,operator:o,value:v,high:h};};this.getInternalFilter=function(){return new sap.apf.core.utils.Filter(m,n,o,v,h);};this.update=function(e){c(e.high,e.operator);n=e.name;o=e.operator;v=e.value;h=e.high;};this.updateValue=function(a,b){v=a;if(b!==undefined){h=b;}c(h,o);};function c(a,b){if(!b){return;}if(b===sap.apf.core.constants.FilterOperators.BT&&(a===null||a===undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value needed for 'between' selection");}else if(b!==sap.apf.core.constants.FilterOperators.BT&&(a!==null&&a!==undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value only needed for 'between' selection");}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.binding')){jQuery.sap.declare("sap.apf.core.binding");sap.apf.core.Binding=function(I,b,f){var t=this;this.type="binding";var n=0;var r=[];var R=[];var c=[];var C;var s;this.oTitle=b.oTitle;this.oLongTitle=b.oLongTitle;var a=b.requiredFilters;this.getFilter=function(){var S=this.getSelectedRepresentation();var m=sap.apf.core.constants.filterMethodTypes;var i=[];if(S.getFilterMethodType()===m.filter){var F=S.getFilter().getInternalFilter();if(s){return s.getInternalFilter().overwriteWith(F);}else{return F;}}if(S.getSelectionAsArray){i=S.getSelectionAsArray();}else{return new sap.apf.core.utils.Filter(I.messageHandler);}if(i===undefined){return sap.apf.core.utils.Filter.createEmptyFilter(I.messageHandler,a);}if(i.length===c.length||i.length===0){return new sap.apf.core.utils.Filter(I.messageHandler);}return sap.apf.core.utils.Filter.createFromArray(I.messageHandler,a,c,i);};this.getRequestOptions=function(){if(jQuery.isFunction(this.getSelectedRepresentation().getRequestOptions)){return this.getSelectedRepresentation().getRequestOptions();}return{};};function d(o){return o.getFilterMethodType()===sap.apf.core.constants.filterMethodTypes.startFilter;}this.setFilter=function(F){var o=this.getSelectedRepresentation();s=F;if(d(o)){o.setFilter(s);}};this.setData=function(D){I.messageHandler.check(D!==undefined,"aDataResponse is undefined (binding function setData)");c=D.data;C=D.metadata;this.getSelectedRepresentation().setData(D.data,D.metadata);};this.getRepresentationInfo=function(){var h=jQuery.extend(true,[],R);for(var i=0;i<h.length;i++){delete h[i].id;delete h[i].type;delete h[i].constructor;}return h;};this.getSelectedRepresentationInfo=function(){I.messageHandler.check(0<=n&&n<R.length,"index in array boundaries");var o=jQuery.extend(true,{},R[n]);delete o.id;delete o.type;delete o.constructor;return o;};this.getSelectedRepresentation=function(){I.messageHandler.check(0<=n&&n<r.length,"selectedRepresentation in array boundaries");return r[n];};this.setSelectedRepresentation=function(h){I.messageHandler.check(typeof h==="string","setSelectedRepresentation() - sRepresentationId missing");var t=this;var o=this.getSelectedRepresentation();var S=j(h,b.representations);var N=k(S);n=S.index;if(c!==undefined&&C!==undefined){N.setData(c,C);}if(N.adoptSelection){N.adoptSelection(o);}function j(h,l){for(var i=0;i<l.length;i++){if(h===l[i].id){return{config:l[i],constructor:f.getConfigurationById(l[i].representationTypeId).constructor,index:i};}}I.messageHandler.check(false,"Representation config not found");}function k(i){var l;if(r[i.index]===undefined){if(i.config.parameter&&i.config.parameter.alternateRepresentationTypeId){i.config.parameter.alternateRepresentationType=f.getConfigurationById(i.config.parameter.alternateRepresentationTypeId);}i.config.parameter.requiredFilters=b.requiredFilters;l=t.convertSortToOrderBy(i.config.parameter);r[i.index]=I.coreApi.createRepresentation(i.constructor,l);return r[i.index];}else{return r[i.index];}}};this.serialize=function(){return{selectedRepresentation:t.getSelectedRepresentation().serialize(),selectedRepresentationId:t.getSelectedRepresentationInfo().representationId};};this.deserialize=function(S){t.setSelectedRepresentation(S.selectedRepresentationId);t.getSelectedRepresentation().deserialize(S.selectedRepresentation);return t;};this.convertSortToOrderBy=function(p){var h;if(p.sort&&!p.orderby){h=jQuery.extend(true,{},p);if(p.alternateRepresentationType){h.alternateRepresentationType=p.alternateRepresentationType;}h.orderby=[{property:p.sort.sortField,ascending:!p.sort.descending}];delete h.sort;return h;}h=p;return h;};r[0]=undefined;for(var e in b.representations){var g=b.representations[e].representationTypeId;R[e]=jQuery.extend(true,{},f.getConfigurationById(g));R[e].representationId=b.representations[e].id;R[e].representationLabel=b.representations[e].label;R[e].thumbnail=b.representations[e].thumbnail;R[e].parameter=jQuery.extend(true,{},b.representations[e].parameter);}if(R.length>0){this.setSelectedRepresentation(R[0].representationId);}};};if(!jQuery.sap.isDeclared('sap.apf.core.request')){jQuery.sap.declare("sap.apf.core.request");jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.Request=function(I,c){var m=I.messageHandler;var C=I.coreApi;var s=c.service;var a=c.selectProperties;var u=C.getUriGenerator();var M;if(s===undefined){M=m.createMessageObject({code:"5015",aParameters:[c.id]});m.putMessage(M);}var o=C.getMetadata(s);var e=o.patchEntitySetName(c.entityType);m.check(e!==undefined,"Invalid request configuration entityset does not exist under the service"+c.entityType);this.type=c.type;this.sendGetInBatch=function(F,g,R){var p=r(F);var h;d(F);if(F&&F.getProperties){h=F.reduceToProperty(o.getFilterableProperties(e));}b(R);var P=R&&R.paging;var S=R&&R.orderby;var U=o.getUriSuffix(e);var i=u.buildUri(m,e,a,h,p,S,P,undefined,f,U);var j={method:'POST',headers:{"x-csrf-token":C.getXsrfToken(s)},requestUri:u.getAbsolutePath(s)+'$batch',data:{__batchRequests:[{requestUri:i,method:'GET',headers:{"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":C.getXsrfToken(s)}}]}};var k=function(l,n){var q={};var t="";if(l&&l.__batchResponses&&l.__batchResponses[0].data){q.data=l.__batchResponses[0].data.results;q.metadata=C.getEntityTypeMetadata(c.service,c.entityType);if(l.__batchResponses[0].data.__count){q.count=parseInt(l.__batchResponses[0].data.__count,10);}}else if(l&&l.__batchResponses[0]&&l.__batchResponses[0].response&&l.__batchResponses[0].message){t=n.requestUri;var v=l.__batchResponses[0].message;var w=l.__batchResponses[0].response.body;var H=l.__batchResponses[0].response.statusCode;q=m.createMessageObject({code:"5001",aParameters:[H,v,w,t]});}else{t=n.requestUri||i;q=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",t]});}g(q,false);};var E=function(l){var n="unknown error";var q="unknown error";var t=i;if(l.message!==undefined){n=l.message;}var H="unknown";if(l.response&&l.response.statusCode){H=l.response.statusCode;q=l.response.statusText||"";t=l.response.requestUri||i;}if(l.messageObject&&l.messageObject.type==="messageObject"){g(l.messageObject);}else{g(m.createMessageObject({code:"5001",aParameters:[H,n,q,t]}));}};C.odataRequest(j,k,E,OData.batchHandler);};function f(p,v){var g="'";var E=o.getPropertyMetadata(e,p);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}else{if(typeof v==='number'){return v;}else{return g+sap.apf.utils.escapeOdata(v)+g;}}}function b(R){var p,i;if(!R){return;}p=Object.getOwnPropertyNames(R);for(i=0;i<p.length;i++){if(p[i]!=='orderby'&&p[i]!=='paging'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,p[i]]}));}}}function d(F){var g=o.getFilterableProperties(e);var R="";var E=o.getEntityTypeMetadata(e);var h;if(E.requiresFilter!==undefined&&E.requiresFilter==="true"){if(E.requiredProperties!==undefined){R=E.requiredProperties;}}if(R===""){return;}if(jQuery.inArray(R,g)===-1){h=m.createMessageObject({code:"5006",aParameters:[e,R]});m.putMessage(h);}var p=F.getProperties();if(jQuery.inArray(R,p)===-1){h=m.createMessageObject({code:"5005",aParameters:[e,R]});m.putMessage(h);}}function r(F){var p={};var P;var n;var t,i,g;function h(j,v){if(P[j].dataType.type==='Edm.String'){p[P[j].name]=(jQuery.sap.encodeURL("'"+sap.apf.utils.escapeOdata(v)+"'"));}else if(P[j].dataType.type){p[P[j].name]=sap.apf.utils.formatValue(v,P[j].dataType.type);}else{if(typeof v==="string"){p[P[j].name]=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(v));}else{p[P[j].name]=v;}}}P=o.getParameterEntitySetKeyProperties(e);if(P!==undefined){n=P.length;}else{n=0;}if(n>0){for(i=0;i<n;i++){if(F&&F instanceof sap.apf.core.utils.Filter){t=F.getFilterTermsForProperty(P[i].name);g=t[t.length-1];}if(g instanceof sap.apf.core.utils.FilterTerm){h(i,g.getValue());}else if(P[i].defaultValue){h(i,P[i].defaultValue);}else{m.putMessage(m.createMessageObject({code:"5016",aParameters:[P[i].name]}));}}}return p;}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.resourcePathHandler')){(function(){'use strict';jQuery.sap.declare("sap.apf.core.resourcePathHandler");sap.apf.core.ResourcePathHandler=function(i){var t=this;var c=i.coreApi;var m=i.messageHandler;var h=new sap.apf.utils.Hashtable(m);var C;var p;var s=null;var a;var A="";var b=false;var I=false;n();this.getApplicationConfigurationURL=function(){return A;};this.loadConfigFromFilePath=function(F){if(b){return;}if(c.getStartParameterFacade().getAnalyticalConfigurationId()){I=true;}var u=F;A=F;jQuery.ajax({url:u,dataType:"json",success:o,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingRessource,rawText:"Error "+E+" when loading the configuration of the resource location: "+u});m.putMessage(M);},async:false});f();if(I){l();}else{e();}b=true;function o(D,S,J){var M=sap.apf.core.utils.checkForTimeout(J);if(M){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"Timeout when loading application configuration from "+F+"."}));}if(!D||!D.applicationConfiguration){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The application configuration from "+F+" has no valid format."}));return;}if(D.applicationConfiguration.textResourceLocations===undefined){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The textResourceLocations is missing in the application configuration from "+F+"."}));return;}var r=D.applicationConfiguration;q(r);var T=D.applicationConfiguration.textResourceLocations;p=D.applicationConfiguration.persistence;j(p);if(!p.path.entitySet){p.path.entitySet=sap.apf.core.constants.entitySets.analysisPath;}if(D.applicationConfiguration.smartBusiness){s=D.applicationConfiguration.smartBusiness;k(s);}if(p.analyticalConfiguration){a=p.analyticalConfiguration;}var v;var u;var P;for(P in sap.apf.core.constants.resourceLocation){if(!sap.apf.core.constants.resourceLocation.hasOwnProperty(P)){continue;}if(r[P]!==undefined){u=r[P];}else{if(T[P]!==undefined){u=T[P];}else{continue;}}if(sap.apf.core.utils.fileExists(u)){h.setItem(P,u);}else{if(!I){v=m.createMessageObject({code:sap.apf.core.constants.message.code.wrongRessourcePath,rawText:"The path "+u+" for resource location "+P+"is not valid."});m.putMessage(v);}}}}function q(r){C=jQuery.extend(true,{},r);delete C.type;delete C.analyticalConfigurationLocation;delete C.applicationMessageDefinitionLocation;delete C.textResourceLocations;delete C.persistence;}};function l(){var o=new sap.apf.core.OdataProxy({serviceRoot:p.path.service,entityTypes:{configuration:sap.apf.core.constants.entitySets.configuration,texts:sap.apf.core.constants.entitySets.texts}},{instance:{coreApi:c,messageHandler:m}});o.readEntity("configuration",function(r,q,u){if(u){m.putMessage(m.createMessageObject({code:"5022",aParameters:[c.getStartParameterFacade().getAnalyticalConfigurationId()]}));}else{var v=JSON.parse(r.SerializedAnalyticalConfiguration);c.loadAnalyticalConfiguration(JSON.parse(r.SerializedAnalyticalConfiguration));d(r.Application,o);if(v.applicationTitle){C.appName=v.applicationTitle.key;C.appTitle=v.applicationTitle.key;}}},[{name:"AnalyticalConfiguration",value:c.getStartParameterFacade().getAnalyticalConfigurationId()}],undefined,false);}function d(o,q){var r=new sap.apf.core.utils.Filter(m,'Application','eq',o);var u=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);u.addAnd(r);var v=["TextElement","TextElementDescription"];q.readCollection('texts',function(w,x,y){if(y){m.putMessage(m.createMessageObject({code:"5023",aParameters:[sap.apf.utils.uriParameter.getConfigurationId()]}));}else{c.loadTextElements(w);}},undefined,v,u,false);}function e(){var u=t.getResourceLocation(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation);var M;if(u!==""){jQuery.ajax({url:u,dataType:"json",success:function(D,S,J){if(D){c.loadAnalyticalConfiguration(D);if(D.applicationTitle){C.appName=D.applicationTitle.key;C.appTitle=D.applicationTitle.key;}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"No data received when loading analytical configuration file"+u});m.putMessage(M);}},error:function(J,S,E){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading analytical configuration file"+u});m.putMessage(M);},async:false});}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.missingAnalyticalConfig,rawText:"No analytical configuration defined in the application configuration"});m.putMessage(M);}}function f(){c.loadMessageConfiguration(sap.apf.core.messageDefinition,true);g(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,false);}function g(r,R){var u=t.getResourceLocation(r);if(u!==""){jQuery.ajax({url:u,dataType:"json",success:o,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading message configuration file"+u});m.putMessage(M);},async:false});}function o(D,S,J){var M;var q=sap.apf.core.utils.checkForTimeout(J);if(!q){if(D.messageConfiguration){c.loadMessageConfiguration(D.messageConfiguration.definitions,R);}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Timeout error when loading message configuration file"+u});m.putMessage(M);}}}function j(o){var M;if(!o||!o.path){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"persistence path configuration is missing in the application configuration"});m.putMessage(M);}if(!o.path.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in persistence path configuration is missing"});m.putMessage(M);}if(!o.logicalSystem){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"logical system configuration is missing in the application configuration"});m.putMessage(M);}if(!o.logicalSystem.service&&o.logicalSystem.service!==null){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service is missing in logical system configuration  in the application configuration"});m.putMessage(M);}if(o.analyticalConfiguration){if(!o.analyticalConfiguration.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service or entity set are missing in analytical configuration in the application configuration"});m.putMessage(M);}}}function k(o){var M;if(o.evaluations&&!o.evaluations.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in Smart Business service root configuration is missing"});m.putMessage(M);}if(o.evaluations&&(!o.evaluations.type||o.evaluations.type!=="smartBusinessRequest")){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"type in Smart Business configuration is not smartBusinessRequest"});m.putMessage(M);}if(o.evaluations&&!o.evaluations.entityType){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"entityType in Smart Business service root configuration is missing"});m.putMessage(M);}}this.getResourceLocation=function(r){return h.getItem(r);};this.getPersistenceConfiguration=function(){m.check(b,"RessourcePathHandler: configuration must be loaded before access to ressources");return p;};this.getConfigurationProperties=function(){return C;};function n(){var o=c.getUriGenerator().getApfLocation();h.setItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle,o+"resources/i18n/apfUi.properties");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation,"");}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.sessionHandler')){jQuery.sap.declare("sap.apf.core.sessionHandler");sap.apf.core.SessionHandler=function(i){var t=this;var x="";var s="";var h=new sap.apf.utils.Hashtable(i.messageHandler);var n=0;var l="";var c=i.coreApi;var m=i.messageHandler;var C=new sap.apf.utils.Filter(m);var S="";this.type="sessionHandler";this.ajax=function(d){sap.apf.core.ajax(d);};this.odata=function(r,O,e){c.odataRequest(r,O,e);};this.getXsrfToken=function(d){s=d;if(h.hasItem(s)){return h.getItem(s);}else{t.fetchXcsrfToken();h.setItem(s,x);return x;}};this.getLogicalSystem=function(){return l;};this.setContext=function(f){C=f;var T=C.getInternalFilter().getFilterTermsForProperty('SAPClient');if(T&&T.length===1){b();}c.updatePath(function(){},true);};this.getContext=function(){return C;};this.fetchXcsrfToken=function(){t.ajax({url:c.getUriGenerator().getAbsolutePath(s),type:"GET",beforeSend:function(d){d.setRequestHeader("x-csrf-token","Fetch");},success:a,error:o,async:false});n=n+1;};var o=function(j,d,e){if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}else{m.check(false,"No XSRF Token available!",5101);}};var a=function(d,e,X){x=X.getResponseHeader("x-csrf-token");if(x===null){x="";}else if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}};var g=function(){var T=C.getInternalFilter().getFilterTermsForProperty('SAPClient');if(T===undefined||T.length!==1){m.putMessage(m.createMessageObject({code:"5025"}));}return T[0].getValue();};var b=function(){var d=c.getPersistenceConfiguration().logicalSystem.service;var e=c.getPersistenceConfiguration().logicalSystem.entityType;var f=g();if(d===null){l=f;return;}if(e===undefined){e=sap.apf.core.constants.entitySets.logicalSystem;}if(S===f){return;}S=f;var F=new sap.apf.core.utils.Filter(m,"SAPClient",'eq',S);var u=c.getUriGenerator().getAbsolutePath(d);u=u+c.getUriGenerator().buildUri(m,e,['LogicalSystem'],F,undefined,undefined,undefined,undefined,undefined,'Results');var r={requestUri:u,method:"GET",headers:{"x-csrf-token":x},async:false};var O=function(D){if(D&&D.results&&D.results instanceof Array&&D.results.length===1&&D.results[0].LogicalSystem){l=D.results[0].LogicalSystem;}else{m.putMessage(m.createMessageObject({code:"5026",aParameters:[S]}));}};var E=function(j){var M=m.createMessageObject({code:"5026",aParameters:[S]});if(j.messageObject!==undefined&&j.messageObject.type==="messageObject"){M.setPrevious(j.messageObject);}m.putMessage(M);};t.odata(r,O,E);};};};if(!jQuery.sap.isDeclared('sap.apf.core.step')){jQuery.sap.declare("sap.apf.core.step");(function(){'use strict';sap.apf.core.Step=function(m,s,f){m.check(s!==undefined,"Step: step configuration is missing");m.check(s.binding!==undefined,"No binding assigned to step "+s.id+" in analytical configuration",sap.apf.core.constants.message.code.errorCheckConfiguration);var b,r,c,C;var a=jQuery.extend(true,{},s);delete a.id;delete a.picture;delete a.hoverPicture;delete a.title;delete a.longTitle;delete a.type;delete a.thumbnail;delete a.categories;this.type=s.type;this.title=jQuery.extend(true,{},s.title);this.longTitle=undefined;if(s.longTitle){this.longTitle=jQuery.extend(true,{},s.longTitle);}this.thumbnail=jQuery.extend(true,{},s.thumbnail);this.categories=s.categories;this.getAdditionalConfigurationProperties=function(){return a;};this.update=function(F,h){var o=b.getRequestOptions();var i=!F.isEqual(c);var R=!e(C,o);if(r&&(i||R)){r.sendGetInBatch(F,h,o);}else{h({},true);}};this.determineFilter=function(o,h){if(g()&&this.getFilter().toUrlParam()){var k=function(l){var D=[];var t;var F;if(l&&l.type&&l.type==="messageObject"){m.putMessage(l);}else{D=l.data;t=s.filterMapping.target;F=new sap.apf.core.utils.Filter(m);for(var i=0;i<D.length;i++){var n=new sap.apf.core.utils.Filter(m);for(var j=0;j<t.length;j++){n.addAnd(new sap.apf.core.utils.Filter(m,t[j],sap.apf.core.constants.FilterOperators.EQ,D[i][t[j]]));}F.addOr(n);}if(s.filterMapping.keepSource==='true'){F=this.getFilter().addAnd(F);}h(F);}};var R=f.getConfigurationById(s.filterMapping.requestForMappedFilter);R.selectProperties=s.filterMapping.target;var M=o.addAnd(this.getFilter());f.createRequest(R).sendGetInBatch(M,k.bind(this));}else{h(this.getFilter());}};this.setFilter=function(F){return b.setFilter(F);};this.getFilter=function(){return b.getFilter();};this.setData=function(D,F){c=F.copy();C=jQuery.extend({},b.getRequestOptions());b.setData(D);};this.getRepresentationInfo=function(){return b.getRepresentationInfo();};this.getSelectedRepresentationInfo=function(){return b.getSelectedRepresentationInfo();};this.getSelectedRepresentation=function(){return b.getSelectedRepresentation();};this.setSelectedRepresentation=function(R){b.setSelectedRepresentation(R);};this.serialize=function(){return{stepId:s.id,binding:b.serialize()};};this.deserialize=function(S){b.deserialize(S.binding);m.check(s.id,S.stepId,"sap.apf.core.step.deserialize inconsistent serialization data - id "+S.stepId);return this;};d();function d(){b=f.createBinding(s.binding);delete a.binding;if(s.request!==undefined&&s.request!==""){r=f.createRequest(s.request);delete a.request;}}function e(o,O){var n=0;var h=0;var p;for(p in o){n++;}for(p in O){h++;}if(n!==h){return false;}for(p in o){if(!o.hasOwnProperty(p)){continue;}if(typeof o[p]==='object'){if(!e(o[p],O[p])){return false;}}else{if(o[p]!==O[p]){return false;}}}return true;}function g(){if(s.filterMapping){if(s.filterMapping.requestForMappedFilter&&s.filterMapping.target instanceof Array&&s.filterMapping.keepSource){return true;}else{m.putMessage(m.createMessageObject({code:"5104"}));return false;}}else{return false;}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.configurationFactory')){(function(){'use strict';jQuery.sap.declare("sap.apf.core.configurationFactory");sap.apf.core.ConfigurationFactory=function(i){var t=this;var a=new sap.apf.utils.Hashtable(i.messageHandler);var s=function(I){i.messageHandler.check(I!==undefined&&I.hasOwnProperty("id")!==false,"oItem is undefined or property 'id' is missing",sap.apf.core.constants.message.code.errorCheckConfiguration);if(!a){a=new sap.apf.utils.Hashtable(i.messageHandler);}var v=a.setItem(I.id,I);i.messageHandler.check((v===undefined),"Configuration includes duplicated identifiers (IDs)",sap.apf.core.constants.message.code.errorCheckConfigurationWarning);};var g=function(v){var R=[];if(a.getNumberOfItems()!==0){a.each(function(w,x){if(x.type===v){R.push(x);}});return R;}i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5020"}));return R;};function l(v){if(v.type===undefined){v.type="step";}s(v);}function b(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aSteps is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){l(w);});}function c(R){if(R.type===undefined){R.type="request";}if(R.entitySet){R.entityType=R.entitySet;delete R.entitySet;}s(R);}function d(v){if(v.type===undefined){v.type="navigationTarget";}s(v);}function e(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRequests is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){c(v);});}function f(B){function v(){var w=new sap.apf.utils.Hashtable(i.messageHandler);B.representations.forEach(function(x){if(!(x.id&&typeof x.id==="string")){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5028",aParameters:[B.id]}));}if(w.setItem(x.id,x.id)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5029",aParameters:[B.id]}));}});}if(B.type===undefined){B.type="binding";}i.messageHandler.check(B.id!==undefined,"binding has no id");i.messageHandler.check(B.representations!==undefined&&B.representations instanceof Array!==false,"representations for binding "+B.id+" not defined",sap.apf.core.constants.message.code.errorCheckConfiguration);v();s(B);}function h(B){i.messageHandler.check(B!==undefined&&B instanceof Array!==false,"aBindings is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);B.forEach(function(v){f(v);});}function j(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"navigationTarget is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){d(w);});}function k(v){if(v.type===undefined){v.type="category";}s(v);}function m(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aCategories is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){var x=w.steps;i.messageHandler.check(x!==undefined&&x instanceof Array!==false,"steps for category "+w.id+" are missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);x.forEach(function(y){i.messageHandler.check(y.type&&y.type==="step"&&y.id,"step with wrong format assigned to category '"+w.id+"'");i.messageHandler.check(t.existsConfiguration(y.id),"step with id '"+y.id+"' which is assigned to category '"+w.id+"' does not exist");});k(w);});}function n(v){var w=false;var R=sap.apf.core.representationTypes();R.forEach(function(x){if(v===x.id){w=true;}});return w;}function o(R){var v;if(R.type===undefined){R.type="representationType";}if(!n(R.id)){v=sap.apf.utils.extractFunctionFromModulePathString(R.constructor);if(!jQuery.isFunction(v)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5030',parameters:[R.id]}));}}s(R);}function p(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRepresentationInfo is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){o(v);});}function q(F){if(F.type===undefined){F.type="facetFilter";}t.addObject(F);}function r(F){i.messageHandler.check(F!==undefined&&F instanceof Array!==false,"Facet filter configuration is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);F.forEach(function(v){q.call(t,v);});}var u=function(R){p(R);};function S(v,F){function w(v,z){var A=z.getConfigurationById(v.binding).representations;if(A){return A;}i.messageHandler.check(false,'Binding of step with ID "'+v.id+'" does not contain any representations.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}function x(v,z){var A;var B=[];if(v.binding){A=w(v,z);A.forEach(function(D){var E=jQuery.extend(true,{},z.getConfigurationById(D.representationTypeId));E.representationId=D.id;E.representationLabel=D.label;E.parameter=jQuery.extend(true,{},D.parameter);B.push(E);});return B;}i.messageHandler.check(false,'Step with ID "'+v.id+'" does not contain any binding references.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}var y=jQuery.extend(true,{},v);var R=x(v,F);delete y.request;delete y.binding;delete y.thumbnail;delete y.longTitle;y.type="stepTemplate";y.getRepresentationInfo=function(){var z=jQuery.extend(true,[],R);z.forEach(function(A){delete A.id;delete A.type;delete A.constructor;});return z;};return y;}var C=function(v,w){var t=this;this.type=v.type;this.id=v.id;this.label=v.label;this.stepTemplates=[];v.steps.forEach(function(x){var y=w.getConfigurationById(x.id);t.stepTemplates.push(new S(y,w));});return this;};var T=function(v,F){this.type="thumbnail";if(v===undefined){return this;}this.leftUpper=F.createLabel(v.leftUpper);this.rightUpper=F.createLabel(v.rightUpper);this.leftLower=F.createLabel(v.leftLower);this.rightLower=F.createLabel(v.rightLower);this.altTitle=F.createLabel(v.altTitle);return this;};this.createThumbnail=function(v){return new T(v,this);};function L(v){this.type="label";this.kind=v.kind;if(this.kind==="text"){this.file=v.file;this.key=v.key;}else if(this.kind==="property"){this.property=v.property;}else if(this.kind==="sapLabel"){this.labelOf=v.labelOf;}}this.createLabel=function(v){return new L(v,this);};this.loadConfig=function(v){a=new sap.apf.utils.Hashtable(i.messageHandler);if(v.applicationTitle){a.setItem('applicationTitle',v.applicationTitle);}var w={constructor:{hashtable:sap.apf.utils.Hashtable},instance:{messageHandler:i.messageHandler}};sap.apf.utils.migrateConfigToCategoryStepAssignment(v,w);var R=sap.apf.core.representationTypes();u(R);b(v.steps);m(v.categories);e(v.requests);h(v.bindings);if(v.representationTypes){p(v.representationTypes);}if(v.facetFilters){r.call(this,v.facetFilters);}if(v.navigationTargets){j(v.navigationTargets);}};this.addObject=function(v){if(!sap.apf.core.constants.configurationObjectTypes.hasOwnProperty(v.type)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5033",aParams:[v.type]}));}if(!(v.property)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5034"}));}a.setItem(v.id,v);};this.getConfigurationById=function(I){return a.getItem(I);};this.existsConfiguration=function(I){return a.hasItem(I);};this.getServiceDocuments=function(){var R=g("request");var v=[];R.forEach(function(w){v.push(w.service);});return sap.apf.utils.eliminateDuplicatesInArray(i.messageHandler,v);};this.getNavigationTargets=function(){var v=g("navigationTarget");return jQuery.extend(true,[],v);};this.getStepTemplates=function(){var I=g("step");var v=[];I.forEach(function(w,x){v[x]=new S(w,t);});return v;};this.getFacetFilterConfigurations=function(){var v=g("facetFilter");var w;v=jQuery.extend(true,[],v);v.forEach(function(x){if(x.preselectionFunction){w=sap.apf.utils.extractFunctionFromModulePathString(x.preselectionFunction);if(!jQuery.isFunction(w)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5035',parameters:[x.id]}));x.preselectionFunction=undefined;}else{x.preselectionFunction=w;}}});return v;};this.getCategories=function(){var I=g("category");var v=[];I.forEach(function(w,x){v[x]=new C(w,t);});return v;};this.createStep=function(v){var w=this.getConfigurationById(v);i.messageHandler.check((w!==undefined&&w.type==="step"),"Error - referenced object is undefined or has not type step",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(sap.apf.core.Step!==undefined,"Step must be defined ",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(typeof sap.apf.core.Step==="function","Step must be Ctor function");return new sap.apf.core.Step(i.messageHandler,w,this);};this.createBinding=function(B,v,w){var x=this.getConfigurationById(B);i.messageHandler.check((x!==undefined&&x.type==="binding"),"Error - oBindingConfig is undefined or has not type binding",sap.apf.core.constants.message.code.errorCheckConfiguration);x.oTitle=v;x.oLongTitle=w;return new sap.apf.core.Binding(i,x,this);};this.createRequest=function(v){if(v.entitySet){v.entityType=v.entitySet;delete v.entitySet;}var M;var R;function w(){var x=new Date();return Math.random()*x.getTime();}if(typeof v==="string"){R=this.getConfigurationById(v);if(!(R!==undefined&&R.type==="request")){M=i.messageHandler.createMessageObject({code:"5004",aParameters:[v]});i.messageHandler.putMessage(M);return undefined;}}else{R=v;i.messageHandler.check(R.type&&R.type==="request"&&R.service&&R.entityType,'Wrong request configuration when creating a new request');if(!R.id){R.id=w();s(R);}}return new sap.apf.core.Request(i,R);};if(i.constructor.registryProbe){this.getRegistry=function(){return new i.constructor.registryProbe(a);};}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.readRequest')){jQuery.sap.declare("sap.apf.core.readRequest");sap.apf.core.ReadRequest=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;this.type="readRequest";this.send=function(f,C,R){var a;var b=function(o,n){var M;var E;var d=[];if(o&&o.type&&o.type==="messageObject"){m.putMessage(o);M=o;}else{d=o.data;E=o.metadata;}C(d,E,M);};if(f){a=f.getInternalFilter()}else{a=new sap.apf.core.utils.Filter(m);}r.sendGetInBatch(a,b,R);};this.getMetadata=function(){return c.getEntityTypeMetadata(s,e);};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};};if(!jQuery.sap.isDeclared('sap.apf.core.readRequestByRequiredFilter')){jQuery.sap.declare("sap.apf.core.readRequestByRequiredFilter");sap.apf.core.ReadRequestByRequiredFilter=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;var M;this.type="readRequestByRequiredFilter";this.send=function(f,C,R){var o;var a=function(g,n){var h;var E;var D=[];if(g&&g.type&&g.type==="messageObject"){m.putMessage(g);h=g;}else{D=g.data;E=g.metadata;}C(D,E,h);};if(!M){M=c.getMetadata(s);}var p=M.getParameterEntitySetKeyProperties(e);var b="";var E=M.getEntityTypeMetadata(e);if(E.requiresFilter!==undefined&&E.requiresFilter==="true"){if(E.requiredProperties!==undefined){b=E.requiredProperties;}}var d=b.split(',');p.forEach(function(g){d.push(g.name);});var P=c.getContext().getInternalFilter().reduceToProperty(d);if(f){o=f.getInternalFilter();o.addAnd(P);}else{o=P;}r.sendGetInBatch(o,a,R);};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.instance");(function(){'use strict';jQuery.sap.require('sap.ui.thirdparty.datajs');sap.apf.modeler.core.Instance=function(p,a){var t=this;var A,C,b,c,d,S,F,N,R,E,H,e,M,f,g,h,j,L,k,m,s,l,n,o,q,r,O,u,v,w,x,y,z,B;A=(a&&a.constructor&&a.constructor.applicationHandler)||sap.apf.modeler.core.ApplicationHandler;C=(a&&a.constructor&&a.constructor.configurationHandler)||sap.apf.modeler.core.ConfigurationHandler;b=(a&&a.constructor&&a.constructor.configurationEditor)||sap.apf.modeler.core.ConfigurationEditor;c=(a&&a.constructor&&a.constructor.configurationObjects)||sap.apf.modeler.core.ConfigurationObjects;d=(a&&a.constructor&&a.constructor.configurationFactory)||sap.apf.core.ConfigurationFactory;E=(a&&a.constructor&&a.constructor.elementContainer)||sap.apf.modeler.core.ElementContainer;S=(a&&a.constructor&&a.constructor.step)||sap.apf.modeler.core.Step;F=(a&&a.constructor&&a.constructor.facetFilter)||sap.apf.modeler.core.FacetFilter;N=(a&&a.constructor&&a.constructor.navigationTarget)||sap.apf.modeler.core.NavigationTarget;R=(a&&a.constructor&&a.constructor.representation)||sap.apf.modeler.core.Representation;H=(a&&a.constructor&&a.constructor.hashtable)||sap.apf.utils.Hashtable;e=(a&&a.constructor&&a.constructor.registryProbe)||sap.apf.modeler.core.RegistryWrapper;L=(a&&a.constructor&&a.constructor.LazyLoader)||sap.apf.modeler.core.LazyLoader;M=(a&&a.constructor&&a.constructor.metadata)||sap.apf.core.Metadata;f=(a&&a.constructor&&a.constructor.entityTypeMetadata)||sap.apf.core.EntityTypeMetadata;g=(a&&a.constructor&&a.constructor.metadataFacade)||sap.apf.core.MetadataFacade;h=(a&&a.constructor&&a.constructor.metadataProperty)||sap.apf.core.MetadataProperty;j=(a&&a.constructor&&a.constructor.metadataFactory)||sap.apf.core.MetadataFactory;if(a&&a.constructor&&a.constructor.textHandler){k=new a.constructor.textHandler();}else{k=new sap.apf.modeler.core.TextHandler();}if(a&&a.constructor&&a.constructor.messageHandler){m=new a.constructor.messageHandler(true);}else{m=new sap.apf.core.MessageHandler(true);}m.setTextResourceHandler(k);m.loadConfig(sap.apf.core.messageDefinition);m.loadConfig(sap.apf.modeler.core.messageDefinition);m.activateOnErrorHandling(true);o={instance:{messageHandler:m,coreApi:t}};if(a&&a.constructor&&a.constructor.persistenceProxy){l=new a.constructor.persistenceProxy(p,o);}else{l=new sap.apf.core.OdataProxy(p,o);}if(a&&a.constructor&&a.constructor.sessionHandler){s=new a.constructors.sessionHandler(o.instance);}else{s=new sap.apf.core.SessionHandler(o.instance);}q={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:H,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:m,coreApi:t,datajs:OData,configurationFactory:{getServiceDocuments:function(){return[p.serviceRoot];}},deactivateFatalError:true};n=new sap.apf.core.MetadataFactory(q);r={constructor:{hashtable:H},instance:{messageHandler:m}};v=(a&&a.functions&&a.functions.loadApplicationHandler)||D;function D(i,I){new A({instance:{messageHandler:m,persistenceProxy:l},constructor:{hashtable:H},functions:{resetConfigurationHandler:K}},J);function J(P,Q){I(i,P,Q);}function K(P){if(y.getId()===P){y.getInstance().removeAllConfigurations();y.reset();}}}x=new L(r,v);w=(a&&a.functions&&a.functions.loadConfigurationHandler)||G;function G(i,I,J){var K=function(V,W){var X,Y;var Z;var $;var _=J;if(W){I(i,undefined,W);}else{Z=V[0];$=V[1];Y={instance:{messageHandler:m,persistenceProxy:l},constructor:{hashtable:H}};X=new sap.apf.modeler.core.TextPool(Y,i,$);if(!_){_=new C({instance:{messageHandler:m,persistenceProxy:l,datajs:OData,coreApi:t,metadataFactory:n},constructor:{configurationEditor:b,configurationFactory:d,configurationObjects:c,elementContainer:E,entityTypeMetadata:f,facetFilter:F,navigationTarget:N,hashtable:H,representation:R,registryProbe:e,step:S,lazyLoader:L},functions:{getApplication:x.getInstance().getApplication}});}_.setApplicationIdAndContext(i,Z,X);I(i,_,W);}};var P=new sap.apf.core.utils.Filter(m,'Application','eq',i);var Q=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);Q.addAnd(P);var T=[];var U=["AnalyticalConfiguration","AnalyticalConfigurationName","Application","CreatedByUser","CreationUTCDateTime","LastChangeUTCDateTime","LastChangedByUser"];T.push({entitySetName:"configuration",filter:P,selectList:U});T.push({entitySetName:'texts',filter:Q});l.readCollectionsInBatch(T,K,true);}y=new L(r,w);O=(a&&a.functions&&a.functions.odataRequestWrapper)||sap.apf.core.odataRequestWrapper;u=(a&&a.functions&&a.functions.ajax)||sap.apf.core.ajax;this.ajax=function(i){return u(i);};this.odataRequest=function(i,I,J,K){O(m,i,I,J,K);};this.checkForTimeout=function(i){var I=sap.apf.core.utils.checkForTimeout(i);if(I){m.putMessage(I);}return I;};this.getEntityTypeMetadata=function(i,I){return n.getEntityTypeMetadata(i,I);};this.getXsrfToken=function(i){return s.getXsrfToken(i);};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getText=function(i,P){return k.getText(i,P);};this.putMessage=function(i){return m.putMessage(i);};this.check=function(i,I,J){return m.check(i,I,J);};this.createMessageObject=function(i){return m.createMessageObject(i);};this.setCallbackForMessageHandling=function(i){m.setMessageCallback(i);};this.importTexts=function(I,J){var K;var i;var P;var Q;var T;function U(W,X,K){var Y;var Z;if(K){J(K);}else{Y={instance:{messageHandler:m,persistenceProxy:l},constructor:{hashtable:H}};Z=new sap.apf.modeler.core.TextPool(Y,T,W);Z.addTextsAndSave(Q.TextElements,J);}}function V(W,X){if(X){J(X);return;}var K;var Y=W.getApplication(T);if(!Y){K=m.createMessageObject({code:11021});J(K);return;}if(y.getId()===T){y.getInstance().getTextPool().addTextsAndSave(Q.TextElements,J);}else{var Z=new sap.apf.core.utils.Filter(m,'Application','eq',T);var $=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);$.addAnd(Z);l.readCollection("texts",U,undefined,undefined,$,true);}}Q=sap.apf.modeler.core.parseTextPropertyFile(I,{instance:{messageHandler:m}});if(Q.Messages.length>0){K=m.createMessageObject({code:11020});P=Q.Messages.length;for(i=0;i<P-1;i++){Q.Messages[i+1].setPrevious(Q.Messages[i]);}K.setPrevious(Q.Messages[P-1]);J(K);}else{T=Q.Application;this.getApplicationHandler(V);}};this.importConfiguration=function(i,I,J){var K=JSON.parse(i);var P=K.configHeader;var Q;if(!T(K,J)){return;}this.getApplicationHandler(U);function T(K,J){var Y=[],T=true,Z;if(!sap.apf.utils.isValidGuid(K.configHeader.Application)){Y.push(m.createMessageObject({code:11037,aParameters:[K.configHeader.Application]}));T=false;}if(!sap.apf.utils.isValidGuid(K.configHeader.AnalyticalConfiguration)){Y.push(m.createMessageObject({code:11038,aParameters:[K.configHeader.AnalyticalConfiguration]}));T=false;}Z=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(K);Z.forEach(function($){var _=new H(m);if(!_.hasItem($)){_.setItem($,$);if(!sap.apf.utils.isValidGuid($)){Y.push(m.createMessageObject({code:11039,aParameters:[$]}));T=false;}}});if(T){return T;}Y.forEach(function($,_,Y){if(_){$.setPrevious(Y[_-1]);}});J(i,undefined,Y[Y.length-1]);return T;}function U(Y,Z){if(Z){J(undefined,undefined,Z);return;}var $=false;var _=Y.getList();Q=P.Application;_.forEach(function(b1){if(b1.Application===P.Application){$=true;}});if($){t.getConfigurationHandler(P.Application,W);}else{var a1={ApplicationName:P.ApplicationName,SemanticObject:P.SemanticObject};Y.setAndSave(a1,V,P.Application,true);}}function V(Y,Z,$){if($){J(undefined,undefined,$);return;}t.getConfigurationHandler(P.Application,W);}function W(Y,Z){if(Z){J(undefined,undefined,Z);return;}var $=jQuery.extend({},K,true);delete $.configHeader;var _=false;var a1=Y.getList();a1.forEach(function(e1){if(e1.AnalyticalConfiguration===P.AnalyticalConfiguration){_=true;}});if(_){I(c1,d1);}else{Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName},P.AnalyticalConfiguration);var b1={id:P.AnalyticalConfiguration,creationDate:P.CreationUTCDateTime,lastChangeDate:P.LastChangeUTCDateTime,content:$};Y.loadConfiguration(b1,X);}function c1(){Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName},P.AnalyticalConfiguration);var b1={updateExisting:true,id:P.AnalyticalConfiguration,creationDate:P.CreationUTCDateTime,lastChangeDate:P.LastChangeUTCDateTime,content:$};Y.loadConfiguration(b1,X);}function d1(){var e1=Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName});var i={id:e1,content:$};Y.loadConfiguration(i,X);}}function X(Y,Z){if(Z){J(undefined,undefined,Z);return;}Y.save(J);}};this.getApplicationHandler=function(i){x.asyncGetInstance("ApplicationHandlerId",function(I,J){i(I,J);});};this.getConfigurationHandler=function(i,I){y.asyncGetInstance(i,function(J,K){I(J,K);});};this.getUnusedTextKeys=function(i,I){var J={instance:{messageHandler:m,persistenceProxy:l},constructor:{hashtable:H}};var K=new c(J);var P=null,Q=null,T=null;K.getTextKeysFromAllConfigurations(i,function(V,W){if(Q){return;}P=V;Q=W;if(W||T){U();}});this.getConfigurationHandler(i,function(V,W){if(Q){return;}T=V;Q=W;if(W||P){U();}});function U(){var V=[];if(Q){I(undefined,Q);return;}T.getTextPool().getTextKeys().forEach(function(W){if(!P.hasItem(W)){V.push(W);}});I(V,undefined);}};this.resetConfigurationHandler=function(){y.reset();};this.getRepresentationTypes=function(){var i=sap.apf.core.representationTypes();var I=[];jQuery.extend(true,I,i);return I;};this.getAllAvailableSemanticObjects=function(i){function I(P,Q){B=P.results;i(P.results,undefined);}function J(P){var Q;if(P.messageObject){Q=P.messageObject;}else{Q=m.createMessageObject({code:"11041"});}i([],Q);}if(B){i(B,undefined);return;}var K={requestUri:"/sap/opu/odata/UI2/INTEROP/SemanticObjects?$format=json&$select=id,text",method:"GET",headers:{"x-csrf-token":s.getXsrfToken("/sap/opu/odata/UI2/INTEROP/SemanticObjects")}};t.odataRequest(K,I,J);};this.getSemanticActions=function(I){var J;var K=jQuery.Deferred();if(!z){z=new H(m);}J=z.getItem(I);if(J){K.resolve(J);return K.promise();}t.getAllAvailableSemanticObjects(P);return K.promise();function P(Q,T){if(T){fnCallback(undefined,T);return;}var U=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var V;var i;if(!U){fnCallback(undefined,m.createMessageObject({code:"5038"}));return;}for(i=0;i<Q.length;i++){if(Q[i].id===I){V=Q[i];break;}}U.getSemanticObjectLinks(I,undefined,true,a.instances.component,undefined).done(function(W){var X=[];W.forEach(function(Y){var Z=Y.intent.split("-");var $=Z[1].split("?");var $=$[0].split("~");X.push({id:$[0],text:Y.text});});z.setItem(I,{semanticObject:V,semanticActions:X});K.resolve({semanticObject:V,semanticActions:X});}).fail(function(){K.rejectWith(m.createMessageObject({code:"11042"}));});}};if(a&&a.probe){new a.probe({constructor:{applicationHandler:A,configurationHandler:C,configurationEditor:b,configurationObjects:c,configurationFactory:d,metadataFactory:j,metadata:M,entityTypeMetadata:f,metadataFacade:g,metadataProperty:h,step:S,facetFilter:F,navigationTarget:N,representation:R,elementContainer:E,hashtable:H,lazyLoader:L,registryProbe:e},textHandler:k,messageHandler:m,sessionHandler:s,persistenceProxy:l,applicationHandler:x.getInstance(),configurationHandler:y.getInstance(),metadataFactory:n,injectForFollowUp:o,injectMetadataFactory:q,fnOdataRequestWrapper:O,ajax:u,odataRequestWrapper:O});}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.instance");sap.apf.core.Instance=function(a){'use strict';var t=this;var m=a.messageHandler;var s=a.startParameter;var r;var I={messageHandler:m,coreApi:t};var R;var M;var T;var c;var p;var S;var P;this.ajax=function(b){return sap.apf.core.ajax(b);};this.odataRequest=function(b,f,e,B){sap.apf.core.odataRequestWrapper(m,b,f,e,B);};this.getStartParameterFacade=function(){return s;};this.getMessageHandler=function(){return m;};this.putMessage=function(b){return m.putMessage(b);};this.check=function(e,b,C){return m.check(e,b,C);};this.createMessageObject=function(C){return m.createMessageObject(C);};this.activateOnErrorHandling=function(O){m.activateOnErrorHandling(O);};this.setCallbackForMessageHandling=function(C){m.setMessageCallback(C);};this.setApplicationCallbackForMessageHandling=function(C){m.setApplicationMessageCallback(C);};this.getLogMessages=function(){return m.getLogMessages();};this.checkForTimeout=function(b){var d=sap.apf.core.utils.checkForTimeout(b);if(d){m.putMessage(d);}return d;};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getMetadata=function(A){return M.getMetadata(A);};this.getMetadataFacade=function(){return M.getMetadataFacade();};this.getEntityTypeMetadata=function(A,e){return M.getEntityTypeMetadata(A,e);};this.loadApplicationConfig=function(f){R.loadConfigFromFilePath(f);};this.loadTextElements=function(b){T.loadTextElements(b);};this.getApplicationConfigProperties=function(){return R.getConfigurationProperties();};this.getResourceLocation=function(b){return R.getResourceLocation(b);};this.getPersistenceConfiguration=function(){return R.getPersistenceConfiguration();};this.getApplicationConfigurationURL=function(){return R.getApplicationConfigurationURL();};this.getCategories=function(){return c.getCategories();};this.existsConfiguration=function(i){return c.existsConfiguration(i);};this.getStepTemplates=function(){return c.getStepTemplates();};this.getFacetFilterConfigurations=function(){return c.getFacetFilterConfigurations();};this.getNavigationTargets=function(){return c.getNavigationTargets();};this.createStep=function(b,f,d){var e;function g(){var h;var i;if(e&&d){h=e.getRepresentationInfo();h.forEach(function(j){if(j.representationId===d){i=d;}});if(i){e.setSelectedRepresentation(i);}else{m.putMessage(m.createMessageObject({code:'5037',aParameters:[d]}));}}}m.check(b!==undefined&&typeof b==="string"&&b.length!==0,"sStepID is  unknown or undefined");e=c.createStep(b);g();p.addStep(e,f);return e;};this.getSteps=function(){return p.getSteps();};this.moveStepToPosition=function(b,n,f){p.moveStepToPosition(b,n,f);};this.updatePath=function(f,C){p.update(f,C);};this.removeStep=function(b,f){p.removeStep(b,f);};this.resetPath=function(b){if(b){r=jQuery.extend(true,{},p);}p=new sap.apf.core.Path(I);};this.restoreOriginalPath=function(){if(r){p=r;}};this.stepIsActive=function(b){return p.stepIsActive(b);};this.serializePath=function(){return p.serialize();};this.deserializePath=function(b){p.deserialize(b);};this.getTextNotHtmlEncoded=function(l,b){return T.getTextNotHtmlEncoded(l,b);};this.getTextHtmlEncoded=function(l,b){return T.getTextHtmlEncoded(l,b);};this.isInitialTextKey=function(b){return(b===sap.apf.core.constants.textKeyForInitialText);};this.getMessageText=function(C,b){return T.getMessageText(C,b);};this.getXsrfToken=function(b){return S.getXsrfToken(b);};this.setContext=function(C){S.setContext(C);};this.getContext=function(){return S.getContext();};this.getLogicalSystem=function(){return S.getLogicalSystem();};this.createReadRequest=function(b){var d=c.createRequest(b);var e;if(typeof b==='string'){e=c.getConfigurationById(b);}else{e=b;}return new sap.apf.core.ReadRequest(I,d,e.service,e.entityType);};this.createReadRequestByRequiredFilter=function(b){var d=c.createRequest(b);var e;if(typeof b==='string'){e=c.getConfigurationById(b);}else{e=b;}return new sap.apf.core.ReadRequestByRequiredFilter(I,d,e.service,e.entityType);};this.loadMessageConfiguration=function(b,d){m.loadConfig(b,d);};this.loadAnalyticalConfiguration=function(C){c.loadConfig(C);};this.savePath=function(b,d,e,f){var g;var n;var C;var E;if(typeof b==='string'&&typeof d==='string'&&typeof e==='function'){g=b;n=d;C=e;E=f;P.modifyPath(g,n,C,E);}else if(typeof b==='string'&&typeof d==='function'){n=b;C=d;E=e;P.createPath(n,C,E);}else{m.putMessage(sap.apf.core.createMessageObject({code:"5027",aParameters:[b,d,e]}));}};this.readPaths=function(C){P.readPaths(C);};this.openPath=function(b,C,n){return P.openPath(b,C,n);};this.deletePath=function(b,C){P.deletePath(b,C);};this.createFilter=function(b){return new sap.apf.utils.Filter(m,b);};this.getActiveStep=function(){return p.getActiveSteps()[0];};this.getCumulativeFilterUpToActiveStep=function(){return p.getCumulativeFilterUpToActiveStep();};this.setActiveStep=function(b){p.makeStepActive(b);var A=p.getActiveSteps();var i;for(i=0;i<A.length;++i){p.makeStepInactive(A[i]);}return p.makeStepActive(b);};this.createFirstStep=function(b,d,e){var i=false;var f;f=t.getStepTemplates();f.forEach(function(g){i=g.id===b?true:i;});if(!i){m.putMessage(m.createMessageObject({code:'5036',aParameters:[b]}));}else{t.createStep(b,e,d);}};R=new sap.apf.core.ResourcePathHandler(I);T=new sap.apf.core.TextResourceHandler(I);m.setTextResourceHandler(T);c=new sap.apf.core.ConfigurationFactory(I);var o={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:sap.apf.utils.Hashtable,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:I.messageHandler,coreApi:t,datajs:OData,configurationFactory:c};M=new sap.apf.core.MetadataFactory(o);p=new sap.apf.core.Path(I);S=new sap.apf.core.SessionHandler(I);P=new sap.apf.core.Persistence(I);};};if(!jQuery.sap.isDeclared('sap.apf.modeler.Component')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.modeler.Component");jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.routing.RouteMatchedHandler');sap.ui.core.UIComponent.extend("sap.apf.modeler.Component",{oCoreApi:null,metadata:{"dependencies":{"libs":["sap.m","sap.ui.layout"]},"config":{"fullWidth":true},routing:{"config":{viewType:"XML",viewPath:"sap.apf.modeler.ui.view",clearTarget:false},"routes":{"applicationList":{pattern:"",view:"applicationList",targetAggregation:"pages",targetControl:"applicationList","subroutes":[{pattern:"app/{appId}",view:"configurationList",name:"configurationList",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}",view:"configurationList",name:"configuration",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}/category/{categoryId}",view:"configurationList",name:"category",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}/facetFilter/{facetFilterId}",view:"configurationList",name:"facetFilter",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}/category/{categoryId}/step/{stepId}",view:"configurationList",name:"step",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}/category/{categoryId}/step/{stepId}/repn/{representationId}",view:"configurationList",name:"representation",targetAggregation:"pages"},{pattern:"app/{appId}/config/{configId}/navigationTarget/{navTargetId}",view:"configurationList",name:"navigationTarget",targetAggregation:"pages"}]}}}},init:function(){var p={serviceRoot:"/sap/hba/r/apf/core/odata/modeler/AnalyticalConfiguration.xsodata"};var i={instances:{component:this}};this.oCoreApi=new sap.apf.modeler.core.Instance(p,i);var a=this.oCoreApi.getUriGenerator().getApfLocation();jQuery.sap.includeStyleSheet(a+"modeler/resources/css/configModeler.css","configModelerCss");sap.ui.core.UIComponent.prototype.init.apply(this,arguments);var r=this.getRouter();this.oRouteHandler=new sap.m.routing.RouteMatchedHandler(r);r.initialize();},createContent:function(){if(a===undefined){var a=sap.ui.view({viewName:"sap.apf.modeler.ui.view.applicationList",type:"XML",viewData:this.oCoreApi});}var b=this.oCoreApi.getUriGenerator().getApfLocation();return a;}});}());};if(!jQuery.sap.isDeclared('sap.apf.api')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.api');sap.apf.Api=function(c,i){var p=null;var m;var C;var s;var n;this.type='api';this.constants={};this.constants.eventTypes=sap.apf.core.constants.eventTypes;s=new sap.apf.utils.StartParameter(c);m=new sap.apf.core.MessageHandler();C=new sap.apf.core.Instance({startParameter:s,messageHandler:m});this.activateOnErrorHandling=function(h){return C.activateOnErrorHandling(h);};this.getStartParameterFacade=function(){return C.getStartParameterFacade();};this.setCallbackForMessageHandling=function(f){return C.setCallbackForMessageHandling(f);};this.setApplicationCallbackForMessageHandling=function(f){return C.setApplicationCallbackForMessageHandling(f);};this.getLogMessages=function(){return C.getLogMessages();};this.createStep=function(a,f,r){return C.createStep(a,f,r);};this.getActiveStep=function(){return C.getActiveStep();};this.getCategories=function(){return C.getCategories();};this.getContext=function(){return jQuery.extend({},C.getContext());};this.getSteps=function(){return C.getSteps();};this.getStepTemplates=function(){return C.getStepTemplates();};this.getFacetFilterConfigurations=function(){return C.getFacetFilterConfigurations();};this.getApplicationConfigProperties=function(){return C.getApplicationConfigProperties();};this.moveStepToPosition=function(o,a,f){return C.moveStepToPosition(o,a,f);};this.removeStep=function(o,f){return C.removeStep(o,f);};this.resetPath=function(){return C.resetPath();};this.setActiveStep=function(o){return C.setActiveStep(o);};this.stepIsActive=function(o){return C.stepIsActive(o);};this.updatePath=function(f){return C.updatePath(f);};this.getApfLocation=function(){return C.getUriGenerator().getApfLocation();};this.readPaths=function(f){return C.readPaths(f);};this.savePath=function(a,N,f){C.savePath(a,N,f);};this.openPath=function(a,f,b){return C.openPath(a,f,b);};this.deletePath=function(a,f){return C.deletePath(a,f);};this.setContext=function(f){P.update('ApfInitialContext',f);};this.addFacetFilter=function(f){u.getLayoutView().getController().addFacetFilter(f);};this.getEventCallback=function(e){return u.getEventCallback(e);};this.putMessage=function(M){return C.putMessage(M);};this.createMessageObject=function(o){return C.createMessageObject(o);};this.getTextHtmlEncoded=function(l,a){return C.getTextHtmlEncoded(l,a);};this.getTextNotHtmlEncoded=function(l,a){return C.getTextNotHtmlEncoded(l,a);};this.loadApplicationConfig=function(f){C.loadApplicationConfig(f);};this.createFilter=function(){return C.createFilter();};this.addPathFilter=function(f){return P.add(f);};this.updatePathFilter=function(a,f){P.update(a,f);};this.getPathFilter=function(a){return P.get(a);};this.createReadRequest=function(r){return C.createReadRequest(r);};this.createReadRequestByRequiredFilter=function(r){return C.createReadRequestByRequiredFilter(r);};var P=new sap.apf.utils.PathContextHandler({setContext:C.setContext},C.getMessageHandler());n=new sap.apf.utils.NavigationHandler({instances:{messageHandler:m,component:c},functions:{getCumulativeFilterUpToActiveStep:C.getCumulativeFilterUpToActiveStep,getNavigationTargets:C.getNavigationTargets,serializePath:C.serializePath,serializeContext:P.serialize,deserializePath:C.deserializePath,deserializeContext:P.deserialize}});var S=new sap.apf.utils.SerializationMediator({coreApi:C,pathContextHandler:P});var d={oCoreApi:C,oPathContextHandler:P,oSerializationMediator:S,oNavigationHandler:n,oComponent:c,oStartParameter:s};var u=new sap.apf.ui.Instance(d);C.createRepresentation=function(r,o){var a=new sap.apf.ui.representations.RepresentationInterfaceProxy(C,u);var R=sap.apf.utils.extractFunctionFromModulePathString(r);return new R(a,o);};this.selectionChanged=function(r){u.selectionChanged(r);};this.createApplicationLayout=function(){return u.createApplicationLayout();};this.startApf=function(){var t=this;if(this.fnBeforeApfStartupCallback&&typeof this.fnBeforeApfStartupCallback==="function"){this.fnBeforeApfStartupCallback.apply(c,[this]);}var a=this.createApplicationLayout();var b=n.checkMode();var e=u.handleStartup(b);e.done(function(){if(t.fnAfterApfStartupCallback&&typeof t.fnAfterApfStartupCallback==="function"){t.fnAfterApfStartupCallback.apply(c,[t]);}});return a;};this.addMasterFooterContent=function(o){return u.addMasterFooterContentRight(o);};this.setEventCallback=function(e,f){switch(e){case sap.apf.core.constants.eventTypes.contextChanged:u.setEventCallback(e,f);return true;case sap.apf.core.constants.eventTypes.printTriggered:u.setEventCallback(e,f);return true;case sap.apf.core.constants.eventTypes.format:u.setEventCallback(e,f);return true;default:return false;}};this.setCallbackBeforeApfStartup=function(f){this.fnBeforeApfStartupCallback=f;};this.setCallbackAfterApfStartup=function(f){this.fnAfterApfStartupCallback=f;};if(i){if(i.probe){p=new i.probe({coreApi:C,component:c,uiApi:u,pathContextHandler:P,serializationMediator:S,navigationHandler:n});}}};}());};if(!jQuery.sap.isDeclared('sap.apf.Component')){(function(){'use strict';jQuery.sap.declare("sap.apf.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.apf.Component",{oApi:null,metadata:{"config":{"fullWidth":true},"name":"CoreComponent","version":"0.0.1","publicMethods":["getApi"],"dependencies":{"libs":["sap.m","sap.ui.layout","sap.ca.ui","sap.viz"]}},init:function(){if(!this.oApi){this.oApi=new sap.apf.Api(this);}this.oApi.activateOnErrorHandling(true);var a=this.oApi.getStartParameterFacade().getApplicationConfigurationPath();if(a){this.oApi.loadApplicationConfig(a);}sap.ui.core.UIComponent.prototype.init.apply(this,arguments);},createContent:function(){sap.ui.core.UIComponent.prototype.createContent.apply(this,arguments);return this.oApi.startApf();},getApi:function(){return this.oApi;}});}());};
